{"result":[{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2021-06-09 20:45:29","sys_class_name":"sys_script_vtable","sys_id":"02f5d56487032300e0ef0cf888cb0b0d","sys_updated_by":"admin","sys_created_on":"2019-01-13 17:29:01","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_recent_item","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"flow":"","sys_created_by":"admin","table":"v_st_recent_item","cache_isolation_level":"","cache_strategy":"","editable":"false","sys_mod_count":"29","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"sys_update_name":"sys_script_vtable_02f5d56487032300e0ef0cf888cb0b0d","name":"v_st_recent_item","sys_policy":"protected"},{"enhanced_capacity":"true","advanced":"false","sys_updated_on":"2024-08-13 23:01:10","sys_class_name":"sys_script_vtable","sys_id":"035dde48433d61101f6d73e60db8f273","sys_updated_by":"admin","sys_created_on":"2023-03-20 23:23:56","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Subscribed Groups","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_subscribed_groups","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"38","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\n    const encodedQuery = getEncodedQuery(v_query.getCondition(\"subscription\"));\n\n    const gr = new GlideRecord(\"group_has_subscription\");\n    gr.addEncodedQuery(encodedQuery);\n    // Setting remote table row limit to 20000 along with turning on Enhanced Capacity flag\n    gr.setLimit(20000);\n    // joins\n    const helper = new sn_sub_man.SMGlideRecordHelper();\n    helper.addExtraField(gr, \"subscription.sys_id\");\n    helper.addExtraField(gr, \"group.sys_id\");\n    helper.addExtraField(gr, \"group.manager.sys_id\");\n    helper.addExtraField(gr, \"group.description\");\n    helper.addExtraField(gr, \"group.type\");\n    gr.query();\n\n    const rows = [];\n    const groupIds = [];\n    const ZERO = Number(0).toLocaleString();\n\n    while (gr.next()) {\n        const row = {\n            sys_id: gr.group.sys_id,\n            user_count: ZERO,\n            user_count_int: 0,\n            active_users_count: ZERO,\n            active_users_count_int: 0,\n            group: gr.group.sys_id,\n            manager: gr.group.manager.sys_id,\n            subscription: gr.subscription.sys_id,\n            type: gr.group.type,\n            description: gr.group.description\n        };\n        groupIds.push(String(row.group));\n        rows.push(row);\n    }\n\n    const userCountsByGroup = getNumGroupMembersByGroupIDs(groupIds);\n    const activeUserCountsByGroup = new sn_entitlement.UserDao().getActiveGroupMembersCountByGroupIDs(groupIds);\n    rows.forEach(row => {\n        const grpId = String(row.group);\n        if (userCountsByGroup.has(grpId)) {\n            row.user_count = Number(userCountsByGroup.get(grpId)).toLocaleString();\n            row.user_count_int = userCountsByGroup.get(grpId);\n            row.active_users_count = Number(activeUserCountsByGroup.get(grpId) | 0).toLocaleString();\n            row.active_users_count_int = activeUserCountsByGroup.get(grpId) | 0;\n        }\n\n        v_table.addRow(row);\n    });\n\n    function getNumGroupMembersByGroupIDs(groupIds) {\n        const counts = new Map();\n\n        if (groupIds.length === 0)\n            return counts;\n\n        const grmembers = new GlideAggregate('sys_user_grmember');\n        grmembers.addQuery('group', \"IN\", groupIds);\n        grmembers.addAggregate('COUNT', \"group\");\n        grmembers.query();\n        while (grmembers.next()) {\n            counts.set(grmembers.getValue(\"group\"), grmembers.getAggregate(\"COUNT\", \"group\"));\n        }\n\n        return counts;\n    }\n\n    function getEncodedQuery(subscriptionIDCondition) {\n        // If this remote table is being queried by subscription ID, optimize our query of the group_has_subscription table\n        // to only retrieve the relevant records\n        if (gs.nil(subscriptionIDCondition))\n            return \"\";\n\n        const [key, value] = subscriptionIDCondition.split(\"=\");\n        const shouldApplyIDCondition = key === \"subscription\" && !gs.nil(value);\n\n        if (shouldApplyIDCondition) {\n            return \"subscription=\" + value;\n        } else\n            return \"\";\n    }\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_035dde48433d61101f6d73e60db8f273","update_script":"","delete_script":"","name":"Subscribed Groups","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-11-21 19:10:30","sys_class_name":"sys_script_vtable","sys_id":"0712d9f8373012109f982bc4f3924b7b","sys_updated_by":"admin","sys_created_on":"2024-09-19 21:23:22","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"MIF Application Trust Profiles defn","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/47401582b7a6b9501e8f827b9e11a913","value":"47401582b7a6b9501e8f827b9e11a913"},"flow":"","sys_created_by":"admin","table":"sn_mif_application_trust_profile","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"8","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar gr = new GlideAggregate(\"sn_mif_capability\");\n\tgr.addNotNullQuery(\"application.name\");\n\tgr.groupBy(\"application\");\n\tgr.query();\n\twhile (gr.next()) {\n\t\tvar appId = gr.getValue(\"application\");\n\t\tv_table.addRow({\n\t\t\tsys_id: appId,\n\t\t\tapplication: appId,\n\t\t\tdescription: \"Trust Profile for \" + gr.getValue(\"application.name\")\n\t\t});\n\t}\n  })(v_table, v_query);","insert_script":"(function executeInsert(v_record) {     // Parameters:     //      v_record is a map of field names and values containing the sys_id of the     //              record and the fields that need to be inserted in the record on the     //              remote system (source of data)          //          v_record.<field_name>                   - fields in the remote table GlideRecord     //          v_record.setLastErrorMessage(message)   - signal an error      // Sample code:     //  try {     //      update-external-system;     //      if (there-was-an-error) {     //          var message = ...;     //          v_record.setLastErrorMessage(message);     //      }     //  } catch (ex) {     //      var message = ex.getMessage();     //      v_record.setLastErrorMessage(message);     //  }  })(v_record);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/47401582b7a6b9501e8f827b9e11a913","value":"47401582b7a6b9501e8f827b9e11a913"},"sys_update_name":"sys_script_vtable_0712d9f8373012109f982bc4f3924b7b","update_script":"(function executeUpdate(v_record, v_changed_fields) {     // Parameters:     //    v_record - a map of field names and values containing the sys_id of the record     //          v_record.<field_name>                   - fields in the remote table GlideRecord     //          v_record.setLastErrorMessage(message)   - signal an error     //    v_changed_fields - a map of field names and values containing the sys_id of the     //          v_changed_fields.<field_name>           - changed fields in the remote table GlideRecord      // Sample code:     //  try {     //      update-external-system;     //      if (there-was-an-error) {     //          var message = ...;     //          v_record.setLastErrorMessage(message);     //      }     //  } catch (ex) {     //      var message = ex.getMessage();     //      v_record.setLastErrorMessage(message);     //  }  })(v_record, v_changed_fields);","delete_script":"(function executeDelete(v_record) {     // Parameters:     //      v_record - a map of field names and values containing (among others) the     //              sys_id of the record that needs to be deleted on the remote system     //          v_record.<field_name>                  - fields in the remote table GlideRecord     //          v_record.setLastErrorMessage(message)   - signal an error      // Sample code:     //  try {     //      update-external-system;     //      if (there-was-an-error) {     //          var message = ...;     //          v_record.setLastErrorMessage(message);     //      }     //  } catch (ex) {     //      var message = ex.getMessage();     //      v_record.setLastErrorMessage(message);     //  }  })(v_record);","name":"MIF Application Trust Profiles defn","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-02-08 05:19:25","sys_class_name":"sys_script_vtable","sys_id":"0da495a0878a1010420e5cdac5cb0ba6","sys_updated_by":"admin","sys_created_on":"2020-07-13 12:42:25","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"sn_km_mr_st_kb_knowledge","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"flow":"","sys_created_by":"admin","table":"sn_km_mr_st_kb_knowledge","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"3","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    var kbList = new GlideRecordSecure(\"kb_knowledge\");\n    var query = v_query.getEncodedQuery();\n    if (query)\n        kbList.addEncodedQuery(query);\n\n    kbList.setLimit(100);\n    kbList.query();\n\tvar isHeaderCustomized = true;\n\tvar nativeArticleScreen = new GlideRecord(\"sys_sg_form_screen\");\n\tif(nativeArticleScreen.get(\"c80c22e987521010420e5cdac5cb0b27\") && nativeArticleScreen.use_view_config)\n\t\tisHeaderCustomized =false;\n\tvar emptyStar = '☆', filledStar = '★';\n\tif(!isHeaderCustomized){\n\t\temptyStar='';\n\t\tfilledStar='';\n\t}\n\t\n\tvar helpfulStyle = \"text-align: center; font-size: 16px;\";\n\n    while (kbList.next()) {\n        var viewModel = new global.KBViewModel();\n        if (!viewModel.getInfoById(kbList.getUniqueValue()))\n            continue;\n\n        var kbRecord = viewModel.knowledgeRecord;\n        var contentAndMedia = viewModel.getArticleContentAndMedia();\n\n        var lastUsefulRating = viewModel.getLastFeedback('useful', false);\n        var viewCount = kbRecord.sys_view_count;\n\n\t\tv_table.addRow({\n            sys_id: kbList.getUniqueValue(),\n            number: kbRecord.getDisplayValue('number'),\n            rating: getRating(kbRecord.rating),\n            last_rating: viewModel.getLastFeedback('rating', false),\n            last_helpful_rating: lastUsefulRating == 'yes' ? 1 : lastUsefulRating == 'no' ? 2 : 0,\n            short_description: kbRecord.getDisplayValue('short_description'),\n            author: kbRecord.author,\n\t\t\tlanguage: kbRecord.getDisplayValue('language'),\n            content: contentAndMedia.content,\n            helpful_text: viewModel.helpfulText? '<div style=\"' + helpfulStyle + '\">' + viewModel.helpfulText + '</div>': '',\n            view_count: viewCount == 1 ? gs.getMessage('{0} View', viewCount) : gs.getMessage('{0} Views', viewCount),\n            last_updated_on: gs.getMessage('Updated {0}', viewModel.getTimeAgoText('sys_updated_on')),\n            embedded_media: contentAndMedia.media\n        });\n    }\n\n    function getRating(rating) {\n        var roundedRating = Math.round(rating);\n        var icons = [];\n        while (roundedRating-- > 0)\n            icons.push(filledStar);\n        while (icons.length < 5)\n            icons.push(emptyStar);\n        return icons.join(' ');\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"sys_update_name":"sys_script_vtable_0da495a0878a1010420e5cdac5cb0ba6","update_script":"","delete_script":"","name":"sn_km_mr_st_kb_knowledge","sys_policy":""},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2024-03-21 03:39:35","sys_class_name":"sys_script_vtable","sys_id":"16dee97c43333110805a71f1cbb8f209","sys_updated_by":"admin","sys_created_on":"2024-01-15 10:12:06","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Now Assist Creator Instances Defn","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_now_assist_creator_instances","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"8","active":"true","cache_ttl":"3600","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    const rows = new SMv2GenAIInstancesTableProvider(sn_entitlement.LicensingEngineConstants.CREATOR).getRows();\n    rows.forEach(row => {\n        v_table.addRow(row);\n    });\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_16dee97c43333110805a71f1cbb8f209","update_script":"","delete_script":"","name":"Now Assist Creator Instances Defn","sys_policy":""},{"enhanced_capacity":"true","advanced":"true","sys_updated_on":"2024-06-03 18:27:30","sys_class_name":"sys_script_vtable","sys_id":"180c0a14436a021073e946c8dbb8f202","sys_updated_by":"admin","sys_created_on":"2024-05-29 15:55:47","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Stuck Jobs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/74fdcd7a437121109fa864cec7b8f27b","value":"74fdcd7a437121109fa864cec7b8f27b"},"flow":"","sys_created_by":"admin","table":"sn_async_dashboard_st_stuck_jobs","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"18","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar utils = new AsyncDashboardUtils();\n\tvar gr = utils.getStuckJobs();\n\n    while (gr.next()) {\n        var row = {\n            sys_id: gr.getUniqueValue(),\n\t\t\tname: gr.getUniqueValue(),\n\t\t\tsystem_id: gr.getValue(\"system_id\"),\n\t\t\ttrigger_type: gr.getValue(\"trigger_type\"),\n\t\t\tpriority: gr.getValue(\"priority\"),\n\t\t\tnext_action: gr.getValue(\"next_action\"),\n\t\t\tstate: gr.getValue(\"state\"),\n\t\t\tlateness: utils.getTimeDelayed(new GlideDateTime(gr.getValue(\"next_action\")), new GlideDateTime(gr.getValue(\"sys_updated_on\")))\n        };\n        v_table.addRow(row);\n    }\n  })(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/74fdcd7a437121109fa864cec7b8f27b","value":"74fdcd7a437121109fa864cec7b8f27b"},"sys_update_name":"sys_script_vtable_180c0a14436a021073e946c8dbb8f202","update_script":"","delete_script":"","name":"Stuck Jobs","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-07-03 04:17:34","sys_class_name":"sys_script_vtable","sys_id":"1b235a8af732061086c7d3e543bfd627","sys_updated_by":"admin","sys_created_on":"2024-06-16 13:31:08","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Similar Task","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"admin","table":"v_st_km_genai_mra_similar_task","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"2","active":"true","cache_ttl":"0","sys_domain_path":"","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    \n    //Open task record instead of virtual table record\n    if (v_query.isGet()) {\n        gs.setRedirect(\"task.do?sys_id=\" + v_query.getSysId());\n        return;\n    }\n    var query = v_query.getEncodedQuery();\n    var table = v_query.getParameter('table');\n    if (GlidePluginManager.isActive('sn_km_gen_ai') && !gs.nil(query)) {\n\t\tnew global.KMGenAISimilarTaskSearchUtil().getTasks(query, table, v_table);\n        \n    } else return;\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/2fe727ff04b12210559073c06a02f7dd","value":"2fe727ff04b12210559073c06a02f7dd"},"sys_update_name":"sys_script_vtable_1b235a8af732061086c7d3e543bfd627","update_script":"","delete_script":"","name":"Similar Task","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2023-05-04 16:07:54","sys_class_name":"sys_script_vtable","sys_id":"234928664f266110ebc21c51b1ce0bd0","sys_updated_by":"maint","sys_created_on":"2023-05-04 16:07:54","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Configuration Hub Performance Metric","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/2028fe718b11c8f32122c6da3b496a83","value":"2028fe718b11c8f32122c6da3b496a83"},"flow":"","sys_created_by":"maint","table":"st_dfc_performance_metric","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"0","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    var referenceTables = [{\n            table: 'sys_transaction_pattern',\n            scopeColumnName: 'origin_scope'\n        },\n        {\n            table: 'sys_script_pattern',\n            scopeColumnName: 'script_scope'\n        },\n        {\n            table: 'sysevent_pattern',\n            scopeColumnName: 'event_scope'\n        }\n    ];\n\n    for (var i = 0; i < referenceTables.length; i++) {\n        var records = getReferenceRecords(referenceTables[i].table, referenceTables[i].scopeColumnName);\n        populateVTable(records);\n    }\n\n    function populateVTable(rows) {\n        for (var i = 0; i < rows.length; i++) {\n            v_table.addRow(rows[i]);\n        }\n    }\n\n    function getReferenceRecords(table, scopeColumnName) {\n        var records = [];\n        var glideRecord = new GlideRecord(table);\n        glideRecord.addQuery(scopeColumnName, '!=', 'global');\n        glideRecord.query();\n\n        if (!glideRecord.hasNext())\n            return records;\n\n        while (glideRecord.next()) {\n            var record = {\n                scope: glideRecord.getValue(scopeColumnName),\n            };\n\n            // Adding reference table to record;\n            record[table] = glideRecord.getUniqueValue();\n\n            records.push(record);\n        }\n\n        return records;\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/2028fe718b11c8f32122c6da3b496a83","value":"2028fe718b11c8f32122c6da3b496a83"},"sys_update_name":"sys_script_vtable_234928664f266110ebc21c51b1ce0bd0","update_script":"","delete_script":"","name":"Configuration Hub Performance Metric","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2020-03-19 13:38:45","sys_class_name":"sys_script_vtable","sys_id":"25294c1b87230010e0ef0cf888cb0b86","sys_updated_by":"admin","sys_created_on":"2020-03-19 13:38:45","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_sc_catalog","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"flow":"","sys_created_by":"admin","table":"v_st_sc_catalog","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"0","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar start = v_query.getFirstRowWanted();\n\tvar end = v_query.getLastRowWanted();\n\tvar index = -1;\n\t\n\t//reset the window for glide record\n\tv_query.setFirstRowWanted(0);\n\tv_query.setLastRowWanted(end - start);\n\t\n\tvar portalCatalogs = new sn_scmobile.MobileCatalogUtil().getCatalogsInPortal('mesp').value || '';\n\tportalCatalogs = portalCatalogs.split(',');\n\tportalCatalogs.forEach(function (catalogID) {\n\t\tvar catalogObj = new sn_sc.Catalog(catalogID);\n\t\tif (catalogObj == null || !catalogObj.canView())\n\t\t\treturn;\n\t\t\n\t\tindex++;\n\t\tif (index < start)\n\t\t\treturn;\n\t\tif (index >= end)\n\t\t\treturn;\n\t\t\n\t\tvar row = {};\n\t\trow.sys_id = catalogObj.getID();\n\t\trow.title = catalogObj.getTitle();\n\t\trow.short_description = catalogObj.getDescription();\n\t\trow.picture = catalogObj.getDesktopImageSRC();\n\t\trow.picture = row.picture || '';\n\t\trow.picture = row.picture.substring(0,32);\n\t\trow.table = 'sc_catalog';\n\t\tv_table.addRow(row);\n\t});\n  })(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"sys_update_name":"sys_script_vtable_25294c1b87230010e0ef0cf888cb0b86","update_script":"","delete_script":"","name":"v_st_sc_catalog","sys_policy":""},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2023-10-12 20:46:21","sys_class_name":"sys_script_vtable","sys_id":"30b7d93e43113110805a71f1cbb8f246","sys_updated_by":"admin","sys_created_on":"2023-09-19 07:02:04","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Gen AI Metadata defn","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_gen_ai_metadata","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"10","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    var encodedQuery = v_query.getCondition(\"subscription.sys_id\");\n    var GR = new GlideRecord('sku_metadata');\n    if(encodedQuery) {\n      GR.addEncodedQuery(encodedQuery);\n    }\n    GR.addQuery('schema', 'genai_metadata');\n    GR.query();\n    while (GR.next()) {\n        var subscriptionId = String(GR.subscription.sys_id);\n        var columnValues = GR.getValue('column_values');\n        var columnValuesArray = columnValues.split(',');\n        var featureId = columnValuesArray[0];\n        var feature = columnValuesArray[1];\n        var assistRatio = columnValuesArray[2];\n        // insert into gen_ai_metadata table\n        v_table.addRow({\n            subscription: subscriptionId,\n            feature_id: featureId,\n            feature: feature,\n            assist_ratio: assistRatio,\n            sys_id: gs.generateGUID()\n        });\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_30b7d93e43113110805a71f1cbb8f246","update_script":"","delete_script":"","name":"Gen AI Metadata defn","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-09-04 18:53:30","sys_class_name":"sys_script_vtable","sys_id":"3432e33d439202101b78ebbd2ab8f2f7","sys_updated_by":"admin","sys_created_on":"2024-05-22 03:50:21","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Scheduled Job History Trend Defintion","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/74fdcd7a437121109fa864cec7b8f27b","value":"74fdcd7a437121109fa864cec7b8f27b"},"flow":"","sys_created_by":"admin","table":"sn_async_dashboard_st_scheduled_job_history_trend","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"38","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar fixedDecimalLength = 10;\n\tvar query = \"\";\n\t//this remote table does not have a sys_id since it is an aggregated query\n\t//use job_classification instead\n\tif (v_query.isGet()) \n\t\tquery= \"job_classification=\" + v_query.getSysId();\n\telse \n\t\tquery = v_query.getEncodedQuery();\n\n\tvar gr = new GlideAggregate(\"sys_scheduler_job_history\");\n\tgr.addAggregate('SUM', 'count');\n\tgr.addAggregate('SUM', 'total');\n\tgr.addAggregate('MAX', 'max_duration');\n\tgr.addAggregate('MIN', 'time_range_start');\n\tgr.addAggregate('MAX', 'time_range_end');\n\tgr.addAggregate('SUM', 'total_lateness');\n\tgr.addEncodedQuery(query, true);\n\tgr.groupBy('job_classification');\n\tgr.groupBy('priority');\n\tgr.orderByAggregate('SUM', 'count');\n\tgr.query();\n\n\twhile(gr.next()) {\n\t\tvar count = gr.getAggregate('SUM', 'count');\n\t\tvar total_processing = gr.getAggregate('SUM', 'total');\n\t\tvar avg_processing_time = total_processing/count;\n\t\tvar total_lateness = gr.getAggregate('SUM', 'total_lateness');\n\t\tvar max_processing_time = gr.getAggregate('MAX', 'max_duration');\n\n\t\tv_table.addRow({\n\t\t\t\"sys_id\": gr.job_classification,\n\t\t\t\"job_classification\": gr.job_classification,\n\t\t\t'priority': gr.priority,\n\t\t\t'average_processing_time': parseFloat((avg_processing_time/1000).toFixed(fixedDecimalLength)),\n\t\t\t'max_processing_time': parseFloat((max_processing_time/1000).toFixed(fixedDecimalLength)),\n\t\t\t'total_processing_time': parseFloat((total_processing/1000).toFixed(fixedDecimalLength)),\n\t\t\t'total_lateness': total_lateness ? \n\t\t\t\tparseFloat((total_lateness/1000).toFixed(fixedDecimalLength)) : \n\t\t\t\tnull,\n\t\t\t'average_lateness': total_lateness ? \n\t\t\t\tparseFloat(((total_lateness/count)/1000).toFixed(fixedDecimalLength)) : \n\t\t\t\tnull,\n\t\t\t'execution_count': count,\n\t\t\t'time_range_start': gr.getAggregate('MIN', 'time_range_start'),\n\t\t\t'time_range_end': gr.getAggregate('MAX', 'time_range_end'),\n\t\t});\t\n\t}\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/74fdcd7a437121109fa864cec7b8f27b","value":"74fdcd7a437121109fa864cec7b8f27b"},"sys_update_name":"sys_script_vtable_3432e33d439202101b78ebbd2ab8f2f7","update_script":"","delete_script":"","name":"Scheduled Job History Trend Defintion","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-06-26 11:27:41","sys_class_name":"sys_script_vtable","sys_id":"3ebc16f4ff5d41102e3cc9b7cddcbda3","sys_updated_by":"admin","sys_created_on":"2022-01-24 18:47:28","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"sn_hr_sp_st_relevant_for_you","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"flow":"","sys_created_by":"admin","table":"sn_hr_sp_st_relevant_for_you","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"30","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\t\tvar data = {};\n\t\n\t\t//adding data properties\n\t\tdata.userPredictionCount = 25;\n\t\tdata.cardType = 'single';\n\t\tdata.listType = 'card-list';\n\t\n\t\n\t\t//service portal accessible knowledge bases and catalog items, need to check if they work on remote tables.\n\t\tvar knowledgeBases = getKnowledgeBases();\n\t\tvar displayCount = 10;\n\t\tdata.viewType = (displayCount > 3) ? 'max-view' : 'min-view';\n\t\tvar RelevantForYouUtil = new sn_hr_sp.RelevantForYouUtil();\n\t\tvar taxonomyId = new sn_me.MobileTaxonomyUtil().getMobileServicePortalTaxonomy();\n\t\n\t\t// creating payloads\n\t\tvar catalogPayload = {\n\t\t\tusers: null,\n\t\t\tcatalogCount: displayCount,\n\t\t\tignoredCatalogs: null,\n\t\t\trecentActivityCutoffDate: null,\n\t\t\ttaxonomyId: taxonomyId\n\t\t};\n\t\t\n\t\tvar articlesPayload = {\n\t\t\t\tusers: null,\n\t\t\t\tknowledgeBases: knowledgeBases,\n\t\t\t\tkbRecords : getAllKBRecords(knowledgeBases),\n\t\t\t\tarticleCount: displayCount,\n\t\t\t\trecentActivityCutoffDate: null,\n\t\t\t\ttaxonomyId: taxonomyId\n\t\t};\n\t\n\t\tvar dataItems = RelevantForYouUtil.getRelevantArticlesAndCatalogs(articlesPayload,catalogPayload, displayCount, data.userPredictionCount, taxonomyId);\n\t\taddRowsToVTable(dataItems);\n\t\n\t\t// ---- helper functions ----\n\t\t\n\t\t\n\t\tfunction getKnowledgeBases() {\n\t\t\tvar kbGR = new GlideRecord('kb_knowledge_base');\n\t\t\tvar kbIDs = [];\n\t\t\tkbGR.addActiveQuery();\n\t\t\tkbGR.query();\n\t\t\twhile(kbGR.next()) {\n\t\t\t\tkbIDs.push(kbGR.getUniqueValue());\n\t\t\t}\n\t\t\treturn kbIDs.join(\",\");\n\t\t}\n\t\t\n\t\tfunction getAllKBRecords(kbIDs) {\n\t\t\tvar gr = new GlideRecord(\"kb_knowledge\");\n\t\t\tif (kbIDs)\n\t\t\t\tgr.addQuery(\"kb_knowledge_base\", \"IN\", kbIDs);\n\t\n\t\t\tgr.addQuery(\"workflow_state\", \"published\");\n\t\t\treturn gr;\n\t\t}\n\n\t\tfunction timeAgo(input_date) {\n\t\t\tvar diff = (new GlideDateTime().getNumericValue()) - input_date; //milliseconds\n\n\t\t\tvar seconds = parseInt(diff / 1000);\n\t\t\tvar minutes = parseInt(seconds / 60);\n\t\t\tvar hours = parseInt(minutes / 60);\n\t\t\tvar days = parseInt(hours / 24);\n\t\t\tvar months = parseInt(days / 30);\n\t\t\tvar years = parseInt(days / 365);\n\n\t\t\tvar result = null;\n\n\t\t\tif (years) {\n\t\t\t\tresult = years > 1 ? years + \" years ago\" : years + \" year ago\";\n\t\t\t} else if (months) {\n\t\t\t\tresult = months > 1 ? months + \" months ago\" : months + \" month ago\";\n\t\t\t} else if (days) {\n\t\t\t\tresult = days > 1 ? days + \" days ago\" : days + \" day ago\";\n\t\t\t} else if (hours) {\n\t\t\t\tresult = hours > 1 ? hours + \" hours ago\" : hours + \" hour ago\";\n\t\t\t} else if (minutes) {\n\t\t\t\tresult = minutes > 1 ? minutes + \" minutes ago\" : minutes + \" minute ago\";\n\t\t\t} else if (seconds) {\n\t\t\t\tresult = \"just now\";\n\t\t\t}\n\n\t\t\tif (!result) result = String(input_date);\n\n\t\t\treturn result;\n\t\t}\n\n\tfunction addRowsToVTable(relevantItems) {\n\t\trelevantItems.forEach(function(item) {\n\t\t\tv_table.addRow({\n\t\t\t\tsys_id : item.sys_id,\n\t\t\t\tactive : true,\n\t\t\t\tcontent_sys_id : item.sys_id,\n\t\t\t\tcontent_url : item.category == 'article' ? 'id=kb_article&sys_id='+item.sys_id : 'id=sc_cat_item&sys_id='+item.sys_id,\n\t\t\t\ttitle : item.category == 'article' ? item.short_description : item.name,\n\t\t\t\tdescription : item.category == 'article' ? item.meta_description : item.short_description,\n\t\t\t\timage: item.image && item.image.replace(\".iix\", \"\"),\n\t\t\t\ttype :  item.category == 'article' ? gs.getMessage('Article') : gs.getMessage('Request'),\n\t\t\t\ticon : item.category == 'article' ? 'article-document' : 'cart-full',\n\t\t\t\tview_type : data.viewType,\n\t\t\t\tadditional_info : item.sys_updated_on ? timeAgo(new GlideDateTime(item.sys_updated_on).getNumericValue()) : '',\n\t\t\t\taccess_price: item.category == 'article' ? null : item.price \n\t\t\t});\n\t\t});\n\n\t}\n\t\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_update_name":"sys_script_vtable_3ebc16f4ff5d41102e3cc9b7cddcbda3","update_script":"","delete_script":"","name":"sn_hr_sp_st_relevant_for_you","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-02-20 06:40:07","sys_class_name":"sys_script_vtable","sys_id":"4664defdeb322010e0ef83c45e522876","sys_updated_by":"admin","sys_created_on":"2021-03-10 17:39:25","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Portal Favorite","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"admin","table":"st_portal_favorite","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"22","active":"true","cache_ttl":"0","sys_domain_path":"","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    var portalID = v_query.getParameter('portal');\n\n\tif (portalID) {\n\t\tif (new GlideSPScriptable(portalID).getValue('enable_favorites') == 'false') {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar favorite = new GlideRecord('sp_favorite');\n\t\tfavorite.addQuery(\"user\", gs.getUserID());\n\t\tfavorite.orderByDesc('sys_updated_on');\n\t\tfavorite.query();\n\n\t\twhile (favorite.next()) {\n\t\t\tvar row = getRecordDetails(favorite, portalID);\n\t\t\tif (!row.type)\n\t\t\t\tcontinue;\n\n\t\t\trow.portal = portalID;\n\t\t\tv_table.addRow(row);\n\t\t}\n\t}\n\t\n\tfunction getRecordDetails(gr, portalID) {\n\t\tvar rec = {};\n\t\tvar refRecord = new GlideRecord(gr.reference_table);\n\t\tif (refRecord.get(gr.reference_document)) {\n\t\t\tif (SPFavoriteUtil.canView(refRecord, portalID)) {\n\t\t\t\tif (refRecord.instanceOf('kb_knowledge')) {\n\t\t\t\t\trec.short_description = refRecord.getDisplayValue('short_description') || '';\n\t\t\t\t\trec.text = refRecord.getDisplayValue('text') || '';\n\t\t\t\t\trec.text = new GlideSPScriptable(portalID).stripHTML(rec.text);\n\t\t\t\t\trec.text = rec.text.substring(0, 200);\n\t\t\t\t\trec.name = refRecord.getValue('number');\n\t\t\t\t\trec.sys_id = refRecord.getValue('sys_id');\n\t\t\t\t\trec.fav_sys_id = gr.getUniqueValue();\n\t\t\t\t\trec.sys_updated_on = gr.getValue('sys_updated_on');\n\t\t\t\t\trec.table_name = refRecord.getTableName();\n\t\t\t\t\trec.type = 'kb';\n\t\t\t\t}\n\n\t\t\t\telse if (refRecord.instanceOf('sc_cat_item_guide')) {\n\t\t\t\t\trec.short_description = refRecord.getDisplayValue('short_description') || '';\n\t\t\t\t\trec.name = refRecord.getDisplayValue('name') || '';\n\t\t\t\t\trec.sys_id = refRecord.getValue('sys_id');\n\t\t\t\t\trec.fav_sys_id = gr.getUniqueValue();\n\t\t\t\t\trec.text = refRecord.getDisplayValue('description') || '';\n\t\t\t\t\trec.text = new GlideSPScriptable(portalID).stripHTML(rec.text);\n\t\t\t\t\trec.text = rec.text.substring(0, 200);\n\t\t\t\t\trec.sys_updated_on = gr.getValue('sys_updated_on');\n\t\t\t\t\trec.table_name = 'sc_cat_item_guide';\n\t\t\t\t\trec.type = 'guide';\n\t\t\t\t\tvar itemObject = new sn_sc.CatItem(rec.sys_id);\n\t\t\t\t\trec.picture = itemObject.getPicture();\n\t\t\t\t\trec.picture = rec.picture || '';\n\t\t\t\t\trec.picture = rec.picture.substring(0,32);\n\t\t\t\t}\n\n\t\t\t\telse if (refRecord.instanceOf('sc_cat_item') && !refRecord.instanceOf('sc_cat_item_guide')) {\n\t\t\t\t\trec.short_description = refRecord.getDisplayValue('short_description') || '';\n\t\t\t\t\trec.name = refRecord.getDisplayValue('name') || '';\n\t\t\t\t\trec.sys_id = refRecord.getValue('sys_id');\n\t\t\t\t\trec.fav_sys_id = gr.getUniqueValue();\n\t\t\t\t\trec.text = refRecord.getDisplayValue('description') || '';\n\t\t\t\t\trec.text = new GlideSPScriptable(portalID).stripHTML(rec.text);\n\t\t\t\t\trec.text = rec.text.substring(0, 200) ;\n\t\t\t\t\trec.sys_updated_on = gr.getValue('sys_updated_on');\n\t\t\t\t\trec.table_name = 'sc_cat_item';\n\t\t\t\t\trec.type = 'cat_item';\n\t\t\t\t\tvar itemObject = new sn_sc.CatItem(rec.sys_id);\n\t\t\t\t\trec.picture = itemObject.getPicture();\n\t\t\t\t\trec.picture = rec.picture || '';\n\t\t\t\t\trec.picture = rec.picture.substring(0,32);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse if (refRecord.instanceOf('task')) {\n\t\t\t\t\trec.short_description = refRecord.getDisplayValue('short_description') || '';\n\t\t\t\t\trec.name = refRecord.getDisplayValue('number');\n\t\t\t\t\trec.text = refRecord.getDisplayValue('description') || '';\n\t\t\t\t\trec.text = new GlideSPScriptable(portalID).stripHTML(rec.text);\n\t\t\t\t\trec.text = rec.text.substring(0, 200);\n\t\t\t\t\trec.sys_id = refRecord.getValue('sys_id');\n\t\t\t\t\trec.fav_sys_id = gr.getUniqueValue();\n\t\t\t\t\trec.sys_updated_on = gr.getValue('sys_updated_on');\n\t\t\t\t\trec.table_name = refRecord.getTableName();\n\t\t\t\t\trec.type = 'task';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\trec.short_description = refRecord.getDisplayValue('short_description') || '';\n\t\t\t\t\trec.name = refRecord.getDisplayValue() || '';\n\t\t\t\t\trec.sys_id = refRecord.getValue('sys_id');\n\t\t\t\t\trec.fav_sys_id = gr.getUniqueValue();\n\t\t\t\t\trec.sys_updated_on = gr.getValue('sys_updated_on');\n\t\t\t\t\trec.table_name = refRecord.getTableName();\n\t\t\t\t\trec.type = 'record';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn rec;\n\t}\n  })(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/cdc9abbb04f12210559073c06a02f7ae","value":"cdc9abbb04f12210559073c06a02f7ae"},"sys_update_name":"sys_script_vtable_4664defdeb322010e0ef83c45e522876","update_script":"","delete_script":"","name":"Portal Favorite","sys_policy":"read"},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-04-12 18:10:14","sys_class_name":"sys_script_vtable","sys_id":"49ea0fc043b031101f6d73e60db8f293","sys_updated_by":"maint","sys_created_on":"2023-08-17 06:06:28","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Subscription Application Family","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/bcadabf277f311109c62f5f3cb5a992a","value":"bcadabf277f311109c62f5f3cb5a992a"},"flow":"","sys_created_by":"maint","table":"sn_entitlement_st_subscription_application_family","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"63","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\n    const subscription = v_query.getParameter(\"subscription\");\n    const licenseFamily = v_query.getParameter(\"subscription_family\");\n\n    const dao = new sn_entitlement.SubscriptionApplicationFamilyDao();\n    var rows = dao.getData(subscription, licenseFamily);\n    rows.forEach(row => v_table.addRow(row));\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/bcadabf277f311109c62f5f3cb5a992a","value":"bcadabf277f311109c62f5f3cb5a992a"},"sys_update_name":"sys_script_vtable_49ea0fc043b031101f6d73e60db8f293","update_script":"","delete_script":"","name":"Subscription Application Family","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2023-04-11 12:58:10","sys_class_name":"sys_script_vtable","sys_id":"4bca960e77502110910428e47a5a9934","sys_updated_by":"admin","sys_created_on":"2023-01-11 15:05:35","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"sc_wizard_question_script","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"admin","table":"st_sc_wizard_question","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"1","active":"true","cache_ttl":"0","sys_domain_path":"","sys_tags":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/9b9dabff04352210559073c06a02f71f","value":"9b9dabff04352210559073c06a02f71f"},"sys_update_name":"sys_script_vtable_4bca960e77502110910428e47a5a9934","name":"sc_wizard_question_script","sys_policy":"protected"},{"enhanced_capacity":"true","advanced":"true","sys_updated_on":"2024-05-21 16:41:20","sys_class_name":"sys_script_vtable","sys_id":"5dd9716343022110f3063fea8eb8f2e4","sys_updated_by":"maint","sys_created_on":"2023-04-13 04:06:18","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Unallocated Group Recommendations","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_unallocated_group_recommendation","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"54","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    const getValFromVQueryCondition = (condition) => {\n        if (!condition || condition.length === 0 || condition.indexOf('=') === -1)\n            return null;\n\n        return condition.split('=')[1];\n    };\n\n    const subscriptionId = getValFromVQueryCondition(v_query.getCondition(\"subscription\"));\n\n    new sn_sub_man.UnallocatedGroupRecommendationProvider()\n        .getData(subscriptionId)\n        .forEach(row => v_table.addRow(row));\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_5dd9716343022110f3063fea8eb8f2e4","update_script":"","delete_script":"","name":"Unallocated Group Recommendations","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2022-10-26 07:54:05","sys_class_name":"sys_script_vtable","sys_id":"6b208cbc87032300e0ef0cf888cb0be0","sys_updated_by":"admin","sys_created_on":"2019-01-14 05:47:27","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_popular_item","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"flow":"","sys_created_by":"admin","table":"v_st_popular_item","cache_isolation_level":"","cache_strategy":"","editable":"false","sys_mod_count":"59","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"sys_update_name":"sys_script_vtable_6b208cbc87032300e0ef0cf888cb0be0","name":"v_st_popular_item","sys_policy":"protected"},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2021-08-05 11:27:33","sys_class_name":"sys_script_vtable","sys_id":"70e9dea8c3b43010069aec4b7d40dd4d","sys_updated_by":"admin","sys_created_on":"2021-06-14 06:49:03","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"sn_me_st_topic","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/5cfbdaac77eb2300454792718a106157","value":"5cfbdaac77eb2300454792718a106157"},"flow":"","sys_created_by":"admin","table":"sn_me_st_topic","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"81","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/5cfbdaac77eb2300454792718a106157","value":"5cfbdaac77eb2300454792718a106157"},"sys_update_name":"sys_script_vtable_70e9dea8c3b43010069aec4b7d40dd4d","name":"sn_me_st_topic","sys_policy":"protected"},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-03-01 21:33:32","sys_class_name":"sys_script_vtable","sys_id":"76e8acf043dcc210482439a56cb8f2af","sys_updated_by":"admin","sys_created_on":"2024-02-09 01:38:03","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"SM aggregates of now assists usage","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_now_assists_aggregate","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"4","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tnew NowAssistsAggregateProvider()\n\t\t.getData()\n\t\t.forEach(row => v_table.addRow(row));\n  })(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_76e8acf043dcc210482439a56cb8f2af","update_script":"","delete_script":"","name":"SM aggregates of now assists usage","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2023-08-04 06:25:00","sys_class_name":"sys_script_vtable","sys_id":"83c27bbb07e541108d6d78e99cd30007","sys_updated_by":"admin","sys_created_on":"2022-02-15 18:44:06","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Favorite","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"flow":"","sys_created_by":"admin","table":"sn_ex_sp_st_favorite","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"330","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\n    var defaultPortalID = FavoriteConstants.MESP_PORTAL;\n    var portalID = v_query.getParameter('portal') || defaultPortalID;\n    var encodedQuery = v_query.getEncodedQuery();\n\n    var contentType = getFilterQuery(encodedQuery) || \"\";\n    var sortQuery = getSortQuery(encodedQuery);\n\n    var isMobile = false;\n    var versioningEnabled = GlidePluginManager.isActive('com.snc.knowledge_advanced') && gs.getProperty(\"glide.knowman.versioning.enabled\", \"true\") === \"true\";\n    if (portalID) {\n        var portalGr = new GlideSPScriptable(portalID);\n        if (portalGr.getValue('enable_favorites') == 'false') {\n            return;\n        }\n        isMobile = portalGr.getValue('url_suffix') == \"mesp\" ? true : false;\n        var PAGINATION_WINDOW_SIZE = 20;\n        var start = v_query.getFirstRowWanted() || 0;\n        var end = v_query.getLastRowWanted() || getFavoriteCount();\n        v_query.setFirstRowWanted(0);\n        v_query.setLastRowWanted(end - start);\n\n        var favoriteConfig = new FavoriteContentConfigAPI(isMobile, contentType, portalGr);\n        var configTables = favoriteConfig.getConfigTables() || [];\n\n\n        if (isMobile) {\n            getFavoritesForMobile(PAGINATION_WINDOW_SIZE);\n        } else {\n            getFavoritesForDesktop(start, end);\n        }\n    }\n\n    function getFavoritesForMobile(windowSize) {\n\n        var index = -1;\n        var startWindow = 0;\n        var endWindow = windowSize;\n        while (true) {\n            var favoriteGr = new GlideRecord(\"sp_favorite\");\n\n            favoriteGr.addEncodedQuery(sortQuery);\n            favoriteGr.chooseWindow(startWindow, endWindow);\n            favoriteGr.addQuery(\"user\", gs.getUserID());\n            favoriteGr.addQuery(\"reference_table\", \"IN\", configTables);\n            favoriteGr.query();\n            if (!favoriteGr.hasNext())\n                break;\n\n            while (favoriteGr.next()) {\n                if (favoriteGr.getValue('reference_table') === 'kb_knowledge' && versioningEnabled) {\n                    replaceFavoriteWithLatestArticle(favoriteGr);\n                }\n                if (!canView(favoriteGr, isMobile))\n                    continue;\n\n                var favoriteDetails = getFavoriteDetails(favoriteGr) || {};\n\n                var favorite = favoriteConfig.applyConfig(favoriteDetails) || [];\n\n                if (favorite.length == 0)\n                    continue;\n\n                index++;\n\n                //skip all records to start of window\n                if (index < start)\n                    continue;\n\n                if (index < end)\n                    v_table.addRow(getRowData(favorite[0]));\n                else\n                    break;\n            }\n\n            //Check if bucket is full \n            if (index >= end)\n                break;\n\n            startWindow = endWindow;\n            endWindow = endWindow + windowSize;\n        }\n    }\n\n    function getFavoriteDetails(favoriteGr) {\n        var favoriteInfo = {\n            \"fav_sys_id\": favoriteGr.getValue(\"sys_id\") || \"\",\n            \"sys_id\": favoriteGr.getValue(\"reference_document\"),\n            \"sys_updated_on\": favoriteGr.getValue(\"sys_updated_on\"),\n            \"table_name\": favoriteGr.getValue(\"reference_table\"),\n            \"sys_created_on\": favoriteGr.getValue(\"sys_created_on\"),\n            \"last_viewed\": favoriteGr.getValue(\"last_viewed\") ? favoriteGr.getValue(\"last_viewed\") : favoriteGr.getValue(\"sys_created_on\")\n        };\n        var refTable = favoriteGr.getValue(\"reference_table\");\n        var favorite = {};\n        favorite[refTable] = [];\n        favorite[refTable].push(favoriteInfo);\n        return favorite;\n    }\n\n    function getFavoritesForDesktop(start, end) {\n        var favorites = getFavorites(start, end);\n        var response = favoriteConfig.applyConfig(favorites);\n        for (var i = 0; i < response.length; i++) {\n            var row = {};\n            row.portal = portalID;\n            row.start = start;\n            row.end = end;\n            populateRow(row, response[i]);\n            v_table.addRow(row);\n        }\n    }\n\n    function getFavorites(start, end) {\n\n        var favorites = {};\n        var favoriteGr = new GlideRecord('sp_favorite');\n        favoriteGr.addQuery(\"user\", gs.getUserID());\n        favoriteGr.addQuery(\"reference_table\", \"IN\", configTables);\n        favoriteGr.addEncodedQuery(sortQuery);\n        favoriteGr.chooseWindow(start, end);\n        favoriteGr.query();\n        while (favoriteGr.next()) {\n            if (favoriteGr.getValue('reference_table') === 'kb_knowledge' && versioningEnabled) {\n                replaceFavoriteWithLatestArticle(favoriteGr);\n            }\n            if (canView(favoriteGr, isMobile)) {\n                var referenceTable = favoriteGr.getValue(\"reference_table\");\n                if (!favorites[referenceTable]) {\n                    favorites[referenceTable] = [];\n                }\n                var favorite = {\n                    \"fav_sys_id\": favoriteGr.getValue(\"sys_id\") || \"\",\n                    \"sys_id\": favoriteGr.getValue(\"reference_document\"),\n                    \"sys_updated_on\": favoriteGr.getValue(\"sys_updated_on\"),\n                    \"table_name\": referenceTable,\n                    \"sys_created_on\": favoriteGr.getValue(\"sys_created_on\"),\n                    \"last_viewed\": favoriteGr.getValue(\"last_viewed\") ? favoriteGr.getValue(\"last_viewed\") : favoriteGr.getValue(\"sys_created_on\")\n                };\n                favorites[referenceTable].push(favorite);\n            }\n        }\n        return favorites;\n    }\n\n    /**\n     * Find the latest published version of the favorited knowledge article and update the sp_favorite record with that version.\n     * @param {GlideRecord} favoriteGr - GlideRecord on sp_favorite table.\n     **/\n    function replaceFavoriteWithLatestArticle(favoriteGr) {\n        var kbId = favoriteGr.getValue('reference_document');\n        var originalKbGr = new GlideRecord('kb_knowledge');\n        originalKbGr.get(kbId);\n        var publishedKbGr = new GlideRecord('kb_knowledge');\n        publishedKbGr.addQuery('article_id', originalKbGr.getValue('article_id'));\n        publishedKbGr.addQuery('workflow_state', 'published');\n        publishedKbGr.orderByDesc('sys_created_on');\n        publishedKbGr.setLimit(1);\n        publishedKbGr.query();\n        if (publishedKbGr.next()) {\n            favoriteGr.setValue('reference_document', publishedKbGr.getUniqueValue());\n            favoriteGr.update();\n        }\n    }\n\n    function canView(gr, isMobile) {\n        var refRecord = new GlideRecord(gr.reference_table);\n        if (refRecord.get(gr.reference_document)) {\n            if (FavoriteSecurityUtil.canView(refRecord, isMobile)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    function populateRow(row, obj) {\n        for (key in obj) {\n            row[key] = obj[key];\n        }\n    }\n\n    function getFavoriteCount() {\n        var count = 0;\n        var favoriteGr = new GlideAggregate(\"sp_favorite\");\n        favoriteGr.addAggregate(\"COUNT\");\n        favoriteGr.addQuery(\"user\", gs.getUserID());\n        favoriteGr.query();\n        if (favoriteGr.next()) {\n            count = favoriteGr.getAggregate(\"COUNT\");\n        }\n        return count;\n    }\n\n    function getSortQuery(query) {\n        if (query.indexOf('ORDERBYsys_created_on') > -1) {\n            return 'ORDERBYsys_created_on';\n        } else if (query.indexOf('ORDERBYDESClast_viewed') > -1) {\n            return 'ORDERBYDESClast_viewed^ORDERBYsys_created_on';\n        }\n        return 'ORDERBYDESCsys_created_on';\n\n    }\n\n    function getFilterQuery(query) {\n        var index = query.indexOf('categoryIN');\n        if (index == -1) {\n            if (query.indexOf('categoryISEMPTY') > -1)\n                return \"ISEMPTY\";\n            return \"\";\n        }\n        var categoriesEndIndex = query.substring(index).indexOf('^');\n        return query.substring(index + 10, index + categoriesEndIndex);\n    }\n\n    function getRowData(response) {\n        var row = {};\n        row.portal = portalID;\n        for (key in response) {\n            row[key] = response[key];\n        }\n        return row;\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_update_name":"sys_script_vtable_83c27bbb07e541108d6d78e99cd30007","update_script":"","delete_script":"","name":"Favorite","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-04-18 07:18:46","sys_class_name":"sys_script_vtable","sys_id":"8988419643200210e777c91766b8f282","sys_updated_by":"maint","sys_created_on":"2024-02-26 06:26:58","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Cloud entitlement instance","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_cloud_entitlement_instance","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"51","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    const rows = new CloudEntitlementInstanceTableProvider().getRows();\n\trows.forEach(row => {\n        v_table.addRow(row);\n    });\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_8988419643200210e777c91766b8f282","update_script":"","delete_script":"","name":"Cloud entitlement instance","sys_policy":""},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2024-03-08 16:48:45","sys_class_name":"sys_script_vtable","sys_id":"8a89c87e30000210cf98cac3e9eae363","sys_updated_by":"admin","sys_created_on":"2024-01-15 10:13:12","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Account level entitlements defn","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_account_level_entitlement","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"6","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    const entitlements = new AccountlevelEntitlementsProvider().getEntitlements();\n    entitlements.forEach(entitlement => {\n        v_table.addRow(entitlement);\n    });\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_8a89c87e30000210cf98cac3e9eae363","update_script":"","delete_script":"","name":"Account level entitlements defn","sys_policy":""},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2024-06-04 22:32:47","sys_class_name":"sys_script_vtable","sys_id":"9322bd2443212110805a71f1cbb8f237","sys_updated_by":"admin","sys_created_on":"2023-03-09 23:16:23","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Subscription license detail definition","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_subscription_license_detail_metric","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"121","active":"true","cache_ttl":"60","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\n    const subscriptionId = String(v_query.getParameter(\"subscription\"));\n    const type = v_query.getParameter(\"type\");\n\n    new sn_sub_man.SubscriptionLicenseDetailDefinitionProvider()\n        .getData(subscriptionId, type)\n        .forEach(row => v_table.addRow(row));\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_9322bd2443212110805a71f1cbb8f237","update_script":"","delete_script":"","name":"Subscription license detail definition","sys_policy":""},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2024-09-26 05:13:28","sys_class_name":"sys_script_vtable","sys_id":"9813d61bc3625110c9f0985cb140dd08","sys_updated_by":"admin","sys_created_on":"2022-10-20 11:34:30","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"PAR Scheduled Export","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/9509c0e54e289e08608566160eb606cb","value":"9509c0e54e289e08608566160eb606cb"},"flow":"","sys_created_by":"admin","table":"snpar_sched_export_v_scheduled_export_visualization","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"57","active":"true","cache_ttl":"60","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\n    var dashboardText = gs.getMessage(\"Dashboards\");\n    var vizText = gs.getMessage(\"Visualizations\");\n    var dashboardAndVizText = gs.getMessage(\"Dashboards and Visualizations\");\n    var sysauto = new GlideRecordSecure('sysauto_par');\n    sysauto.addQuery('active', true);\n    sysauto.query();\n    while (sysauto.next()) {\n        try {\n            var users, groups;\n            var parNotifEmailRecipients = new GlideRecordSecure('par_notification_email_recipients');\n            if (parNotifEmailRecipients.get(\"par_notification_email\", sysauto.notification)) {\n                users = parNotifEmailRecipients.users;\n                groups = parNotifEmailRecipients.groups;\n            }\n            var parExportVisualizationGr = new GlideRecordSecure('par_export_visualization');\n            var parExportDashboardGr = new GlideRecordSecure('par_export_dashboard');\n            var parExportGr = new GlideRecordSecure(\"par_export\");\n            var parVizGr = new GlideRecordSecure(\"par_visualization\");\n            var parDashboardGr = new GlideRecordSecure(\"par_dashboard\");\n            var exoprtIds = sysauto.to_export;\n            var exportItems = {\n                \"dashboards\": [],\n                \"visualizations\": []\n            };\n            var omitIfEmpty;\n            parExportGr.addQuery(\"sys_id\", \"IN\", exoprtIds);\n            parExportGr.query();\n            while (parExportGr.next()) {\n                switch (parExportGr.sys_class_name.toString()) {\n                    case \"par_export_visualization\":\n                        if (parExportVisualizationGr.get(parExportGr.sys_id)) {\n                            var vizId = parExportVisualizationGr.visualizations.split(',')[0];\n                            if (parVizGr.get(vizId)) {\n                                var viz = {\n                                    \"name\": parVizGr.getValue(\"name\"),\n                                    \"id\": vizId\n                                };\n                                exportItems.visualizations.push(viz);\n                            }\n\n                        }\n                        break;\n                    case \"par_export_dashboard\":\n                        if (parExportDashboardGr.get(parExportGr.sys_id)) {\n                            var dashboardId = parExportDashboardGr.dashboard.toString();\n                            if (parDashboardGr.get(dashboardId)) {\n                                var dashboard = {\n                                    \"name\": parDashboardGr.getValue(\"name\"),\n                                    \"id\": dashboardId\n                                };\n                                exportItems.dashboards.push(dashboard);\n                            }\n\n                        }\n                        break;\n                    default:\n                        continue;\n                }\n            }\n            if (!gs.nil(parExportVisualizationGr.omit_if_empty))\n                omitIfEmpty = parExportVisualizationGr.omit_if_empty;\n            else\n                omitIfEmpty = parExportDashboardGr.omit_if_empty;\n            var summary = dashboardAndVizText\n            if (exportItems.dashboards.length == 0) {\n                summary = vizText;\n            }\n            if (exportItems.visualizations.length == 0) {\n                summary = dashboardText;\n            }\n            var row = {\n                sys_id: sysauto.getUniqueValue(),\n                active: sysauto.active,\n                frequency: sysauto.run_type.getDisplayValue(),\n                name: sysauto.name,\n                subject: sysauto.notification.subject,\n                updated: sysauto.sys_updated_on,\n                updated_by: sysauto.sys_updated_by,\n                condition: sysauto.condition,\n                use_conditions: sysauto.conditional,\n                created: sysauto.sys_created_on,\n                created_by: sysauto.sys_created_by,\n                day_of_the_week: sysauto.run_dayofweek,\n                time: sysauto.run_time,\n                omit_if_no_records: omitIfEmpty,\n                send_as_zip: sysauto.zip_output,\n                run_as: sysauto.run_as,\n                run_as_tz: sysauto.run_as_tz,\n                recipients: sysauto.notification.recipients,\n                groups: groups,\n                users: users,\n                export_items: JSON.stringify(exportItems),\n                summary: summary\n            };\n            v_table.addRow(row);\n        } catch (e) {\n            gs.warn('PAR_SCHEDULED_EXPORT: Failed generating scheduled visualization for ' + sysauto.getUniqueValue() + ' with error ' + e)\n        }\n    }\n    if (gs.getProperty('com.glide.par.unified_analytics.enabled', false) === true || gs.getProperty('com.glide.par.unified_analytics.enabled', false) === \"true\") {\n        var sysautoReport = new GlideRecordSecure('sysauto_report');\n        sysautoReport.addQuery('active', true);\n        sysautoReport.query();\n        while (sysautoReport.next()) {\n            try {\n                var row = {\n                    sys_id: sysautoReport.getUniqueValue(),\n                    active: sysautoReport.active,\n                    frequency: sysautoReport.run_type.getDisplayValue(),\n                    name: sysautoReport.name,\n                    subject: sysautoReport.report_title,\n                    updated: sysautoReport.sys_updated_on,\n                    updated_by: sysautoReport.sys_updated_by,\n                    report: sysautoReport.report,\n                    condition: sysautoReport.condition,\n                    use_conditions: sysautoReport.conditional,\n                    created: sysautoReport.sys_created_on,\n                    created_by: sysautoReport.sys_created_by,\n                    day_of_the_week: sysautoReport.run_dayofweek,\n                    time: sysautoReport.run_time,\n                    omit_if_no_records: sysautoReport.omit_if_no_records,\n                    send_as_zip: sysautoReport.zip,\n                    run_as: sysautoReport.run_as,\n                    run_as_tz: sysautoReport.run_as_tz,\n                    recipients: sysautoReport.address_list,\n                    groups: sysautoReport.group_list,\n                    users: sysautoReport.user_list,\n                };\n                v_table.addRow(row);\n            } catch (e) {\n                gs.warn('PAR_SCHEDULED_EXPORT: Failed generating scheduled report for ' + sysautoReport.getUniqueValue() + ' with error ' + e)\n            }\n        }\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/9509c0e54e289e08608566160eb606cb","value":"9509c0e54e289e08608566160eb606cb"},"sys_update_name":"sys_script_vtable_9813d61bc3625110c9f0985cb140dd08","update_script":"","delete_script":"","name":"PAR Scheduled Export","sys_policy":""},{"enhanced_capacity":"true","advanced":"false","sys_updated_on":"2024-08-13 23:01:46","sys_class_name":"sys_script_vtable","sys_id":"9b2ba1354321211082fe346bbbb8f20f","sys_updated_by":"admin","sys_created_on":"2023-03-13 19:58:07","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Unconfirmed user groups","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"maint","table":"sn_sub_man_st_unconfirmed_user_group","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"62","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\n    const encodedQuery = getEncodedQuery(v_query.getCondition(\"subscription\"));\n    const gr = new GlideRecord(\"group_allocation_data_m2m_subscription_detail\");\n    gr.addEncodedQuery(encodedQuery);\n    gr.addActiveQuery();\n    // Setting remote table row limit to 20000 along with turning on Enhanced Capacity flag\n    gr.setLimit(20000);\n    // joins\n    const helper = new sn_sub_man.SMGlideRecordHelper();\n    helper.addExtraField(gr, \"subscription_detail.subscription.sys_id\");\n    helper.addExtraField(gr, \"group_allocation_data.group.sys_id\");\n    helper.addExtraField(gr, \"group_allocation_data.group.manager\");\n    gr.query();\n\n    const rows = [];\n    const groupIds = [];\n\n    const ZERO = Number(0).toLocaleString();\n    while (gr.next()) {\n        const row = {\n            // using group sys id as record sys id\n            sys_id: gr.group_allocation_data.group.sys_id,\n            user_count: ZERO,\n            user_count_int: 0,\n            active_users_count: ZERO,\n            active_users_count_int: 0,\n            group: gr.group_allocation_data.group.sys_id,\n            manager: gr.group_allocation_data.group.manager,\n            subscription: gr.subscription_detail.subscription.sys_id\n        };\n        groupIds.push(String(row.group));\n        rows.push(row);\n    }\n\n    const userCountsByGroup = getNumGroupMembersByGroupIDs(groupIds);\n    const activeUserCountsByGroup = new sn_entitlement.UserDao().getActiveGroupMembersCountByGroupIDs(groupIds);\n    rows.forEach(row => {\n        const grpId = String(row.group);\n        if (userCountsByGroup.has(grpId)) {\n            row.user_count = Number(userCountsByGroup.get(grpId)).toLocaleString();\n            row.user_count_int = userCountsByGroup.get(grpId);\n            row.active_users_count = Number(activeUserCountsByGroup.get(grpId) | 0).toLocaleString();\n            row.active_users_count_int = activeUserCountsByGroup.get(grpId) | 0;\n        }\n\n        v_table.addRow(row);\n    });\n\n    function getNumGroupMembersByGroupIDs(groupIds) {\n        const counts = new Map();\n\n        if (groupIds.length === 0)\n            return counts;\n\n        const grmembers = new GlideAggregate('sys_user_grmember');\n        grmembers.addQuery('group', \"IN\", groupIds);\n        grmembers.addAggregate('COUNT', \"group\");\n        grmembers.query();\n        while (grmembers.next()) {\n            counts.set(grmembers.getValue(\"group\"), grmembers.getAggregate(\"COUNT\", \"group\"));\n        }\n\n        return counts;\n    }\n\n    function getEncodedQuery(subscriptionIDCondition) {\n        let encodedQuery = \"subscription_detail.is_latest=true^is_allocated=false\";\n\n        // If this remote table is being queried by subscription ID, optimize our query of the m2m table\n        // to only retrieve the relevant records\n        if (gs.nil(subscriptionIDCondition))\n            return encodedQuery;\n\n        const [key, value] = subscriptionIDCondition.split(\"=\");\n        const shouldApplyIDCondition = key === \"subscription\" && !gs.nil(value);\n\n        if (shouldApplyIDCondition)\n            encodedQuery += \"^subscription_detail.subscription.sys_id=\" + value;\n\n        return encodedQuery;\n    }\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_9b2ba1354321211082fe346bbbb8f20f","update_script":"","delete_script":"","name":"Unconfirmed user groups","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2023-03-09 23:37:02","sys_class_name":"sys_script_vtable","sys_id":"9f1ad3775f112110f082532aca731308","sys_updated_by":"admin","sys_created_on":"2023-03-07 22:54:24","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Scan Suites","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/bb67ed7253e83010b846ddeeff7b1204","value":"bb67ed7253e83010b846ddeeff7b1204"},"flow":"","sys_created_by":"admin","table":"sn_deploy_pipeline_st_scan_suite","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"2","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n        // Main API:\n        //    v_table.addRow({ ... }) - adds a row to the result set\n\n        // There are also query helper methods\n        //    v_query.getEncodedQuery() - returns encoded querystring\n        //    v_query.getCondition(field) - returns encoded querystring for the given field (includes field name, operator, and value)\n        //    v_query.getParameter(field) - returns parameter for the given field (only includes value for equality conditions)\n        //    v_query.isGet() - returns whether the query is a single get by sys_id\n        //    v_query.getSysId() - returns parameter for sys_id field\n        //    v_query.isTextSearch() - returns whether the query contains a text query parameter\n        //    v_query.getTextSearch() - returns text search query parameter (internal field name 123TEXTQUERY321)\n        //    v_query.getFirstRowWanted() - returns the first row to include\n        //    v_query.getLastRowWanted() - returns the last row to include\n\n        // Note: You must define sys_id for each row so that forms and lists for this table work properly\n\n        // Your code goes here\n        // v_table.addRow({...})\n\n        var responses = ScanSuiteService.getScansFromPipelineEnvs();\n\n        responses.forEach(function(response) {\n                response.result.suites.forEach(function(suite) {\n                    suite.instance_url = response.instanceURL;\n                    v_table.addRow(suite);\n                });\n        });\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/bb67ed7253e83010b846ddeeff7b1204","value":"bb67ed7253e83010b846ddeeff7b1204"},"sys_update_name":"sys_script_vtable_9f1ad3775f112110f082532aca731308","update_script":"","delete_script":"","name":"Scan Suites","sys_policy":"read"},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2019-03-21 15:43:51","sys_class_name":"sys_script_vtable","sys_id":"a0930155530323004c36ddeeff7b12dc","sys_updated_by":"admin","sys_created_on":"2019-01-15 23:55:13","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_kb_most_viewed","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"flow":"","sys_created_by":"admin","table":"v_st_kb_most_viewed","cache_isolation_level":"","cache_strategy":"","editable":"false","sys_mod_count":"0","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar fieldList = \"number,author,sys_view_count,rating,sys_updated_on\".split(\",\");\n\tvar kbService = new global.KBPortalServiceImpl();\n\tvar kb = kbService.getMostViewedArticles('20', 'short_description', fieldList, '');\n\tif(kb) {\n\t\tkb.forEach(function(data) {\n\t\t\tvar record = {};\n\t\t\trecord.sys_id = data.id;\n\t\t\trecord.short_description = data.display_field;\n\t\t\tdata.secondary_fields.forEach(function(field) {\n\t\t\t\tvar name = field.name;\n\t\t\t\tif(name == 'sys_view_count')\n\t\t\t\t\tname = 'view_count';\n\t\t\t\tif(name == 'sys_updated_on')\n\t\t\t\t\tname = 'last_updated';\n\t\t\t\trecord[name] = field.value;\n\t\t\t});\n\t\t\tv_table.addRow(record);\n\t\t});\n\t}\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"sys_update_name":"sys_script_vtable_a0930155530323004c36ddeeff7b12dc","update_script":"","delete_script":"","name":"v_st_kb_most_viewed","sys_policy":"read"},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2021-06-09 20:46:03","sys_class_name":"sys_script_vtable","sys_id":"a1eb6e4187032300e0ef0cf888cb0b17","sys_updated_by":"admin","sys_created_on":"2019-01-15 13:01:51","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_sc_category","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"flow":"","sys_created_by":"admin","table":"v_st_sc_category","cache_isolation_level":"","cache_strategy":"","editable":"false","sys_mod_count":"71","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"sys_update_name":"sys_script_vtable_a1eb6e4187032300e0ef0cf888cb0b17","name":"v_st_sc_category","sys_policy":"protected"},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-04-16 12:53:47","sys_class_name":"sys_script_vtable","sys_id":"a8288b498b3002104e0e73a3e1239569","sys_updated_by":"maint","sys_created_on":"2024-03-06 04:26:42","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Cloud entitlement subscription defn","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_cloud_entitlement_subscription","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"10","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tconst rows = new CloudEntitlementSubscriptionTableProvider().getRows();\n\trows.forEach(row => {\n        v_table.addRow(row);\n    });\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_a8288b498b3002104e0e73a3e1239569","update_script":"","delete_script":"","name":"Cloud entitlement subscription defn","sys_policy":""},{"enhanced_capacity":"true","advanced":"true","sys_updated_on":"2024-06-03 18:29:07","sys_class_name":"sys_script_vtable","sys_id":"a8b27f2843e6421073e946c8dbb8f26e","sys_updated_by":"admin","sys_created_on":"2024-05-30 18:02:11","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Permanent Error Jobs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/74fdcd7a437121109fa864cec7b8f27b","value":"74fdcd7a437121109fa864cec7b8f27b"},"flow":"","sys_created_by":"admin","table":"sn_async_dashboard_st_permanent_error_jobs","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"5","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar utils = new AsyncDashboardUtils();\n\tvar gr = utils.getPermanentErrorJobs();\n\n    while (gr.next()) {\n        var row = {\n            sys_id: gr.getUniqueValue(),\n\t\t\tname: gr.getUniqueValue(),\n\t\t\tlast_error: gr.getValue(\"last_error\"),\n\t\t\ttrigger_type: gr.getValue(\"trigger_type\"),\n\t\t\tpriority: gr.getValue(\"priority\"),\n\t\t\tnext_action: gr.getValue(\"next_action\"),\n\t\t\tstate: gr.getValue(\"state\"),\n\t\t\tlateness: utils.getTimeDelayed(new GlideDateTime(gr.getValue(\"next_action\")), new GlideDateTime(gr.getValue(\"sys_updated_on\")))\n        };\n        v_table.addRow(row);\n    }\n  })(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/74fdcd7a437121109fa864cec7b8f27b","value":"74fdcd7a437121109fa864cec7b8f27b"},"sys_update_name":"sys_script_vtable_a8b27f2843e6421073e946c8dbb8f26e","update_script":"","delete_script":"","name":"Permanent Error Jobs","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2021-05-05 12:37:34","sys_class_name":"sys_script_vtable","sys_id":"ae6ab88b9f03230088aebde8132e70e1","sys_updated_by":"admin","sys_created_on":"2019-01-21 14:43:42","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_kb_category","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"flow":"","sys_created_by":"admin","table":"v_st_kb_category","cache_isolation_level":"","cache_strategy":"","editable":"false","sys_mod_count":"5","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar qryParent = v_query.getParameter('parent') || \"\";\n\tvar knowledgeUtil = new global.KBKnowledge();\n\n\tvar fetchAll = \"false\";\n\tvar childCategories = [];\n\tvar childCategoriesMap = {};\n\tvar parentIDs = qryParent;\n\tvar kcat = new GlideRecord(\"kb_category\");\n\tkcat.addActiveQuery();\n\tif (qryParent)\n\t\tkcat.addQuery(\"parent_id\", parentIDs);\n\telse {\n\t\tvar portalKBs = knowledgeUtil.getServicePortalKnowledgeBases(\"mesp\") || [];\n\t\tvar accessibleKBs = knowledgeUtil.getReadableKnowledgeBaseIDs(portalKBs.join()) || \"\";\n\t\tkcat.addQuery(\"parent_table\", \"kb_knowledge_base\");\n\t\tkcat.addQuery(\"parent_id\", \"IN\", accessibleKBs);\n\t\tparentIDs = accessibleKBs;\n\t\tfetchAll = \"true\";\n\t\tvar initOffset = v_query.getFirstRowWanted() || 0;\n\t\tkcat.setLimit(1000 + initOffset);\n\t}\n\tkcat.orderBy(\"label\");\n\tkcat.setCategory(\"list\");\n\tkcat.query();\n\twhile (kcat.next()) {\n\t\tif (kcat.label) {\n\t\t\tchildCategories.push(kcat.getUniqueValue() + '');\n\t\t\tchildCategoriesMap[kcat.getUniqueValue() + ''] = kcat.getDisplayValue(\"label\") + \"\";\n\t\t}\n\t}\n\n\tvar categoriesData = knowledgeUtil.getCategoriesAccessInfo(parentIDs, childCategories.join(), fetchAll, v_query.getLastRowWanted() || 20);\n\tvar filteredChildCategories = categoriesData.accessibleChilds;\n\n\tfilteredChildCategories.forEach(function(category){\n\t\tif(category){\n\t\t\tvar rec = {};\n\t\t\trec.label = convertToString(childCategoriesMap[category]);\n\t\t\trec.order = \"0\";\n\t\t\trec.has_child = categoriesData.onlyChilds && categoriesData.onlyChilds.indexOf(category+'') != -1 ? \"false\" : \"true\";\n\t\t\trec.sys_id = convertToString(category);\n\t\t\tif(qryParent)\n\t\t\t\trec.parent = convertToString(qryParent);\n\n\t\t\tv_table.addRow(rec);\n\t\t}\n\t});\n\n\t//Check if it has articles\n\tif (categoriesData.parentHasArticle){\n\t\t\tvar otherRec = {};\n\t\t\totherRec.label = gs.getMessage(\"Other\");\n\t\t\totherRec.order = \"1\";\n\t\t\totherRec.has_child = \"false\";\n\t\t\totherRec.sys_id = convertToString(qryParent);\n\t\t\totherRec.parent = convertToString(qryParent);\n\t\t\tv_table.addRow(otherRec);\n\t}\n\n\tfunction convertToString(str){\n\t\tif(str)\n\t\t\treturn str.toString();\n\n\t\treturn \"\";\n\t}\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"sys_update_name":"sys_script_vtable_ae6ab88b9f03230088aebde8132e70e1","update_script":"","delete_script":"","name":"v_st_kb_category","sys_policy":"read"},{"enhanced_capacity":"true","advanced":"true","sys_updated_on":"2024-05-14 20:00:36","sys_class_name":"sys_script_vtable","sys_id":"b50d2b7dffc20210c45b65d7d3b8febc","sys_updated_by":"admin","sys_created_on":"2024-05-09 18:19:11","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Subscription Overview","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_subscription_overview","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"25","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    new SubscriptionOverviewProvider()\n        .getData()\n        .forEach(row => v_table.addRow(row));\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_b50d2b7dffc20210c45b65d7d3b8febc","update_script":"","delete_script":"","name":"Subscription Overview","sys_policy":"read"},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2023-03-02 00:50:40","sys_class_name":"sys_script_vtable","sys_id":"bfa6f9c1c7233300099a308dc7c26098","sys_updated_by":"admin","sys_created_on":"2019-08-27 01:40:10","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Design System Icons","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"admin","table":"st_sys_design_system_icon","cache_isolation_level":"SYSTEM","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"15","active":"true","cache_ttl":"604800","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    var icons = new GlideDesignSystemIconRepository();\n    var iconsList = icons.getIcons();\n    var iterator = iconsList.iterator();\n\n    while (iterator.hasNext()) {\n        var icon = iterator.next();\n        var iconName = icon.getName();\n        var iconLabel = icon.getLabel();\n        var svgName = icon.getSVGName();\n        var iconId = iconName.replaceAll(\"-\", \"_\");\n\n        var item = {};\n        item.name = iconName;\n        item.label = iconLabel;\n        item.sys_id = iconId;\n        item.icon = svgName;\n\n        v_table.addRow(item);\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3993e7f304312210559073c06a02f724","value":"3993e7f304312210559073c06a02f724"},"sys_update_name":"sys_script_vtable_bfa6f9c1c7233300099a308dc7c26098","update_script":"","delete_script":"","name":"Design System Icons","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-05-01 20:04:51","sys_class_name":"sys_script_vtable","sys_id":"c4af29e243302110805a71f1cbb8f2a5","sys_updated_by":"admin","sys_created_on":"2023-02-06 21:26:01","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Subscription Insights definition","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_subscription_insights","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"86","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    main(unconfirmedFlowIsEnabled());\n\n    function generateOverAllocatedSubsPayload(product, subscriptionSysId) {\n        return {\n            insight: sn_i18n.Message.getMessage('Subscription Management', 'You allocated more subscriptions than you purchased.'),\n            product,\n            category: sn_i18n.Message.getMessage('Subscription Management', 'Over-allocated subscriptions'),\n            category_english: 'Over-allocated subscriptions',\n            count: 1,\n            subscription_entitlement: subscriptionSysId,\n            sys_id: gs.generateGUID()\n        };\n    }\n\n    function generateAvailableSubsPayload(product, count, subscriptionSysId) {\n        return {\n            insight: sn_i18n.Message.getMessage('Subscription Management', 'You have {count} unallocated subscriptions.', {\n                count: count.toString()\n            }),\n            product,\n            category: sn_i18n.Message.getMessage('Subscription Management', 'Available subscriptions'),\n            category_english: 'Available subscriptions',\n            count,\n            subscription_entitlement: subscriptionSysId,\n            sys_id: gs.generateGUID()\n        };\n    }\n\n    function generateUnconfirmedCountPayload(product, userCount, subscriptionSysId) {\n        return {\n            insight: sn_i18n.Message.getMessage('Subscription Management', '{userCount} user(s) are using subscriptions that need to be allocated.', {\n                userCount: userCount.toString()\n            }),\n            product,\n            category: sn_i18n.Message.getMessage('Subscription Management', 'Unconfirmed users'),\n            category_english: 'Unconfirmed users',\n            count: userCount,\n            subscription_entitlement: subscriptionSysId,\n            sys_id: gs.generateGUID()\n        };\n    }\n\n    function unconfirmedFlowIsEnabled() {\n        const unconfirmedFlowEnabledProperty = gs.getProperty('sn_sub_man.unconfirmed_user_flow_enabled');\n        return !gs.nil(unconfirmedFlowEnabledProperty) && unconfirmedFlowEnabledProperty.toLowerCase() === 'true';\n    }\n\n    function getSubscriptionEntitlementRecordsByActive() {\n        const now = new GlideDate().getValue();\n\n        const perUserType = 0;\n        const displayTypeNone = 0;\n        const active = 0;\n\n        const gr = new GlideRecord('subscription_entitlement');\n\n        //only check per user subscriptions\n        gr.addQuery('subscription_type', perUserType);\n\n        //only check active subscriptions\n        gr.addQuery('status', active);\n\n        // checking only for non-expired subscriptions\n        gr.addQuery('start_date', '<=', now).addOrCondition('start_date', 'NULL');\n        gr.addQuery('end_date', '>=', now).addOrCondition('end_date', 'NULL');\n        gr.addQuery('display_type', displayTypeNone);\n\n        gr.query();\n\n        const rows = [];\n        while (gr.next()) {\n            rows.push({\n                product: gr.getValue('name'),\n                purchased: gr.getValue('purchased_count'),\n                sys_id: gr.getUniqueValue(),\n                isMeterTypeCreator: String(gr.getValue(\"meter_type\")).toLowerCase() === \"creator\",\n            });\n        }\n        return rows;\n    }\n\n    function getSubscriptionDetailRecordsByActive(includeUnconfirmedData) {\n        const subscriptionUsageUtils = new sn_entitlement.SubscriptionUsageUtils();\n\n        const gr = new GlideRecord('subscription_detail');\n        gr.addQuery('is_latest', 'true');\n        gr.query();\n\n        const rows = [];\n        while (gr.next()) {\n            rows.push({\n                subscription: String(gr.subscription),\n                allocated_count: subscriptionUsageUtils.calculateStringAllocation(gr),\n                unconfirmed_user_realtime_count: includeUnconfirmedData ? subscriptionUsageUtils.calculateRealTimeUnconfirmedUsers(gr) : null,\n            });\n        }\n        return rows;\n    }\n\n    function main(unconfirmedFlowEnabled) {\n        const unconfirmedCountSubsPayloads = [];\n        const overAllocatedSubsPayloads = [];\n        const availableSubsPayloads = [];\n\n        const subscriptionEntitlementRecords = getSubscriptionEntitlementRecordsByActive();\n        const subscriptionDetailRecords = getSubscriptionDetailRecordsByActive(unconfirmedFlowEnabled);\n\n        subscriptionEntitlementRecords.forEach(subscriptionEntitlementRecord => {\n            const subscriptionDetailRecord = subscriptionDetailRecords.find(record => record.subscription === subscriptionEntitlementRecord.sys_id);\n            if (subscriptionDetailRecord) {\n                // always insights should be of this order\n                // 1. Unconfirmed users Category\n                // 2. Over-Allocated Category\n                // 3. Available Category\n\n                if (unconfirmedFlowEnabled) {\n                    const unconfirmedUserCount = subscriptionDetailRecord.unconfirmed_user_realtime_count;\n                    const isUnconfirmedUserCountValid = !gs.nil(unconfirmedUserCount) && unconfirmedUserCount > 0;\n                    if (isUnconfirmedUserCountValid) {\n                        // insert only when unconfirmed_flow_enabled is true and there is a valid unconfirmed user count\n                        unconfirmedCountSubsPayloads.push(generateUnconfirmedCountPayload(subscriptionEntitlementRecord.product, unconfirmedUserCount, subscriptionEntitlementRecord.sys_id));\n                    }\n                }\n\n                if (!subscriptionEntitlementRecord.isMeterTypeCreator) { // Creator is account level subscription, therefore, not counting available subscriptions at instance level\n                    const count = subscriptionEntitlementRecord.purchased - subscriptionDetailRecord.allocated_count;\n                    if (count < 0) {\n                        overAllocatedSubsPayloads.push(generateOverAllocatedSubsPayload(subscriptionEntitlementRecord.product, subscriptionEntitlementRecord.sys_id));\n                    } else if (count > 0) {\n                        availableSubsPayloads.push(generateAvailableSubsPayload(subscriptionEntitlementRecord.product, count, subscriptionEntitlementRecord.sys_id));\n                    }\n                }\n            }\n        });\n\n        const finalPayload = unconfirmedCountSubsPayloads.concat(overAllocatedSubsPayloads, availableSubsPayloads);\n        finalPayload.forEach(row => v_table.addRow(row));\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_c4af29e243302110805a71f1cbb8f2a5","update_script":"","delete_script":"","name":"Subscription Insights definition","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2019-06-26 06:31:31","sys_class_name":"sys_script_vtable","sys_id":"ca4ceb2a5317230097a2ddeeff7b12b2","sys_updated_by":"admin","sys_created_on":"2019-01-15 23:55:13","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_kb_recently_viewed","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"flow":"","sys_created_by":"admin","table":"v_st_kb_recently_viewed","cache_isolation_level":"","cache_strategy":"","editable":"false","sys_mod_count":"0","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar kbUtil = new global.KBKnowledge();\n\tvar articleArr = kbUtil.getRecentlyViewedArticles();\n\tif(articleArr && articleArr.length){\n\t\tarticleArr.forEach(function(article){\n\t\t\tv_table.addRow(article);\n\t\t});\n\t}\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/b3a70c8a530323004c36ddeeff7b124c","value":"b3a70c8a530323004c36ddeeff7b124c"},"sys_update_name":"sys_script_vtable_ca4ceb2a5317230097a2ddeeff7b12b2","update_script":"","delete_script":"","name":"v_st_kb_recently_viewed","sys_policy":"read"},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2024-03-21 03:39:45","sys_class_name":"sys_script_vtable","sys_id":"d94660fc439cc210482439a56cb8f236","sys_updated_by":"admin","sys_created_on":"2024-02-09 01:27:13","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"SM instance used assists count","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"flow":"","sys_created_by":"admin","table":"sn_sub_man_st_instance_used_assist_count","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"59","active":"true","cache_ttl":"3600","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    const rows = new SMv2GenAIInstancesTableProvider(sn_entitlement.LicensingEngineConstants.ASSIST).getRows();\n    rows.forEach(row => {\n        v_table.addRow(row);\n    });\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/86d7bb63ff021110468365d7d3b8fe41","value":"86d7bb63ff021110468365d7d3b8fe41"},"sys_update_name":"sys_script_vtable_d94660fc439cc210482439a56cb8f236","update_script":"","delete_script":"","name":"SM instance used assists count","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2021-11-12 11:11:23","sys_class_name":"sys_script_vtable","sys_id":"ddbf165b1b0d381009cbea48624bcb2d","sys_updated_by":"admin","sys_created_on":"2021-07-05 06:33:49","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Docker Image Remote","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/dcb0e1e4db075300dd14596e5e9619ca","value":"dcb0e1e4db075300dd14596e5e9619ca"},"flow":"","sys_created_by":"admin","table":"sn_docker_spoke_images","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"15","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\n    try {\n        var inputs = {};\n        inputs['show_all_images'] = true;\n        var outputs = sn_fd.FlowAPI.executeAction('sn_docker_spoke.look_up_images', inputs);\n        var Results = outputs['images'];\n        var status = outputs['status'];\n        var error_message = outputs['error_message'];\n        var row = {};\n        if (status != \"Success\") {\n            throw new Error(error_message);\n        } else {\n            if (Results != '') {\n                for (var i = 0; i < Results.length; i++) {\n                    var sysId = i.toString();\n                    v_table.addRow({\n                        image_id: Results[i].Id.toString(),\n                        image_size: Results[i].Size.toString(),\n                        sys_id: new GlideDigest().getMD5Hex(sysId)\n                    });\n                }\n            }\n        }\n    } catch (ex) {\n        gs.info(ex);\n    }\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/dcb0e1e4db075300dd14596e5e9619ca","value":"dcb0e1e4db075300dd14596e5e9619ca"},"sys_update_name":"sys_script_vtable_ddbf165b1b0d381009cbea48624bcb2d","update_script":"","delete_script":"","name":"Docker Image Remote","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2024-04-12 18:08:38","sys_class_name":"sys_script_vtable","sys_id":"e72b5a8effe0b110468365d7d3b8fe81","sys_updated_by":"maint","sys_created_on":"2023-08-10 21:16:17","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Subscription Application Users","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/bcadabf277f311109c62f5f3cb5a992a","value":"bcadabf277f311109c62f5f3cb5a992a"},"flow":"","sys_created_by":"maint","table":"sn_entitlement_st_subscription_application_users","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"91","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    const subscription = v_query.getParameter(\"subscription\");\n    const licenseFamily = v_query.getParameter(\"license_family\");\n\n    const dao = new sn_entitlement.SubscriptionApplicationUsersDao();\n    var rows = dao.getUsers(subscription, licenseFamily);\n    rows.forEach(row => v_table.addRow(row));\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/bcadabf277f311109c62f5f3cb5a992a","value":"bcadabf277f311109c62f5f3cb5a992a"},"sys_update_name":"sys_script_vtable_e72b5a8effe0b110468365d7d3b8fe81","update_script":"","delete_script":"","name":"Subscription Application Users","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2020-01-19 20:45:25","sys_class_name":"sys_script_vtable","sys_id":"eafa6cccb72a4010100a9b56ee11a9c3","sys_updated_by":"admin","sys_created_on":"2020-01-19 20:45:25","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"Catalog Items and Variable Sets","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"admin","table":"st_sys_catalog_items_and_variable_sets","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"0","active":"true","cache_ttl":"0","sys_domain_path":"","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tvar SYS_CAT_ITEM_TABLE = \"sc_cat_item\";\n\tvar SYS_ITEM_OPTION_NEW_SET_TABLE = \"item_option_new_set\";\n\tvar SYS_DOMAIN = \"sys_domain\";\n\tvar SYS_DOMAIN_PATH = \"sys_domain_path\";\n\tvar COLUMN_NAME = \"name\";\n\tvar COLUMN_TYPE = \"type\";\n\tvar COLUMN_TITLE = \"title\";\n\tvar EQUALS_STRING = \"=\";\n\tvar ORDERBY_STRING = \"ORDERBY\";\n\tvar VARIABLESET_TYPE = \"one_to_one\";\n\tvar count = 0;\n\n\tvar encodedQuery = v_query.getEncodedQuery();\n\tvar catItems = new GlideRecordSecure(SYS_CAT_ITEM_TABLE);\n\tcatItems.orderBy(COLUMN_NAME);\n\tcatItems.addEncodedQuery(encodedQuery);\n\tcatItems.query();\n\t\n\twhile (catItems._next()) {\n\t\tif(count > 1000){\n\t\t\tbreak;\n\t\t}\n\t\tcount++;\n\t\tvar obj = {};\n\t\tobj.name = String(catItems.name);\n\t\tobj.sys_id = String(catItems.sys_id);\n\t\tobj.data_type = \"Catalog item\";\n\t\tobj.data_source = SYS_CAT_ITEM_TABLE;\n\t\tobj.sc_catalogs = catItems.getValue(\"sc_catalogs\");\n\t\tif(catItems.isValidField(SYS_DOMAIN)){\n\t\t\tobj.sys_domain = catItems.getValue(SYS_DOMAIN);\n\t\t\tobj.sys_domain_path = catItems.getValue(SYS_DOMAIN_PATH);\n\t\t}\n\t\tv_table.addRow(obj);\n\t}\n\n\tvar conditions = encodedQuery.split(\"^\");\n\tvar i ;\n\tvar variableSetConditions = [];\n\tfor(i=0;i<conditions.length;i++){\n\t\tvar nameIndex = conditions[i].indexOf(COLUMN_NAME);\n\t\tvar orderBYIndex = conditions[i].indexOf(ORDERBY_STRING);\n\t\tif(nameIndex === 0){\n\t\t\t//In VariableSet column name is title hence appending \"title\" while removing \"name\"\n\t\t\tvariableSetConditions.push(COLUMN_TITLE + conditions[i].substr(4));\n\t\t}else if(orderBYIndex === 0){\n\t\t\tvariableSetConditions.push(ORDERBY_STRING + COLUMN_TITLE);\n\t\t}\n\t}\n\tvar variableSetEQ = variableSetConditions[0];\n\tfor(i=1;i<variableSetConditions.length;i++){\n\t\tvariableSetEQ = variableSetEQ + \"^\" + variableSetConditions[i];\n\t}\n\tvar variableSets = new GlideRecordSecure(SYS_ITEM_OPTION_NEW_SET_TABLE);\n\tvariableSets.orderBy(COLUMN_TITLE);\n\tvariableSets.addEncodedQuery(variableSetEQ);\n\tvariableSets.addQuery(COLUMN_TYPE, EQUALS_STRING, VARIABLESET_TYPE);\n\tvariableSets.query();\n\t\n\t\n\twhile (variableSets._next()) { \n\t\tif(count > 1000){\n\t\t\tbreak;\n\t\t}\n\t\tcount++;\n\t\tvar setObj = {};\n\t\tsetObj.name = String(variableSets.title);\n\t\tsetObj.sys_id = String(variableSets.sys_id);\n\t\tsetObj.data_type = \"Variable set\";\n\t\tsetObj.data_source = SYS_ITEM_OPTION_NEW_SET_TABLE;\n\t\tif(variableSets.isValidField(SYS_DOMAIN)){\n\t\t\tsetObj.sys_domain = variableSets.getValue(SYS_DOMAIN);\n\t\t\tsetObj.sys_domain_path = variableSets.getValue(SYS_DOMAIN_PATH);\n\t\t}\n\t\tv_table.addRow(setObj);\n\t}\n\t\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/239baff304352210559073c06a02f71a","value":"239baff304352210559073c06a02f71a"},"sys_update_name":"sys_script_vtable_eafa6cccb72a4010100a9b56ee11a9c3","update_script":"","delete_script":"","name":"Catalog Items and Variable Sets","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2020-09-18 22:08:10","sys_class_name":"sys_script_vtable","sys_id":"ec10d65253221010b643ddeeff7b12a3","sys_updated_by":"admin","sys_created_on":"2020-08-13 00:02:52","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"License Detail Metric","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"maint","table":"st_license_detail_metric","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"20","active":"true","cache_ttl":"0","sys_domain_path":"","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    var su = new SNSubscriptionUtils();\n    populateVTable(su.getSubscriptionMetrics());\n    populateVTable(su.getSubscriptionAllocatedMetrics());\n    populateVTable(su.getUnmappedTable());\n\n    function populateVTable(metrics) {\n        for (var i = 0; i < metrics.length; i++) {\n            v_table.addRow(metrics[i]);\n        }\n    }\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/8bc96fbb04f12210559073c06a02f755","value":"8bc96fbb04f12210559073c06a02f755"},"sys_update_name":"sys_script_vtable_ec10d65253221010b643ddeeff7b12a3","update_script":"","delete_script":"","name":"License Detail Metric","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2020-07-06 15:28:23","sys_class_name":"sys_script_vtable","sys_id":"f2d3bbcd53133300a0bdddeeff7b12ae","sys_updated_by":"admin","sys_created_on":"2019-08-15 00:31:03","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_interaction_context","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"admin","table":"v_interaction_context","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"24","active":"true","cache_ttl":"0","sys_domain_path":"/","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n\tif (!v_query.isGet()) {\n\t\t// this table cannot be viewed as a list.\n\t\tgs.info(gs.getMessage(\"The remote table 'v_interaction_context' was queried, but it does not support list view. It can only be accessed if a single sys_id is specified.\"));\n\t\treturn;\n\t}\n\n\tif (!new global.InteractionSecurityUtils().canGetInteraction(v_query.getSysId(), false))\n\t\treturn;\n\tvar row = {\n\t\tsys_id: v_query.getSysId()\n\t};\n\n\tvar interactionContextGR = new GlideRecord('interaction_context');\n\tinteractionContextGR.addQuery('interaction', v_query.getSysId());\n\tinteractionContextGR.query();\n\n\twhile (interactionContextGR.next()) {\n\t\tvar key = interactionContextGR.getValue('name');\n\t\tvar value = interactionContextGR.getValue('value');\n\t\tvar col = 'u_' + key;\n\t\trow[col] = value;\n\t}\n\n\tv_table.addRow(row);\n\n  })(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/aca3b33704b52210559073c06a02f7d3","value":"aca3b33704b52210559073c06a02f7d3"},"sys_update_name":"sys_script_vtable_f2d3bbcd53133300a0bdddeeff7b12ae","update_script":"","delete_script":"","name":"v_interaction_context","sys_policy":""},{"enhanced_capacity":"false","advanced":"true","sys_updated_on":"2020-03-27 09:38:52","sys_class_name":"sys_script_vtable","sys_id":"f60694fdb79f00100c548d58de11a94c","sys_updated_by":"admin","sys_created_on":"2020-03-02 12:29:33","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"On-Call hours","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"flow":"","sys_created_by":"admin","table":"st_on_call_hour","cache_isolation_level":"USER","cache_strategy":"CACHE_BY_QUERY","editable":"false","sys_mod_count":"10","active":"true","cache_ttl":"10","sys_domain_path":"","sys_tags":"","script":"(function executeQuery(v_table, v_query) {\n    var groupId = v_query.getParameter('group');\n\n    if (groupId) {\n        var isValidSysId = groupId.match(/^[0-9a-fA-F]{32}$/) == null ? false : true;\n\t\t\n        if (isValidSysId) {\n            var onCallHours = new OnCallReportingUtils().getOnCallHours(groupId);\n            for (var i = 0; i < onCallHours.length; i++) {\n                var onCallHour = onCallHours[i];\n                v_table.addRow(onCallHour);\n            }\n        }\n    }\n\n})(v_table, v_query);","insert_script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/8c6ca73b04352210559073c06a02f754","value":"8c6ca73b04352210559073c06a02f754"},"sys_update_name":"sys_script_vtable_f60694fdb79f00100c548d58de11a94c","update_script":"","delete_script":"","name":"On-Call hours","sys_policy":""},{"enhanced_capacity":"false","advanced":"false","sys_updated_on":"2021-06-09 20:33:22","sys_class_name":"sys_script_vtable","sys_id":"fe3dda9087132300e0ef0cf888cb0bc4","sys_updated_by":"admin","sys_created_on":"2019-01-25 14:18:01","sys_domain":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_user_group/global","value":"global"},"sys_name":"v_st_sc_cat_item","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"flow":"","sys_created_by":"admin","table":"v_st_sc_cat_item","cache_isolation_level":"","cache_strategy":"","editable":"false","sys_mod_count":"31","active":"true","cache_ttl":"","sys_domain_path":"/","sys_tags":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/2263a68187032300e0ef0cf888cb0b3f","value":"2263a68187032300e0ef0cf888cb0b3f"},"sys_update_name":"sys_script_vtable_fe3dda9087132300e0ef0cf888cb0bc4","name":"v_st_sc_cat_item","sys_policy":"protected"}]}