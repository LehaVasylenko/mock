{"result":[{"short_description":"Publicly accessible Knowledge Base and articles","advanced":"true","description":"Publicly accessible knowledge base and articles will be visible to anyone on the Internet with sufficient skill at querying your instance. Please constrain the visibility of knowledge base articles to your intended audience.","sys_updated_on":"2024-01-16 23:57:48","sys_class_name":"scan_table_check","score_min":"","sys_id":"15371ee5db175010a9ac683b0b9619dd","sys_updated_by":"maint","score_scale":"","sys_created_on":"2020-09-16 23:25:54","sys_name":"Publicly accessible Knowledge Base and articles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"","sys_created_by":"admin","table":"sys_user","run_condition":"gs.getProperty('glide.knowman.block_access_with_no_user_criteria', 'true') == 'false'","resolution_details":"Make sure to create user criteria for Knowledge Base and articles.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:select-user-criteria","finding_type":"","priority":"4","sys_tags":"","script":"(function(finding, current) {\n\n    var guestUC = [];\n    var publicKBList = [];\n    var publicKBs = [];\n\n    var user = gs.getSession().impersonate(current);\n    kbGr = new SNC.KnowledgeHelper().getReadableKnowledgeBases();\n    while (kbGr.next()) {\n        publicKBList.push(kbGr.getUniqueValue());\n        publicKBs.push(kbGr.getValue('title'));\n        var gr_KB = new GlideRecord('kb_knowledge_base');\n        gr_KB.get('sys_id', kbGr.getUniqueValue());\n        finding.setCurrentSource(gr_KB);\n        finding.increment();\n    }\n    kbCount = publicKBList.length;\n    guestUC = new SNC.KnowledgeHelper().getAllMatchingKnowledgeCriteria(current).split(',');\n    gs.getSession().impersonate(user);\n    articleTotalCount(publicKBList, guestUC);\n\n    function articleTotalCount(publicKBList, guestUC) {\n        var articles = new GlideRecord('kb_knowledge');\n        articles.addQuery('kb_knowledge_base', 'IN', publicKBList);\n        articles.addEncodedQuery(guestUC.reduce(function(query, uc) {\n            return query + '^ORcan_read_user_criteriaLIKE' + uc;\n        }, 'can_read_user_criteriaISEMPTY'));\n        articles.addEncodedQuery(guestUC.reduce(function(query, uc) {\n            return query + '^ORcannot_read_user_criteriaNOT LIKE' + uc;\n        }, 'cannot_read_user_criteriaISEMPTY'));\n        articles.setWorkflow(false);\n        articles.query();\n        while (articles.next()) {\n            finding.setCurrentSource(articles);\n            finding.increment();\n\n        }\n\n    }\n\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7e473bbf04b52210559073c06a02f7f2","value":"7e473bbf04b52210559073c06a02f7f2"},"sys_update_name":"scan_table_check_15371ee5db175010a9ac683b0b9619dd","use_manifest":"false","name":"Publicly accessible Knowledge Base and articles","category":"security","conditions":"active=true^user_name=guest^EQ","sys_policy":"read"},{"short_description":"Encrypter API is deprecated","advanced":"true","description":"The Encrypter API will be deprecated for the ServiceNow platform. The API will no longer be supported and will soon be removed in future releases of the platform.\r\n\t\t\t\r\nDue to evolving security standards and for the safety of our customers, the decision has been made to deprecate this API.","sys_updated_on":"2024-02-23 10:25:26","sys_class_name":"scan_table_check","score_min":"0","sys_id":"1e2571c4ffa046107497ffffffffff4c","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-02-19 09:30:58","sys_name":"Deprecated API: Encrypter usages in Dictionary table","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","table":"sys_dictionary","run_condition":"","resolution_details":"Customers should migrate their Encrypter usages to alternative encryption methods. The ServiceNow platform offers a variety of encryption options. For more information, see KB https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1633559\r\n\t\t\t\r\nContinued use of the Encrypter API poses a security risk to your data and will result in compatibility issues with future releases of the ServiceNow platform.","sys_mod_count":"5","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1633559","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding, current) {\n\n    //check encrypter usage at least once\n    var search_regex = /new\\s*Encrypter\\s*\\(/;\n    if (!search_regex.test(current.dynamic_creation_script) &&\n\t\t!search_regex.test(current.default_value) &&\n\t\t!search_regex.test(current.reference_qual))\n        return;\n\n    //remove code comments\n    var code_comments_regex = /\\/\\*[\\s\\S]*?\\*\\/|([^:]|^)\\/\\/.*$/gm;\n    var commentsRemovedDCS = current.dynamic_creation_script.replace(code_comments_regex, '');\n\tvar commentsRemovedDV = current.default_value.replace(code_comments_regex, '');\n\tvar commentsRemovedRQ = current.reference_qual.replace(code_comments_regex, '');\n\n    //raise finding if no comments found or usage found in commentsRemovedValue\n    if (commentsRemovedDCS.length == current.dynamic_creation_script.length || search_regex.test(commentsRemovedDCS)) {\n\t\tfinding.setCurrentSource(current.dynamic_creation_script);\n\t\tfinding.increment();\n\t}\n\tif (commentsRemovedDV.length == current.default_value.length || search_regex.test(commentsRemovedDV)) {\n\t\tfinding.setCurrentSource(current.default_value);\n\t\tfinding.increment();\n\t}\n\tif (commentsRemovedRQ.length == current.reference_qual.length || search_regex.test(commentsRemovedRQ)) {\n\t\tfinding.setCurrentSource(current.reference_qual);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_table_check_1e2571c4ffa046107497ffffffffff4c","use_manifest":"false","name":"Deprecated API: Encrypter usages in Dictionary table","category":"security","conditions":"","sys_policy":"read"},{"short_description":"A table's elements are on compatible columns","advanced":"true","description":"","sys_updated_on":"2022-03-09 17:37:43","sys_class_name":"scan_table_check","score_min":"0","sys_id":"265434a2530201105951ddeeff7b1254","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-08 04:07:08","sys_name":"A table's elements are on compatible columns","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"6","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n    var dictionaryValidator = new sn_schema_validator.DictionaryValidator();\n\tvar fieldsOnIncompatibleColumn = dictionaryValidator.findFieldsOnIncompatibleColumn(current.name);\n\tfor (var i = 0; i < fieldsOnIncompatibleColumn.length; i++) {\n\t\tfinding.setCurrentSource(fieldsOnIncompatibleColumn[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_265434a2530201105951ddeeff7b1254","use_manifest":"false","name":"A table's elements are on compatible columns","category":"manageability","conditions":"extension_model=partition^ORextension_model=hierarchy^ORextension_model=class^ORextension_model=^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Class Path physical column is synchronized (Table Per Partition)","advanced":"true","description":"Physical column for sys_class_path exists on all partitions of a TPP Table","sys_updated_on":"2022-03-09 01:46:45","sys_class_name":"scan_table_check","score_min":"0","sys_id":"33af765e530201105951ddeeff7b12f3","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-07 19:36:06","sys_name":"Class Path physical column is synchronized (Table Per Partition)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"13","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\t\n    var hierarchyValidator = new sn_schema_validator.HierarchyValidator();\n\tvar partitionsMissingColumn = hierarchyValidator.findPartitionsMissingColumn(current.name, \"sys_class_path\");\n\t\n\tfor (var i = 0; i < partitionsMissingColumn.length; i++) {\n\t\tfinding.setCurrentSource(partitionsMissingColumn[i]);\n\t\tfinding.increment();\n\t}\n\t\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_33af765e530201105951ddeeff7b12f3","use_manifest":"false","name":"Class Path physical column is synchronized (Table Per Partition)","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Encrypter API is deprecated","advanced":"true","description":"The Encrypter API will be deprecated for the ServiceNow platform. The API will no longer be supported and will soon be removed in future releases of the platform.\r\n\t\t\t\r\nDue to evolving security standards and for the safety of our customers, the decision has been made to deprecate this API.","sys_updated_on":"2024-03-14 14:31:28","sys_class_name":"scan_table_check","score_min":"0","sys_id":"361531c4ffa046107497ffffffffff03","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-02-19 09:30:44","sys_name":"Deprecated API: Encrypter usages in Variables table","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","table":"sys_variable_value","run_condition":"","resolution_details":"Customers should migrate their Encrypter usages to alternative encryption methods. The ServiceNow platform offers a variety of encryption options. For more information, see KB https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1633559\r\n\t\t\t\r\nContinued use of the Encrypter API poses a security risk to your data and will result in compatibility issues with future releases of the ServiceNow platform.","sys_mod_count":"6","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1633559","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding, current) {\n\n    //check encrypter usage at least once\n    var search_regex = /new\\s*Encrypter\\s*\\(/;\n    if (!search_regex.test(current.value))\n        return;\n\n    //remove code comments\n    var code_comments_regex = /\\/\\*[\\s\\S]*?\\*\\/|([^:]|^)\\/\\/.*$/gm;\n    var commentsRemovedValue = current.value.replace(code_comments_regex, '');\n\n    //raise finding if no comments found or usage found in commentsRemovedValue\n    if (commentsRemovedValue.length == current.value.length || search_regex.test(commentsRemovedValue)) {\n\t\tfinding.setCurrentSource(current);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_table_check_361531c4ffa046107497ffffffffff03","use_manifest":"false","name":"Deprecated API: Encrypter usages in Variables table","category":"security","conditions":"valueISNOTEMPTY^variable.internal_type=script^ORvariable.internal_type=script_plain^ORvariable.internal_type=string^ORvariable.internal_type=string_full_utf8^ORvariable.internal_type=condition_string^EQ","sys_policy":"read"},{"short_description":"Synchronized columns should have storage aliases for each partition","advanced":"true","description":"","sys_updated_on":"2022-03-17 19:06:27","sys_class_name":"scan_table_check","score_min":"0","sys_id":"379616e5531201105951ddeeff7b1271","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-17 19:06:27","sys_name":"Synchronized columns should have storage aliases for each partition","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"0","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar aliasValidator = new sn_schema_validator.AliasValidator();\n\tvar synchronizedFieldsMissingAlias = aliasValidator.findSynchronizedFieldsMissingAlias(current.name);\n\n\tfor (var i = 0; i < synchronizedFieldsMissingAlias.length; i++) {\n\t\tfinding.setCurrentSource(synchronizedFieldsMissingAlias[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_379616e5531201105951ddeeff7b1271","use_manifest":"false","name":"Synchronized columns should have storage aliases for each partition","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"User Account should not have both Internal and External roles","advanced":"false","description":"User Account should not have both \"Internal\" and \"External\" roles assigned.","sys_updated_on":"2021-02-18 20:22:27","sys_class_name":"scan_table_check","score_min":"","sys_id":"37b70254dbb09010f85054c5dc961908","sys_updated_by":"admin","score_scale":"","sys_created_on":"2020-05-11 18:30:13","sys_name":"User Account should not have both Internal and External roles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"","sys_created_by":"sachin.banavi@snc","table":"sys_user","run_condition":"","resolution_details":"You can give both internal users and external users access to your instance. However, you might not want both types of users to have the same level of access. To provide added security, every user must have at least one role so that the instance can distinguish between internal and external users.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:explicit-roles","finding_type":"","priority":"2","sys_tags":"","script":"(function (finding, current) {\n\n    // Add your code here\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_table_check_37b70254dbb09010f85054c5dc961908","use_manifest":"false","name":"User Account should not have both Internal and External roles","category":"security","conditions":"roles=snc_external^roles=snc_internal^EQ","sys_policy":"read"},{"short_description":"A table's fields have a corresponding physical column","advanced":"true","description":"","sys_updated_on":"2022-03-09 18:08:37","sys_class_name":"scan_table_check","score_min":"0","sys_id":"37de5d2a530201105951ddeeff7b1222","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-08 07:14:00","sys_name":"A table's fields have a corresponding physical column","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"3","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar dictionaryValidator = new sn_schema_validator.DictionaryValidator();\n\tvar fieldsMissingPhysicalColumns = dictionaryValidator.findFieldsMissingPhysicalColumn(current.name);\n\tfor (var i = 0; i < fieldsMissingPhysicalColumns.length; i++) {\n\t\tfinding.setCurrentSource(fieldsMissingPhysicalColumns[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_37de5d2a530201105951ddeeff7b1222","use_manifest":"false","name":"A table's fields have a corresponding physical column","category":"manageability","conditions":"extension_model=partition^ORextension_model=hierarchy^ORextension_model=class^ORextension_model=^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Class Path physical column exists for root table (TPP)","advanced":"true","description":"","sys_updated_on":"2022-03-09 01:46:02","sys_class_name":"scan_table_check","score_min":"0","sys_id":"390ef342530201105951ddeeff7b12bf","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-07 05:33:50","sys_name":"Class Path physical column exists for root table (TPP)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"9","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n    var hierarchyValidator = new sn_schema_validator.HierarchyValidator();\n\tvar tableMissingColumn = hierarchyValidator.checkPhysicalColumnExists(current.name, \"sys_class_path\");\n\n\tif (tableMissingColumn) {\n\t\tfinding.setCurrentSource(tableMissingColumn);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_390ef342530201105951ddeeff7b12bf","use_manifest":"false","name":"Class Path physical column exists for root table (TPP)","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Can Contribute / Cannot Contribute user criteria to be defined on each knowledge","advanced":"true","description":"Each knowledge base should have either Can Contribute or Cannot Contribute user criteria defined.  Otherwise, any user can contribute content to a knowledge base with no Contribute criteria defined.","sys_updated_on":"2020-07-23 17:46:38","sys_class_name":"scan_table_check","score_min":"","sys_id":"50e935f78702101001c8de05b7cb0b97","sys_updated_by":"admin","score_scale":"","sys_created_on":"2020-07-23 17:46:38","sys_name":"Can Contribute / Cannot Contribute user criteria to be defined on each knowledge","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"","sys_created_by":"admin","table":"kb_knowledge_base","run_condition":"","resolution_details":"Define Can Contribute or Cannot Contribute user criteria for each knowledge base - otherwise, any user will be able to contribute content.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:select-user-criteria","finding_type":"","priority":"2","sys_tags":"","script":"(function(finding, current) {\n\n    var kb_id = current.sys_id.toString();\n    var ccGR = new GlideRecord('kb_uc_can_contribute_mtom');\n    ccGR.addQuery('kb_knowledge_base', kb_id);\n    ccGR.query();\n    if (!ccGR.hasNext()) {\n        var ncGR = new GlideRecord('kb_uc_cannot_contribute_mtom');\n        ncGR.addQuery('kb_knowledge_base', kb_id);\n        ncGR.query();\n        if (!ncGR.hasNext()) {\n            finding.increment();\n        }\n    }\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_table_check_50e935f78702101001c8de05b7cb0b97","use_manifest":"false","name":"Can Contribute / Cannot Contribute user criteria to be defined on each knowledge","category":"security","conditions":"active=true^EQ","sys_policy":"read"},{"short_description":"Element should be on correct storage table","advanced":"true","description":"","sys_updated_on":"2022-03-17 18:35:59","sys_class_name":"scan_table_check","score_min":"0","sys_id":"54d052a1531201105951ddeeff7b12c7","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-17 18:29:54","sys_name":"Element should be on correct storage table","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"2","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar aliasValidator = new sn_schema_validator.AliasValidator();\n\tvar incorrectStorageTables = aliasValidator.findIncorrectStorageTables(current.name);\n\n\tfor (var i = 0; i < incorrectStorageTables.length; i++) {\n\t\tfinding.setCurrentSource(incorrectStorageTables[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_54d052a1531201105951ddeeff7b12c7","use_manifest":"false","name":"Element should be on correct storage table","category":"manageability","conditions":"extension_model=hierarchy^ORextension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Checks whether the scoped app contains any custom tables that extend task","advanced":"false","description":"","sys_updated_on":"2021-06-03 16:41:59","sys_class_name":"scan_table_check","score_min":"0","sys_id":"5ec2b2b053203010b846ddeeff7b123a","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2021-06-02 17:00:49","sys_name":"Tables that extend Task","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/bb67ed7253e83010b846ddeeff7b1204","value":"bb67ed7253e83010b846ddeeff7b1204"},"score_max":"100","sys_created_by":"admin","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"4","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function (engine) {\n\n    // Add your code here\n\n})(engine);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/bb67ed7253e83010b846ddeeff7b1204","value":"bb67ed7253e83010b846ddeeff7b1204"},"sys_update_name":"scan_table_check_5ec2b2b053203010b846ddeeff7b123a","use_manifest":"false","name":"Tables that extend Task","category":"manageability","conditions":"super_class.name=task^EQ","sys_policy":"read"},{"short_description":"Fields per logical table should glom to only one column","advanced":"true","description":"","sys_updated_on":"2022-03-17 18:46:59","sys_class_name":"scan_table_check","score_min":"0","sys_id":"63841e65531201105951ddeeff7b1234","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-17 18:46:50","sys_name":"Fields per logical table should glom to only one column","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"1","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar aliasValidator = new sn_schema_validator.AliasValidator();\n\tvar fieldsIncorrectlyGlommed = aliasValidator.findFieldsIncorrectlyGlommed(current.name);\n\n\tfor (var i = 0; i < fieldsIncorrectlyGlommed.length; i++) {\n\t\tfinding.setCurrentSource(fieldsIncorrectlyGlommed[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_63841e65531201105951ddeeff7b1234","use_manifest":"false","name":"Fields per logical table should glom to only one column","category":"manageability","conditions":"extension_model=hierarchy^ORextension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Access controls on Tables","advanced":"true","description":"Tables should be secured with access controls, data in the table should be limited access to only necessary audience.","sys_updated_on":"2022-09-14 17:07:06","sys_class_name":"scan_table_check","score_min":"","sys_id":"66f9f49ddb7f0010f85054c5dc96191e","sys_updated_by":"maint","score_scale":"","sys_created_on":"2020-03-25 22:22:07","sys_name":"Access controls on Tables","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"","sys_created_by":"sachin.banavi@snc","table":"sys_db_object","run_condition":"","resolution_details":"Make sure that all tables should have ACL's. Rules for access control lists (ACLs) restrict access to data by requiring users to pass a set of requirements before they can interact with it.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:Access_Controls","finding_type":"","priority":"2","sys_tags":"","script":"(function(finding, current) {\n\n    function checkTableForACL(table) {\n        var g_acl = new GlideRecord('sys_security_acl');\n        g_acl.addQuery('name', 'CONTAINS', table.name);\n        g_acl.query();\n        if (!g_acl.next() && table.sys_scope.scope != 'polaris_app_shell') {\n            if (table.super_class) {\n                var gr = new GlideRecord('sys_db_object');\n                gr.get(table.super_class);\n                checkTableForACL(gr);\n            } else {\n                finding.setCurrentSource(current);\n                finding.increment();\n            }\n        }\n    }\n    checkTableForACL(current);\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_table_check_66f9f49ddb7f0010f85054c5dc96191e","use_manifest":"false","name":"Access controls on Tables","category":"security","conditions":"","sys_policy":"read"},{"short_description":"A table's elements should not be cloned to it's descendants (TPC | TPH)","advanced":"true","description":"","sys_updated_on":"2022-03-09 18:13:56","sys_class_name":"scan_table_check","score_min":"0","sys_id":"70df3c8b530201105951ddeeff7b1203","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-09 18:10:33","sys_name":"A table's elements should not be cloned to it's descendants (TPC | TPH)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"1","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar dictionaryValidator = new sn_schema_validator.DictionaryValidator();\n\tvar fieldsIncorrectlyCloned = dictionaryValidator.findFieldsIncorrectlyCloned(current.name);\n\tfor (var i = 0; i < fieldsIncorrectlyCloned.length; i++) {\n\t\tfinding.setCurrentSource(fieldsIncorrectlyCloned[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_70df3c8b530201105951ddeeff7b1203","use_manifest":"false","name":"A table's elements should not be cloned to it's descendants (TPC | TPH)","category":"manageability","conditions":"extension_model=class^ORextension_model=hierarchy^ORextension_model=^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"GlideEncrypter API is deprecated","advanced":"true","description":"The GlideEncrypter API will be deprecated for the ServiceNow platform. The API will no longer be supported and will soon be removed in future releases of the platform.\r\n\t\t\t\r\nDue to evolving security standards and for the safety of our customers, the decision has been made to deprecate this API.","sys_updated_on":"2024-03-14 14:28:11","sys_class_name":"scan_table_check","score_min":"0","sys_id":"765921b6ff1002107497ffffffffffe8","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-02-15 11:31:31","sys_name":"Deprecated API: GlideEncrypter usages in Variables table","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","table":"sys_variable_value","run_condition":"","resolution_details":"Customers should migrate their GlideEncrypter usages to alternative encryption methods. The ServiceNow platform offers a variety of encryption options. For more information, see KB https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1320986\r\n\t\t\t\r\nContinued use of the GlideEncrypter API poses a security risk to your data and will result in compatibility issues with future releases of the ServiceNow platform.","sys_mod_count":"9","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1320986","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding, current) {\n\n    //check glide encrypter usage at least once\n    var search_regex = /new\\s*GlideEncrypter\\s*\\(/;\n    if (!search_regex.test(current.value))\n        return;\n\n    //remove code comments\n    var code_comments_regex = /\\/\\*[\\s\\S]*?\\*\\/|([^:]|^)\\/\\/.*$/gm;\n    var commentsRemovedValue = current.value.replace(code_comments_regex, '');\n\n    //raise finding if no comments found or usage found in commentsRemovedValue\n    if (commentsRemovedValue.length == current.value.length || search_regex.test(commentsRemovedValue)) {\n\t\tfinding.setCurrentSource(current);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_table_check_765921b6ff1002107497ffffffffffe8","use_manifest":"false","name":"Deprecated API: GlideEncrypter usages in Variables table","category":"security","conditions":"valueISNOTEMPTY^variable.internal_type=string^ORvariable.internal_type=string_full_utf8^ORvariable.internal_type=script^ORvariable.internal_type=script_plain^ORvariable.internal_type=condition_string^EQ","sys_policy":"read"},{"short_description":"Storage aliases should not clone (TPH)","advanced":"true","description":"","sys_updated_on":"2022-03-17 20:42:21","sys_class_name":"scan_table_check","score_min":"0","sys_id":"76d59ea5531201105951ddeeff7b1240","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-17 18:51:37","sys_name":"Storage aliases should not clone (TPH)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"1","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar aliasValidator = new sn_schema_validator.AliasValidator();\n\tvar aliasesIncorrectlyCloned = aliasValidator.findAliasesIncorrectlyCloned(current.name);\n\n\tfor (var i = 0; i < aliasesIncorrectlyCloned.length; i++) {\n\t\tfinding.setCurrentSource(aliasesIncorrectlyCloned[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_76d59ea5531201105951ddeeff7b1240","use_manifest":"false","name":"Storage aliases should not clone (TPH)","category":"manageability","conditions":"extension_model=hierarchy^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"PA breakdown visibility to roles","advanced":"false","description":"Validate if PA breakdown is required to be visible for all roles or can be restricted to specific users/groups/roles.","sys_updated_on":"2020-05-04 20:57:48","sys_class_name":"scan_table_check","score_min":"","sys_id":"77e8c0188713001001c8de05b7cb0b9c","sys_updated_by":"admin","score_scale":"","sys_created_on":"2020-02-26 19:41:01","sys_name":"PA breakdown visibility to roles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"","sys_created_by":"admin","table":"pa_breakdowns","run_condition":"","resolution_details":"You can restrict visibility by roles. Unselect Visible by all roles and select the Roles that are required to access the breakdown.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:t_CreatingABreakdownForIndicators","finding_type":"","priority":"3","sys_tags":"","script":"(function (finding, current) {\n\n    // Add your code here\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_table_check_77e8c0188713001001c8de05b7cb0b9c","use_manifest":"false","name":"PA breakdown visibility to roles","category":"security","conditions":"visible_to=2^role_override=true^EQ","sys_policy":"read"},{"short_description":"Storage aliases should be cloned (TPP)","advanced":"true","description":"","sys_updated_on":"2022-03-17 19:08:04","sys_class_name":"scan_table_check","score_min":"0","sys_id":"94b99669531201105951ddeeff7b1294","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-17 19:08:04","sys_name":"Storage aliases should be cloned (TPP)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"0","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar aliasValidator = new sn_schema_validator.AliasValidator();\n\tvar aliasesMissingClone = aliasValidator.findAliasesMissingClone(current.name);\n\n\tfor (var i = 0; i < aliasesMissingClone.length; i++) {\n\t\tfinding.setCurrentSource(aliasesMissingClone[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_94b99669531201105951ddeeff7b1294","use_manifest":"false","name":"Storage aliases should be cloned (TPP)","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Class Name dictionary element exists for all extensions (Table Per Partition)","advanced":"true","description":"","sys_updated_on":"2022-03-09 01:45:04","sys_class_name":"scan_table_check","score_min":"0","sys_id":"99f90fd2530201105951ddeeff7b12a3","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-07 20:33:58","sys_name":"Class Name dictionary element exists for all extensions (Table Per Partition)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"10","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\t\n\tvar hierarchyValidator = new sn_schema_validator.HierarchyValidator();\n\tvar extensionsMissingElement = hierarchyValidator.findExtensionsMissingElement(current.name, \"sys_class_name\");\n\t\n\tfor (var i = 0; i < extensionsMissingElement.length; i++) {\n\t\tfinding.setCurrentSource(extensionsMissingElement[i]);\n\t\tfinding.increment();\n\t}\n\t\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_99f90fd2530201105951ddeeff7b12a3","use_manifest":"false","name":"Class Name dictionary element exists for all extensions (Table Per Partition)","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Class Path dictionary element exists for all extensions (Table Per Partition)","advanced":"true","description":"","sys_updated_on":"2022-03-09 01:44:39","sys_class_name":"scan_table_check","score_min":"0","sys_id":"9bb16b16530201105951ddeeff7b12d8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-07 22:02:47","sys_name":"Class Path dictionary element exists for all extensions (Table Per Partition)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"4","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\t\n\tvar hierarchyValidator = new sn_schema_validator.HierarchyValidator();\n\tvar extensionsMissingElement = hierarchyValidator.findExtensionsMissingElement(current.name, \"sys_class_path\");\n\t\n\tfor (var i = 0; i < extensionsMissingElement.length; i++) {\n\t\tfinding.setCurrentSource(extensionsMissingElement[i]);\n\t\tfinding.increment();\n\t}\n\t\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_9bb16b16530201105951ddeeff7b12d8","use_manifest":"false","name":"Class Path dictionary element exists for all extensions (Table Per Partition)","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Class path should not be null (TPP)","advanced":"true","description":"","sys_updated_on":"2022-03-17 19:11:07","sys_class_name":"scan_table_check","score_min":"0","sys_id":"a34a9e69531201105951ddeeff7b121a","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-17 19:10:54","sys_name":"Class path should not be null (TPP)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"1","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar aliasValidator = new sn_schema_validator.AliasValidator();\n\tvar tablesWithNullClassPath = aliasValidator.findTablesWithNullClassPath(current.name);\n\n\tfor (var i = 0; i < tablesWithNullClassPath.length; i++) {\n\t\tfinding.setCurrentSource(tablesWithNullClassPath[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_a34a9e69531201105951ddeeff7b121a","use_manifest":"false","name":"Class path should not be null (TPP)","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"A table's fields should clone to it's descendant tables (TPP)","advanced":"true","description":"","sys_updated_on":"2022-03-09 18:06:57","sys_class_name":"scan_table_check","score_min":"0","sys_id":"a5e0656a530201105951ddeeff7b1232","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-08 07:19:42","sys_name":"A table's fields should clone to it's descendant tables (TPP)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"2","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n    var dictionaryValidator = new sn_schema_validator.DictionaryValidator();\n\tvar fieldsMissingClone = dictionaryValidator.findFieldsMissingClone(current.name);\n\tfor (var i = 0; i < fieldsMissingClone.length; i++) {\n\t\tfinding.setCurrentSource(fieldsMissingClone[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_a5e0656a530201105951ddeeff7b1232","use_manifest":"false","name":"A table's fields should clone to it's descendant tables (TPP)","category":"manageability","conditions":"extension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"GlideEncrypter API is deprecated","advanced":"true","description":"The GlideEncrypter API will be deprecated for the ServiceNow platform. The API will no longer be supported and will soon be removed in future releases of the platform.\r\n\t\t\t\r\nDue to evolving security standards and for the safety of our customers, the decision has been made to deprecate this API.","sys_updated_on":"2024-02-23 10:27:08","sys_class_name":"scan_table_check","score_min":"0","sys_id":"a89d6dbaff1002107497ffffffffff77","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-02-15 11:45:24","sys_name":"Deprecated API: GlideEncrypter usages in Dictionary table","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","table":"sys_dictionary","run_condition":"","resolution_details":"Customers should migrate their GlideEncrypter usages to alternative encryption methods. The ServiceNow platform offers a variety of encryption options. For more information, see KB https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1320986\r\n\t\t\t\r\nContinued use of the GlideEncrypter API poses a security risk to your data and will result in compatibility issues with future releases of the ServiceNow platform.","sys_mod_count":"7","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1320986","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding, current) {\n\n    //check glide encrypter usage at least once\n    var search_regex = /new\\s*GlideEncrypter\\s*\\(/;\n    if (!search_regex.test(current.dynamic_creation_script) &&\n\t\t!search_regex.test(current.default_value) &&\n\t\t!search_regex.test(current.reference_qual))\n        return;\n\n    //remove code comments\n    var code_comments_regex = /\\/\\*[\\s\\S]*?\\*\\/|([^:]|^)\\/\\/.*$/gm;\n    var commentsRemovedDCS = current.dynamic_creation_script.replace(code_comments_regex, '');\n\tvar commentsRemovedDV = current.default_value.replace(code_comments_regex, '');\n\tvar commentsRemovedRQ = current.reference_qual.replace(code_comments_regex, '');\n\n    //raise finding if no comments found or usage found in commentsRemovedValue\n    if (commentsRemovedDCS.length == current.dynamic_creation_script.length || search_regex.test(commentsRemovedDCS)) {\n\t\tfinding.setCurrentSource(current.dynamic_creation_script);\n\t\tfinding.increment();\n\t}\n\tif (commentsRemovedDV.length == current.default_value.length || search_regex.test(commentsRemovedDV)) {\n\t\tfinding.setCurrentSource(current.default_value);\n\t\tfinding.increment();\n\t}\n\tif (commentsRemovedRQ.length == current.reference_qual.length || search_regex.test(commentsRemovedRQ)) {\n\t\tfinding.setCurrentSource(current.reference_qual);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_table_check_a89d6dbaff1002107497ffffffffff77","use_manifest":"false","name":"Deprecated API: GlideEncrypter usages in Dictionary table","category":"security","conditions":"","sys_policy":"read"},{"short_description":"System elements storage aliases should have same name as their elements","advanced":"true","description":"","sys_updated_on":"2022-03-17 18:42:43","sys_class_name":"scan_table_check","score_min":"0","sys_id":"b0e29a25531201105951ddeeff7b12bc","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-17 18:41:40","sys_name":"System elements storage aliases should have same name as their elements","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"1","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\n\tvar aliasValidator = new sn_schema_validator.AliasValidator();\n\tvar incorrectSysElementAliases = aliasValidator.findIncorrectSysElementAliases(current.name);\n\n\tfor (var i = 0; i < incorrectSysElementAliases.length; i++) {\n\t\tfinding.setCurrentSource(incorrectSysElementAliases[i]);\n\t\tfinding.increment();\n\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_b0e29a25531201105951ddeeff7b12bc","use_manifest":"false","name":"System elements storage aliases should have same name as their elements","category":"manageability","conditions":"extension_model=hierarchy^ORextension_model=partition^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Access Controls on Client callable Script Includes","advanced":"true","description":"Rules for access control lists (ACLs) restrict access to data by requiring users to pass a set of requirements before they can interact with it, all client callable script includes should be secured with required roles.","sys_updated_on":"2020-11-05 19:57:34","sys_class_name":"scan_table_check","score_min":"","sys_id":"b95a4b2ddb841010f85054c5dc961934","sys_updated_by":"admin","score_scale":"","sys_created_on":"2020-04-08 13:57:17","sys_name":"Access Controls on Client callable Script Includes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"","sys_created_by":"admin","table":"sys_script_include","run_condition":"","resolution_details":"Any logged-in users with minimum snc_internal can access an unprotected CCSI by default. Attacker can run a GlideAjax on console or do a custom HTTP request xmlhttp.do and can execute functions defined in Client callable script include. Create ACL around script include with Type as \"client_callable_script_include\" and define required roles.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:Access_Controls","finding_type":"","priority":"2","sys_tags":"","script":"(function (finding, current) {\n\n    var gr_acl = new GlideRecord('sys_security_acl');\n\t\tgr_acl.addQuery('type','client_callable_script_include');\n\t\tgr_acl.addQuery('name','CONTAINS',current.name);\n\t\tgr_acl.query();\n\t\tif(!gr_acl.next()){\n\t\t\tfinding.setCurrentSource(current);\n\t\t\tfinding.increment();\n\t\t}\n\t\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_table_check_b95a4b2ddb841010f85054c5dc961934","use_manifest":"false","name":"Access Controls on Client callable Script Includes","category":"security","conditions":"active=true^client_callable=true^EQ","sys_policy":"read"},{"short_description":"All Processors of type - SCRIPT must be protected with CSRF Token","advanced":"false","description":"All Processors of type - SCRIPT must be protected with CSRF Token. CSRF Option should be checked for all Active Processors. This Option is to protect the processor from running unless the instance uses a CSRF token.","sys_updated_on":"2020-05-18 14:23:59","sys_class_name":"scan_table_check","score_min":"","sys_id":"be3efc51dbbf0010f85054c5dc961997","sys_updated_by":"sachin.banavi@snc","score_scale":"","sys_created_on":"2020-03-25 22:41:21","sys_name":"All Processors of type - SCRIPT must be protected with CSRF Token","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"","sys_created_by":"sachin.banavi@snc","table":"sys_processor","run_condition":"","resolution_details":"All Processors of type - SCRIPT must be protected with CSRF Token. This Option is to protect the processor from running unless the instance uses a CSRF token.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:Processors","finding_type":"","priority":"2","sys_tags":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_table_check_be3efc51dbbf0010f85054c5dc961997","use_manifest":"false","name":"All Processors of type - SCRIPT must be protected with CSRF Token","category":"security","conditions":"active=true^require_csrf=false^type=script^EQ","sys_policy":"read"},{"short_description":"Class Name physical column exists on root table (Table Per Hierarchy)","advanced":"true","description":"","sys_updated_on":"2022-03-09 01:45:41","sys_class_name":"scan_table_check","score_min":"0","sys_id":"c3d26796530201105951ddeeff7b1261","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-07 22:07:54","sys_name":"Class Name physical column exists on root table (Table Per Hierarchy)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"5","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\t\n\tvar hierarchyValidator = new sn_schema_validator.HierarchyValidator();\n\tvar tableMissingColumn = hierarchyValidator.checkPhysicalColumnExists(current.name, \"sys_class_name\");\n\t\n\tif (tableMissingColumn) {\n\t\tfinding.setCurrentSource(tableMissingColumn);\n\t\tfinding.increment();\n\t}\n\t\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_c3d26796530201105951ddeeff7b1261","use_manifest":"false","name":"Class Name physical column exists on root table (Table Per Hierarchy)","category":"manageability","conditions":"extension_model=hierarchy^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Class Name dictionary element exists (Table Per Hierarchy)","advanced":"true","description":"","sys_updated_on":"2022-03-09 01:46:16","sys_class_name":"scan_table_check","score_min":"0","sys_id":"cd10e316530201105951ddeeff7b1224","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-03-07 21:55:22","sys_name":"Class Name dictionary element exists (Table Per Hierarchy)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"maint","table":"sys_db_object","run_condition":"","resolution_details":"","sys_mod_count":"9","active":"true","documentation_url":"","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function (finding, current) {\n\t\n\tvar hierarchyValidator = new sn_schema_validator.HierarchyValidator();\n\tvar tableMissingElement = hierarchyValidator.checkLogicalElementExists(current.name, \"sys_class_name\");\n\n\tif (tableMissingElement) {\n\t\tfinding.setCurrentSource(current);\t\t\t\n\t\tfinding.increment();\n\t}\n\t\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/7a8d27ff04352210559073c06a02f776","value":"7a8d27ff04352210559073c06a02f776"},"sys_update_name":"scan_table_check_cd10e316530201105951ddeeff7b1224","use_manifest":"false","name":"Class Name dictionary element exists (Table Per Hierarchy)","category":"manageability","conditions":"extension_model=hierarchy^super_classISEMPTY^EQ","sys_policy":"read"},{"short_description":"Access controls on UI Pages","advanced":"true","description":"When there is no ACL for an UI Page, by default the UI Page can be accessed by all the logged-in internal users. If there is no, script level authorization checks like gs.hasRole('user_admin'), then any logged in user can access this UI Page and change anybody's password by passing the user sys_id and the new password.","sys_updated_on":"2020-05-11 13:04:13","sys_class_name":"scan_table_check","score_min":"","sys_id":"f8fab4dddb7f0010f85054c5dc9619ca","sys_updated_by":"sachin.banavi@snc","score_scale":"","sys_created_on":"2020-03-25 22:26:16","sys_name":"Access controls on UI Pages","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"","sys_created_by":"sachin.banavi@snc","table":"sys_ui_page","run_condition":"","resolution_details":"UI Pages making call to server side code should have ACL's implemented.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/CSHelp:acl-rule-types","finding_type":"","priority":"2","sys_tags":"","script":"(function (finding, current) {\n\t\n    var gr_acl = new GlideRecord('sys_security_acl');\n\t\tgr_acl.addQuery('type','ui_page');\n\t\tgr_acl.addQuery('name','CONTAINS',current.name);\n\t\tgr_acl.query();\n\t\tif(!gr_acl.next()){\n\t\t\tfinding.setCurrentSource(current);\n\t\t\tfinding.increment();\n\t\t}\n\n})(finding, current);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_table_check_f8fab4dddb7f0010f85054c5dc9619ca","use_manifest":"false","name":"Access controls on UI Pages","category":"security","conditions":"htmlLIKE:evaluate^EQ","sys_policy":"read"}]}