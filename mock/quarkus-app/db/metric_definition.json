{"result":[{"sys_mod_count":"11","active":"true","description":"On resolution, if the incident references a Problem that is a Known Error, create one of these","sys_updated_on":"2008-12-18 11:58:05","sys_tags":"","type":"calculation","script":"// variables available\r\n// current: GlideRecord -  target incident\r\n// definition: GlideRecord -  (this row)\r\nif (!current.active) {\r\n    if (current.problem_id.problem_state == '2')\r\n        createMetric();\r\n}\r\n\r\nfunction createMetric() {\r\n  var mi = new MetricInstance(definition, current);\r\n  if (mi.metricExists()) \r\n    return;\r\n\r\n  var gr = mi.getNewRecord();\r\n  gr.field_value = true;\r\n  gr.calculation_complete = true;\r\n  gr.insert();\r\n}\r\n","sys_class_name":"metric_definition","number":"MTRC0000001","sys_id":"35de8adac0a808ae0027b623851e22f1","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_35de8adac0a808ae0027b623851e22f1","sys_updated_by":"glide.maint","field":"active","sys_created_on":"2008-12-14 14:20:48","name":"Resolved by Known Error","sys_name":"Resolved by Known Error","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"incident","order":"100","sys_policy":""},{"sys_mod_count":"24","active":"true","description":"When an incident goes into state resolved or closed, calculate the duration from open","sys_updated_on":"2009-06-19 13:45:20","sys_tags":"","type":"calculation","script":"// variables available\r\n// current: GlideRecord -  target incident\r\n// definition: GlideRecord -  (this row)\r\nvar s = current.incident_state;\r\nif (s >= 6)\r\n  createMetric();\r\n\r\nfunction createMetric() {\r\n  var mi = new MetricInstance(definition, current);\r\n  if (mi.metricExists()) \r\n    return; \r\n\r\n  var gr = mi.getNewRecord();\r\n  gr.start = current.sys_created_on;\r\n  gr.end = current.sys_updated_on;\r\n  gr.duration = gs.dateDiff(gr.start.getDisplayValue(), gr.end.getDisplayValue());\r\n  gr.calculation_complete = true;\r\n  gr.insert();\r\n}\r\n","sys_class_name":"metric_definition","number":"MTRC0000002","sys_id":"35edf981c0a808ae009895af7c843ace","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_35edf981c0a808ae009895af7c843ace","sys_updated_by":"glide.maint","field":"incident_state","sys_created_on":"2008-12-14 14:38:00","name":"Create to Resolve Duration","sys_name":"Create to Resolve Duration","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"incident","order":"100","sys_policy":""},{"sys_mod_count":"12","active":"true","description":"","sys_updated_on":"2011-12-05 21:05:57","sys_tags":"","type":"field_value_duration","script":"","sys_class_name":"metric_definition","number":"MTRC0000003","sys_id":"35f0791ac0a808ae008f0a2b1dc1030c","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_35f0791ac0a808ae008f0a2b1dc1030c","sys_updated_by":"john.roberts","field":"assigned_to","sys_created_on":"2008-12-14 14:40:24","name":"Assigned to Duration","sys_name":"Assigned to Duration","timeline":"true","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"incident","order":"100","sys_policy":""},{"sys_mod_count":"12","active":"true","description":"","sys_updated_on":"2011-12-05 21:05:58","sys_tags":"","type":"field_value_duration","script":"","sys_class_name":"metric_definition","number":"MTRC0000004","sys_id":"35f2b283c0a808ae000b7132cd0a4f55","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_35f2b283c0a808ae000b7132cd0a4f55","sys_updated_by":"john.roberts","field":"incident_state","sys_created_on":"2008-12-14 14:43:28","name":"Incident State Duration","sys_name":"Incident State Duration","timeline":"true","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"incident","order":"100","sys_policy":""},{"sys_mod_count":"11","active":"true","description":"Overly simplified definition of first call resolution.  \r\n\r\nIf the incident is inactive and the update count (sys_mod_count) is zero, create one of these.","sys_updated_on":"2009-05-01 19:42:58","sys_tags":"","type":"calculation","script":"// variables available\r\n// current: GlideRecord -  target incident\r\n// definition: GlideRecord -  (this row)\r\nif (current.sys_mod_count == 0) {\r\n  var value = false;\r\n  if (!current.active)\r\n      value = true;\r\n     \r\n  createMetric(value);\r\n}\r\n\r\nfunction createMetric(value) {\r\n  var mi = new MetricInstance(definition, current);\r\n  if (mi.metricExists()) \r\n    return;\r\n\r\n  var gr = mi.getNewRecord();\r\n  gr.field_value = value;\r\n  gr.field = null;\r\n  gr.calculation_complete = true;\r\n  gr.insert();\r\n}\r\n\r\n","sys_class_name":"metric_definition","number":"MTRC0000005","sys_id":"35f3dc69c0a808ae0008665731c17d03","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_35f3dc69c0a808ae0008665731c17d03","sys_updated_by":"glide.maint","field":"incident_state","sys_created_on":"2008-12-14 14:44:01","name":"First Call Resolution","sys_name":"First Call Resolution","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"incident","order":"100","sys_policy":""},{"sys_mod_count":"3","active":"true","description":"","sys_updated_on":"2008-12-16 20:22:16","sys_tags":"","type":"field_value_duration","script":"","sys_class_name":"metric_definition","number":"MTRC0000006","sys_id":"39d43745c0a808ae0062603b77018b90","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_39d43745c0a808ae0062603b77018b90","sys_updated_by":"glide.maint","field":"assignment_group","sys_created_on":"2008-12-15 08:48:20","name":"Assignment Group","sys_name":"Assignment Group","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"incident","order":"100","sys_policy":""},{"sys_mod_count":"31","active":"true","description":"Special case that closes out (ends) other metrics when an the active flag in the incident turns false","sys_updated_on":"2012-12-10 12:34:32","sys_tags":"","type":"field_value_duration","script":"// script can set answer to false to terminate processing of the metric\n// mi - MonitorInstance\n// answer\nif (!current.active) {\n  answer = false;\n  mi.endDuration();\n  closeDurations(mi.current);\n}\n\nfunction closeDurations(current) {\n    var gr = new GlideRecord('metric_instance');\n    gr.addQuery('id', current.sys_id);\n    gr.addQuery('calculation_complete', false);\n    gr.addQuery('definition.type', 'field_value_duration');\n    gr.query();\n    while (gr.next()) {\n       var definition = new GlideRecord('metric_definition');\n       definition.get(gr.definition);\n       var mi = new MetricInstance(definition, current);\n       mi.endDuration();\n    }\n}\n  ","sys_class_name":"metric_definition","number":"MTRC0000007","sys_id":"39d631fcc0a808ae00486d7bad874380","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_39d631fcc0a808ae00486d7bad874380","sys_updated_by":"admin","field":"active","sys_created_on":"2008-12-15 09:04:14","name":"Open","sys_name":"Open","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"incident","order":"10","sys_policy":""},{"sys_mod_count":"3","active":"true","description":"Track change approval states","sys_updated_on":"2008-12-16 20:22:16","sys_tags":"","type":"field_value_duration","script":"","sys_class_name":"metric_definition","number":"MTRC0000008","sys_id":"40c1b8dc0a2581020017b100e99646ba","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_40c1b8dc0a2581020017b100e99646ba","sys_updated_by":"glide.maint","field":"approval","sys_created_on":"2008-12-16 17:05:41","name":"Change Approval","sys_name":"Change Approval","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"change_request","order":"100","sys_policy":""},{"sys_mod_count":"3","active":"true","description":"","sys_updated_on":"2008-12-16 20:22:16","sys_tags":"","type":"field_value_duration","script":"","sys_class_name":"metric_definition","number":"MTRC0000009","sys_id":"4133566e0a258102000f867dec7cb6e2","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_4133566e0a258102000f867dec7cb6e2","sys_updated_by":"glide.maint","field":"problem_state","sys_created_on":"2008-12-16 19:09:23","name":"Problem State Duration","sys_name":"Problem State Duration","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"problem","order":"100","sys_policy":""},{"sys_mod_count":"1","active":"true","description":"","sys_updated_on":"2008-12-17 18:20:37","sys_tags":"","type":"field_value_duration","script":"","sys_class_name":"metric_definition","number":"MTRC0010003","sys_id":"462cf6520a25810200ebe763047cc273","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/f909a3b704f12210559073c06a02f7a8","value":"f909a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_462cf6520a25810200ebe763047cc273","sys_updated_by":"glide.maint","field":"type","sys_created_on":"2008-12-17 18:20:19","name":"Change Type Duration","sys_name":"Change Type Duration","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"change_request","order":"100","sys_policy":""},{"sys_mod_count":"4","active":"true","description":"","sys_updated_on":"2018-01-16 15:35:42","sys_tags":"","type":"field_value_duration","script":"","sys_class_name":"metric_definition","number":"MTRC0010003","sys_id":"67637ef667030300d358bb2d07415a1b","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4c792f3b04f12210559073c06a02f709","value":"4c792f3b04f12210559073c06a02f709"},"sys_update_name":"metric_definition_67637ef667030300d358bb2d07415a1b","sys_updated_by":"admin","field":"state","sys_created_on":"2017-12-19 07:30:05","name":"Knowledge Feedback Task State Duration","sys_name":"Knowledge Feedback Task State Duration","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","table":"kb_feedback_task","order":"100","sys_policy":""},{"sys_mod_count":"5","active":"true","description":"","sys_updated_on":"2021-03-02 11:00:10","sys_tags":"","type":"calculation","script":"// variables available\n// current: GlideRecord -  target incident\n// definition: GlideRecord -  (this row)\nif(pm.isActive('com.snc.best_practice.problem.madrid.state_model')){\n\tif(current.problem_state == ProblemState.STATES.RESOLVED && current.resolution_code == ProblemState.RESOLUTION_CODES.FIX_APPLIED)\n\t\tcreateMetric();\n}\nelse{\n\tif(current.problem_state == 4)\n\t\tcreateMetric();\n}\n\nfunction createMetric() {\n  var mi = new MetricInstance(definition, current);\n  if (mi.metricExists()) \n    return; \n\n  var gr = mi.getNewRecord();\n  gr.start = current.sys_created_on;\n  gr.end = current.sys_updated_on;\n  gr.duration = gs.dateDiff(gr.start, gr.end);\n  gr.calculation_complete = true;\n  gr.insert();\n}","sys_class_name":"metric_definition","number":"MTRC0010005","sys_id":"e950c339c0a80a8b00bf711eebbc5b1e","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3109a3b704f12210559073c06a02f7a8","value":"3109a3b704f12210559073c06a02f7a8"},"sys_update_name":"metric_definition_e950c339c0a80a8b00bf711eebbc5b1e","sys_updated_by":"admin","field":"problem_state","sys_created_on":"2009-04-27 20:44:11","name":"Problem - Create to Resolve Duration","sys_name":"Problem - Create to Resolve Duration","timeline":"false","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","table":"problem","order":"100","sys_policy":""}]}