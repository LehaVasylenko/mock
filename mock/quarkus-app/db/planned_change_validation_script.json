{"result":[{"sys_mod_count":"3","active":"true","sys_updated_on":"2015-08-17 19:14:10","sys_tags":"","script":"isValidChange();\n\nfunction isValidChange(/*GlideRecord current, GlideDateTime updatedOn, String updatedBy, String changedFields*/) {\n\t//Return true if the user that updated the record has an admin role\n\treturn isUserAdmin(updatedBy);\n}\n\nfunction isUserAdmin(userName){\n\tvar grUser = new GlideRecord(\"sys_user\");\n\tgrUser.addQuery('name', userName);\n\tgrUser.query();\n\tif(grUser.next()) {\n\t\tvar roles = new GlideRecord (\"sys_user_has_role\");\n\t\troles.addActiveQuery();\n\t\troles.addQuery('user', grUser.sys_id);\n\t\troles.query();\n\t\twhile(roles.next()) {\n\t\t\tif(roles.role.name == 'admin')\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}","sys_class_name":"planned_change_validation_script","sys_id":"0dc58e3337310200f212cc028e41f160","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/6535677304712210559073c06a02f74f","value":"6535677304712210559073c06a02f74f"},"sys_update_name":"planned_change_validation_script_0dc58e3337310200f212cc028e41f160","sys_updated_by":"admin","applies_to":"cmdb_ci_service","sys_created_on":"2015-08-17 18:41:10","sys_name":"","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""}]}