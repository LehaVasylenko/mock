{"result":[{"sys_mod_count":"0","sys_updated_on":"2017-02-23 22:23:52","sys_tags":"","type":"directive","script":"function spToolTip($compile) {\n\treturn {\n\t\trestrict: 'A',\n\t\tlink: function($scope, element, attrs, ctrl) {\n\t\t\t$(element).one('mouseover', function(e) {\n\t\t\t\tif (!attrs.tooltips) {\n\t\t\t\t\t$(e.target).attr('tooltips', true);\n\t\t\t\t\t$compile(element)($scope);\n\t\t\t\t} \n\t\t\t});\n\t\t}\n\t}\n}","sys_class_name":"sp_angular_provider","sys_id":"059cceb25b8132006b11c7ad31f91a78","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"sys_update_name":"sp_angular_provider_059cceb25b8132006b11c7ad31f91a78","sys_updated_by":"admin","sys_created_on":"2017-02-23 22:23:52","name":"spTooltip","sys_name":"spTooltip","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"1","sys_updated_on":"2019-02-07 06:39:44","sys_tags":"","type":"directive","script":"function () {\n\treturn {\n\t\trestrict: 'AE',\n\t\treplace: true,\n\t\ttemplate: '<svg viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style=\"display: none;\"><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-bmp\"><title>BMP</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#FC27CB\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"4\" y=\"29\">BMP</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-zip\"><title>ZIP</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M36.3102679,9.84598214 C36.6956865,10.2314007 37.0260403,10.754461 37.3013393,11.4151786 C37.5766383,12.0758962 37.7142857,12.6815449 37.7142857,13.2321429 L37.7142857,37.0178571 C37.7142857,37.5684551 37.5215793,38.0364564 37.1361607,38.421875 C36.7507421,38.8072936 36.2827408,39 35.7321429,39 L7.98214286,39 C7.43154487,39 6.96354359,38.8072936 6.578125,38.421875 C6.19270641,38.0364564 6,37.5684551 6,37.0178571 L6,3.98214286 C6,3.43154487 6.19270641,2.96354359 6.578125,2.578125 C6.96354359,2.19270641 7.43154487,2 7.98214286,2 L26.4821429,2 C27.0327408,2 27.6383896,2.13764743 28.2991071,2.41294643 C28.9598247,2.68824542 29.482885,3.01859926 29.8683036,3.40401786 L36.3102679,9.84598214 Z M27.1428571,4.80803571 L27.1428571,12.5714286 L34.90625,12.5714286 C34.7686005,12.172245 34.6171883,11.8900678 34.4520089,11.7248884 L27.9893973,5.26227679 C27.8242179,5.09709739 27.5420407,4.94568521 27.1428571,4.80803571 Z M35.0714286,36.3571429 L35.0714286,15.2142857 L26.4821429,15.2142857 C25.9315449,15.2142857 25.4635436,15.0215793 25.078125,14.6361607 C24.6927064,14.2507421 24.5,13.7827408 24.5,13.2321429 L24.5,4.64285714 L8.64285714,4.64285714 L8.64285714,36.3571429 L35.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#9958F6\" x=\"1\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"7\" y=\"29\">ZIP</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-xls\"><title>XLS</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#3AA756\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"6\" y=\"29\">XLS</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-txt\"><title>TXT</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#52DBA7\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"6\" y=\"29\">TXT</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-ppt\"><title>PPT</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#FC8A3D\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"6\" y=\"29\">PPT</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-png\"><title>PNG</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#278EFC\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"5\" y=\"29\">PNG</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-pdf\"><title>PDF</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#F95050\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"6\" y=\"29\">PD</tspan><tspan x=\"19.8063617\" y=\"29\" letter-spacing=\"0.357142895\">F</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-jpg\"><title>JPG</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#FCC742\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"6\" y=\"29\">JPG</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-gif\"><title>GIF</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#E340A9\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"7\" y=\"29\">GIF</tspan></text></g></g></symbol><symbol viewBox=\"0 0 41 41\" id=\"cm-icon-doc\"><title>DOC</title><desc>Created with Sketch.</desc><defs></defs><g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g><path d=\"M37.3102679,9.84598214 C37.6956865,10.2314007 38.0260403,10.754461 38.3013393,11.4151786 C38.5766383,12.0758962 38.7142857,12.6815449 38.7142857,13.2321429 L38.7142857,37.0178571 C38.7142857,37.5684551 38.5215793,38.0364564 38.1361607,38.421875 C37.7507421,38.8072936 37.2827408,39 36.7321429,39 L8.98214286,39 C8.43154487,39 7.96354359,38.8072936 7.578125,38.421875 C7.19270641,38.0364564 7,37.5684551 7,37.0178571 L7,3.98214286 C7,3.43154487 7.19270641,2.96354359 7.578125,2.578125 C7.96354359,2.19270641 8.43154487,2 8.98214286,2 L27.4821429,2 C28.0327408,2 28.6383896,2.13764743 29.2991071,2.41294643 C29.9598247,2.68824542 30.482885,3.01859926 30.8683036,3.40401786 L37.3102679,9.84598214 Z M28.1428571,4.80803571 L28.1428571,12.5714286 L35.90625,12.5714286 C35.7686005,12.172245 35.6171883,11.8900678 35.4520089,11.7248884 L28.9893973,5.26227679 C28.8242179,5.09709739 28.5420407,4.94568521 28.1428571,4.80803571 Z M36.0714286,36.3571429 L36.0714286,15.2142857 L27.4821429,15.2142857 C26.9315449,15.2142857 26.4635436,15.0215793 26.078125,14.6361607 C25.6927064,14.2507421 25.5,13.7827408 25.5,13.2321429 L25.5,4.64285714 L9.64285714,4.64285714 L9.64285714,36.3571429 L36.0714286,36.3571429 Z\" fill=\"#BDC0C4\"></path><rect fill=\"#4866F9\" x=\"2\" y=\"17\" width=\"27\" height=\"17\" rx=\"3\"></rect><text font-family=\"Roboto-Bold, Roboto\" font-size=\"10\" font-weight=\"bold\" letter-spacing=\"0.428571463\" fill=\"#FFFFFF\"><tspan x=\"5\" y=\"29\">DOC</tspan></text></g></g></symbol><symbol viewBox=\"-6 0 38 38\" id=\"cm-icon-err\"> <title>Error</title> <desc>Created with Sketch.</desc> <defs></defs> <g id=\"error\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"> <g id=\"00_error-icon\"> <g id=\"Group-2\" stroke-width=\"1\" transform=\"translate(7.000000, 12.000000)\" fill=\"#F95050\"> <g id=\"attachment-error\" fill-rule=\"nonzero\"> <g id=\"Group\" transform=\"translate(0.461538, 0.750000)\"> <path d=\"M12.4923077,2.23125 C9.69230769,-0.425 5.38461538,-0.425 2.58461538,2.23125 C-0.107692308,4.99375 -0.107692308,9.24375 2.58461538,12.00625 C3.98461538,13.3875 5.70769231,14.025 7.53846154,14.025 C9.36923077,14.025 11.0923077,13.28125 12.4923077,12.00625 C15.1846154,9.35 15.1846154,4.99375 12.4923077,2.23125 Z M11.6307692,11.2625 C9.36923077,13.49375 5.70769231,13.49375 3.44615385,11.2625 C1.18461538,9.03125 1.18461538,5.41875 3.44615385,3.1875 C4.63076923,2.01875 6.03076923,1.4875 7.53846154,1.4875 C9.04615385,1.4875 10.5538462,2.01875 11.6307692,3.1875 C13.8923077,5.3125 13.8923077,8.925 11.6307692,11.2625 Z\" id=\"Shape\"></path> <polygon id=\"PolygonShape\" points=\"10.8769231 4.8875 9.90769231 4.0375 7.64615385 6.26875 5.49230769 4.0375 4.52307692 4.99375 6.78461538 7.225 4.52307692 9.45625 5.49230769 10.30625 7.75384615 8.075 10.0153846 10.30625 10.9846154 9.35 8.72307692 7.11875\"></polygon> </g> </g> </g> <path d=\"M28.671875,7.421875 C29.0364602,7.78646016 29.348957,8.28124688 29.609375,8.90625 C29.869793,9.53125313 30,10.1041641 30,10.625 L30,33.125 C30,33.6458359 29.8177102,34.0885398 29.453125,34.453125 C29.0885398,34.8177102 28.6458359,35 28.125,35 L1.875,35 C1.35416406,35 0.911460156,34.8177102 0.546875,34.453125 C0.182289844,34.0885398 0,33.6458359 0,33.125 L0,1.875 C0,1.35416406 0.182289844,0.911460156 0.546875,0.546875 C0.911460156,0.182289844 1.35416406,0 1.875,0 L19.375,0 C19.8958359,0 20.4687469,0.130207031 21.09375,0.390625 C21.7187531,0.651042969 22.2135398,0.963539844 22.578125,1.328125 L28.671875,7.421875 Z M20,2.65625 L20,10 L27.34375,10 C27.213541,9.62239395 27.0703133,9.35546953 26.9140625,9.19921875 L20.8007813,3.0859375 C20.6445305,2.92968672 20.3776061,2.78645898 20,2.65625 Z M27.5,32.5 L27.5,12.5 L19.375,12.5 C18.8541641,12.5 18.4114602,12.3177102 18.046875,11.953125 C17.6822898,11.5885398 17.5,11.1458359 17.5,10.625 L17.5,2.5 L2.5,2.5 L2.5,32.5 L27.5,32.5 Z\" id=\"\" fill=\"#979797\"></path> </g> </g> </symbol></svg>'\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"0621eb68530323008bd7ddeeff7b1215","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/bab6dea3db20320099f93691f0b8f590","value":"bab6dea3db20320099f93691f0b8f590"},"sys_update_name":"sp_angular_provider_0621eb68530323008bd7ddeeff7b1215","sys_updated_by":"admin","sys_created_on":"2019-01-14 03:26:06","name":"knowledgeIcons","sys_name":"knowledgeIcons","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/bab6dea3db20320099f93691f0b8f590","value":"bab6dea3db20320099f93691f0b8f590"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"127","sys_updated_on":"2024-11-04 11:15:00","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\ttemplate: '<div ng-show=\"attachments.length > 0\" class=\"sp-attachment-manager\">' +\n\t\t\t\t\t\t\t\t'<h2 style=\"display: inline\" class=\"h5\">{{::translations[\"Attachments\"]}}</h2>' +\n\t\t\t\t\t\t\t\t'<button class=\"btn btn-link m-l\" ng-show=\"::!omitEdit\" ng-click=\"toggleEditMode()\" aria-label=\"{{translations[\\'Edit Attachments mode\\']}}\" aria-pressed={{editMode}}>{{getToggleName()}}</button>' +\n\t\t\t\t\t\t\t\t'<ul class=\"unstyled-list\" aria-label=\"{{::translations[\\'Attachments\\']}}\">' +\n\t\t\t\t\t\t\t\t\t'<li class=\"attached-file\" ng-repeat=\"attachment in attachments\">' +\n\t\t\t\t\t\t\t\t\t\t'<a ng-if=\"attachment.state === \\'available\\'\" ng-href=\"{{getAttachmentURL(attachment)}}\" target=\"_blank\" aria-label=\"{{::getAriaLabel(attachment)}}\" title=\"{{::getTitle(attachment)}}\"><span class=\"fa {{getIcon(attachment)}}\"></span>' +\n\t\t\t\t\t\t\t\t\t\t'{{attachment.file_name}}</a>' +\n\t\t\t\t\t\t\t\t\t\t'<a href=\"#\" ng-if=\"attachment.state === \\'pending\\' || attachment.state === \\'\\' || attachment.state === \\'available_conditionally\\'\" ng-click=\"scanAttachment(attachment)\" aria-label=\"{{::getAriaLabel(attachment)}}\" title=\"{{::getTitle(attachment)}}\"><span class=\"fa {{getIcon(attachment)}}\"></span>' +\n\t\t\t\t\t\t\t\t\t\t'{{attachment.file_name}}</a>' +\n\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"attachment.state === \\'not_available\\'\" aria-label=\"{{::translations[\\'Attachment\\']}}: {{attachment.file_name}}\" title=\"{{::getTitle(attachment)}}\" class=\"{{attachment.state}}\">' +\n\t\t\t\t\t\t\t\t\t\t'{{attachment.file_name}} <span class=\"error\">({{::translations[\\'File failed security scan\\']}})</span></span>' +\n\t\t\t\t\t\t\t\t\t\t'<button ng-show=\"editMode && attachment.canDelete\" aria-label=\"{{::translations[\\'Delete\\']}} {{attachment.file_name}}\" title=\"{{::translations[\\'Delete\\']}} {{attachment.file_name}}\" data-toggle=\"tooltip\" data-placement=\"top\" ng-click=\"removeAttachment($event, attachment)\" class=\"fa fa-times m-l-xs delete-attachment\"></button>' +\n\t\t\t\t\t\t\t\t\t'</li>' +\n\t\t\t\t\t\t\t\t'</ul>' +\n\t\t\t\t\t\t\t'</div>',\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\tscope: {\n\t\t\ttable: \"=\",\n\t\t\tsysId: \"=\",\n\t\t\tomitEdit: \"=\"\n\t\t},\n\t\tlink: function(scope, elem, attr) {\n\t\t\ti18n.getMessages(['Attachment',\n\t\t\t\t\t\t\t  'Edit',\n\t\t\t\t\t\t\t  'Done',\n\t\t\t\t\t\t\t  'File failed security scan',\n\t\t\t\t\t\t\t  'Attachments',\n\t\t\t\t\t\t\t  'Delete',\n\t\t\t\t\t\t\t  'Attachment deleted successfully',\n\t\t\t\t\t\t\t  'View attachment',\n\t\t\t\t\t\t\t  'Download attachment',\n\t\t\t\t\t\t\t  'Edit Attachments mode'], function(msgArr){\n\t\t\t\tscope.translations = msgArr;\n\t\t\t});\n\t\t},\n\t\tcontroller: function($scope, snAttachmentHandler, spUtil) {\n\t\t\tvar cacheMap = {};\n\t\t\t\n\t\t\t$scope.attachments = [];\n\t\t\t$scope.translations = [];\n\t\t\tvar attachmentHandler;\n\n\t\t\tfunction initializeAttachmentHandler() {\n\t\t\t\t$scope.editMode = false;\n\t\t\t\t\n\t\t\t\tvar key = $scope.table + '.' + $scope.sysId;\n\t\t\t\tvar cached = cacheMap[key];\n\t\t\t\t\n\t\t\t\tif(cached) {\n\t\t\t\t\tattachmentHandler = cached.handler;\n\t\t\t\t\t$scope.attachments = cached.attachments;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tattachmentHandler = snAttachmentHandler.create($scope.table, $scope.sysId);\n\t\t\t\tattachmentHandler.getAttachments().then(function(response) {\n\t\t\t\t\t$scope.attachments = response;\n\t\t\t\t\tcacheMap[key] = {\n\t\t\t\t\t\thandler: attachmentHandler,\n\t\t\t\t\t\tattachments: $scope.attachments\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t$scope.getAriaLabel = function(attachment) {\n\t\t\t    var attachmentMsg = (attachment.viewImage) ? $scope.translations['View attachment'] : $scope.translations['Download attachment'];\n\t\t\t    attachmentMsg += ' ' + attachment.file_name;\n\t\t\t    return attachmentMsg;\n\t\t\t};\n\n\t\t\t$scope.getTitle = function(attachment) {\n\t\t\t\tvar msg = i18n.getMessage(\"Attached by {0} {1}\").withValues([attachment.sys_created_by_display, attachment.sys_updated_on_display]);\n\t\t\t\tif (attachment.encryption_context)\n\t\t\t\t\tmsg += \", \" + i18n.getMessage(\"Encrypted\") + \": \" + attachment.encryption_context_display;\n\t\t\t\treturn msg;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.editMode = false;\n\t\t\t$scope.toggleEditMode = function() {\n\t\t\t\t$scope.editMode = !$scope.editMode;\n\t\t\t}\n\n\t\t\t$scope.getToggleName = function() {\n\t\t\t\treturn ($scope.editMode) ? $scope.translations['Done'] : $scope.translations['Edit'];\n\t\t\t}\n\t\t\t\n\t\t\t$scope.scanAttachment = function(attachment){\n\t\t\t\tsnAttachmentHandler.scanAttachment(attachment);\n\t\t\t}\n\t\t\t\n\t\t\t$scope.$on(\"sn.attachment.scanned\", function(e, recordID) {\n\t\t\t\tattachmentHandler.getAttachments().then(function(response) {\n\t\t\t\t\t$scope.attachments = response;\n\t\t\t\t});\n\t\t\t})\n\t\t\t\n\t\t\t$scope.getAttachmentURL = function(attachment) {\n\t\t\t\tvar url;\n\t\t\t\tif (attachment.viewUrl)\n\t\t\t\t\turl = attachment.viewUrl + \"&view=true\";\n\t\t\t\telse \n\t\t\t\t\turl = '/sys_attachment.do?sys_id='+ attachment.sys_id + '&view=true';\n\t\t\t\treturn url;\n\t\t\t}\n\n\n\t\t\t$scope.removeAttachment = function(e, attachment) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\n\t\t\t\tattachmentHandler.deleteAttachment(attachment).then(function() {\n\t\t\t\t\tif ($scope.attachments.length === 0)\n\t\t\t\t\t\t$scope.editMode = false;\n\n\t\t\t\t\tspUtil.addInfoMessage($scope.translations['Attachment deleted successfully']);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t$scope.$watch(\"sysId\", initializeAttachmentHandler);\n\n\t\t\t$scope.$on(\"sp.attachments.update\", function(e, recordID) {\n\t\t\t\tif (recordID !== $scope.sysId)\n\t\t\t\t\treturn;\n\n\t\t\t\tattachmentHandler.getAttachments().then(function(response) {\n\t\t\t\t\t$scope.attachments = response;\n\n\t\t\t\t\t$scope.$emit('sp.attachments.recount', $scope.attachments.length);\n\t\t\t\t});\n\t\t\t})\n\n\t\t\tvar extIconMap = {\n\t\t\t\t'ppt': 'fa-file-powerpoint-o',\n\t\t\t\t'pptx': 'fa-file-powerpoint-o',\n\t\t\t\t'doc': 'fa-file-word-o',\n\t\t\t\t'docx': 'fa-file-word-o',\n\t\t\t\t'xls': 'fa-file-excel-o',\n\t\t\t\t'xlsx': 'fa-file-excel-o'\n\t\t\t};\n\n\t\t\tvar fileIconMap = {\n\t\t\t\t'image/jpeg': 'fa-file-image-o',\n\t\t\t\t'image/pjpeg': 'fa-file-image-o',\n\t\t\t\t'image/tiff': 'fa-file-image-o',\n\t\t\t\t'image/png': 'fa-file-image-o',\n\t\t\t\t'image/gif': 'fa-file-image-o',\n\t\t\t\t'application/zip': 'fa-file-archive-o',\n\t\t\t\t'application/x-compressed': 'fa-file-archive-o',\n\t\t\t\t'application/x-zip-compressed': 'fa-file-archive-o',\n\t\t\t\t'application/pdf': 'fa-file-pdf-o',\n\t\t\t\t'application/vnd.openxmlformats-officedoc': 'fa-file-word-o',\n\t\t\t\t'application/msword': 'fa-file-word-o',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'fa-file-word-o',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.template': 'fa-file-word-o',\n\t\t\t\t'application/excel': 'fa-file-excel-o',\n\t\t\t\t'application/vnd.ms-excel': 'fa-file-excel-o',\n\t\t\t\t'application/x-excel': 'fa-file-excel-o',\n\t\t\t\t'application/x-msexcel': 'fa-file-excel-o',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': 'fa-file-excel-o',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.template': 'fa-file-excel-o',\n\t\t\t\t'application/powerpoint': 'fa-file-powerpoint-o',\n\t\t\t\t'application/vnd.ms-powerpoint': 'fa-file-powerpoint-o',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.presentation': 'fa-file-powerpoint-o',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.template': 'fa-file-powerpoint-o',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.slideshow': 'fa-file-powerpoint-o'\n\t\t\t};\n\n\t\t\t$scope.getIcon = function(attachment) {\n\t\t\t\treturn attachment.encryption_context ? \"fa-lock\" : (extIconMap[attachment.ext] || fileIconMap[attachment.content_type] || \"fa-file-o\");\n\t\t\t}\n\n\t\t\tinitializeAttachmentHandler();\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"06e836f0d722120023c84f80de6103a1","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"sys_update_name":"sp_angular_provider_06e836f0d722120023c84f80de6103a1","sys_updated_by":"admin","sys_created_on":"2016-03-31 18:06:41","name":"spAttachmentManager","sys_name":"spAttachmentManager","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"46","sys_updated_on":"2021-11-17 04:54:42","sys_tags":"","type":"directive","script":"function(dateUtils, $rootScope, $document, i18n, $window, spAriaUtil,$timeout) {\n    var dateFormat = dateUtils.SYS_DATE_FORMAT;\n\tvar dateTimeFormat = dateUtils.SYS_DATE_TIME_FORMAT;\n    var isChrome = $window.navigator.userAgent.indexOf(\"Chrome\") > -1;\n    var isSafari = !isChrome && $window.navigator.userAgent.indexOf(\"Safari\") > -1;\n    var enableDateTranslation = $window.NOW.sp.enableDateTranslation;\n    var TOGGLE_DATETIME_PICKER = \"toggleDateTimePicker\";\n    var DECREMENT_MINUTES = \"decrementMinutes\";\n    const ACTIVE_DAY = '.datepicker-days .day.active div';\n    const ACTIVE_MONTH = '.datepicker-months span.active';\n    const MONTH_ELEMENTS = '.datepicker-months .month';\n    const ACTIVE_YEAR = '.datepicker-years span.active';\n    var translations = [];\n\n    i18n.getMessages([\"month\", \"year\", \"decade\", \"Toggle\", \"Previous\", \"Next\"], function(msgs){\n        translations = msgs;\n    });\n\tvar keyMap = {\n\t\t\tArrowLeft: {date: 'decrementDays', time: null},\n\t\t\tLeft: {date: 'decrementDays', time: null},\n\t\t\tArrowRight: {date: 'incrementDays', time: null},\n\t\t\tRight: {date: 'incrementDays', time: null},\n\t\t\tArrowUp: {date: 'decrementWeeks', time: 'incrementMinutes'},\n\t\t\tUp: {date: 'decrementWeeks', time: 'incrementMinutes'},\n\t\t\tArrowDown: {date: 'incrementWeeks', time: 'decrementMinutes'},\n\t\t\tDown: {date: 'incrementWeeks', time: 'decrementMinutes'},\n\t\t\tAltUp: 'toggleDateTimePicker',\n\t\t\tAltArrowUp: 'toggleDateTimePicker',\n\t\t\tAltDown: 'toggleDateTimePicker',\n\t\t\tAltArrowDown: 'toggleDateTimePicker',\n\t\t\tPageUp: {date: 'decrementMonths', time: 'incrementHours'},\n\t\t\tPageDown: {date: 'incrementMonths', time: 'decrementHours'},\n\t\t\tAltPageUp: {date: 'decrementYears', time: null},\n\t\t\tAltPageDown: {date: 'incrementYears' ,time: null},\n\t\t\tHome: {date: 'startOfCurrentMonth', time: null},\n\t\t\tEnd: {date: 'endOfCurrentMonth', time: null}\n\t};\n    if ($rootScope.user && $rootScope.user.date_format)\n\t\tdateFormat = $rootScope.user.date_format;\n\t\n\tif ($rootScope.user && $rootScope.user.date_time_format)\t\t\n \t\tdateTimeFormat = $rootScope.user.date_time_format;\n\n    function isValidDate(value, format){\n        if (value === '')\n            return true;\n\n        return dateUtils.getDateFromFormat(value, format) != 0;\n    }\n\n    return {\n        template:\n            '<div class=\"row\"><div class=\"col-xs-12 col-sm-6 col-md-4\">' +\n\t\t\t\t'<div id=\"valueIsInvalid{{field.sys_id}}\">' +\n\t\t\t\t\t'<div aria-live=\"polite\" class=\"sr-only wrapper-xs alert alert-danger\" ng-if=\"field.invalidValue\">' +\n\t\t\t\t\t\t'{{errorMsg}}' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t'</div>' +\n\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>'+\n\t\t\t'</div>' +\n                '<div ng-class=\"{\\'input-group\\': !snDisabled}\" style=\"width: 100%;\">' +\n                    '<span ng-if=\"isSafari\" class=\"sr-only\" aria-live=\"{{::live}}\">{{formattedDateAria}}</span>' +\n                    '<input ng-class=\"{\\'has-error\\':field.invalidValue || !field.isMandatoryFilled, \\'autofocus-error\\':field.invalidValue || !field.isMandatoryFilled}\" aria-describedby=\"details_{{field.sys_id}} valueIsInvalid{{field.sys_id}} notAnswered{{field.sys_id}}\" aria-invalid=\"{{field.invalidValue || !field.isMandatoryFilled}}\" type=\"text\" name=\"{{field.name}}\" class=\"form-control autofocus-class\" placeholder=\"{{::field.placeholder}}\" ng-model=\"formattedDate\" ng-model-options=\"{updateOn: \\'blur\\', getterSetter: true}\" ng-disabled=\"snDisabled\" ng-readonly=\"field.readOnly\" aria-label=\"{{::field.label}}\" aria-required=\"{{::field.mandatory}}\"/>' +\n                    '<span class=\"input-group-btn\" ng-hide=\"snDisabled\">' +\n                        '<input type=\"hidden\" class=\"datepickerinput\" ng-model=\"formattedDate\" ng-readonly=\"true\" />' +\n                        '<button class=\"btn btn-default\" type=\"button\" ng-hide=\"field.readOnly\" title=\"{{title}}\" aria-label=\"{{title}}\" data-toggle=\"tooltip\" data-placement=\"top\">' +\n                            '<glyph sn-char=\"calendar\" />' +\n                        '</button>' +\n                    '</span>' +\n                '</div>' +\n            '</div>' + '<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' + '</div>',\n        restrict: 'E',\n        replace: true,\n        require: '?ngModel',\n        scope: {\n            field: '=',\n            snDisabled: '=',\n            snIncludeTime: '=',\n            snChange: '&',\n            c: '='\n        },\n        link: function(scope, element, attrs, ngModel) {\n            var includeTime = scope.snIncludeTime;\n            var format = includeTime ? dateTimeFormat.trim() : dateFormat.trim();\n\t\t\tformat = format.replace(/y/g, 'Y').replace(/d/g, 'D').replace(/a/g, 'A');\t\n\t\t\tscope.initDateTimePicker = true;\n\t\t\tscope.oldDateValue;\n\t\t\tscope.oldInputValue;\n\t\t\tscope.picker;\n\t\t\tscope.title = i18n.getMessage(\"Show calendar\");\n\t\t\tscope.live = isSafari ? \"polite\" : \"off\";\n\t\t\tscope.isSafari = isSafari;\n\t\t\tvar dp = element.find('.input-group-btn').datetimepicker({\n                keepInvalid: true,\n                pickTime: scope.snIncludeTime === true,\n                format: format\n            }).on('dp.change', onDpChange);\n\t\t\t\n            function closeOnTouch(evt) {\n                if (!jQuery.contains(dp.data('DateTimePicker').widget[0], evt.target)) {\n                        dp.data('DateTimePicker').hide();\n                }\n            }\n\n            function bindTouchClose() {\n\t\t\t\tvar picker = dp.data('DateTimePicker');\n\t\t\t\tscope.oldDateValue = dp.data('DateTimePicker').date.clone();\n\t\t\t\tscope.oldInputValue = scope.field.invalidValue ? '' : getDatePickerInput(dp.data('DateTimePicker')).val();\n\t\t\t\tif (scope.initDateTimePicker) {\n\t\t\t\t\tscope.picker = picker;\n                    scope.initDateTimePicker = false;\n                    attachKeyboardEvent(picker);\n                    picker.widget.find('table.table-condensed').attr('role', 'presentation');\n                    if (picker.options.pickTime)\n                        picker.widget.find('.picker-switch.accordion-toggle').append('<div class=\"flex-row cancelok-datetime\"><button class=\"btn cancel\">' + i18n.getMessage('Cancel') + '</button><button class=\"btn ok\">' + i18n.getMessage('OK') + '</button></div>');\n                    else\n                        picker.widget.append('<div class=\"flex-row cancelok-date\"><button class=\"btn cancel\">' + i18n.getMessage('Cancel') + '</button><button class=\"btn ok\">' + i18n.getMessage('OK') + '</button></div>');\n                    picker.widget.find('.cancel').on('click', function(e) {\n                        e.stopPropagation();\n                        cancelDatePickerValue(picker);\n                    });\n                    picker.widget.find('.ok').on('click', function(e) {\n                        e.stopPropagation();\n                        hidePicker(picker);\n                    });\n                }\n\t\t\t\tattachOnscrollEvent();\n                $document.on('touchstart', closeOnTouch);\n\t\t\t\tonShowDatePicker(dp.data('DateTimePicker'));\n            }\n\n            function unBindTouchClose() {\n\t\t\t\tdp.data('DateTimePicker').element.find('button').removeClass('calendarbutton-pressed');\n                $document.off('touchstart', closeOnTouch);\n\t\t\t\tdetachOnscrollEvent();\n            }\n            dp.on('dp.show', bindTouchClose).on('dp.hide', unBindTouchClose);\n\t\t\t\n\t\t\tdp.on('dp.action', function(e) {\n                onDpAction(e);\n            });\n\t\t\t\n\t\t\tdp.on('dp.toggle', function(e) {\n\t\t\t\tonDpToggle(dp.data('DateTimePicker'), e);\n\t\t\t});\n\n            function onDpChange(e) {\n\t\t\t\tvar translatedDate = enableDateTranslation ? e.date.format(format) : e.date.locale(\"en\").format(format);\n                scope.formattedDate(translatedDate);\n                // Update isMandatoryFilled\n\t\t\t\tscope.formattedDateAria = formatDate(dp.data('DateTimePicker'), e.date);\n                scope.field.isMandatoryFilled = ngModel.$viewValue != \"\"\n                if (!scope.$root.$$phase)\n                    scope.$apply();\n            }\n\n            function validate(formattedDate) {\n                var field = scope.field;\n                field.invalidValue = false;\n\t\t\t\tvar format = scope.snIncludeTime ? dateTimeFormat.trim() : dateFormat.trim();\n                if (formattedDate == null || formattedDate == '') {\n                    dp.data('DateTimePicker').setValue(new Date());\n\t\t\t\t\tscope.formattedDateAria = '';\n                    return '';\n                }\n\n                if (isValidDate(formattedDate, format)) {\n\t\t\t\t\tdp.data('DateTimePicker').setDate(formattedDate);\n                }\n                else {\n                    field.invalidValue = true;\n                    scope.c.getErrorMessage(\"valueIsInvalid\" + field.sys_id, field.invalidValue, \"${Value is invalid}\", scope, element);\n                }\n                return formattedDate;\n            }\n\n            if (ngModel) {\n                ngModel.$parsers.push(validate);\n\n                // Called when setting value from g_form.setValue()\n                // Shows a red border if the date isn't formatted properly\n                ngModel.$render = function() {\n                    validate(ngModel.$viewValue);\n                };\n\n                // Connect the input field's ng-model to this directive's ng-model\n                scope.formattedDate = function(formattedValue) {\n                    if (angular.isDefined(formattedValue)) {\n                        ngModel.$setViewValue(formattedValue);\n                        if (scope.snChange) scope.snChange({newValue: formattedValue});\n                    }\n\n                    return ngModel.$viewValue;\n                };\n            } else {\n                scope.formattedDate = function(formattedValue) {\n                    if (angular.isDefined(formattedValue)) {\n                        scope.field.value = validate(formattedValue);\n                        if (scope.snChange) scope.snChange({newValue: formattedValue});\n                    }\n\n                    return scope.field.value;\n                };\n                scope.$watch('field.value', function(newValue, oldValue){\n                    if (newValue != oldValue) {\n                        validate(newValue);\n                    }\n                });\n            }\n\t\t\t\n\t\t\tfunction attachKeyboardEvent(picker) {\n                picker.widget.on('keydown', $.proxy(onKeydownEvt, this, picker));\n                picker.widget.on('keyup', $.proxy(onKeyupEvt, this, picker));\n                picker.widget.on('click', '.datepicker *', $.proxy(onClickEvt, this, picker));\n            }\n\t\t\t\n\t\t\tfunction detachKeyboardEvent(picker) {\n\t\t\t\tpicker.widget.off('keydown');\n\t\t\t\tpicker.widget.off('keyup');\n\t\t\t\tpicker.widget.off('click','.datepicker *');\n\t\t\t}\n\t\t\t\n\t\t\tfunction cancelDatePickerValue(picker) {\n                picker.setDate(scope.oldDateValue);\n                picker.hide();\n                setHideDatePickerFocus(picker);\n\t\t\t\tif (scope.oldInputValue == '') {\n\t\t\t\t\tgetDatePickerInput(picker).val('');\n\t\t\t\t\tscope.formattedDateAria = '';\n\t\t\t\t}\n            }\n\t\t\t\n\t\t\tfunction setHideDatePickerFocus(picker) {\n                var calendarButtonElement = picker.element.find('button');\n                var closeMessage = (picker.options.pickTime ? i18n.getMessage('date time') : i18n.getMessage('date')) + \" \" + i18n.getMessage('picker is closed');\n                if (calendarButtonElement.length > 0) {\n                    setArialabel(calendarButtonElement[0], closeMessage + \". \" + i18n.getMessage('Show calendar'));\n                    calendarButtonElement[0].focus();\n                    setTimeout(function() {\n                        setArialabel(calendarButtonElement[0], i18n.getMessage('Show calendar'));\n                    }, 3000);\n                }\n            }\n\t\t\t\n\t\t\tfunction hidePicker(picker) {\n\t\t\t\tvar input = getDatePickerInput(picker);\n\t\t\t\t\tif (input && input.val() === '') {\n\t\t\t\t\t\tpicker.setDate(enableDateTranslation ? moment().format(picker.format) : moment().locale(\"en\").format(picker.format));\n\t\t\t\t\t}\n                picker.hide();\n                setHideDatePickerFocus(picker);\n            }\n\t\t\t\n\t\t\tfunction onShowDatePicker(picker) {\n                setArialabels(picker);\n                setShowDatePickerFocus(picker, picker.date, \"open\");\n\n\t\t\t\tif (datePickerShowType(picker) == 'date') //to display the Cancel and OK buttons if the picker was previously closed in month,year view\n\t\t\t\t\tpicker.options.pickTime ? picker.widget.find('.picker-switch.accordion-toggle .flex-row').removeClass('cancelok-hidden') : picker.widget.find('.datepicker').next().removeClass('cancelok-hidden');\n\n                picker.element.find('button').addClass('calendarbutton-pressed'); //to show the pressed state of the datepicker\n            }\n\t\t\t\n\t\t\tfunction setShowDatePickerFocus(picker, date, action) {\n                var showType = datePickerShowType(picker);\n                var formattedDate = formatDate(picker, date);\n                var openMessage = getOpenMessage(picker);\n                var calendarShowType = getCalendarShowType(picker);\n\n                if (action == 'toggleDateTimePicker') {\n                    if (showType == 'date' && calendarShowType == 'days')\n                        picker.widget.find('.picker-switch.accordion-toggle .flex-row').removeClass('cancelok-hidden');\n                    else\n                        picker.widget.find('.picker-switch.accordion-toggle .flex-row').addClass('cancelok-hidden');\n                }\n\n                if (!action || action.indexOf(\"toggleDateTimePicker\") !== -1) {\n                    return;\n                }\n\n                if (showType === \"date\") {\n                    //focus on dayElement for date picker\n                    var dayElement = picker.widget.find('.datepicker-days td.active div');\n                    if (dayElement.length > 0) {\n                        var label = formattedDate;\n\n                        if (action === \"open\") {\n                            label = openMessage + (picker.options.pickTime ? showTypeMessage(picker) : \"\") + label;\n                            setArialabel(dayElement[0], label); //aria-label for date picker open message, all browsers\n                        } else {\n                            if (!isSafari) {\n                                setArialabel(dayElement[0], label); //aria-label for current selected date, all browsers except safari using aria-live\n                            }\n                        }\n\n                        dayElement[0].blur();\n                        setTimeout(function() {\n                            dayElement[0].focus();\n                        }, 50);\n                    }\n                }\n\n\n                if (showType === \"time\") {\n                    if (action === \"open\") {\n                        onDpToggle(picker, null, openMessage);\n                    } else if (action === \"togglePeriod\") {\n                        var togglePeriodElement = picker.widget.find('.timepicker [data-action=' + action + ']');\n                        setArialabel(togglePeriodElement[0], action + \" \" + togglePeriodElement[0].innerText);\n                        togglePeriodElement[0].blur();\n                        setTimeout(function() {\n                            togglePeriodElement[0].focus();\n                        }, 100);\n                    } else if (action === \"selectHour\") {\n                        var showHoursEl = picker.widget.find('.timepicker [data-action=\"showHours\"]');\n                        showHoursEl.focus();\n                    } else if (action === \"selectMinute\") {\n                        var showMinutesEl = picker.widget.find('.timepicker [data-action=\"showMinutes\"]');\n                        showMinutesEl.focus();\n                    } else if (action === \"showHours\") {\n                        var togglePickerEl = picker.widget.find('[data-action=\"toggleDateTimePicker\"]');\n                        togglePickerEl.focus();\n                        spAriaUtil.sendLiveMessage(i18n.getMessage('hour picker opened'), 'status')\n                    } else if (action === \"showMinutes\") {\n                        var togglePickerEl = picker.widget.find('[data-action=\"toggleDateTimePicker\"]');\n                        togglePickerEl.focus();\n                        spAriaUtil.sendLiveMessage(i18n.getMessage('minute picker opened'), 'status');\n                    } else {\n                        var arrowElement = picker.widget.find('.timepicker [data-action=' + action + ']');\n                        setArialabel(arrowElement[0], action + \" \" + (isSafari ? \"\" : formattedDate));\n                        arrowElement[0].blur();\n                        setTimeout(function() {\n                            arrowElement[0].focus();\n                        }, 100);\n                    }\n                }\n            }\n\t\t\t\n\t\t\tfunction getOpenMessage(picker) {\n                return (picker.options.pickTime ? i18n.getMessage('date time') : i18n.getMessage('date')) + \" \" + i18n.getMessage('picker is opened') + \". \";\n            }\n\t\t\t\n\t\t\tfunction getCalendarShowType(picker) {\n                if (picker.widget.find('.datepicker-days').css('display') == 'block')\n                    return \"days\";\n                if (picker.widget.find('.datepicker-months').css('display') == 'block')\n                    return \"months\";\n                if (picker.widget.find('.datepicker-years').css('display') == 'block')\n                    return \"years\";\n            }\n\t\t\t\n\t\t\tfunction formatDate(picker, date) {\n                var format = \"DD MMMM YYYY\",\n                    formattedDate = null,\n                    a = \"\",\n                    s = \"\";\n\n                if (picker.options.pickTime) {\n\n                    if (picker.options.format.indexOf(\"h\") !== -1) {\n                        a = \" A\";\n                    }\n\n                    if (picker.options.format.indexOf(\"s\") !== -1) {\n                        s = \":ss\";\n                    }\n\n                    format += (a ? \" hh\" : \" HH\") + \":mm\" + s + a;\n                }\n\n                format += \" dddd\";\n\n                if (enableDateTranslation) {\n                    formattedDate = moment(date).format(format);\n                } else {\n                    formattedDate = moment(date).locale(\"en\").format(format);\n                }\n\n                return formattedDate;\n            }\n\t\t\t\n\t\t\tfunction showTypeMessage(picker) {\n                var showType = datePickerShowType(picker);\n                return i18n.getMessage('showing') + \" \" + i18n.getMessage(showType) + \" \" + i18n.getMessage('picker') + \". \";\n            }\n\t\t\t\n\t\t\t\n            function onDpToggle(picker, e, openMessage) {\n                var toggleElement = setToggleElementArialabel(picker);\n\n                if (openMessage) {\n                    setArialabel(toggleElement, openMessage + \" \" + toggleElement.getAttribute('aria-label'));\n                }\n                toggleElement.blur();\n                setTimeout(function() {\n                    toggleElement.focus();\n                }, 150);\n            }\n\t\t\t\n\t\t\tfunction setToggleElementArialabel(picker) {\n                var showType = datePickerShowType(picker),\n                    toggleElement = picker.widget.find('.accordion-toggle a');\n\n                if (toggleElement[0])\n                    toggleElement.attr('title', translations['Toggle date time picker']);\n\n                setArialabel(toggleElement[0], showTypeMessage(picker) + i18n.getMessage(\"Toggle date time picker\"));\n                return toggleElement[0];\n\n            }\n\t\t\t\n\t\t\tfunction onKeyupEvt(picker, e) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n\t\t\t\n\t\t\tfunction onClickEvt(picker, e) {\n                var calendarShowType = getCalendarShowType(picker);\n                 var toggleText = calendarShowType == 'years' ? translations['decade'] : (calendarShowType == 'months' ? translations['year'] : translations['month']);\n\t\t\t\tvar pickerSwitchAriaLabel = calendarShowType == 'years' ? picker.widget.find('.datepicker-years .picker-switch').html() : picker.widget.find('.datepicker-' + calendarShowType + ' .picker-switch').html() + '. ' + translations['Toggle'] + ' ' + toggleText;\n\n                if ($(e.target).is('.day div,.day')) {\n                    setTimeout(function() {\n                        setShowDatePickerFocus(picker, picker.date, \"click\");\n                    }, 200);\n                } else if ($(e.target).is(MONTH_ELEMENTS)) {\n                    picker.options.pickTime ? picker.widget.find('.picker-switch.accordion-toggle .flex-row').removeClass('cancelok-hidden') : picker.widget.find('.datepicker').next().removeClass('cancelok-hidden');\n                    picker.widget.find('.datepicker-' + calendarShowType + ' .picker-switch').attr('aria-label', pickerSwitchAriaLabel);\n                    setMonthDayYearArialabel(picker);\n                } else if ($(e.target).hasClass('picker-switch')) {\n                    picker.options.pickTime ? picker.widget.find('.picker-switch.accordion-toggle .flex-row').addClass('cancelok-hidden') : picker.widget.find('.datepicker').next().addClass('cancelok-hidden');\n                    picker.widget.find('.datepicker-' + calendarShowType + ' .picker-switch').attr('aria-label', pickerSwitchAriaLabel);\n                } else if ($(e.target).is('.prev,.next,.year')) {\n                    picker.widget.find('.datepicker-' + calendarShowType + ' .picker-switch').attr('aria-label', pickerSwitchAriaLabel);\n                }\n            }\n\t\t\t\n\t\t\tfunction onKeydownEvt(picker, e) {\n                var showType = datePickerShowType(picker);\n                var calendarShowType = getCalendarShowType(picker);\n                var amPmCheck = picker.widget.find('.timepicker [data-action=\"togglePeriod\"]').length ? true : false;\n\n                if (e.keyCode === 9) {\n                    if (showType === \"date\") {\n                        var datePickerfocusableEls = window.tabbable(picker.widget[0]);\n                        var firstFocusableEl = datePickerfocusableEls[0],\n                            nextButtonEl = datePickerfocusableEls[2],\n                            cancelOrTimeButtonEl = datePickerfocusableEls[3],\n                            lastFocusableEl = datePickerfocusableEls[datePickerfocusableEls.length - 1],\n                            dmyEl = calendarShowType == 'days' ? '.datepicker-days td.day div' : '.datepicker-' + calendarShowType + ' span.' + calendarShowType.slice(0, -1);\n\n                        if (e.shiftKey) {\n                            if (document.activeElement === firstFocusableEl) {\n                                if (!picker.options.pickTime && calendarShowType != 'days')\n                                    setFocusOnTab(picker);\n                                else\n                                    lastFocusableEl.focus();\n\n                                e.stopPropagation();\n                                e.preventDefault();\n                            } else if (document.activeElement === cancelOrTimeButtonEl) {\n                                setFocusOnTab(picker);\n                                e.stopPropagation();\n                                e.preventDefault();\n                            } else if ($(e.target).is(dmyEl)) {\n                                nextButtonEl.focus();\n                                e.stopPropagation();\n                                e.preventDefault();\n                            }\n                        } else {\n                            if (document.activeElement === nextButtonEl) {\n                                setFocusOnTab(picker);\n                                e.stopPropagation();\n                                e.preventDefault();\n                            } else if (document.activeElement === lastFocusableEl) {\n                                firstFocusableEl.focus();\n                                e.stopPropagation();\n                                e.preventDefault();\n                            } else if ($(e.target).is(dmyEl)) {\n                                if (!picker.options.pickTime && calendarShowType != 'days')\n                                    firstFocusableEl.focus();\n                                else\n                                    cancelOrTimeButtonEl.focus();\n\n                                e.stopPropagation();\n                                e.preventDefault();\n                            }\n                        }\n                    }\n\n                    if (showType === \"time\") {\n                        //tab handling for hour picker and minute picker\n                        if (picker.widget.find('.timepicker-picker')[0].style.display === 'none') {\n                            var timePickerfocusableEls = window.tabbable(picker.widget[0]);\n                            var firstFocusableElem = timePickerfocusableEls[0],\n                                lastFocusableElem = timePickerfocusableEls[timePickerfocusableEls.length - 1];\n\n                            if (event.which === 9) {\n                                if (event.shiftKey) {\n                                    if (document.activeElement === firstFocusableElem) {\n                                        lastFocusableElem.focus();\n                                        event.preventDefault();\n                                        event.stopPropagation();\n                                    }\n                                } else {\n                                    if (document.activeElement === lastFocusableElem) {\n                                        firstFocusableElem.focus();\n                                        event.preventDefault();\n                                        event.stopPropagation();\n                                    }\n                                }\n                            }\n                            return;\n                        }\n                        if (e.shiftKey) {\n                            e.stopPropagation();\n                            e.preventDefault();\n                            if (($(e.target).parent().hasClass('accordion-toggle') && !amPmCheck) || $(e.target).attr('data-action') === 'togglePeriod') {\n                                setTimeArrowElementFocus(picker, DECREMENT_MINUTES);\n                            } else if ($(e.target).attr('data-action') === 'incrementHours') {\n                                var toggleElement = picker.widget.find('.accordion-toggle a');\n                                toggleElement[0].focus();\n                            } else if ($(e.target).attr('data-action') === 'incrementMinutes') {\n                                setTimeArrowElementFocus(picker, 'decrementHours');\n                            } else if ($(e.target).attr('data-action') === 'decrementHours') {\n                                setTimeArrowElementFocus(picker, 'showHours');\n                            } else if ($(e.target).attr('data-action') === 'showHours') {\n                                setTimeArrowElementFocus(picker, 'incrementHours');\n                            } else if ($(e.target).attr('data-action') === 'decrementMinutes') {\n                                setTimeArrowElementFocus(picker, 'showMinutes');\n                            } else if ($(e.target).attr('data-action') === 'showMinutes') {\n                                setTimeArrowElementFocus(picker, 'incrementMinutes');\n                            } else if ($(e.target).parent().hasClass('accordion-toggle')) {\n                                setTimeArrowElementFocus(picker, 'togglePeriod');\n                            }\n                        } else {\n                            if (($(e.target).attr('data-action') === DECREMENT_MINUTES && !amPmCheck) || $(e.target).attr('data-action') === 'togglePeriod') {\n                                e.stopPropagation();\n                                e.preventDefault();\n                                picker.widget.find(\"[data-action=\" + TOGGLE_DATETIME_PICKER + \"]\").focus();\n                            } else {\n                                e.stopPropagation();\n                                e.preventDefault();\n                                if ($(e.target).parent().hasClass('accordion-toggle')) {\n                                    setTimeArrowElementFocus(picker, 'incrementHours');\n                                } else if ($(e.target).attr('data-action') === 'incrementHours') {\n                                    setTimeArrowElementFocus(picker, 'showHours');\n                                } else if ($(e.target).attr('data-action') === 'showHours') {\n                                    setTimeArrowElementFocus(picker, 'decrementHours');\n                                } else if ($(e.target).attr('data-action') === 'decrementHours') {\n                                    setTimeArrowElementFocus(picker, 'incrementMinutes');\n                                } else if ($(e.target).attr('data-action') === 'incrementMinutes') {\n                                    setTimeArrowElementFocus(picker, 'showMinutes');\n                                } else if ($(e.target).attr('data-action') === 'showMinutes') {\n                                    setTimeArrowElementFocus(picker, 'decrementMinutes');\n                                } else if ($(e.target).attr('data-action') === 'decrementMinutes') {\n                                    setTimeArrowElementFocus(picker, 'togglePeriod');\n                                }\n                            }\n                        }\n                    }\n\n                    return;\n                }\n\n                if (e.keyCode === 13 && $(e.target).attr(\"data-action\")) {\n                    if ($(e.target).attr(\"data-action\") !== 'showHours' && $(e.target).attr(\"data-action\") !== 'showMinutes')\n                        return;\n                }\n\n                var arrowKeys = [37, 38, 39, 40]; // left,up,right,down\n                if (arrowKeys.indexOf(e.keyCode) != -1 && calendarShowType != 'days') {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    var clone = moment(picker.date).clone();\n                    if (e.keyCode == 37) { // left\n                        clone.subtract('1', calendarShowType.slice(0, -1));\n                    } else if (e.keyCode == 38) { // up\n                        clone.subtract('4', calendarShowType.slice(0, -1));\n                    } else if (e.keyCode == 39) { // right\n                        clone.add('1', calendarShowType.slice(0, -1));\n                    } else if (e.keyCode == 40) { // down\n                        clone.add('4', calendarShowType.slice(0, -1));\n                    }\n                    picker.setDate(clone);\n                    picker.widget.find('.month,.year').attr({\n                        'tabindex': '-1',\n                        'role': 'button'\n                    });\n                    picker.widget.find('.datepicker-' + calendarShowType + ' .active').focus();\n                    return;\n                }\n\n                e.stopPropagation();\n                e.preventDefault();\n\n                if (e.keyCode === 13) { //handle enter key for all the buttons on the picker\n                    $(e.target).click();\n                    if ($(e.target).hasClass('picker-switch')) { //click on month,year toggles - focus on the toggle of next view\n                        calendarShowType = getCalendarShowType(picker);\n                        picker.widget.find('.datepicker-' + calendarShowType + ' .picker-switch').attr({\n                            tabindex: '0',\n                            role: 'button'\n                        }).focus();\n                    } else if ($(e.target).is('.month, .year')) { //pressing enter on any month/year will focus on the active day/month respectively(or the first day/month)\n                        if ($(e.target).is('.month')) {\n                            var dmyElement = picker.widget.find(ACTIVE_DAY).length ? picker.widget.find(ACTIVE_DAY) : picker.widget.find('.datepicker-days .day:not(.old) div').first();\n                            dmyElement.focus();\n                        } else {\n                            var dmyElement = picker.widget.find(ACTIVE_MONTH).length ? picker.widget.find(ACTIVE_MONTH) : picker.widget.find(MONTH_ELEMENTS).first();\n                            $(dmyElement).attr({\n                                tabindex: '-1',\n                                role: 'button'\n                            });\n                            dmyElement.focus();\n                        }\n                    } else {\n                        $(e.target).blur(); //blur and focus for screenreaders to re-announce if on the same element(like prev,next buttons)\n                        setTimeout(function() {\n                            $(e.target).focus();\n                        }, 100);\n                    }\n                } else if (e.keyCode === 32) {\n                    //Speical handling for space key, since FF treats space key to trigger both \"click\" and \"keydown\" event\n                    setTimeout(function() {\n                        hidePicker(picker);\n                    }, 200);\n                } else if (e.keyCode === 27) { // allow escape key to cancel picker value and hide picker\n                    cancelDatePickerValue(picker);\n                } else {\n                    var maybeAltHandler = e.altKey && keyMap[\"Alt\" + e.key],\n                        action = maybeAltHandler || keyMap[e.key];\n\n                    if (action && action instanceof Object) {\n                        action = action[showType];\n                    }\n\n                    if (action) {\n                        if (showType === \"time\" && action.indexOf(\"toggle\") === -1) {\n                            var arrowElement = picker.widget.find('.timepicker [data-action=' + action + ']');\n                            $(arrowElement[0]).trigger('click');\n                        } else {\n                            var actionEvent = jQuery.Event(\"doAction\", {\n                                action: action\n                            });\n                            picker.widget.trigger(actionEvent);\n                        }\n                    }\n                }\n\n                if (maybeAltHandler && (e.keyCode === 38 || e.keyCode === 40)) {\n                    spAriaUtil.sendLiveMessage(i18n.getMessage('Switching to') + \" \" + datePickerShowType(picker) + \" \" + i18n.getMessage('picker'));\n                }\n            }\n\t\t\t\n\t\t\tfunction datePickerShowType(picker) {\n                if (!picker.options.pickTime) {\n                    return \"date\";\n                }\n\n                if (!picker.options.pickDate) {\n                    return \"time\";\n                }\n\n                var $this = $(picker.widget.find('.accordion-toggle')[0]);\n                return $this.find('.glyphicon-calendar').length !== 0 ? \"time\" : \"date\";\n            }\n\t\t\t\n\t\t\tfunction setTimeArrowElementFocus(picker, action) {\n                var arrowElement = picker.widget.find('.timepicker [data-action=' + action + ']');\n                if (arrowElement[0])\n                    arrowElement[0].focus();\n            }\n\t\t\t\n\t\t\tfunction setFocusOnTab(picker) {\n                var activeEl;\n                var calendarShowType = getCalendarShowType(picker);\n\n                switch (calendarShowType) {\n                    case 'days':\n                        if (picker.widget.find(ACTIVE_DAY).length == 0) // if no selected date in current month view - select the first date \n                            picker.setDate(moment(picker.date).year(picker.widget.find('.datepicker-days .picker-switch').html().slice(-4)).month(picker.widget.find('.datepicker-days .picker-switch').html().slice(0, -5)).date(1));\n\n                        activeEl = ACTIVE_DAY;\n                        break;\n                    case 'months':\n                        if (picker.widget.find(ACTIVE_MONTH).length == 0) // if no selected month in current year view - select the first month\n                            picker.setDate(moment(picker.date).year(picker.widget.find('.datepicker-months .picker-switch').html()).month(0));\n\n                        activeEl = ACTIVE_MONTH;\n                        break;\n                    case 'years':\n                        if (picker.widget.find(ACTIVE_YEAR).length == 0) // if no selected year in current decade view - select the first year\n                            picker.setDate(moment(picker.date).year(picker.widget.find('.datepicker-years .picker-switch').html().slice(0, 4)));\n\n                        activeEl = ACTIVE_YEAR;\n                        break;\n                }\n                picker.widget.find(activeEl).attr({\n                    tabindex: '-1',\n                    role: 'button'\n                }).focus();\n            }\n\t\t\t\n\t\t\tfunction setArialabels(picker) {\n                setMonthDayYearArialabel(picker);\n                setHourMinuteArialabel(picker);\n                setDayMonthYearArrowElementsArialabel(picker);\n                if (picker.options.pickTime) {\n                    setToggleElementArialabel(picker);\n                    setTimeArrowElementsArialabel(picker);\n                }\n            }\n\t\t\t\n\t\t\tfunction setMonthDayYearArialabel(picker) {\n                if (isSafari) return;\n\n                var dates = picker.widget.find('.datepicker .day'),\n                    months = picker.widget.find('.datepicker .month'),\n                    currentDate = moment(picker.date);\n\n                $(dates).each(function(index, date) {\n                    var clone = currentDate.clone(),\n                        div = $(date).find('div')[0];\n\n                    if ($(date).hasClass(\"old\")) {\n                        clone.subtract(\"1\", \"month\");\n                    } else if ($(date).hasClass(\"new\")) {\n                        clone.add(\"1\", \"month\");\n                    }\n                    clone.date(div.innerHTML);\n\n                    var dateText = formatDate(picker, clone);\n                    div.setAttribute('aria-label', dateText);\n                });\n\n                $(months).each(function(index, month) {\n                    var clone = currentDate.clone(),\n                        format = 'MMMM',\n                        monthAriaLabel;\n                    clone.month(month.innerHTML);\n\n                    if (enableDateTranslation) {\n                        monthAriaLabel = moment(clone).format(format);\n                    } else {\n                        monthAriaLabel = moment(clone).locale(\"en\").format(format);\n                    }\n\n                    month.setAttribute('aria-label', monthAriaLabel);\n                });\n\n            }\n\t\t\t\n\t\t\tfunction setHourMinuteArialabel(picker) {\n                var minutes = picker.widget.find('.timepicker .minute'),\n                    hours = picker.widget.find('.timepicker .hour');\n\n                $(minutes).each(function(index, minute) {\n                    $(minute).attr({\n                        tabindex: '0',\n                        role: 'button',\n                        'aria-label': i18n.getMessage('{0} minutes').withValues([$(minute).text()])\n                    });\n                });\n\n                $(hours).each(function(index, hour) {\n                    var hourValue = parseInt($(hour).text());\n                    var ariaLabel = i18n.getMessage('{0}{1}{2} hours').withValues([(picker.use24hours && hourValue < 10 ? '0 ' : ''), hourValue, (picker.use24hours ? ' hundred' : '')]);\n                    $(hour).attr({\n                        tabindex: '0',\n                        role: 'button',\n                        'aria-label': ariaLabel\n                    });\n                });\n\n                var hourPicker = picker.widget.find('.timepicker [data-action=\"showHours\"]'),\n                    minutePicker = picker.widget.find('.timepicker [data-action=\"showMinutes\"]');\n                hourPicker.attr({\n                    tabindex: '0',\n                    role: 'button',\n                    'aria-label': i18n.getMessage('hour picker')\n                });\n                minutePicker.attr({\n                    tabindex: '0',\n                    role: 'button',\n                    'aria-label': i18n.getMessage('minute picker')\n                });\n            }\n\t\t\t\n\t\t\tfunction setDayMonthYearArrowElementsArialabel(picker) {\n                setDayMonthYearArrowElementArialabel(picker, 'days', translations['month']);\n                setDayMonthYearArrowElementArialabel(picker, 'months', translations['year']);\n                setDayMonthYearArrowElementArialabel(picker, 'years', translations['decade']);\n            }\n\t\t\t\n\t\t\tfunction setDayMonthYearArrowElementArialabel(picker, calendarShowType, toggleText) {\n                var pickerSwitchAriaLabel = calendarShowType == 'years' ? picker.widget.find('.datepicker-years .picker-switch').html() : picker.widget.find('.datepicker-' + calendarShowType + ' .picker-switch').html() + '. ' + translations['Toggle'] + ' ' + toggleText;\n                picker.widget.find('.datepicker-' + calendarShowType + ' .prev').attr({\n                    'role': 'button',\n                    'tabindex': '0',\n                    'title': translations['Previous'] + ' ' + toggleText,\n                    'data-toggle': 'tooltip',\n                    'data-placement': 'top',\n                    'data-container': 'body'\n                });\n                picker.widget.find('.datepicker-' + calendarShowType + ' .next').attr({\n                    'role': 'button',\n                    'tabindex': '0',\n                    'title': translations['Next'] + ' ' + toggleText,\n                    'data-toggle': 'tooltip',\n                    'data-placement': 'top',\n                    'data-container': 'body'\n                });\n                picker.widget.find('.datepicker-' + calendarShowType + ' .picker-switch').attr({\n                    'role': 'button',\n                    'tabindex': '0',\n                    'aria-label': pickerSwitchAriaLabel\n                });\n            }\n\t\t\t\n\t\t\tfunction setTimeArrowElementsArialabel(picker) {\n                setTimeArrowElementArialabel(picker, 'increment Minutes');\n                setTimeArrowElementArialabel(picker, 'decrement Minutes');\n                setTimeArrowElementArialabel(picker, 'increment Hours');\n                setTimeArrowElementArialabel(picker, 'decrement Hours');\n            }\n\t\t\t\n\t\t\tfunction setTimeArrowElementArialabel(picker, action) {\n                var arrowElement = picker.widget.find('.timepicker [data-action=' + action.replace(/\\s/g, '') + ']');\n                if (arrowElement.length > 0) {\n                    setArialabel(arrowElement[0], action)\n                }\n            }\n\t\t\t\n\t\t\tfunction onDpAction(e) {\n                setShowDatePickerFocus(e.picker, e.date, e.action)\n            }\n\t\t\t\n\t\t\tfunction onDpToggle(picker, e, openMessage) {\n                var toggleElement = setToggleElementArialabel(picker);\n\n                if (openMessage) {\n                    setArialabel(toggleElement, openMessage + \" \" + toggleElement.getAttribute('aria-label'));\n                }\n                toggleElement.blur();\n                setTimeout(function() {\n                    toggleElement.focus();\n                }, 150);\n            }\n\n\t\t\tfunction setArialabel(element, label) {\n                if (element) {\n                    element.setAttribute('aria-label', label);\n                }\n            }\n\t\t\t\n\t\t\tfunction attachOnscrollEvent() {\n\t\t\t\tvar lazyPlace = _.debounce(onscrollEvt, 100);\n\n\t\t\t\tvar scrollContainer = $('.sp-scroll');\n\t\t\t\tif(scrollContainer) {\n\t\t\t\t\t$(scrollContainer[0]).scroll(lazyPlace.bind(null, scrollContainer[0]));\n\t\t\t\t}\n\n\t\t\t\tvar containers = $('.sp-row-content > div .panel .panel-body');\n\t\t\t\tif(containers) {\n\t\t\t\t\tfor (var i = 0; i < containers.length; i++) {\n\t\t\t\t\t\t$(containers[i]).scroll(lazyPlace.bind(null, containers[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfunction onscrollEvt(container) {\n\t\t\t\tvar picker = dp.data('DateTimePicker');\n\t\t\t\tif(isElementInViewport(picker.element, container)) {\n\t\t\t\t\tpicker.place(container);\n\t\t\t\t} else {\n\t\t\t\t\tpicker.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfunction isElementInViewport(el, scrollContainer) {\n\t\t\t\t\tif (typeof jQuery === \"function\" && el instanceof jQuery) {\n\t\t\t\t\t\t\tel = el[0];\n\t\t\t\t\t}\n\n\t\t\t\t\tvar rect = el.getBoundingClientRect(),\n\t\t\t\t\t\t\tscrollContainerRect = scrollContainer.getBoundingClientRect();\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t\trect.top >= scrollContainerRect.top &&\n\t\t\t\t\t\t\trect.left >= scrollContainerRect.left &&\n\t\t\t\t\t\t\trect.bottom <= scrollContainerRect.bottom && /*or $(window).height() */\n\t\t\t\t\t\t\trect.right <= scrollContainerRect.right /*or $(window).width() */\n\t\t\t\t\t);\n\t\t\t}\n\t\t\t\n\t\t\tfunction detachOnscrollEvent () {\n\t\t\t\tvar scrollContainer = $('.sp-scroll');\n\t\t\t\tif(scrollContainer) {\n\t\t\t\t\t$(scrollContainer[0]).off( \"scroll\" )\n\t\t\t\t}\n\n\t\t\t\tvar containers = $('.sp-row-content > div .panel .panel-body');\n\t\t\t\tif(containers) {\n\t\t\t\t\tfor (var i = 0; i < containers.length; i++) {\n\t\t\t\t\t\t$(containers[i]).off( \"scroll\" )\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfunction getDatePickerInput (picker){\n\t\t\t\tvar input;\n\t\t\t\tif (picker.isInput) {\n\t\t\t\t\treturn picker.element;\n\t\t\t\t}\n\t\t\t\tinput = picker.element.find('.datepickerinput');\n\t\t\t\tif (input.size() === 0) {\n\t\t\t\t\tinput = picker.element.find('input');\n\t\t\t\t}\n\t\t\t\telse if (!input.is('input')) {\n\t\t\t\t\tthrow new Error('CSS class \"datepickerinput\" cannot be applied to non input element');\n\t\t\t\t}\n\t\t\t\treturn input.parent().prev();\n\t\t\t}\n\t\t\t\n\t\t\t$timeout(function(){\n\t\t\t\telement.find(\".autofocus-class\").attr(\"aria-label\", scope.c.getAriaLabel(scope.field));\n\t\t\t});\n\t\t\t\n            scope.$on('$destroy', function() {\n                dp.off('dp.change', onDpChange);\n                unBindTouchClose();\n\t\t\t\tdetachKeyboardEvent(dp.data('DateTimePicker'));\n\t\t\t\tif (scope.picker)\n\t\t\t\t\tscope.picker.hide();\n            });\n\n        }\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"0a386936c3331200e44574e1c1d3ae2b","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_0a386936c3331200e44574e1c1d3ae2b","sys_updated_by":"admin","sys_created_on":"2016-06-07 20:14:29","name":"spSurveyDatePicker","sys_name":"spSurveyDatePicker","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2017-01-04 00:23:13","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"0eee3fda5b0032003d1c484c11f91a73","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_0eee3fda5b0032003d1c484c11f91a73","sys_updated_by":"admin","sys_created_on":"2017-01-04 00:23:13","name":"bmKpiScoreDifference","sys_name":"bmKpiScoreDifference","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"12","sys_updated_on":"2021-08-23 11:22:24","sys_tags":"","type":"service","script":"function() {\n\tvar listeners = [];\n\tvar defaultListener;\n\tvar categoryId;\n\tvar categoryPicked = false;\n\n\tfunction setCategoryId(catId) {\n\t\tcategoryId = catId;\n\t\tif (listeners.length > 0) {\n\t\t\tlisteners.forEach(function(fn){ fn.call(null, catId); });\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// Call the default listener if no other listeners were set\n\t\tif (defaultListener)\n\t\t\tdefaultListener.call(null, catId);\n\t}\n\t\n\tfunction addListener(callbackFn) {\n\t\tlisteners.push(callbackFn);\n\t\t\n\t\treturn function removeListener() {\n\t\t\tvar l = listeners.indexOf(callbackFn);\n\t\t\tif (l > -1)\n\t\t\t\tlisteners.splice(l, 1);\n\t\t};\n\t}\n\t\n\tfunction addDefaultListener(callbackFn) {\n\t\tdefaultListener = callbackFn;\n\t}\n\t\n\tfunction getCategoryId() {\n\t\treturn categoryId;\n\t}\n\n\tfunction setCategorySelected(val) {\n\t\tcategoryPicked = val;\n\t}\n\n\tfunction isCategorySelected() {\n\t\treturn categoryPicked;\n\t}\n\n\treturn {\n\t\tsetCategoryId: setCategoryId,\n\t\taddListener: addListener,\n\t\taddDefaultListener: addDefaultListener,\n\t\tgetCategoryId: getCategoryId,\n\t\tisCategorySelected: isCategorySelected,\n\t\tsetCategorySelected: setCategorySelected\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"10eb7596c7033200b0b0409b9b97631c","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/fdc9ebbb04f12210559073c06a02f7e2","value":"fdc9ebbb04f12210559073c06a02f7e2"},"sys_update_name":"sp_angular_provider_10eb7596c7033200b0b0409b9b97631c","sys_updated_by":"admin","sys_created_on":"2017-06-01 20:28:00","name":"spKBCategoryService","sys_name":"spKBCategoryService","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2019-02-05 06:02:07","sys_tags":"","type":"directive","script":"function($timeout, $http, urlTools, filterExpressionParser, $sanitize, i18n, spIs) {\n\t\"use strict\";\n\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\tscope: {\n\t\t\ted: \"=?\",\n\t\t\tfield: \"=\",\n\t\t\trefTable: \"=?\", // comes from this table\n\t\t\trefId: \"=?\", // and this sys_id\n\t\t\tsnOptions: \"=?\",\n\t\t\tsnOnBlur: \"&\",\n\t\t\tsnOnClose: \"&\",\n\t\t\tminimumInputLength : \"@\",\n\t\t\tsnDisabled: \"=\",\n\t\t\tdropdownCssClass: \"@\",\n\t\t\tformatResultCssClass: \"&\",\n\t\t\tdisplayColumn: \"@\",\n\t\t\trecordValues: '&',\n\t\t\tgetGlideForm: '&glideForm',\n\t\t\tdomain: \"@\",\n\t\t\tsnSelectWidth: '@', // Width of the selector. Default to 100%.\n\t\t},\n\t\ttemplate: '<input type=\"text\" name=\"{{field.name}}\" ng-disabled=\"snDisabled\" style=\"min-width: 150px;\" />',\n\t\tlink: function(scope, element, attrs, ctrl) {\n\t\t\tscope.ed = scope.ed || scope.field.ed;\n\t\t\tscope.selectWidth = scope.snSelectWidth || '100%';\n\t\t\telement.css(\"opacity\", 0);\n\t\t\tvar fireReadyEvent = true;\n\t\t\tvar g_form;\n\t\t\tvar displayColumns;\n\t\t\tvar field = scope.field;\n\t\t\tvar isMultiple = scope.snOptions && scope.snOptions.multiple === true;\n\t\t\tif (angular.isDefined(scope.getGlideForm))\n\t\t\t\tg_form = scope.getGlideForm();\n\n\t\t\tvar fieldAttributes = {};\n\t\t\tif (angular.isDefined(scope.field) && angular.isDefined(scope.field.attributes) && typeof scope.ed.attributes == 'undefined')\n\t\t\t\tif (Array.isArray(scope.field.attributes))\n\t\t\t\t\tfieldAttributes = scope.field.attributes;\n\t\t\t\telse\n\t\t\t\t\tfieldAttributes = parseAttributes(scope.field.attributes);\n\t\t\telse\n\t\t\t\tfieldAttributes = parseAttributes(scope.ed.attributes);\n\n\t\t\tif (angular.isDefined(fieldAttributes['ref_ac_columns']))\n\t\t\t\tdisplayColumns = fieldAttributes['ref_ac_columns'];\n\n\t\t\tvar s2Helpers = {\n\t\t\t\tformatSelection: function(item) {\n\t\t\t\t\treturn $sanitize(getDisplayValue(item));\n\t\t\t\t},\n\t\t\t\tformatResult: function(item) {\n\t\t\t\t\tvar displayValues = getDisplayValues(item);\n\t\t\t\t\tif (displayValues.length == 1)\n\t\t\t\t\t\treturn $sanitize(displayValues[0]);\n\t\t\t\t\tif (displayValues.length > 1) {\n\t\t\t\t\t\tvar width = 100 / displayValues.length;\n\t\t\t\t\t\tvar markup = \"\";\n\t\t\t\t\t\tfor (var i = 0; i < displayValues.length; i++)\n\t\t\t\t\t\t\tmarkup += \"<div style='width: \" + width + \"%;' class='select2-result-cell'>\" + $sanitize(displayValues[i])  + \"</div>\";\n\t\t\t\t\t\treturn markup;\n\t\t\t\t\t}\n\t\t\t\t\treturn \"\";\n\t\t\t\t},\n\n\t\t\t\tsearch: function(queryParams) {\n\t\t\t\t\tvar url = urlTools.getURL('sp_ref_list_data');\n\t\t\t\t\treturn $http.post(url, queryParams.data).then(queryParams.success);\n\t\t\t\t},\n\n\t\t\t\tinitSelection: function(elem, callback) {\n\t\t\t\t\tif (scope.field.displayValue) {\n\t\t\t\t\t\tif (isMultiple) {\n\t\t\t\t\t\t\tvar items = [];\n\t\t\t\t\t\t\tvar values = scope.field.value.split(',');\n\t\t\t\t\t\t\tvar displayValues = scope.field.displayValue.split(',');\n\t\t\t\t\t\t\tfor(var i=0; i<values.length; i++){\n\t\t\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\t\tsys_id: values[i],\n\t\t\t\t\t\t\t\t\tname: displayValues[i]\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcallback(items);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcallback({\n\t\t\t\t\t\t\t\tsys_id: scope.field.value,\n\t\t\t\t\t\t\t\tname: scope.field.displayValue\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else\n\t\t\t\t\t\tcallback([]);\n\t\t\t\t},\n\t\t\t\tonSelecting: function(e) {\n\t\t\t\t\tvar selectedItem = e.choice;\n\t\t\t\t\tif ('sys_id' in selectedItem) {\n\t\t\t\t\t\tvar values = field.value == '' ? [] : field.value.split(',');\n\t\t\t\t\t\tvar displayValues = field.displayValue == '' ? [] : field.displayValue.split(',');\n\n\t\t\t\t\t\tvalues.push(selectedItem.sys_id);\n\t\t\t\t\t\tdisplayValues.push(getDisplayValue(selectedItem));\n\t\t\t\t\t\t//g_form.setValue(field.name, values.join(','), displayValues.join(','));\n\t\t\t\t\t\tscope.field.displayValue = displayValues.join(',');\n\t\t\t\t\t\tscope.field.value = values.join(',');\n\t\t\t\t\t\tscope.$apply();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\telement.select2('val', values).select2('close');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonRemoving: function(e) {\n\t\t\t\t\tvar removed = e.choice;\n\t\t\t\t\tvar values = field.value.split(',');\n\t\t\t\t\tvar displayValues = field.displayValue.split(',');\n\t\t\t\t\tfor(var i = values.length-1; i>=0; i--){\n\t\t\t\t\t\tif (removed.sys_id == values[i]) {\n\t\t\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\t\t\t\tdisplayValues.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//g_form.setValue(field.name, values.join(','), displayValues.join(','));\n\t\t\t\t\tscope.field.displayValue = displayValues.join(',');\n\t\t\t\t\tscope.field.value = values.join(',');\n\t\t\t\t\tscope.$apply();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\telement.select2('val', values);\n\t\t\t\t},\n\t\t\t\tselect2Change: function(e) {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tif (e.added) {\n\t\t\t\t\t\tvar selectedItem = e.added;\n\t\t\t\t\t\tvar value = selectedItem.sys_id;\n\t\t\t\t\t\tvar displayValue = value ? getDisplayValue(selectedItem) : '';\n\t\t\t\t\t\t//g_form.setValue(scope.field.name, value, displayValue);\n\t\t\t\t\t\tscope.field.displayValue = displayValue;\n\t\t\t\t\t\tscope.field.value = value;\n\t\t\t\t\t\tscope.$apply();\n\t\t\t\t\t} else if (e.removed) {\n\t\t\t\t\t\t//g_form.clearValue(scope.field.name);\n\t\t\t\t\t\tscope.field.value = '';\n\t\t\t\t\t\tscope.field.displayValue = '';\n\t\t\t\t\t\tscope.$apply();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar config = {\n\t\t\t\twidth : scope.selectWidth,\n\t\t\t\tminimumInputLength: scope.minimumInputLength ? parseInt(scope.minimumInputLength, 10) : 0,\n\t\t\t\tcontainerCssClass : 'select2-reference ng-form-element',\n\t\t\t\tplaceholder : '   ',\n\t\t\t\tformatSearching: '',\n\t\t\t\tallowClear: attrs.allowClear !== 'false',\n\t\t\t\tid: function(item) {\n\t\t\t\t\treturn item.sys_id;\n\t\t\t\t},\n\t\t\t\tsortResults: (scope.snOptions && scope.snOptions.sortResults) ? scope.snOptions.sortResults : undefined,\n\t\t\t\tajax: {\n\t\t\t\t\tquietMillis: NOW.ac_wait_time,\n\n\t\t\t\t\tdata: function(filterText, page) {\n\t\t\t\t\t\tvar filterExpression = filterExpressionParser.parse(filterText, scope.ed.defaultOperator);\n\t\t\t\t\t\tvar colToSearch = getReferenceColumnToSearch();\n\t\t\t\t\t\tvar refCondition = scope.ed.refCondition;\n\t\t\t\t\t\tvar q = colToSearch + filterExpression.operator + filterExpression.filterText +\n\t\t\t\t\t\t\t'^' + colToSearch + 'ISNOTEMPTY' + getExcludedValues();\n\t\t\t\t\t\tif (refCondition)\n\t\t\t\t\t\t\tq += \"^\" + refCondition;\n\t\t\t\t\t\tif (!q.endsWith(\"^EQ\"))\n\t\t\t\t\t\t\tq += \"^EQ\";\n\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\tstart: (scope.pageSize * (page - 1)),\n\t\t\t\t\t\t\tcount: scope.pageSize,\n\t\t\t\t\t\t\tsysparm_target_table: scope.refTable,\n\t\t\t\t\t\t\tsysparm_target_sys_id: scope.refId,\n\t\t\t\t\t\t\tsysparm_target_field: scope.ed.name,\n\t\t\t\t\t\t\ttable: scope.ed.reference,\n\t\t\t\t\t\t\tqualifier: scope.ed.qualifier,\n\t\t\t\t\t\t\tdata_adapter: scope.ed.data_adapter,\n\t\t\t\t\t\t\tattributes: scope.ed.attributes,\n\t\t\t\t\t\t\tdependent_field: scope.ed.dependent_field,\n\t\t\t\t\t\t\tdependent_table: scope.ed.dependent_table,\n\t\t\t\t\t\t\tdependent_value: scope.ed.dependent_value,\n\t\t\t\t\t\t\tp: scope.ed.reference + ';q:' + q + ';r:' + scope.ed.qualifier\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (scope.domain) {\n\t\t\t\t\t\t\tparams.sysparm_domain = scope.domain;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (angular.isDefined(scope.field) && scope.field['_cat_variable'] === true){\n\t\t\t\t\t\t\t/*delete params['sysparm_target_table'];\n\t\t\t\t\t\t\tparams['sysparm_include_variables'] = true;\n\t\t\t\t\t\t\tparams['variable_ids'] = scope.field.sys_id;\n\t\t\t\t\t\t\tvar getFieldSequence = g_form.$private.options('getFieldSequence');\n\t\t\t\t\t\t\tif (getFieldSequence) {\n\t\t\t\t\t\t\t\tparams['variable_sequence1'] = getFieldSequence();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar itemSysId = g_form.$private.options('itemSysId');\n\t\t\t\t\t\t\tparams['sysparm_id'] = itemSysId;\n\t\t\t\t\t\t\tvar getFieldParams = g_form.$private.options('getFieldParams');\n\t\t\t\t\t\t\tif (getFieldParams) {\n\t\t\t\t\t\t\t\tangular.extend(params, getFieldParams());\n\t\t\t\t\t\t\t}*/\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (scope.recordValues)\n\t\t\t\t\t\t\tparams.sysparm_record_values = scope.recordValues();\n\n\t\t\t\t\t\treturn params;\n\t\t\t\t\t},\n\n\t\t\t\t\tresults: function(data, page) {\n\t\t\t\t\t\treturn ctrl.filterResults(data, page, scope.pageSize);\n\t\t\t\t\t},\n\n\t\t\t\t\ttransport: s2Helpers.search\n\t\t\t\t},\n\t\t\t\tformatSelection: s2Helpers.formatSelection,\n\t\t\t\tformatResult: s2Helpers.formatResult,\n\t\t\t\tinitSelection: s2Helpers.initSelection,\n\t\t\t\tdropdownCssClass: attrs.dropdownCssClass,\n\t\t\t\tformatResultCssClass: scope.formatResultCssClass || null,\n\t\t\t\tmultiple: isMultiple\n\t\t\t};\n\n\t\t\tif (isMultiple && scope.ed.reference == \"sys_user\") {\n\t\t\t\tconfig.createSearchChoice = function (term) {\n\t\t\t\t\tif (spIs.an.email(term)) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\temail: term,\n\t\t\t\t\t\t\tname: term,\n\t\t\t\t\t\t\tuser_name: term,\n\t\t\t\t\t\t\tsys_id: term\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (scope.snOptions) {\n\t\t\t\tif (scope.snOptions.placeholder) {\n\t\t\t\t\tconfig.placeholder = scope.snOptions.placeholder;\n\t\t\t\t}\n\t\t\t\tif (scope.snOptions.width) {\n\t\t\t\t\tconfig.width = scope.snOptions.width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction getReferenceColumnToSearch() {\n\t\t\t\tvar colName = 'name';\n\t\t\t\tif (fieldAttributes['ref_ac_columns_search'] == 'true' && 'ref_ac_columns' in fieldAttributes && fieldAttributes['ref_ac_columns'] != '') {\n\t\t\t\t\tvar refAcColumns = fieldAttributes['ref_ac_columns'].split(';');\n\t\t\t\t\tcolName = refAcColumns[0];\n\t\t\t\t} else if (scope.ed.searchField)\n\t\t\t\t\tcolName = scope.ed.searchField;\n\t\t\t\telse if (fieldAttributes['ref_ac_order_by'])\n\t\t\t\t\tcolName = fieldAttributes['ref_ac_order_by'];\n\n\t\t\t\treturn colName;\n\t\t\t}\n\n\t\t\tfunction getExcludedValues () {\n\t\t\t\tif (scope.ed.excludeValues && scope.ed.excludeValues != '') {\n\t\t\t\t\t//nameISNOTEMPTY^sys_idIN681b365ec0a80164000fb0b05854a0cd,5137153cc611227c000bbd1bd8cd2005\n\t\t\t\t\treturn '^sys_idNOT IN' + scope.ed.excludeValues;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tfunction parseAttributes(strAttributes) {\n\t\t\t\t// Turn an attribute string into a simple object\n\t\t\t\t// \"ref_auto_completer=AJAXTableCompleter,ref_contributions=task_show_ci_map;show_related_records,ref_ac_columns=sys_class_name,ref_ac_order_by=sys_class_name\"\n\t\t\t\t// into: {ref_auto_completer: AJAXTableCompleter, ref_contributions: 'task_show_ci_map;show_related_records' ... }\n\n\t\t\t\tvar attributeArray = (strAttributes && strAttributes.length ? strAttributes.split(',') : []);\n\t\t\t\tvar attributeObj = {};\n\t\t\t\tfor (var i = 0; i < attributeArray.length; i++) {\n\t\t\t\t\tif (attributeArray[i].length > 0) {\n\t\t\t\t\t\tvar attribute = attributeArray[i].split('=');\n\t\t\t\t\t\tattributeObj[attribute[0]] = attribute.length > 1 ? attribute[1] : '';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn attributeObj;\n\t\t\t}\n\n\t\t\tfunction init() {\n\t\t\t\t$timeout(function() {\n\t\t\t\t\ti18n.getMessage('Searching...', function(searchingMsg) {\n\t\t\t\t\t\tconfig.formatSearching = function() {\n\t\t\t\t\t\t\treturn searchingMsg;\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\telement.css(\"opacity\", 1);\n\t\t\t\t\telement.select2(\"destroy\");\n\t\t\t\t\tvar select2 = element.select2(config);\n\t\t\t\t\telement.select2(\"val\", scope.field.value.split(','));\n\t\t\t\t\tif (isMultiple){\n\t\t\t\t\t\telement.bind(\"select2-selecting\", s2Helpers.onSelecting);\n\t\t\t\t\t\telement.bind(\"select2-removing\", s2Helpers.onRemoving);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.bind(\"change select2-removed\", s2Helpers.select2Change);\n\t\t\t\t\t}\n\t\t\t\t\telement.bind(\"select2-blur\", function() {\n\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\tscope.snOnBlur();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tif (fireReadyEvent) {\n\t\t\t\t\t\tscope.$emit('select2.ready', element);\n\t\t\t\t\t\tfireReadyEvent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\n\n\t\t\tfunction getDisplayValue(selectedItem) {\n\t\t\t\tvar displayValue = '';\n\t\t\t\tif (selectedItem && selectedItem.sys_id) {\n\t\t\t\t\tif (scope.displayColumn && typeof selectedItem[scope.displayColumn] != \"undefined\")\n\t\t\t\t\t\tdisplayValue = selectedItem[scope.displayColumn];\n\t\t\t\t\telse if (selectedItem.$$displayValue)\n\t\t\t\t\t\tdisplayValue = selectedItem.$$displayValue;\n\t\t\t\t\telse if (selectedItem.name)\n\t\t\t\t\t\tdisplayValue = selectedItem.name;\n\t\t\t\t\telse if (selectedItem.title)\n\t\t\t\t\t\tdisplayValue = selectedItem.title;\n\t\t\t\t}\n\t\t\t\treturn displayValue;\n\t\t\t}\n\n\t\t\tfunction getDisplayValues(selectedItem) {\n\t\t\t\tvar displayValues = [];\n\t\t\t\tif (selectedItem && selectedItem.sys_id) {\n\t\t\t\t\tdisplayValues.push(getDisplayValue(selectedItem));\n\t\t\t\t}\n\n\t\t\t\tif (displayColumns) {\n\t\t\t\t\tvar columns = displayColumns.split(\";\");\n\t\t\t\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\t\t\t\tvar column = columns[i];\n\t\t\t\t\t\tif (selectedItem[column])\n\t\t\t\t\t\t\tdisplayValues.push(selectedItem[column]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn displayValues;\n\t\t\t}\n\n\t\t\t/*g_form.$private.events.on(\"change\", function(fieldName, oldValue, value) {\n\t\t\t\tif (fieldName == field.name) {\n\t\t\t\t\telement.select2(\"val\", typeof value == 'string' ? value.split(',') : value);\n\t\t\t\t}\n\t\t\t});*/\n\n\t\t\tscope.$on(\"snReferencePicker.activate\", function(evt, parms) {\n\t\t\t\t$timeout(function() {\n\t\t\t\t\telement.select2(\"open\");\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tinit();\n\t\t},\n\n\t\tcontroller: function($scope, $rootScope) {\n\t\t\t$scope.pageSize = 20;\n\n\t\t\t// Default Results Filter (aka, None)\n\t\t\tthis.filterResults = function(data, page) {\n\t\t\t\treturn {\n\t\t\t\t\tresults: data.data.items,\n\t\t\t\t\tmore: (page * $scope.pageSize < data.data.total)\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"1408dd77531323002d96ddeeff7b1271","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_1408dd77531323002d96ddeeff7b1271","sys_updated_by":"admin","sys_created_on":"2019-02-05 06:02:07","name":"mespSurveyReferenceElement","sys_name":"mespSurveyReferenceElement","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"54","sys_updated_on":"2021-04-27 11:38:51","sys_tags":"","type":"directive","script":"function($timeout, $rootScope) {\n\treturn {\n\t\ttemplate: '<div>' +\n\t\t\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<fieldset>' +\n\t\t\t\t\t\t'<legend class=\"sr-only\">' +\n\t\t\t\t\t\t\t'<span ng-if=\"field.mandatory && !field.value\">${Required} - </span>' +\n\t\t\t\t\t\t\t'<span ng-if=\"field.mandatory && field.value\">${Required filled} - </span>' +\n\t\t\t\t\t\t\t'<span>{{c.getAriaLabel(field)}}</span>' +\n\t\t\t\t\t\t\t'<span ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</span>' +\n\t\t\t\t\t\t'</legend>' +\n\t\t\t\t\t'<div ng-if=\"!isMobile\" ng-class=\"{scale_center: data.isKioskSurvey}\" role=\"radiogroup\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"c in field.choices track by $index\">' +\n\t\t\t\t\t\t\t'<label class=\"sps-scale-radio-label\">'+\n\t\t\t\t\t\t\t\t'<input ng-class=\"{\\'has-error\\':!field.isMandatoryFilled,\\'autofocus-error\\':!field.isMandatoryFilled}\" aria-describedby=\"details_{{field.sys_id}}\" class=\"autofocus-class\" type=\"radio\" name=\"{{field.name}}\" elem-id=\"{{::c.sys_id}}\" value=\"{{c.value}}\" aria-checked=\"{{field.value == c.value}}\" ng-model=\"field.value\" ng-checked=\"field.value == c.value\" ng-disabled=\"c.isDisabled || field.isReadonly()\" style=\"margin-right: 1rem;\" ng-change=\"c.isDisabled || selectChoice(c)\" />' +'{{c.label}}'+\n\t\t\t\t\t\t\t'</label>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<sp-survey-end-notes data=\"data\">' +\n\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t'<div ng-if=\"isMobile\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"c in field.choices track by $index\" class=\"wrapper-xs\">' +\n\t\t\t\t\t\t\t'<button aria-describedby=\"details_{{field.sys_id}}\" class=\"btn btn-block autofocus-class\" elem-id=\"{{mobilePrefix}}{{::c.sys_id}}\" ng-click=\"field.value = c.value\" aria-pressed=\"{{c.value == field.value}}\" ng-class=\"field.value == c.value ? \\'btn-primary\\' : \\'btn-default\\'\">{{c.label}}</button>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info && field.type != \\'template\\'\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t\t\t'</fieldset>' +\n\t\t\t\t'</div>',\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\trequire: '?ngModel',\n\t\tscope: {\n\t\t\t'field': '=',\n\t\t\t'mobilePrefix': '=',\n\t\t\t'data': '=',\n\t\t\t'c': '=',\n\t\t\t'isMobile': '='\n\t\t},\n\t\tcontroller: function($scope) {\n\t\t\t$scope.selectChoice = function(choice) {\n\t\t\t\tif ($scope.data.isKioskSurvey) {\n\t\t\t\t\tfor (var i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice1 = $scope.field.choices[i];\n\t\t\t\t\t    choice1.isDisabled = true;\n\t\t\t\t}\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t}\n\t\t\t\t// Update isMandatoryFilled\n\t\t\t   $scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\t\t\t}\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"14f9e936c3331200e44574e1c1d3aec9","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_14f9e936c3331200e44574e1c1d3aec9","sys_updated_by":"admin","sys_created_on":"2016-06-07 20:22:00","name":"spSurveyScale","sys_name":"spSurveyScale","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"34","sys_updated_on":"2023-05-10 10:12:44","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"1b263f7b5b5032003d1c484c11f91a74","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_1b263f7b5b5032003d1c484c11f91a74","sys_updated_by":"admin","sys_created_on":"2017-01-21 01:51:42","name":"bmKpiDetails","sys_name":"bmKpiDetails","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"45","sys_updated_on":"2016-06-08 14:19:19","sys_tags":"","type":"directive","script":"function($location, $timeout) {\n\n\tfunction getHost() {\n\t\tvar host = $location.protocol() + '://' + $location.host();\n\t\tif ($location.port()) {\n\t\t\thost += ':' + $location.port();\n\t\t}\n\t\treturn host;\n\t}\n\t\n\tfunction getUrl(sysId) {\n\t\treturn\tgetHost() + \"/$sp.do?id=sp-preview&sys_id=\" + sysId;\n\t}\n\n\treturn {\n\t\trestrict: 'E',\n\t\tscope: {\n\t\t\toptions: '='\n\t\t},\n\t\treplace: true,\n\t\ttemplate: '<iframe class=\"iframe-preview\" src=\"{{url}}\"></iframe>',\n\t\tlink: function($scope, element) {\t\t\t\n\t\t\t\t\t\t\n\t\t\t$scope.url = getUrl($scope.options);\t\t\t\n\t\t\t$scope.$on('$sp.preview', function(e, action) {\n\t\t\t\tif (action === 'reload') {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t$(element).attr('src', getUrl($scope.options));\n\t\t\t\t}\t\t\t\t\n\t\t\t})\t\t\t\n\t\t}\n\t}\n\n\n}","sys_class_name":"sp_angular_provider","sys_id":"1b3599b25b3312000d7ec7ad31f91add","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"sys_update_name":"sp_angular_provider_1b3599b25b3312000d7ec7ad31f91add","sys_updated_by":"admin","sys_created_on":"2016-06-07 18:51:46","name":"spPreview","sys_name":"spPreview","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"1","sys_updated_on":"2021-04-15 13:48:01","sys_tags":"","type":"directive","script":"//usage : <XYZ sp-ellipsis-tooltip sp-ellipsis-tooltip-title=\"\" sp-ellipsis-tooltip-data-toggle=\"\" sp-ellipsis-tooltip-data-placement=\"\" sp-ellipsis-tooltip-data-container=\"\" />\n//Default : sp-ellipsis-tooltip-title -> '' sp-ellipsis-tooltip-data-toggle -> 'tooltip' sp-ellipsis-tooltip-data-placement -> 'auto' sp-ellipsis-tooltip-data-container -> 'body' \nfunction spEllipsisTooltip(i18n, $rootScope) {\n\t\"use strict\";\n\treturn {\n\t\trestrict: 'A',\n\t\tlink: function(scope, elem, attrs) {\n\t\t\tangular.element(document).ready(function() {\n\t\t\t\tsetTimeout(function() {\n                   showTooltip(elem, attrs);\n                }, 100);\n\t\t\t});\n\n\t\t\tfunction showTooltip (element, attrs) {\n\t\t\t\tif (element && element.length > 0) {\n\t\t\t\t\tif (isEllipsisActive(element.get(0)))\n\t\t\t\t\t\tvar title = attrs.spEllipsisTooltipTitle ? attrs.spEllipsisTooltipTitle : '';\n\t\t\t\t\t\tvar dataToggle = attrs.spEllipsisTooltipDataToggle ? attrs.spEllipsisTooltipDataToggle : 'tooltip';\n\t\t\t\t\t\tvar dataPlacement = attrs.spEllipsisTooltipDataPlacement ? attrs.spEllipsisTooltipDataPlacement : 'auto';\n\t\t\t\t\t\tvar dataContainer = attrs.spEllipsisTooltipDataContainer ? attrs.spEllipsisTooltipDataContainer : 'body';\n\n\t\t\t\t\t\telement.attr('title', title);\n\t\t\t\t\t\telement.attr('data-toggle', dataToggle);\n\t\t\t\t\t\telement.attr('data-placement', dataPlacement);\n\t\t\t\t\t\telement.attr('data-container', dataContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\tfunction isEllipsisActive (element) {\n\t\t\t\treturn element.clientWidth < element.scrollWidth;\n\t\t\t}\n\t\t}\n\t};\n}\n","sys_class_name":"sp_angular_provider","sys_id":"1d2b40e07323201081d3738234f6a714","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/d1c9ebbb04f12210559073c06a02f719","value":"d1c9ebbb04f12210559073c06a02f719"},"sys_update_name":"sp_angular_provider_1d2b40e07323201081d3738234f6a714","sys_updated_by":"admin","sys_created_on":"2021-04-12 17:07:24","name":"spEllipsisTooltip","sys_name":"spEllipsisTooltip","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"10","sys_updated_on":"2019-03-31 23:46:33","sys_tags":"","type":"directive","script":"function() {\n    return {\n        template:\n            '<div class=\"hidden-xs\" style=\"display: flex;\">' +\n                '<input type=\"checkbox\" elem-id=\"{{::field.sys_id}}\" name=\"{{field.name}}\" aria-labelledby=\"{{::field.sys_id}}_label\" aria-checked=\"{{field.value}}\" ng-model=\"field.value\" ng-true-value=\"\\'true\\'\" ng-false-value=\"\\'false\\'\" ng-model-options=\"{getterSetter: true}\" ng-disabled=\"c.isDisabled || field.isReadonly()\" ng-click=\"c.isDisabled ||selectChoice(c)\" />' +\n                '<h4 ng-if=\"!htmlLabel\" id=\"{{::field.sys_id}}_label\" class=\"question-label\" style=\"margin: 0 0.5em 0;\">{{field.label}}</h4>' +\n                '<h4 ng-if=\"htmlLabel\" id=\"{{::field.sys_id}}_label\" class=\"question-label\" style=\"margin: 0 0.5em 0;\" ng-bind-html=\"field.label\"></h4>' +\n                '<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n          '</div>' +\n\t\t  '<div class=\"row visible-xs\">' +\n                '<div class=\"col-xs-1 question-checkbox-label\">' +\n                    '<label class=\"type-boolean-label\"><input class=\"type-boolean-input\" type=\"checkbox\" elem-id=\"{{::mobilePrefix}}{{::field.sys_id}}\" name=\"{{field.name}}\" aria-labelledby=\"{{::mobilePrefix}}{{::field.sys_id}}_label\" aria-checked=\"{{field.value}}\" ng-model=\"field.value\" ng-true-value=\"\\'true\\'\" ng-false-value=\"\\'false\\'\" ng-model-options=\"{getterSetter: true}\" ng-disabled=\"field.isReadonly()\" />' +\n\t\t\t\t\t\t'<span class=\"type-boolean-span\" style=\"margin-right: 1rem;\"/>' +\n\t\t\t\t\t'</label>' +\n                '</div>' +\n                '<div class=\"col-xs-11\" style=\"padding-top: 6px;\">' +\n                    '<div ng-if=\"!htmlLabel\" id=\"{{::mobilePrefix}}{{::field.sys_id}}_label\" class=\"question-label mesp_question_label\">{{field.label}}</div>' +\n                    '<div ng-if=\"htmlLabel\" id=\"{{::mobilePrefix}}{{::field.sys_id}}_label\" class=\"question-label mesp_question_label\" ng-bind-html=\"field.label\"></div>' +\n                    '<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n                '</div>' +\n            '</div>' +\n            '<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>',\n        scope: {\n            field: '=',\n            htmlLabel: '=',\n            mobilePrefix: '='\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"1dc75d77531323002d96ddeeff7b1246","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_1dc75d77531323002d96ddeeff7b1246","sys_updated_by":"admin","sys_created_on":"2019-02-05 06:01:04","name":"mespSurveyCheckbox","sys_name":"mespSurveyCheckbox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2019-02-05 05:56:08","sys_tags":"","type":"directive","script":"function($timeout, $rootScope) {\n\treturn {\n\t\ttemplate: '<div class=\"radio\">' +\n\t\t\t\t\t'<label ng-repeat=\"c in field.choices track by $index\">' +\n\t\t\t\t\t'<input type=\"radio\" name=\"{{field.sys_id}}\" value=\"{{c.value}}\" aria-checked=\"{{field.value == c.value}}\" ng-model=\"field.value\" ng-model-options=\"{getterSetter: true}\" ng-checked=\"field.value == c.value\" ng-disabled=\"c.isDisabled || field.isReadonly()\" ng-change=\"c.isDisabled || selectChoice(c)\"/>' +\n\t\t\t\t\t'<span class=\"sps-radio-label\" style=\"margin-right: 1rem;\">{{c.label}}</span>' +\n\t\t\t\t\t'</label>'+\n\t\t\t\t\t'<sp-survey-end-notes data=\"data\">' +\n\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t\t'</div>',\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\trequire: '?ngModel',\n\t\tscope: {\n\t\t\t'field': '=',\n\t\t\t'mobilePrefix': '=',\n\t\t\t'data': '=',\n\t\t\t'c': '='\n\t\t},\n\t\tcontroller: function($scope) {\n\t\t\t$scope.selectChoice = function(choice) {\n\t\t\t\tif ($scope.data.isKioskSurvey) {\n\t\t\t\t\tfor (var i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice1 = $scope.field.choices[i];\n\t\t\t\t\t    choice1.isDisabled = true;\n\t\t\t\t}\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"20a69577531323002d96ddeeff7b123d","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_20a69577531323002d96ddeeff7b123d","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:56:08","name":"mespSurveyNumericScale","sys_name":"mespSurveyNumericScale","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"56","sys_updated_on":"2021-04-21 11:59:17","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\ttemplate:\n\t\t\t'<div class=\"col-xs-12 col-sm-12\" style=\"padding: 10px 0 0\">' +\n\t\t\t\t'<div class=\"col-xs-12 col-sm-6\" ng-class=\"{add_info_no_padding: !hasPadding()}\">' +\n\t\t\t\t\t'<span style=\"margin-right: 10px\">' +\n\t\t\t\t\t'<button class=\"btn-link btn chevron-icon\" ng-click=\"toggleAddInfo()\" aria-expanded=\"{{showAddInfo}}\" aria-label=\"{{::field.add_info_label + \\' for \\' + field.aria_label}}\" data-toggle=\"tooltip\" data-placement=\"top\" data-original-title=\"{{chevronAction}}\">' +\n\t\t\t\t\t\t\t'<span class=\"glyphicon glyphicon-menu-down\" ng-if=\"showAddInfo\"></span>' +\n\t\t\t\t\t\t\t'<span class=\"glyphicon glyphicon-menu-right\" ng-if=\"!showAddInfo\"></span>' +\n\t\t\t\t\t\t'</button>' +\n\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t'<span  class=\"question-label h5\" style=\"display: inline-block\">' +\n\t\t\t\t\t\t\t'{{::field.add_info_label}}' +\n\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t'<textarea class=\"form-control collapse\" ng-class=\"{in: showAddInfo}\" rows=\"4\" name=\"{{::field.add_info_name}}\" class=\"form-control\" aria-label=\"{{::field.add_info_label + \\' for \\' + field.aria_label}}\" ng-model=\"field.add_info\" autocomplete=\"off\">' +\n\t\t\t\t\t'</textarea>' +\n\t\t\t\t'</div>' +\n\t\t\t'</div>',\n\n\t\tscope: {\n\t\t\t'field': '='\n\t\t},\n\n\t\tcontroller: function($scope) {\n\t\t\t$scope.showAddInfo = true;\n\t\t\t$scope.chevronAction = \"Collapse\";\n\t\t\t$scope.hasPadding = function() {\n\t\t\t\treturn $scope.field.type == \"choice\" || $scope.field.type == \"date\" || $scope.field.type == \"datetime\";\n\t\t\t};\n\t\t\t$scope.toggleAddInfo = function() {\n\t\t\t\t$scope.showAddInfo = !$scope.showAddInfo;\n\t\t\t\t$scope.chevronAction = $scope.showAddInfo ? \"Collapse\" : \"Expand\";\n\t\t\t};\n\t\t\tif (!$scope.field.add_info)\n\t\t\t\t$scope.field.add_info = \"\";\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"30790f8167233200b3d782f45685ef83","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_30790f8167233200b3d782f45685ef83","sys_updated_by":"admin","sys_created_on":"2017-06-22 23:04:55","name":"spSurveyAddInfo","sys_name":"spSurveyAddInfo","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2023-05-03 09:12:29","sys_tags":"","type":"service","script":"function ActionParameterService($rootScope) {\n    var ACTION_PARAMETER_EVENT = \"dynamicParameterForAction\";\n    return {\n        broadcast: function(actionParameter, value) {\n            var paramObj = {};\n            paramObj[actionParameter] = value;\n            $rootScope.$broadcast(ACTION_PARAMETER_EVENT, paramObj);\n        },\n\n        listen: function(fn) {\n            $rootScope.$on(ACTION_PARAMETER_EVENT, fn);\n        }\n    };\n}","sys_class_name":"sp_angular_provider","sys_id":"32d5d80377562110245242bd9e5a99b0","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_update_name":"sp_angular_provider_32d5d80377562110245242bd9e5a99b0","sys_updated_by":"admin","sys_created_on":"2023-04-23 17:44:16","name":"ActionParameterService","sys_name":"ActionParameterService","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2019-02-05 05:53:27","sys_tags":"","type":"directive","script":"function($timeout, i18n, $rootScope) {\n\treturn {\n\t\ttemplate: \n\t\t'<select name=\"{{field.name}}\" sn-select-width=\"auto\" ng-model=\"field.value\" ng-disabled=\"c.isDisabled || field.isReadonly()\" aria-label=\"{{::field.label}}\" ng-change=\"c.isDisabled || selectChoice(c)\">' +\n\t\t\t'<option ng-repeat=\"c in field.choices track by $index\" value=\"{{c.value}}\" ng-selected=\"field.value == c.value\">{{c.label + getChoicePrice(c, variable)}}</option> ' +\n\t\t'</select>',\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\trequire: '?ngModel',\n\t\tscope: {\n\t\t\t'field' : '=',\n\t\t\t'options': '=?',\n\t\t\t'data': '=',\n\t\t\t'c': '=',\n\t\t\t'isMobile': '='\n\t\t},\n\n\t\tcontroller: function ($scope) {\n\t\t\tvar chooseLabel = '-- ' + i18n.getMessage(\"Choose\") + ' --';\n\t\t\tif ($scope.field.choices.length < 1 || $scope.field.choices[0].label != chooseLabel)\n\t\t\t\t$scope.field.choices = [{label: chooseLabel, value: '', sys_id: 'NONESYSID'}].concat($scope.field.choices);\n\t\t\t\n\t\t\t$scope.selectChoice = function(choice) {\n\t\t\t\tif ($scope.data.isKioskSurvey && !$scope.isMobile) {\n\t\t\t\t\tchoice.isDisabled = true;\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\t\n\t\tlink: function (scope, element, attrs, ngModel) {\n\t\t\tvar field = scope.field;\n\t\t\tvar fieldOptions;\n\n\t\t\tscope.$watchCollection('field.optionStack', function() {\n\t\t\t\tscope.options = applyOptionStack(fieldOptions, field.optionStack);\n\t\t\t});\n\n\t\t\tsetDefaultOptions();\n\n\t\t\tif (field.choices) {\n\t\t\t\tsetChoiceOptions(field.choices);\n\t\t\t}\n\n\t\t\tfunction setDefaultOptions() {\n\t\t\t\tsetChoiceOptions([{\n\t\t\t\t\tvalue: scope.field.value,\n\t\t\t\t\tlabel: scope.field.displayValue || scope.field.placeholder\n\t\t\t\t}]);\n\t\t\t}\n\n\t\t\tfunction setChoiceOptions(options) {\n\n\t\t\t\t// force string values\n\t\t\t\tif (options) {\n\t\t\t\t\toptions.forEach(function(option) {\n\t\t\t\t\t\toption.value = String(option.value);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tfieldOptions = options;\n\t\t\t\tscope.options = applyOptionStack(options, scope.field.optionStack);\n\t\t\t}\n\n\t\t\tfunction applyOptionStack(options, optionStack) {\n\t\t\t\tif (!optionStack || optionStack.length == 0) {\n\t\t\t\t\treturn options;\n\t\t\t\t}\n\t\t\t\tvar newOptions = angular.copy(options);\n\t\t\t\tif (!newOptions) {\n\t\t\t\t\tnewOptions = [];\n\t\t\t\t}\n\t\t\t\toptionStack.forEach(function(item) {\n\t\t\t\t\tswitch (item.operation) {\n\t\t\t\t\t\tcase 'add':\n\t\t\t\t\t\t\tvar newOption = {\n\t\t\t\t\t\t\t\tlabel: item.label,\n\t\t\t\t\t\t\t\tvalue: item.value\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (typeof item.index === 'undefined') {\n\t\t\t\t\t\t\t\tnewOptions.push(newOption);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewOptions.splice(item.index, 0, newOption);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'remove':\n\n\t\t\t\t\t\t\t// normalize comparison to string values\n\t\t\t\t\t\t\tvar itemValue = String(item.value);\n\t\t\t\t\t\t\tfor (var i = 0, iM = newOptions.length; i < iM; i++) {\n\t\t\t\t\t\t\t\tvar optionValue = String(newOptions[i].value);\n\t\t\t\t\t\t\t\tif (optionValue !== itemValue) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnewOptions.splice(i, 1);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'clear':\n\t\t\t\t\t\t\tnewOptions = [];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn newOptions;\n\t\t\t}\n\n\t\t\tfunction setModelValue(){\n\t\t\t\tngModel.$setViewValue(element.val());\n\t\t\t}\n\n\t\t\tif (angular.isFunction(element.select2)) {\n\t\t\t\telement.css(\"opacity\", 0);\n\n\t\t\t\t$timeout(function() {\n\t\t\t\t\telement.css(\"opacity\", 1);\n\t\t\t\t\telement.select2({\n\t\t\t\t\t\tallowClear: false,\n\t\t\t\t\t\twidth: '100%'\n\t\t\t\t\t});\n\n\t\t\t\t\t// Set the select2 value when the viewValue changes\n\t\t\t\t\tngModel.$render = function(){\n\t\t\t\t\t\telement.select2('val', ngModel.$viewValue);\n\t\t\t\t\t\telement.val(ngModel.$viewValue);\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\telement.on('change', function() {\n\t\t\t\t\tscope.$evalAsync(setModelValue);\n\t\t\t\t});\n\n\t\t\t\t// If the choices change, set the selected value.\n\t\t\t\tscope.$watch('snChoices', function(newValue, oldValue){\n\t\t\t\t\tif (angular.isDefined(newValue) && newValue != oldValue) {\n\t\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\t\tsetModelValue();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t}\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"33f55177531323002d96ddeeff7b12af","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_33f55177531323002d96ddeeff7b12af","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:53:27","name":"mespSurveyChoiceList","sys_name":"mespSurveyChoiceList","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"38","sys_updated_on":"2019-11-10 04:40:04","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\ttemplate:\n\t\t'<div class=\"text-center end-note\" style=\"text-overflow: ellipsis;\" ng-if=\"data.successMessage && shouldShowSuccessMsg\">' +\n\t\t    '<h5 class=\"description-text\" ng-bind-html=\"data.successMessage\"></h5>' +\n         '</div>' ,\n\t\t\n\t\tscope: {\n\t\t\tdata: '='\n\t\t},\n\t\t\n\t\tcontroller: function($scope) {\n\t\t\t// DEF0073704: we only show the success message when current page is the last page.\n\t\t\t$scope.$on('update-show-msg', function(event, curState, pagesLength){\n\t\t\t\t$scope.shouldShowSuccessMsg = curState === pagesLength;\n\t\t\t});\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"3a595a0467241300a3b6c3105685efc1","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_3a595a0467241300a3b6c3105685efc1","sys_updated_by":"admin","sys_created_on":"2018-02-23 06:06:34","name":"spSurveyEndNotes","sys_name":"spSurveyEndNotes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"101","sys_updated_on":"2017-07-12 17:39:48","sys_tags":"","type":"directive","script":"function spCategoryListItem() {\n\treturn {\n\t\trestrict: 'E',\n\t\tscope: {\n\t\t\tcategory: \"=\",\n\t\t\tomitBadges: \"=\",\n\t\t\tlevel: \"=\",\n\t\t\tpage: \"=?\"\n\t\t},\n\t\treplace: true,\n\t\ttemplate:   '<div role=\"listitem\" ng-class=\"{\\'indent-category\\': indentCategory}\">' +\n\t\t\t\t\t\t'<a class=\"list-group-item text-overflow-ellipsis\" title=\"{{::category.title}}\" aria-label=\"{{::category.title}} ${Number of items in this category} {{::category.count}}\" ng-class=\"{selected: category.selected}\" href=\"?id={{page}}&sys_id={{::category.sys_id}}\">' +\n\t\t\t\t\t\t\t'<span ng-if=\"!omitBadges\" class=\"label label-as-badge label-primary\">{{::category.count}}</span>' +\n\t\t'<i tabindex=\"0\" aria-label=\"{{category.showSubcategories ? \\'${Collapse subcategories}\\' : \\'${Expand subcategories}\\'}}\" class=\"fa fa-fw text-muted\" ng-class=\"{\\'fa-folder\\': !category.showSubcategories, \\'fa-folder-open\\': category.showSubcategories}\" ng-if=\"category.isParentCategory\" ng-click=\"toggleShowSubcategories($event)\"></i>{{::category.title}}' +\n\t\t'</a>' +\n\t\t\t\t\t\t'<sp-category-list-item ng-if=\"category.showSubcategories\" ng-repeat=\"subcategory in category.subcategories\" category=\"subcategory\" omit-badges=\"omitBadges\" level=\"level + 1\"></sp-category-list-item>' +\n\t\t\t\t\t'</div>',\n\t\tcontroller: function($scope) {\n\t\t\t// We have to eventually stop indenting the categories.\n\t\t\t// So, we're choosing to indent up to 3 times. Otherwise,\n\t\t\t// there won't be enough room to show the category name.\n\t\t\t$scope.indentCategory = ($scope.level > 0 && $scope.level < 4);\n\t\t\t$scope.page = $scope.page || 'sc_category';\n\t\t\t$scope.toggleShowSubcategories = function(e) {\n\t\t\t\te.originalEvent.stopPropagation();\n\t\t\t\te.originalEvent.preventDefault();\n\t\t\t\t$scope.$emit(\"$sp.sc_category.retrieve_subcategories\", $scope.category);\n\t\t\t\t$scope.category.showSubcategories = !$scope.category.showSubcategories;\n\t\t\t}\n\t\t}\n\t}\n}","sys_class_name":"sp_angular_provider","sys_id":"3b664cb56720220023c82e08f585ef14","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/d1c9ebbb04f12210559073c06a02f719","value":"d1c9ebbb04f12210559073c06a02f719"},"sys_update_name":"sp_angular_provider_3b664cb56720220023c82e08f585ef14","sys_updated_by":"admin","sys_created_on":"2016-07-11 17:26:53","name":"spCategoryListItem","sys_name":"spCategoryListItem","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"40","sys_updated_on":"2021-04-23 10:56:18","sys_tags":"","type":"directive","script":"function() {\n\treturn {\n\t\ttemplate: \n\t\t'<fieldset class=\"input-group-checkbox\">' +\n\t\t\t'<legend class=\"sr-only\">{{c.getAriaLabel(field)}} {{c.getRequired(field)}}</legend>' +\n\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>' +\n\t\t\t'</div>' +\n\t\t\t'<div ng-repeat=\"c in field.choices track by $index\">' +\n\t\t\t\t\t'<label>' +\n\t\t\t\t\t'<input class=\"autofocus-class\" ng-class=\"{\\'has-error\\':!field.isMandatoryFilled, \\'autofocus-error\\':!field.isMandatoryFilled}\" id=\"checkbox-input-{{::c.sys_id}}\" aria-label=\"{{::c.label}}\" type=\"checkbox\" name=\"{{::c.name}}\" aria-checked=\"{{c.selected}}\" ng-model=\"c.selected\" ng-change=\"selectChoice()\" aria-describedby=\"details_{{field.sys_id}} notAnswered{{field.sys_id}}\" />' +\n\t\t\t\t\t'<span class=\"sps-checkbox-label\" style=\"margin-left: 1em;display: inline;\">{{::c.label}}</span>' + \n\t\t\t\t\t'</label>' +\n\t\t\t'</div>' +\n\t\t'</fieldset>' + '<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>',\n\t\tscope: {\n\t\t\tfield: '=',\n\t\t\tc: '='\n\t\t},\n\t\tcontroller: function($scope) {\n\t\t\t$scope.selectChoice = function() {\n\t\t       // Update isMandatoryFilled\n\t\t\t   $scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\t          }\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"3bede576c3331200e44574e1c1d3aeb4","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_3bede576c3331200e44574e1c1d3aeb4","sys_updated_by":"admin","sys_created_on":"2016-06-07 20:41:14","name":"spSurveyMultipleCheckbox","sys_name":"spSurveyMultipleCheckbox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"39","sys_updated_on":"2023-12-21 11:50:13","sys_tags":"","type":"directive","script":"function taskAction() {\n\treturn {\n    template: '<div class=\"hr-task-action panel b {{tagId}}\">' +\n      '  <span ng-if=\"caption\">' +\n      '    <div class=\"task-action-caption\">{{caption}}</div>' +\n      '    <div class=\"task-action-small-caption\">' +\n\t  '       <sp-html-content style=\"margin: 0; padding: 0;\" ng-if=\"codeTag === \\'true\\'\" model=\"smallCaption\"></sp-html-content>' +\n      '      <div ng-if=\"codeTag === \\'false\\'\">{{smallCaption}}</div>' +\n      '    </div>' +\n      '  </span> ' +\n      '  <span ng-if=\"timeStamp && !completedBy && !created\" class=\"status\">' +\n      '    ${Completed} <sn-time-ago timeStamp=\"timeStamp\" />' +\n      '  </span>' +\n      '</div>',\n\n    restrict: 'E',\n    replace: true,\n    scope: {\n      timeStamp: \"@\",\n      completedBy: \"@\",\n      created: \"@\",\n      caption: \"@\",\n      shortDescription: \"@\",\n      smallCaption: \"@\",\n      codeTag: \"@\",\n      link: \"@\",\n      linkCaption: \"@\",\n      tagId: \"@\"\n    },\n\n    link: function (scope) {\n      if (!scope.tagId) {\n        scope.tagId = 'task-completed';\n      }\n    }\n  };\n}","sys_class_name":"sp_angular_provider","sys_id":"41aa4ca45b582300f1eaefe5f0f91a06","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_update_name":"sp_angular_provider_41aa4ca45b582300f1eaefe5f0f91a06","sys_updated_by":"admin","sys_created_on":"2018-08-29 18:56:31","name":"taskAction","sys_name":"taskAction","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"106","sys_updated_on":"2021-04-23 10:56:18","sys_tags":"","type":"directive","script":"function (i18n) {\n\tvar inner = '<div id=\"valueIsInvalid{{field.sys_id}}\">' +\n\t\t\t\t\t'<div aria-live=\"polite\"  class=\"sr-only wrapper-xs alert alert-danger\" ng-if=\"field.invalidValue\">{{errorMsg}}</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<div id=\"valueAdjusted{{field.sys_id}}\" >' +\n\t\t\t\t\t'<div aria-live=\"polite\" class=\"sr-only wrapper-xs\" ng-if=\"field.isConverted\">' +\n\t\t\t\t\t\t'{{errorMsg}}' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>'+\n\t\t\t'</div>' +\n\t\t\t'<label for=\"{{::field.sys_id}}\" class=\"sr-only\">{{getAriaLabel()}}</label>' +\n\t\t\t\t\t'<span ng-if=\"!isMobile\">' +\n\t\t\t\t\t\t'<input id=\"{{::field.sys_id}}\" ng-class=\"{\\'has-error\\':field.invalidValue || !field.isMandatoryFilled,\\'autofocus-error\\':field.invalidValue || !field.isMandatoryFilled }\" aria-invalid=\"{{field.invalidValue || !field.isMandatoryFilled}}\" class=\"form-control autofocus-class\" ng-model=\"field.value\" ng-change=\"validate()\" style=\"width:75px;margin-right:5px;padding:3px 6px;display:inline-block;\" minvalue=\"{{::field.minValue}}\" maxvalue=\"{{::field.maxValue}}\" ng-readonly=\"field.readOnly\" aria-describedby=\"details_{{field.sys_id}} valueIsInvalid{{field.sys_id}} valueAdjusted{{field.sys_id}} notAnswered{{field.sys_id}}\" aria-required=\"{{::field.mandatory}}\"/>' +\n\t\t\t\t\t\t'<span ng-if=\"showPercentage || field.type == \\'percentage\\'\">%</span>' +\n\t\t\t\t\t\t'<span class=\"wrapper-sm\">${Range}: {{::field.minValue}} - {{::field.maxValue}}</span>' +\n\t\t\t\t\t'</span>' +\n\t\t\t\t\t'<span  ng-if=\"isMobile\">' +\n\t\t\t\t\t\t'<input id=\"{{::field.sys_id}}\" ng-class=\"{\\'has-error\\':field.invalidValue || !field.isMandatoryFilled,\\'autofocus-error\\':field.invalidValue || !field.isMandatoryFilled}\" aria-invalid=\"{{field.invalidValue || !field.isMandatoryFilled}}\" class=\"form-control text-center autofocus-class\" ng-model=\"field.value\" ng-model=\"field.value\" ng-change=\"validate()\" style=\"width:75px;margin-right:5px;padding:3px 6px;display:inline-block;\" minvalue=\"{{::field.minValue}}\" maxvalue=\"{{::field.maxValue}}\" ng-readonly=\"field.readOnly\" aria-describedby=\"details_{{field.sys_id}} valueIsInvalid{{field.sys_id}} valueAdjusted{{field.sys_id}} notAnswered{{field.sys_id}}\" aria-required=\"{{::field.mandatory}}\"/>' +\n\t\t\t\t\t\t'<span ng-if=\"showPercentage || field.type == \\'percentage\\'\">%</span>' +\n\t\t\t\t\t\t'<span class=\"wrapper-sm\">${Range}: {{::field.minValue}} - {{::field.maxValue}}</span>' +\n\t\t\t\t\t'</span>';\n\t\treturn {\n\t\t\ttemplate: '<div>' +\n\t\t\t\t\t\t'<div  ng-if=\"!isMobile\" >' + inner + '</div>' +\n\t\t\t\t\t\t'<div  ng-if=\"isMobile\" class=\"text-center\">' + inner + '</div>' +\n\t\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t\t\t  '</div>',\n\n\t\t\tscope: {\n\t\t\t\t\t'field': '=',\n\t\t\t\t\t'showPercentage': '=',\n\t\t\t\t\t'isMobile': '=',\n\t\t\t\t\t'c': '='\n\n\t\t\t},\n\n\t\t\tcontroller: function($scope, $timeout, $element) {\n\t\t\t\t$scope.pagination = $scope.c.data.pagination\n\t\t\t    $scope.percent_label = $scope.showPercentage || $scope.field.type === 'percentage' ? '%' : '';\n\t\t\t \t$scope.validate = function() {\n\t\t\t\t\tvar field = $scope.field;\n\t\t\t\t\tif ($scope.isFloat(field.value) === true && field.value >= 0) {\n\t\t\t\t\t\tfield.value = Math.floor(field.value);\n\t\t\t\t\t\tfield.isConverted = true;\n\t\t\t\t\t\t$scope.c.getErrorMessage(\"valueAdjusted\" + field.sys_id, field.isConverted, \"${The input value has been adjusted to an integer}\", $scope, $element);\n\t\t\t\t\t} else\n\t\t\t\t\t\tfield.isConverted = false;\n\t\t\t\t\tif (field.value == '' && field.value != 0) {\n\t\t\t\t\t\tfield.invalidValue = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (isNaN(field.value)) {\n\t\t\t\t\t\tfield.invalidValue = true;\n\t\t\t\t\t\t$scope.c.getErrorMessage(\"valueIsInvalid\" + field.sys_id, field.invalidValue, \"${Value is invalid or out of range}\", $scope, $element);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar value = parseFloat(field.value);\n\t\t\t\t\tvar maxValue = parseInt(field.maxValue);\n\t\t\t\t\tvar minValue = parseInt(field.minValue);\n\t\t\t\t\t// Set this variable if the entered value is out of either max or min value\n\t\t\t\t\tfield.invalidValue = (!isNaN(maxValue) && value > maxValue) || (!isNaN(minValue) && value < minValue);\n\t\t\t\t\t// Update isMandatoryFilled\n\t\t\t\t\tfield.isMandatoryFilled = $scope.c.isMandatoryFilled(field);\n\t\t\t\t\t$scope.c.getErrorMessage(\"valueIsInvalid\" + field.sys_id, field.invalidValue, \"${Value is invalid or out of range}\", $scope, $element);\n\t\t\t \t};\n\t\t\t\t\n\t\t\t\t$scope.getAriaLabel = function() {\n\t\t\t\t\tvar field = $scope.field;\n\t\t\t\t\tvar label = $scope.c.getAriaLabel(field) + \" range \" + field.minValue + \" to \" + field.maxValue + $scope.percent_label + \" \"\n\t\t\t\t\tif(field.value){\n\t\t\t\t\t\tlabel += field.value + $scope.percent_label\n\t\t\t\t\t}\n\t\t\t\t\treturn label;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$scope.isFloat = function(n) {\n\t\t\t\t\treturn n % 1 !== 0;\n\t\t\t\t};\n\t\t\t}\n\t\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"4292b359c3002200e44574e1c1d3aed2","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_4292b359c3002200e44574e1c1d3aed2","sys_updated_by":"admin","sys_created_on":"2016-06-16 00:43:51","name":"spSurveyNumberField","sys_name":"spSurveyNumberField","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"12","sys_updated_on":"2024-03-11 18:00:03","sys_tags":"","type":"directive","script":"//usage : <XYZ ec-ellipsis-tooltip ec-ellipsis-tooltip-title=\"\" ec-ellipsis-tooltip-data-toggle=\"\" ec-ellipsis-tooltip-data-placement=\"\" ec-ellipsis-tooltip-data-container=\"\" />\n//Default : ec-ellipsis-tooltip-title -> '' ec-ellipsis-tooltip-data-toggle -> 'tooltip' ec-ellipsis-tooltip-data-placement -> 'auto' ec-ellipsis-tooltip-data-container -> 'body' \nfunction ecMultilineEllipsisTooltip(i18n, $rootScope) {\n    \"use strict\";\n    return {\n        restrict: 'A',\n        link: function(scope, elem, attrs) {\n            angular.element(document).ready(function() {\n                setTimeout(function() {\n                    showTooltip(elem, attrs);\n                }, 100);\n            });\n            // window resize should recalculate if tooltip is required, \n            // currently the tooltip attribute does not work on window resize or text zoom\n            $(window).resize(function(e) {\n                if(e.type == 'resize') {\n                    showTooltip(elem, attrs);\n                }\n            });\n\n            //destroy the tooltip when directive scope ends\n            scope.$on('$destroy', function() {\n              elem.tooltip('destroy');\n            });\n\n            // To show tooltip for ellipsis without page reload on enabling text-spacing for WCAG testing\n            scope.$watch(\n               function () {\n                  return elem.css(\"line-height\");\n               },\n               function (newVal, oldVal) {\n                  if (newVal !== oldVal) {\n                     showTooltip(elem, attrs);\n                  }\n            });\n\n            function showTooltip(element, attrs) {\n                if (element && element.length > 0) {\n                    if (isEllipsisActive(element.get(0))) {\n                        var title = attrs.ecEllipsisTooltipTitle ? attrs.ecEllipsisTooltipTitle : '';\n                        var html = (attrs.ecEllipsisTooltipDataHtml === 'true');\n                        var dataToggle = attrs.ecEllipsisTooltipDataToggle ? attrs.ecEllipsisTooltipDataToggle : 'tooltip';\n                        var dataPlacement = attrs.ecEllipsisTooltipDataPlacement ? attrs.ecEllipsisTooltipDataPlacement : 'auto';\n                        var dataContainer = attrs.ecEllipsisTooltipDataContainer ? attrs.ecEllipsisTooltipDataContainer : 'body';\n\n                        element.attr('title', title);\n                        if (html)\n                            element.attr('data-html', 'true');\n                        element.attr('data-toggle', dataToggle);\n                        element.attr('data-placement', dataPlacement);\n                        element.attr('data-container', dataContainer);\n                    }\n                    else {\n                        // if ellipsis is not active need to remove the title and data-toggle related attribute,\n                        // to have consistent behaviour also removes malformed attributes.\n                        element.removeAttr('title');\n                        element.removeAttr('data-html');\n                        element.removeAttr('data-toggle');\n                        element.removeAttr('data-placement');\n                        element.removeAttr('data-container');\n                    }\n                }\n            }\n\n            function getInnerDimensions(node) {\n                var computedStyle = getComputedStyle(node);\n                var horizontalPadding = parseFloat(computedStyle.paddingLeft) + parseFloat(computedStyle.paddingRight);\n                var verticalPadding = parseFloat(computedStyle.paddingTop) + parseFloat(computedStyle.paddingBottom);\n                var horizontalBorder = parseFloat(computedStyle.borderLeftWidth) + parseFloat(computedStyle.borderRightWidth);\n                var verticalBorder = parseFloat(computedStyle.borderTopWidth) + parseFloat(computedStyle.borderBottomWidth);\n\n                // offsetWidth and offsetHeight include padding and border, so we need to remove the padding and border and return dimensions\n                return {\n                    offsetWidth: node.offsetWidth - horizontalPadding - horizontalBorder,\n                    offsetHeight: node.offsetHeight - verticalPadding - verticalBorder\n                };\n            }\n\n            function containsLargerChildren(parent) {\n                var innerDimensions = getInnerDimensions(parent);\n                var parentWidth = innerDimensions.offsetWidth; // minus padding\n                var parentHeight = innerDimensions.offsetHeight; // minus padding\n                var children = parent.children;\n\n                for (var i=0; i<children.length; i++) {\n                    var child = children[i];\n                    if ((child.offsetWidth > parentWidth || child.offsetHeight > parentHeight)\n                      || (child.children.length && containsLargerChildren(child)))\n                        return true;\n                }\n\n                return false;\n            }\n\n            function isEllipsisActive(element) {\n                return (element.clientWidth < element.scrollWidth || element.clientHeight < element.scrollHeight) ? true : (element.children.length > 0 ? containsLargerChildren(element) : false);\n              }\n            }\n        };\n    }","sys_class_name":"sp_angular_provider","sys_id":"4de01d4677d530109033bfeacf5a9992","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_update_name":"sp_angular_provider_4de01d4677d530109033bfeacf5a9992","sys_updated_by":"admin","sys_created_on":"2021-07-13 13:55:10","name":"ecMultilineEllipsisTooltip","sys_name":"ecMultilineEllipsisTooltip","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"49","sys_updated_on":"2021-06-24 11:50:29","sys_tags":"","type":"directive","script":"function ($timeout) {\n  /* This attribute directive works alongside the ng-repeat directive and is used to fire an event on finishing rendering\na list of data. $timeout makes sure that the callback is executed when the ng-repeated elements have REALLY finished rendering\n(because the $timeout will execute at the end of the current digest cycle). So after the ng-repeat has finished,\nwe use $emit to emit an event to outer scopes (sibling and parent scopes). */\n   return {\n      restrict: 'A',\n      link: function (scope, element, attr) {\n         if (scope.$last) {\n            $timeout(function () {\n               scope.$emit(attr.onFinishRepeat);\n            });\n         }\n      }\n   }\n}","sys_class_name":"sp_angular_provider","sys_id":"4e9ff00eeb343010ed7966d647522896","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_update_name":"sp_angular_provider_4e9ff00eeb343010ed7966d647522896","sys_updated_by":"admin","sys_created_on":"2021-06-18 16:11:11","name":"onFinishRepeat","sys_name":"onFinishRepeat","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2019-02-05 05:48:58","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\ttemplate:\n\t\t'<div class=\"text-center\" style=\"text-overflow: ellipsis;\" ng-if=\"data.successMessage\">' +\n\t\t    '<h5 class=\"description-text\" ng-bind-html=\"data.successMessage\"></h5>' +\n         '</div>' ,\n\t\t\n\t\tscope: {\n\t\t\t'data': '='\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"4eb49937531323002d96ddeeff7b127b","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_4eb49937531323002d96ddeeff7b127b","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:48:58","name":"mespSurveyEndNotes","sys_name":"mespSurveyEndNotes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"18","sys_updated_on":"2021-03-31 19:56:05","sys_tags":"","type":"directive","script":"function($rootScope, spUtil, $uibModal, $http) {\n\t'use strict';\n\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\ttemplate:   '<span class=\"ref-picker-container\">' +\n\t\t\t\t\t\t'<div class=\"add-on\" ng-if=\"field.value != \\'\\'\">' +\n\t\t\t\t\t\t\t'<button type=\"button\" aria-label=\"${Preview this record {{field.displayValue}}}\" class=\"btn btn-default bg-white lookup\" ng-click=\"openReference(field)\" data-toggle=\"tooltip\" data-placement=\"top\" data-original-title=\"${Preview this record {{field.displayValue}}}\"><span class=\"fa fa-info-circle\"></span></button>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div ng-class=\"{\\'has-error\\': !field.isMandatoryFilled}\" class=\"reference\">' +\n\t\t\t\t\t\t\t'<sp-survey-reference-element c=\"c\" is-mobile=\"isMobile\" field=\"field\" sn-select-width=\"100%\" ref-table=\"field.refTable\" ref-id=\"field.sys_id\" glide-form=\"getGlideForm()\" record-values=\"getEncodedRecordValues()\" sn-disabled=\"field.isReadonly()\"/>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</span>',\n\n\t\tcontroller: function($scope){\n\t\t\t$scope.openReference = function(field) {\n\t\t\t\tvar data = {table: field.ed.reference, sys_id: field.value};\n\t\t\t\tif (angular.isDefined(field.reference_key))\n\t\t\t\t\tdata[field.reference_key] = field.value;\n\t\t\t\telse\n\t\t\t\t\tdata.sys_id = field.value;\n\n\t\t\t\tshowForm(data);\n\t\t\t};\n\n\n\t\t\tfunction showForm(data) {\n\t\t\t\tvar url = spUtil.getWidgetURL(\"widget-form\");\n\n\t\t\t\tvar req = {\n\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\turl : url,\n\t\t\t\t\theaders : {\n\t\t\t\t\t\t'Accept' : 'application/json',\n\t\t\t\t\t\t'x-portal' : $rootScope.portal_id\n\t\t\t\t\t},\n\t\t\t\t\tdata : data\n\t\t\t\t}\n\t\t\t\t$http(req).then(qs, qe);\n\n\t\t\t\tfunction qs(response) {\n\t\t\t\t\tvar r = response.data.result;\n\t\t\t\t\tshowModal(r);\n\t\t\t\t}\n\t\t\t\t// error\n\t\t\t\tfunction qe(error) {\n\t\t\t\t\tconsole.error(\"Error \" + error.status + \" \" + error.statusText);\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tfunction showModal(form) {\n\t\t\t\tvar opts = {\n\t\t\t\t\tsize : 'lg',\n\t\t\t\t\ttemplateUrl : 'sp_form_modal',\n\t\t\t\t\tcontroller : ModalInstanceCtrl,\n\t\t\t\t\tresolve : {}\n\t\t\t\t};\n\n\t\t\t\topts.resolve.item = function() {\n\t\t\t\t\treturn angular.copy({\n\t\t\t\t\t\tform : form\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tvar modalInstance = $uibModal.open(opts);\n\t\t\t\tmodalInstance.result.then(function() {}, function() {});\n\n\t\t\t\t$scope.$on(\"$destroy\", function() {\n\t\t\t\t\tmodalInstance.close();\n\t\t\t\t});\n\n\t\t\t\tvar unregister = $scope.$on('sp.form.record.updated', function(evt, fields) {\n\t\t\t\t\tunregister();\n\t\t\t\t\tunregister = null;\n\t\t\t\t\tmodalInstance.close();\n\n\t\t\t\t\t// Do something here to refresh this record...\n\n\t\t\t\t\tif (evt.stopPropagation)\n\t\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction ModalInstanceCtrl($scope, $uibModalInstance, item) {\n\t\t\t\t$scope.item = item;\n\n\t\t\t\t$scope.ok = function() {\n\t\t\t\t\t$uibModalInstance.close();\n\t\t\t\t};\n\n\t\t\t\t$scope.cancel = function() {\n\t\t\t\t\t$uibModalInstance.dismiss('cancel');\n\t\t\t\t};\n\t\t\t}\n\n\n\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"5064a9f2c3331200e44574e1c1d3aed0","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_5064a9f2c3331200e44574e1c1d3aed0","sys_updated_by":"admin","sys_created_on":"2016-06-07 19:58:08","name":"spSurveyReferenceField","sys_name":"spSurveyReferenceField","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"2","sys_updated_on":"2019-04-01 01:00:02","sys_tags":"","type":"directive","script":"function() {\n\treturn {\n\t\ttemplate:\n\t\t'<div class=\"container-fluid\">' +\n\t\t'<div class=\"row\">' +\n\t\t'<div class=\"col-xs-12 col-sm-6\">' +\n\t\t'<ul style=\"list-style-type: none;padding:0\" class=\"sps-ranking-list\">'+\n\t\t\t'<li class=\"row question-ranking-line-space\" ng-repeat=\"c in field.choices track by $index\" style=\"border: 1px solid #ccc;border-radius: 5px;margin-bottom: 5px;\">'+\n\t\t\t  '<div class=\"col-xs-2 wrapper-xs\" style=\"position:static\">' +\n\t\t\t\t'<select elem-id=\"{{::c.sys_id}}\" name=\"{{c.name}}\" aria-label=\"{{::c.label}}\" ng-change=\"onSelectChange(c)\" class=\"form-control\" style=\"padding:3px;\" sn-select-width=\"auto\" ng-model=\"c.value\" ng-disabled=\"field.isReadonly()\">' +\n\t\t\t\t'<option value=\"-1\" ng-selected=\"c.value == -1\"></option> '+\n\t\t\t\t'<option ng-repeat=\"i in field.choices track by $index\" value=\"{{$index + 1}}\" ng-selected=\"$index + 1 == c.value\">{{$index + 1}}</option> ' +\n\t\t\t\t'</select>'+\n\t\t\t  '</div>' +\n\t\t\t  '<div class=\"col-xs-9 wrapper-sm\" style=\"position:static\"><label for=\"{{::c.sys_id}}\" class=\"sps-checkbox-label\">{{c.label}}</label></div>' +\n\t\t\t  '<div class=\"col-xs-1 wrapper-sm\" style=\"position:static\"><span class=\"fa fa-bars pull-right wrapper-xs\"></span></div>'+\n\t\t\t'<li>'+\n\t\t'</ul>' +\n\t\t'</div>' +\n\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n\t\t'</div>' +\n\t\t'</div>',\n\t\tcontroller: function($scope) {\n\t\t\t$scope.field.choices.sort(function(a, b) {return a.value - b.value;});\n\n\t\t\tfunction swap(a, i, j) {\n\t\t\t\tif (i < 0 || i >= a.length || j < 0 || j >= a.length)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar temp = a[i];\n\t\t\t\ta[i] = a[j];\n\t\t\t\ta[j] = temp;\n\t\t\t}\n\n\t\t\tfunction getCurrentPosition(sys_id) {\n\t\t\t\tvar lis = $($scope.element).find('li');\n\t\t\t\tfor (var i=0; i<lis.length; i++) {\n\t\t\t\t\tvar forSysId = $(lis[i]).find('label').attr('for');\n\t\t\t\t\tif (forSysId && forSysId.trim().indexOf(sys_id.trim()) == 0)\n\t\t\t\t\t\treturn (i + 1);\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\t$scope.onSelectChange = function(choice) {\n\t\t\t\t$scope.field.choices.forEach(function(c) {\n\t\t\t\t\tif (c.value == choice.value && c.sys_id != choice.sys_id)\n\t\t\t\t\t\tc.value = '-1';\n\t\t\t\t});\n\n\t\t\t\tvar oldValue = getCurrentPosition(choice.sys_id);\n\t\t\t\tvar order = $scope.sortable.toArray();\n\t\t\t\tswap(order, parseInt(choice.value) - 1, parseInt(oldValue) - 1);\n\t\t\t\t$scope.sortable.sort(order);\n\t\t\t}\n\t   },\n\t\tlink: function(scope, element) {\n\t\t\tvar sortable = new Sortable($(element).find('ul')[0], {\n\t\t\t\tonUpdate: function () {\n\t\t\t\t\tvar rankList = $(element).find('select');\n\t\t\t\t\tfor(var i = 0; i < rankList.length; i++) {\n\t\t\t\t\t\trankList[i].value = i + 1;\n\t\t\t\t\t\t$(rankList[i]).triggerHandler('change');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetTimeout(function() {\n\t\t\t\t$(element).find('li').mouseenter(function(elem) {\n\t\t\t\t\t$(this).addClass('hovered');\n\t\t\t\t})\n\n\t\t\t\t$(element).find('li').mouseleave(function(elem) {\n\t\t\t\t\t$(this).removeClass('hovered');\n\t\t\t\t})\n\t\t\t}, 10);\n\n\t\t\tscope.sortable = sortable;\n\t\t\tscope.element = element;\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"6187d977531323002d96ddeeff7b120a","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_6187d977531323002d96ddeeff7b120a","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:59:59","name":"mespSurveyRankingSelectBox","sys_name":"mespSurveyRankingSelectBox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"53","sys_updated_on":"2021-04-22 08:00:43","sys_tags":"","type":"directive","script":"function($timeout, $http, urlTools, filterExpressionParser, $sanitize, i18n, spIs) {\n\t\"use strict\";\n\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\tscope: {\n\t\t\ted: \"=?\",\n\t\t\tfield: \"=\",\n\t\t\trefTable: \"=?\", // comes from this table\n\t\t\trefId: \"=?\", // and this sys_id\n\t\t\tsnOptions: \"=?\",\n\t\t\tsnOnBlur: \"&\",\n\t\t\tsnOnClose: \"&\",\n\t\t\tminimumInputLength : \"@\",\n\t\t\tsnDisabled: \"=\",\n\t\t\tdropdownCssClass: \"@\",\n\t\t\tformatResultCssClass: \"&\",\n\t\t\tdisplayColumn: \"@\",\n\t\t\trecordValues: '&',\n\t\t\tgetGlideForm: '&glideForm',\n\t\t\tdomain: \"@\",\n\t\t\tsnSelectWidth: '@', // Width of the selector. Default to 100%.\n\t\t\tc: '=',\n\t\t\tisMobile: '='\n\t\t},\n\t\ttemplate: '<input type=\"text\" name=\"{{field.name}}\" autocomplete=\"off\" ng-disabled=\"snDisabled\" ng-readonly=\"field.readOnly\" style=\"min-width: 150px;\" />',\n\t\tlink: function(scope, element, attrs, ctrl) {\n\t\t\tscope.ed = scope.ed || scope.field.ed;\n\t\t\tscope.selectWidth = scope.snSelectWidth || '100%';\n\t\t\telement.css(\"opacity\", 0);\n\t\t\tvar fireReadyEvent = true;\n\t\t\tvar g_form;\n\t\t\tvar displayColumns;\n\t\t\tvar field = scope.field;\n\t\t\tvar isMultiple = scope.snOptions && scope.snOptions.multiple === true;\n\t\t\tif (angular.isDefined(scope.getGlideForm))\n\t\t\t\tg_form = scope.getGlideForm();\n\t\t\tvar fieldAttributes = {};\n\t\t\tif (angular.isDefined(scope.field) && angular.isDefined(scope.field.attributes) && typeof scope.ed.attributes == 'undefined')\n\t\t\t\tif (Array.isArray(scope.field.attributes))\n\t\t\t\t\tfieldAttributes = scope.field.attributes;\n\t\t\t\telse\n\t\t\t\t\tfieldAttributes = parseAttributes(scope.field.attributes);\n\t\t\telse\n\t\t\t\tfieldAttributes = parseAttributes(scope.ed.attributes);\n\n\t\t\tif (angular.isDefined(fieldAttributes['ref_ac_columns']))\n\t\t\t\tdisplayColumns = fieldAttributes['ref_ac_columns'];\n\n\t\t\tvar s2Helpers = {\n\t\t\t\tformatSelection: function(item) {\n\t\t\t\t\treturn $sanitize(getDisplayValue(item));\n\t\t\t\t},\n\t\t\t\tformatResult: function(item) {\n\t\t\t\t\tvar displayValues = getDisplayValues(item);\n\t\t\t\t\tif (displayValues.length == 1)\n\t\t\t\t\t\treturn $sanitize(displayValues[0]);\n\t\t\t\t\tif (displayValues.length > 1) {\n\t\t\t\t\t\tvar width = 100 / displayValues.length;\n\t\t\t\t\t\tvar markup = \"\";\n\t\t\t\t\t\tfor (var i = 0; i < displayValues.length; i++)\n\t\t\t\t\t\t\tmarkup += \"<div style='width: \" + width + \"%;' class='select2-result-cell'>\" + $sanitize(displayValues[i])  + \"</div>\";\n\t\t\t\t\t\treturn markup;\n\t\t\t\t\t}\n\t\t\t\t\treturn \"\";\n\t\t\t\t},\n\n\t\t\t\tsearch: function(queryParams) {\n\t\t\t\t\tvar url = urlTools.getURL('sp_ref_list_data');\n\t\t\t\t\treturn $http.post(url, queryParams.data).then(queryParams.success);\n\t\t\t\t},\n\n\t\t\t\tinitSelection: function(elem, callback) {\n\t\t\t\t\tif (scope.field.displayValue) {\n\t\t\t\t\t\tif (isMultiple) {\n\t\t\t\t\t\t\tvar items = [];\n\t\t\t\t\t\t\tvar values = scope.field.value.split(',');\n\t\t\t\t\t\t\tvar displayValues = scope.field.displayValue.split(',');\n\t\t\t\t\t\t\tfor(var i=0; i<values.length; i++){\n\t\t\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\t\tsys_id: values[i],\n\t\t\t\t\t\t\t\t\tname: displayValues[i]\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcallback(items);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcallback({\n\t\t\t\t\t\t\t\tsys_id: scope.field.value,\n\t\t\t\t\t\t\t\tname: scope.field.displayValue\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else\n\t\t\t\t\t\tcallback([]);\n\t\t\t\t},\n\t\t\t\tonSelecting: function(e) {\n\t\t\t\t\tvar selectedItem = e.choice;\n\t\t\t\t\tif ('sys_id' in selectedItem) {\n\t\t\t\t\t\tvar values = field.value == '' ? [] : field.value.split(',');\n\t\t\t\t\t\tvar displayValues = field.displayValue == '' ? [] : field.displayValue.split(',');\n\n\t\t\t\t\t\tvalues.push(selectedItem.sys_id);\n\t\t\t\t\t\tdisplayValues.push(getDisplayValue(selectedItem));\n\t\t\t\t\t\t//g_form.setValue(field.name, values.join(','), displayValues.join(','));\n\t\t\t\t\t\tscope.field.displayValue = displayValues.join(',');\n\t\t\t\t\t\tscope.field.value = values.join(',');\n\t\t\t\t\t\tscope.$apply();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\telement.select2('val', values).select2('close');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonRemoving: function(e) {\n\t\t\t\t\tvar removed = e.choice;\n\t\t\t\t\tvar values = field.value.split(',');\n\t\t\t\t\tvar displayValues = field.displayValue.split(',');\n\t\t\t\t\tfor(var i = values.length-1; i>=0; i--){\n\t\t\t\t\t\tif (removed.sys_id == values[i]) {\n\t\t\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\t\t\t\tdisplayValues.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//g_form.setValue(field.name, values.join(','), displayValues.join(','));\n\t\t\t\t\tscope.field.displayValue = displayValues.join(',');\n\t\t\t\t\tscope.field.value = values.join(',');\n\t\t\t\t\tscope.$apply();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\telement.select2('val', values);\n\t\t\t\t},\n\t\t\t\tselect2Change: function(e) {\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tif (e.added) {\n\t\t\t\t\t\tvar selectedItem = e.added;\n\t\t\t\t\t\tvar value = selectedItem.sys_id;\n\t\t\t\t\t\tvar displayValue = value ? getDisplayValue(selectedItem) : '';\n\t\t\t\t\t\t//g_form.setValue(scope.field.name, value, displayValue);\n\t\t\t\t\t\tscope.field.displayValue = displayValue;\n\t\t\t\t\t\tscope.field.value = value;\n\t\t\t\t\t\tscope.$apply();\n\t\t\t\t\t} else if (e.removed) {\n\t\t\t\t\t\t//g_form.clearValue(scope.field.name);\n\t\t\t\t\t\tscope.field.value = '';\n\t\t\t\t\t\tscope.field.displayValue = '';\n\t\t\t\t\t\tscope.$apply();\n\t\t\t\t\t}\n\t\t\t\t// Hard-setting an aria-label on the focused input, so both the question name and selected option can be announced by screen reader\n\t\t\t\tvar select2Focusser = element.parent().find(\".select2-focusser\")\n\t\t\t\tselect2Focusser.attr(\"aria-label\", getAriaLabel());\n\t\t\t\tselect2Focusser.attr(\"aria-required\", field.mandatory);\n\t\t\t\tselect2Focusser.attr(\"aria-describedby\", \"details_\" + scope.field.sys_id);\n\t\t\t\t // Update isMandatoryFilled\n\t\t\t\t scope.field.isMandatoryFilled = scope.c.isMandatoryFilled(field)\n\t\t\t\tif(scope.field.isMandatoryFilled){\n\t\t\t\t\tselect2Focusser.removeClass(\"autofocus-error\")\n\t\t\t\t}else{\n\t\t\t\t\tselect2Focusser.addClass(\"autofocus-error\")\n\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar config = {\n\t\t\t\twidth : scope.selectWidth,\n\t\t\t\tminimumInputLength: scope.minimumInputLength ? parseInt(scope.minimumInputLength, 10) : 0,\n\t\t\t\tcontainerCssClass : 'select2-reference ng-form-element',\n\t\t\t\tplaceholder : '   ',\n\t\t\t\tformatSearching: '',\n\t\t\t\tallowClear: attrs.allowClear !== 'false',\n\t\t\t\tid: function(item) {\n\t\t\t\t\treturn item.sys_id;\n\t\t\t\t},\n\t\t\t\tsortResults: (scope.snOptions && scope.snOptions.sortResults) ? scope.snOptions.sortResults : undefined,\n\t\t\t\tajax: {\n\t\t\t\t\tquietMillis: NOW.ac_wait_time,\n\n\t\t\t\t\tdata: function(filterText, page) {\n\t\t\t\t\t\tvar filterExpression = filterExpressionParser.parse(filterText, scope.ed.defaultOperator);\n\t\t\t\t\t\tvar colToSearch = getReferenceColumnToSearch();\n\t\t\t\t\t\tvar refCondition = scope.ed.refCondition;\n\t\t\t\t\t\tvar q = colToSearch + filterExpression.operator + filterExpression.filterText +\n\t\t\t\t\t\t\t'^' + colToSearch + 'ISNOTEMPTY' + getExcludedValues();\n\t\t\t\t\t\tif (refCondition)\n\t\t\t\t\t\t\tq += \"^\" + refCondition;\n\t\t\t\t\t\tif (!q.endsWith(\"^EQ\"))\n\t\t\t\t\t\t\tq += \"^EQ\";\n\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\tstart: (scope.pageSize * (page - 1)),\n\t\t\t\t\t\t\tcount: scope.pageSize,\n\t\t\t\t\t\t\tsysparm_target_table: scope.refTable,\n\t\t\t\t\t\t\tsysparm_target_sys_id: scope.refId,\n\t\t\t\t\t\t\tsysparm_target_field: scope.ed.name,\n\t\t\t\t\t\t\ttable: scope.ed.reference,\n\t\t\t\t\t\t\tqualifier: scope.ed.qualifier,\n\t\t\t\t\t\t\tdata_adapter: scope.ed.data_adapter,\n\t\t\t\t\t\t\tattributes: scope.ed.attributes,\n\t\t\t\t\t\t\tdependent_field: scope.ed.dependent_field,\n\t\t\t\t\t\t\tdependent_table: scope.ed.dependent_table,\n\t\t\t\t\t\t\tdependent_value: scope.ed.dependent_value,\n\t\t\t\t\t\t\tp: scope.ed.reference + ';q:' + q + ';r:' + scope.ed.qualifier\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (scope.domain) {\n\t\t\t\t\t\t\tparams.sysparm_domain = scope.domain;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (angular.isDefined(scope.field) && scope.field['_cat_variable'] === true){\n\t\t\t\t\t\t\t/*delete params['sysparm_target_table'];\n\t\t\t\t\t\t\tparams['sysparm_include_variables'] = true;\n\t\t\t\t\t\t\tparams['variable_ids'] = scope.field.sys_id;\n\t\t\t\t\t\t\tvar getFieldSequence = g_form.$private.options('getFieldSequence');\n\t\t\t\t\t\t\tif (getFieldSequence) {\n\t\t\t\t\t\t\t\tparams['variable_sequence1'] = getFieldSequence();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar itemSysId = g_form.$private.options('itemSysId');\n\t\t\t\t\t\t\tparams['sysparm_id'] = itemSysId;\n\t\t\t\t\t\t\tvar getFieldParams = g_form.$private.options('getFieldParams');\n\t\t\t\t\t\t\tif (getFieldParams) {\n\t\t\t\t\t\t\t\tangular.extend(params, getFieldParams());\n\t\t\t\t\t\t\t}*/\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (scope.recordValues)\n\t\t\t\t\t\t\tparams.sysparm_record_values = scope.recordValues();\n\n\t\t\t\t\t\treturn params;\n\t\t\t\t\t},\n\n\t\t\t\t\tresults: function(data, page) {\n\t\t\t\t\t\treturn ctrl.filterResults(data, page, scope.pageSize);\n\t\t\t\t\t},\n\n\t\t\t\t\ttransport: s2Helpers.search\n\t\t\t\t},\n\t\t\t\tformatSelection: s2Helpers.formatSelection,\n\t\t\t\tformatResult: s2Helpers.formatResult,\n\t\t\t\tinitSelection: s2Helpers.initSelection,\n\t\t\t\tdropdownCssClass: attrs.dropdownCssClass,\n\t\t\t\tformatResultCssClass: scope.formatResultCssClass || null,\n\t\t\t\tmultiple: isMultiple\n\t\t\t};\n\n\t\t\tif (isMultiple && scope.ed.reference == \"sys_user\") {\n\t\t\t\tconfig.createSearchChoice = function (term) {\n\t\t\t\t\tif (spIs.an.email(term)) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\temail: term,\n\t\t\t\t\t\t\tname: term,\n\t\t\t\t\t\t\tuser_name: term,\n\t\t\t\t\t\t\tsys_id: term\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (scope.snOptions) {\n\t\t\t\tif (scope.snOptions.placeholder) {\n\t\t\t\t\tconfig.placeholder = scope.snOptions.placeholder;\n\t\t\t\t}\n\t\t\t\tif (scope.snOptions.width) {\n\t\t\t\t\tconfig.width = scope.snOptions.width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction getReferenceColumnToSearch() {\n\t\t\t\tvar colName = 'name';\n\t\t\t\tif (fieldAttributes['ref_ac_columns_search'] == 'true' && 'ref_ac_columns' in fieldAttributes && fieldAttributes['ref_ac_columns'] != '') {\n\t\t\t\t\tvar refAcColumns = fieldAttributes['ref_ac_columns'].split(';');\n\t\t\t\t\tcolName = refAcColumns[0];\n\t\t\t\t} else if (scope.ed.searchField)\n\t\t\t\t\tcolName = scope.ed.searchField;\n\t\t\t\telse if (fieldAttributes['ref_ac_order_by'])\n\t\t\t\t\tcolName = fieldAttributes['ref_ac_order_by'];\n\n\t\t\t\treturn colName;\n\t\t\t}\n\n\t\t\tfunction getExcludedValues () {\n\t\t\t\tif (scope.ed.excludeValues && scope.ed.excludeValues != '') {\n\t\t\t\t\t//nameISNOTEMPTY^sys_idIN681b365ec0a80164000fb0b05854a0cd,5137153cc611227c000bbd1bd8cd2005\n\t\t\t\t\treturn '^sys_idNOT IN' + scope.ed.excludeValues;\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tfunction parseAttributes(strAttributes) {\n\t\t\t\t// Turn an attribute string into a simple object\n\t\t\t\t// \"ref_auto_completer=AJAXTableCompleter,ref_contributions=task_show_ci_map;show_related_records,ref_ac_columns=sys_class_name,ref_ac_order_by=sys_class_name\"\n\t\t\t\t// into: {ref_auto_completer: AJAXTableCompleter, ref_contributions: 'task_show_ci_map;show_related_records' ... }\n\n\t\t\t\tvar attributeArray = (strAttributes && strAttributes.length ? strAttributes.split(',') : []);\n\t\t\t\tvar attributeObj = {};\n\t\t\t\tfor (var i = 0; i < attributeArray.length; i++) {\n\t\t\t\t\tif (attributeArray[i].length > 0) {\n\t\t\t\t\t\tvar attribute = attributeArray[i].split('=');\n\t\t\t\t\t\tattributeObj[attribute[0]] = attribute.length > 1 ? attribute[1] : '';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn attributeObj;\n\t\t\t}\n\n\t\t\tfunction init() {\n\t\t\t\t$timeout(function() {\n\t\t\t\t\ti18n.getMessage('Searching...', function(searchingMsg) {\n\t\t\t\t\t\tconfig.formatSearching = function() {\n\t\t\t\t\t\t\treturn searchingMsg;\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\telement.css(\"opacity\", 1);\n\t\t\t\t\telement.select2(\"destroy\");\n\t\t\t\t\tvar select2 = element.select2(config);\n\t\t\t\t\telement.select2(\"val\", scope.field.value.split(','));\n\t\t\t\t\tif (isMultiple){\n\t\t\t\t\t\telement.bind(\"select2-selecting\", s2Helpers.onSelecting);\n\t\t\t\t\t\telement.bind(\"select2-removing\", s2Helpers.onRemoving);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.bind(\"change select2-removed\", s2Helpers.select2Change);\n\t\t\t\t\t}\n\n\t\t\t\t// Hard-setting an aria-label on the focused input, so both the question name and selected option can be announced by screen reader\n\t\t\t\tvar select2Focusser = $(element).parent().find('.select2-focusser');\n\t\t\t    select2Focusser.removeAttr('aria-labelledby');\n\t\t\t\tselect2Focusser.attr('aria-label', getAriaLabel());\n\t\t\t\tselect2Focusser.attr(\"aria-required\", field.mandatory);\n\t\t\t\tselect2Focusser.attr(\"aria-describedby\", \"details_\" + scope.field.sys_id);\n\t\t\t\tselect2Focusser.addClass(\"autofocus-class\");\n\t\t\t\t\t\n\t\t\t\t\t// Enable up or down key functionality to open the select\n\t\t\t\t\telement.parent().find(\".select2-focusser\").on(\"keydown\", function(e) {\n\t\t\t\t\t\tif (e.which === 40 || e.which === 38)\n\t\t\t\t\t\t\telement.select2('open');\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\telement.bind(\"select2-blur\", function() {\n\t\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\t\tscope.snOnBlur();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tif (fireReadyEvent) {\n\t\t\t\t\t\tscope.$emit('select2.ready', element);\n\t\t\t\t\t\tfireReadyEvent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction getAriaLabel() {\n\t\t\t\tvar label = scope.c.getAriaLabel(field);\n\t\t\t\tif (field.displayValue || field.value) {\n\t\t\t\t\tlabel += (\" \" + (field.displayValue || field.value));\n\t\t\t\t}\n\t\t\t\treturn label;\n\t\t\t}\n\n\t\t\tfunction getDisplayValue(selectedItem) {\n\t\t\t\tvar displayValue = '';\n\t\t\t\tif (selectedItem && selectedItem.sys_id) {\n\t\t\t\t\tif (scope.displayColumn && typeof selectedItem[scope.displayColumn] != \"undefined\")\n\t\t\t\t\t\tdisplayValue = selectedItem[scope.displayColumn];\n\t\t\t\t\telse if (selectedItem.$$displayValue)\n\t\t\t\t\t\tdisplayValue = selectedItem.$$displayValue;\n\t\t\t\t\telse if (selectedItem.name)\n\t\t\t\t\t\tdisplayValue = selectedItem.name;\n\t\t\t\t\telse if (selectedItem.title)\n\t\t\t\t\t\tdisplayValue = selectedItem.title;\n\t\t\t\t}\n\t\t\t\treturn displayValue;\n\t\t\t}\n\n\t\t\tfunction getDisplayValues(selectedItem) {\n\t\t\t\tvar displayValues = [];\n\t\t\t\tif (selectedItem && selectedItem.sys_id) {\n\t\t\t\t\tdisplayValues.push(getDisplayValue(selectedItem));\n\t\t\t\t}\n\n\t\t\t\tif (displayColumns) {\n\t\t\t\t\tvar columns = displayColumns.split(\";\");\n\t\t\t\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\t\t\t\tvar column = columns[i];\n\t\t\t\t\t\tif (selectedItem[column])\n\t\t\t\t\t\t\tdisplayValues.push(selectedItem[column]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn displayValues;\n\t\t\t}\n\n\t\t\t/*g_form.$private.events.on(\"change\", function(fieldName, oldValue, value) {\n\t\t\t\tif (fieldName == field.name) {\n\t\t\t\t\telement.select2(\"val\", typeof value == 'string' ? value.split(',') : value);\n\t\t\t\t}\n\t\t\t});*/\n\n\t\t\tscope.$on(\"snReferencePicker.activate\", function(evt, parms) {\n\t\t\t\t$timeout(function() {\n\t\t\t\t\telement.select2(\"open\");\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tinit();\n\t\t},\n\n\t\tcontroller: function($scope, $rootScope, $element) {\n\t\t\t$scope.pageSize = NOW.ac_max_search_matches;\n\n\t\t\t// Default Results Filter (aka, None)\n\t\t\tthis.filterResults = function(data, page) {\n\t\t\t\treturn {\n\t\t\t\t\tresults: data.data.items,\n\t\t\t\t\tmore: (page * $scope.pageSize < data.data.total)\n\t\t\t\t};\n\t\t\t};\n\t\t\t$scope.$on('nextOrSubmitClick', function(e){\n\t\t\t\tif (!$scope.field.value && $scope.field.mandatory)\n\t\t\t\t\t$element.parent().find('.select2-focusser').addClass('autofocus-error');\n\t\t\t})\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"61cec146c3402200e44574e1c1d3ae0e","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_61cec146c3402200e44574e1c1d3ae0e","sys_updated_by":"admin","sys_created_on":"2016-06-17 20:43:46","name":"spSurveyReferenceElement","sys_name":"spSurveyReferenceElement","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"65","sys_updated_on":"2021-04-21 10:31:27","sys_tags":"","type":"directive","script":"function(getTemplateUrl) {\n\t'use strict';\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\ttemplate: '<div ng-repeat=\"attachment in field.attachments track by $index\">' +\n\t\t\t\t\t\t\t\t'<div class=\"sp-attachment-block-single-line file-attachment row\" elem-id=\"att-{{attachment.sys_id}}\">' +\n\t\t\t\t\t\t\t    '<a class=\"col-md-1 col-sm-1 col-xs-2 view-attachment m-b-none text-center\" aria-label=\"${Download {{attachment.file_name}} ({{attachment.size}})}\" style=\"border: none;\"' +\n\t\t\t\t\t\t\t\t\t'data-toggle=\"tooltip\" data-placement=\"top\" data-original-title=\"${Download}\" tabindex=\"-1\"' +\n\t\t\t\t\t\t\t        'ng-click=\"field.attachmentHandler.viewAttachment($event, attachment)\" href=\"javascript:void(0)\">' +\n\t\t\t\t\t\t\t        '<img alt=\"{{attachment.file_name}}\" ng-if=\"attachment.thumbSrc\" class=\"attachment-thumbnail img-responsive\" ng-src=\"{{attachment.thumbSrc}}\"/>' +\n\t\t\t\t\t\t\t        '<span ng-if=\"!attachment.thumbSrc\">' +\n\t\t\t\t\t\t\t            '<span class=\"glyphicon glyphicon-file text-2x\"/>' +\n\t\t\t\t\t\t\t        '</span>' +\n\t\t\t\t\t\t\t    '</a>' +\n\t\t\t\t\t\t\t    '<div class=\"col-md-5 col-sm-6 col-xs-8 file-name v-middle\" style=\"white-space:nowrap;text-overflow:ellipsis;\">' +\n\t\t\t\t\t\t\t        '<a class=\"get-attachment\" ng-click=\"field.attachmentHandler.downloadAttachment(attachment)\" href=\"javascript:void(0)\" aria-label=\"${Download {{attachment.file_name}} ({{attachment.size}})}\"' +\n\t\t\t\t\t\t\t\t\t\t'data-toggle=\"tooltip\" data-placement=\"top\" data-original-title=\"${Download}\">' +\n\t\t\t\t\t\t\t            '{{attachment.file_name}} ({{attachment.size}})' +\n\t\t\t\t\t\t\t        '</a>' +\n\t\t\t\t\t\t\t        '<input ng-keydown=\"field.attachmentHandler.onKeyDown($event, attachment)\" ng-blur=\"field.attachmentHandler.updateAttachment($event, attachment)\" style=\"display: none;\"/>' +\n\t\t\t\t\t\t\t        '<div><time><sn-time-ago timestamp=\"attachment.sys_updated_on\" /></time></div>' +\n\t\t\t\t\t\t\t    '</div>' +\n                                '<div ng-if=\"!isMobile\" class=\"col-md-6 col-sm-5 col-xs-2 tools v-middle\">' +\n                                    '<span ng-if=\"attachment.canWrite && false\" class=\"glyphicon glyphicon-pencil sp-attachment-edit wrapper-xs\" ng-click=\"field.attachmentHandler.editAttachment($event, attachment)\" title=\"Edit file name\"></span>' +\n                                    '<span ng-if=\"attachment.canDelete\" class=\"glyphicon glyphicon-remove sp-attachment-delete wrapper-xs\" ng-click=\"field.attachmentHandler.deleteAttachment(attachment)\" tabindex=\"0\" aria-label=\"${Delete {{attachment.file_name}}}\" data-toggle=\"tooltip\" data-placement=\"top\" data-original-title=\"${Delete}\"/>' +\n                                '</div>' +\n                                '<div ng-if=\"isMobile\" class=\"col-md-6 col-sm-5 col-xs-2 tools v-middle text-right\">' +\n                                    '<span ng-if=\"attachment.canDelete\" class=\"glyphicon glyphicon-remove sp-attachment-delete wrapper-xs\" ng-click=\"field.attachmentHandler.deleteAttachment(attachment)\" tabindex=\"0\" aria-label=\"${Delete {{attachment.file_name}}}\" data-toggle=\"tooltip\" data-placement=\"top\" data-original-title=\"${Delete}\"/>' +\n                                '</div>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'</div>',\n\t\tlink: function(scope, elem, attrs, $parse) {\n\t\t\tscope.icons = {\n\t\t\t\tpreview: attrs.previewIcon,\n\t\t\t\tedit: attrs.editIcon,\n \t\t\t\tdelete: attrs.deleteIcon,\n\t\t\t\tok: attrs.okIcon,\n\t\t\t\tcancel: attrs.cancelIcon\n\t\t\t};\n\t\t\tscope.listClass = \"list-group\";\n\t\t\tvar inline = scope.$eval(attrs.inline);\n\t\t\tif (inline)\n\t\t\t\tscope.listClass = \"list-inline\";\n\t\t},\n\t\tcontroller: function($element, $scope) {\t\t\t\n\t\t\t// Monitor attachment list change\n\t\t\tvar questionSysId = $scope.field.sys_id;\n\t\t\t$scope.$watch('field.attachments', function(newValue, oldValue, scope) {\n\t\t\t\tif (!oldValue) {\n\t\t\t\t\t// Ignore for the first load\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Move focus back to attachment icon\n\t\t\t\t$scope.$broadcast(\"survey.attachment.list.update\", {questionSysId: questionSysId});\n\t\t\t\tif (newValue.length > oldValue.length) {\n\t\t\t\t\t// Send live message when files get uploaded\n\t\t\t\t\t$scope.$broadcast(\"survey.attachment.upload.success\", {questionSysId: questionSysId});\n\t\t\t\t} else if (newValue.length < oldValue.length) {\n\t\t\t\t\t// Send live message when files get deleted\n\t\t\t\t\t$scope.$broadcast(\"survey.attachment.delete.success\", {questionSysId: questionSysId});\n\t\t\t\t}\n\t\t\t}, true);\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"61df1653c3002200e44574e1c1d3ae44","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_61df1653c3002200e44574e1c1d3ae44","sys_updated_by":"admin","sys_created_on":"2016-06-21 23:50:07","name":"spSurveyAttachmentList","sys_name":"spSurveyAttachmentList","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"16","sys_updated_on":"2019-04-01 01:30:56","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\ttemplate: '<div ng-switch=\"field.type\">' +\n                        '<mesp-survey-date-picker ng-switch-when=\"date\" field=\"field\" sn-disabled=\"false\" ng-model=\"field.value\"></mesp-survey-date-picker>' +\n                        '<mesp-survey-date-picker ng-switch-when=\"datetime\" field=\"field\" sn-disabled=\"false\" ng-model=\"field.value\" sn-include-time=\"true\"></mesp-survey-date-picker>' +\n                       '<div ng-switch-when=\"choice\" class=\"row\">' +\n                            '<div class=\"col-xs-12 col-sm-6\" ng-class=\"{col_centered : data.isKioskSurvey}\">' +\n                                '<mesp-survey-choice-list field=\"field\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\" options=\"field.choices\" is-mobile=\"false\" class=\"hidden-xs\"></mesp-survey-choice-list>' +\n\t\t\t\t\t\t\t\t'<mesp-survey-choice-list field=\"field\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\" options=\"field.choices\" is-mobile=\"true\" class=\"visible-xs question-choice-field\"></mesp-survey-choice-list>' +\n                            '</div>' +\n\t\t\t\t\t\t\t'<mesp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></mesp-survey-add-info>' +\n\t\t\t\t\t\t\t'<mesp-survey-end-notes data=\"data\"></mesp-survey-end-notes>' +\n\t\t\t\t\t\t'</div>' +\n                        '<div ng-switch-when=\"boolean\">' +\n                            '<mesp-survey-scale field=\"field\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\"></mesp-survey-scale>' +\n                        '</div>' +\n                        '<div ng-switch-when=\"numericscale\">' +\n                            '<mesp-survey-numeric-scale field=\"field\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\" class=\"hidden-xs\"></mesp-survey-numeric-scale>' +\n                            '<mesp-survey-scale field=\"field\" class=\"visible-xs\" mobile-prefix=\"mobilePrefix\"></mesp-survey-scale>' +\n                        '</div>' +\n                        '<div class=\"row\" ng-switch-when=\"string\">' +\n                            '<div class=\"col-xs-12 col-sm-8 col-md-6\">' +\n                                '<textarea ng-if=\"field.multiLine\" rows=\"4\" name=\"{{field.name}}\" class=\"form-control type_string\" aria-label=\"{{::field.label}}\" ng-model=\"field.value\" autocomplete=\"off\">' +\n                                '</textarea>' +\n                                '<input ng-if=\"!field.multiLine\" name=\"{{field.name}}\" type=\"text\" class=\"form-control type_string type_string_single\" style=\"margin-left:0px !important;width: 98%;\" aria-label=\"{{::field.label}}\" ng-model=\"field.value\" autocomplete=\"off\" />' +\n                            '</div>' +\n                        '</div>' +\n                        '<mesp-survey-checkbox ng-switch-when=\"checkbox\" field=\"field\" mobile-prefix=\"mobilePrefix\"></mesp-survey-checkbox>' +\n                        '<mesp-survey-multiple-checkbox ng-switch-when=\"multiplecheckbox\" field=\"field\"></mesp-survey-multiple-checkbox>' +\n                        '<mesp-survey-number-field ng-switch-when=\"long\" field=\"field\"></mesp-survey-number-field>' +\n                        '<mesp-survey-number-field ng-switch-when=\"percentage\" show-percentage=\"true\" field=\"field\"></mesp-survey-number-field>' +\n                        '<mesp-survey-scale ng-switch-when=\"scale\" field=\"field\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\"></mesp-survey-scale>' +\n                        '<div ng-switch-when=\"reference\" class=\"row\">' +\n                            '<div class=\"col-xs-12 col-sm-6\">' +\n                                '<mesp-survey-reference-field field=\"field\" ng-class=\"{\\'field-has-reference\\': field.value != \\'\\', \\'field-empty-reference\\': field.value == \\'\\'}\"></mesp-survey-reference-field>' +\n                            '</div>' +\n\t\t\t\t\t\t\t'<mesp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></mesp-survey-add-info>' +\n                        '</div>' +\n                        '<mesp-survey-image-scale ng-switch-when=\"imagescale\" field=\"field\" c=\"c\" data=\"data\" is-mobile=\"false\" class=\"hidden-xs\"></mesp-survey-image-scale>' +\n\t\t\t\t\t\t'<mesp-survey-image-scale ng-switch-when=\"imagescale\" field=\"field\" c=\"c\" data=\"data\" is-mobile=\"true\" class=\"visible-xs\"></mesp-survey-image-scale>' + \n                        '<mesp-survey-ranking-select-box ng-switch-when=\"ranking\" field=\"field\"></mesp-survey-ranking-select-box>' +\n                        '<div ng-switch-when=\"attachment\" ng-init=\"c.setupAttachmentHandler(field)\">' +\n                            '<div class=\"hidden-xs\">' +\n                                '<h4 class=\"question-label\" style=\"display:inline-block;\" ng-if=\"field.type == \\'attachment\\'\">' +\n                                    '<span class=\"field-decorations\">' +\n                                        '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" ng-class=\"{\\'mandatory-filled\\': c.isMandatoryFilled(field)}\"' +\n                                        'title=\"{{::data.parameterizedMsgsMap.mandatory}}\" style=\"padding-right: .25em\" ></span>' +\n                                        '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                    '</span>' +\n                                    '{{::field.label}}' +\n                                    '<mesp-survey-attachment-button field=\"field\" attachment-handler=\"field.attachmentHandler\" style=\"margin-left:20px\"></mesp-survey-attachment-button>' +\n                                '</h4>' +\n                                '<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n                            '</div>' +\n                            '<div class=\"visible-xs row\">' +\n\t\t\t\t\t\t\t\t'<div class=\"col-xs-11\">' +\n                                    '<h4 class=\"question-label\" style=\"display:inline-block;\" ng-if=\"field.type == \\'attachment\\'\">' +\n                                        '<span class=\"field-decorations\">' +\n                                            '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" ng-class=\"{\\'mandatory-filled\\': c.isMandatoryFilled(field)}\"' +\n                                            'title=\"{{::data.parameterizedMsgsMap.mandatory}}\" style=\"padding-right: .25em\" ></span>' +\n                                            '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                        '</span>' +\n                                        '{{::field.label}}' +\n\t\t\t\t\t\t\t\t\t'</h4>' +\n\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n\t\t\t\t\t\t\t\t'</div>' +\n                                '<div class=\"col-xs-1\">' +\n                                    '<h4><mesp-survey-attachment-button field=\"field\" attachment-handler=\"field.attachmentHandler\"></mesp-survey-attachment-button></h4>' +\n                                '</div>' +\n                            '</div>' +\n                            '<mesp-survey-attachment-list></mesp-survey-attachment-list>' +\n                            '<mesp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></mesp-survey-add-info>' +\n                        '</div>' +\n                        '<div ng-switch-when=\"template\">' +\n                            '<div class=\"visible-xs\">' +\n                                '<h4 class=\"question-label\">' +\n                                    '<span class=\"field-decorations\">' +\n                                        '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" ng-class=\"{\\'mandatory-filled\\': (field.value != null && field.value != undefined && field.value != \\'\\')}\" title=\"{{::data.parameterizedMsgsMap.mandatory}}\" style=\"padding-right: .25em\" ></span>' +\n                                        '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                    '</span>' +\n                                    '{{::field.label}}' +\n                                '</h4>' +\n                                '<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n                                '<mesp-survey-scale ng-if=\"!field.template.allow_image\" field=\"field\" mobile-prefix=\"mobilePrefix\"></mesp-survey-scale>' +\n                                '<mesp-survey-image-scale ng-if=\"field.template.allow_image\" field=\"field\" c=\"c\" data=\"data\" is-mobile=\"true\"></mesp-survey-image-scale>' +\n                            '</div>' +\n                            '<div class=\"hidden-xs\">' +\n                                '<mesp-survey-template template-group=\"data.templateGroups[field.templateGroup]\" questions-map=\"data.questions.idMap\" c=\"c\" data=\"data\"></mesp-survey-template>' +\n                            '</div>' +\n                        '</div>' +\n                        '<div ng-switch-when=\"signature\">' +\n                            '<div ng-if=\"field.signType != \\'checkbox\\'\" ng-bind-html=\"field.label\"></div>' +\n                            '<div class=\"row\" ng-switch=\"field.signType\">' +\n                                '<mesp-survey-checkbox ng-switch-when=\"checkbox\" html-label=\"true\" field=\"field\" mobile-prefix=\"mobilePrefix\"></mesp-survey-checkbox>' +\n                                '<div class=\"col-xs-12 col-sm-4\" ng-switch-when=\"full_name\">' +\n                                    '<input ng-if=\"field.value != \\'\\'\" class=\"form-control\" type=\"text\" ng-model=\"field.value\" disabled />' +\n                                    '<input ng-if=\"field.value == \\'\\'\" class=\"form-control\" type=\"text\" ng-model=\"field.value\" />' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n                        '<div ng-switch-default></div>' +\n                    '</div>',\n\n        scope: {\n            field: '=',\n            data: '=',\n            c: '=',\n            mobilePrefix: '=',\n\t\t\tisMobile: '='\n\t\t}\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"63139137531323002d96ddeeff7b1258","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_63139137531323002d96ddeeff7b1258","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:41:26","name":"mespSurveyField","sys_name":"mespSurveyField","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"7","sys_updated_on":"2017-08-28 11:42:55","sys_tags":"","type":"directive","script":"function scBindHtmlCompile($compile, $sce) {\n\treturn {\n\t\trestrict: 'A',\n\t\tlink: function(scope, element, attrs) {\n\t\t\tscope.$watch(\n\t\t\t\tfunction(scope) {\n\t\t\t\t\t// watch the 'compile' expression for changes\n\t\t\t\t\treturn scope.$eval(attrs.scBindHtmlCompile);\n\t\t\t\t},\n\t\t\t\tfunction(value) {\n\t\t\t\t\t// when the 'compile' expression changes\n\t\t\t\t\t// assign it into the current DOM\n\t\t\t\t\telement.html($sce.getTrustedHtml(value) + '');\n\n\t\t\t\t\t// compile the new DOM and link it to the current\n\t\t\t\t\t// scope.\n\t\t\t\t\t// NOTE: we only compile .childNodes so that\n\t\t\t\t\t// we don't get into infinite loop compiling ourselves\n\t\t\t\t\t$compile(element.contents())(scope);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"631d65a287300300e0ef0cf888cb0ba3","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/d1c9ebbb04f12210559073c06a02f719","value":"d1c9ebbb04f12210559073c06a02f719"},"sys_update_name":"sp_angular_provider_631d65a287300300e0ef0cf888cb0ba3","sys_updated_by":"admin","sys_created_on":"2017-08-28 11:23:52","name":"scBindHtmlCompile","sys_name":"scBindHtmlCompile","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"8","sys_updated_on":"2021-02-01 09:57:37","sys_tags":"","type":"directive","script":"function(cabrillo, $rootScope, $timeout) {\n\t'use strict';\n\n\treturn {\n\t\trestrict: 'E',\n\t\tscope: {\n\t\t\t'field': '=',\n\t\t\t'attachmentHandler': '='\n\t\t},\n\t\ttemplate: function() {\n\t\t\tvar inputTemplate;\n\t\t\tif (cabrillo.isNative()) {\n\t\t\t\tinputTemplate = '<a href=\"#\" elem-id=\"{{::field.sys_id}}_attachment_add\" ng-click=\"showAttachOptions()\" class=\"panel-button sp-attachment-add\"><span class=\"glyphicon glyphicon-camera\" aria-label=\"Add a new Attachment\"></span></a>';\n\t\t\t} else {\n\t\t\t\tinputTemplate = '<label style=\"cursor:pointer; font-size:22px; margin-top:-6px; position:relative; bottom:-6px;\">' +\n\t\t\t\t\t\t\t\t\t'<input type=\"file\" style=\"display: none\" multiple=\"true\" ng-file-select=\"attachmentHandler.onFileSelect($files)\" class=\"sp-attachments-input\"/>' +\n\t\t\t\t\t\t\t\t\t'<a href=\"javascript:void(0)\" elem-id=\"{{::field.sys_id}}_attachment_add\" aria-label=\"{{::field.label}} Upload Link\" style=\"color: inherit\" ng-click=\"attachmentHandler.openSelector($event)\" class=\"sp-attachment-add\"><span class=\"glyphicon glyphicon-paperclip\"></span></a>' +\n\t\t\t\t\t\t\t\t'</label>';\n\t\t\t}\n\t\t\treturn [\n\t\t\t\t'<span class=\"file-upload-input\">',\n\t\t\t\t\tinputTemplate,\n\t\t\t\t'</span>'\n\t\t\t].join('');\n\t\t},\n\t\tcontroller: function($element, $scope) {\n\t\t\t$scope.attachmentClassNames = 'btn-default attachment-btn btn-primary icon-paperclip icon-camera list-group-btn';\n\n\t\t\t$scope.showAttachOptions = function() {\n\t\t\t\tvar handler = $scope.attachmentHandler;\n\n\t\t\t\tcabrillo.attachments.addFile(\n\t\t\t\t\thandler.tableName,\n\t\t\t\t\thandler.tableId,\n\t\t\t\t\tnull,\n\t\t\t\t\t{maxWidth: 1000, maxHeight: 1000}\n\t\t\t\t).then(function(data) {\n\t\t\t\t\thandler.getAttachmentList();\n\t\t\t\t\t$rootScope.$broadcast(\"added_attachment\");\n\t\t\t\t}, function() {\n\t\t\t\t\tconsole.log('Failed to attach new file');\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.$on('attachment_select_files', function(e) {\n\t\t\t\t$timeout(function() {\n\t\t\t\t\t$($element).find('.sp-attachments-input').click();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n}\n","sys_class_name":"sp_angular_provider","sys_id":"67745537531323002d96ddeeff7b12bc","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_67745537531323002d96ddeeff7b12bc","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:47:26","name":"mespSurveyAttachmentButton","sys_name":"mespSurveyAttachmentButton","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"4","sys_updated_on":"2021-02-01 10:22:51","sys_tags":"","type":"directive","script":"function(getTemplateUrl) {\n\t'use strict';\n\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\ttemplate: '<div ng-repeat=\"attachment in field.attachments track by $index\">' +\n\t\t\t\t\t\t\t\t'<div class=\"sp-attachment-block-single-line file-attachment row\" elem-id=\"att-{{attachment.sys_id}}\">' +\n\t\t\t\t\t\t\t    '<a class=\"col-md-1 col-sm-1 col-xs-2 view-attachment m-b-none text-center\" style=\"border: none;\" ' +\n\t\t\t\t\t\t\t        'ng-click=\"field.attachmentHandler.viewAttachment($event, attachment)\" href=\"javascript:void(0)\" title=\"View\" >' +\n\t\t\t\t\t\t\t        '<img alt=\"{{attachment.file_name}}\" ng-if=\"attachment.thumbSrc\" class=\"attachment-thumbnail img-responsive\" ng-src=\"{{attachment.thumbSrc}}\"/>' +\n\t\t\t\t\t\t\t        '<span ng-if=\"!attachment.thumbSrc\">' +\n\t\t\t\t\t\t\t            '<span class=\"glyphicon glyphicon-file text-2x\" aria-label=\"{{attachment.file_name}}\"/>' +\n\t\t\t\t\t\t\t        '</span>' +\n\t\t\t\t\t\t\t    '</a>' +\n\t\t\t\t\t\t\t    '<div class=\"col-md-5 col-sm-6 col-xs-8 file-name v-middle\" style=\"overflow:hidden;white-space:nowrap;text-overflow:ellipsis;\">' +\n\t\t\t\t\t\t\t        '<a class=\"get-attachment\" ng-click=\"field.attachmentHandler.downloadAttachment(attachment)\" ng-attr-title=\"Download {{attachment.file_name}}\" href=\"javascript:void(0)\">' +\n\t\t\t\t\t\t\t            '{{attachment.file_name}} ({{attachment.size}})' +\n\t\t\t\t\t\t\t        '</a>' +\n\t\t\t\t\t\t\t        '<input ng-keydown=\"field.attachmentHandler.onKeyDown($event, attachment)\" ng-blur=\"field.attachmentHandler.updateAttachment($event, attachment)\" style=\"display: none;\"/>' +\n\t\t\t\t\t\t\t        '<div><time><sn-time-ago timestamp=\"attachment.sys_updated_on\" /></time></div>' +\n\t\t\t\t\t\t\t    '</div>' +\n                                '<div class=\"col-md-6 col-sm-5 col-xs-2 tools v-middle hidden-xs\">' +\n                                    '<span ng-if=\"attachment.canWrite && false\" class=\"glyphicon glyphicon-pencil sp-attachment-edit wrapper-xs\" ng-click=\"field.attachmentHandler.editAttachment($event, attachment)\" title=\"Edit file name\" aria-label=\"Edit file name\"/>' +\n                                    '<span ng-if=\"attachment.canDelete\" class=\"glyphicon glyphicon-remove sp-attachment-delete wrapper-xs\" ng-click=\"field.attachmentHandler.deleteAttachment(attachment)\" title=\"Delete\" aria-label=\"Delete Attachment\"/>' +\n                                '</div>' +\n                                '<div class=\"col-md-6 col-sm-5 col-xs-2 tools v-middle text-right visible-xs\">' +\n                                    '<span ng-if=\"attachment.canDelete\" class=\"glyphicon glyphicon-remove sp-attachment-delete wrapper-xs\" ng-click=\"field.attachmentHandler.deleteAttachment(attachment)\" title=\"Delete\" aria-label=\"Delete Attachment\"/>' +\n                                '</div>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'</div>',\n\n\t\tlink: function(scope, elem, attrs, $parse) {\n\t\t\tscope.icons = {\n\t\t\t\tpreview: attrs.previewIcon,\n\t\t\t\tedit: attrs.editIcon,\n\t\t\t\tok: attrs.okIcon,\n\t\t\t\tcancel: attrs.cancelIcon\n\t\t\t};\n\n\t\t\tscope.listClass = \"list-group\";\n\t\t\tvar inline = scope.$eval(attrs.inline);\n\t\t\tif (inline)\n\t\t\t\tscope.listClass = \"list-inline\";\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"6a9c51f7531323002d96ddeeff7b1259","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_6a9c51f7531323002d96ddeeff7b1259","sys_updated_by":"admin","sys_created_on":"2019-02-05 06:23:11","name":"mespSurveyAttachmentList","sys_name":"mespSurveyAttachmentList","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"72","sys_updated_on":"2023-05-10 09:58:27","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"6f770ec25b0032003d1c484c11f91a1a","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_6f770ec25b0032003d1c484c11f91a1a","sys_updated_by":"admin","sys_created_on":"2017-01-02 21:02:37","name":"bmKpiOverviewCards","sys_name":"bmKpiOverviewCards","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"1","sys_updated_on":"2021-06-02 18:24:17","sys_tags":"","type":"directive","script":"function spLazyWidget(spUtil, $timeout) {\n\t\n\tvar CACHE = {};\n\tvar MAX_CACHE_ITEMS = 100;\n\tvar SPINNER_DELAY = 300;\n\tvar templateHtml = [\n\t\t'<div class=\"lazywidget\" ng-class=\"{loading: ctrl.loading}\">',\n\t\t'\t\t<div class=\"__spinner\">',\n\t\t'\t\t\t<i class=\"fa fa-circle-o-notch fa-2x fa-spin\" aria-hidden=\"true\"></i>',\n\t\t'\t\t</div>',\n\t\t'\t\t<sp-widget widget=\"ctrl.widgetConfig\" ng-if=\"ctrl.widgetConfig\"/>',\n\t\t'</div>'\n\t].join('');\n\t\n\tvar styles = [\n\t\t'.lazywidget > .__spinner {',\n\t\t'\t\ttext-align:center;',\n\t\t'\t\tdisplay: none;',\n\t\t'\t\tcolor: #b7b7b7;',\n\t\t'}',\n\t\t'.lazywidget.loading > .__spinner {',\n\t\t'\t\tdisplay: block;',\n\t\t'}'\n\t].join('');\n\tfunction Controller($scope) {\n\t\tthis.loading = false;\n\t\tthis.widgetConfig = null;\n\t\tthis._importWidget(this.name, this.options);\n\t}\n\tController.prototype = {\n\t\t_importWidget: function(widgetName, widgetOptions) {\n\t\t\tvar self = this;\n\t\t\tvar cachedConfig = this._getCache(widgetName, widgetOptions);\n\t\t\tif (cachedConfig) {\n\t\t\t\tthis._renderWidget(cachedConfig);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar timer = $timeout(function() {\n\t\t\t\t// show spinner only if wait is longer than 300ms\n\t\t\t\tself.loading = true;\n\t\t\t}, SPINNER_DELAY);\n\t\t\tspUtil.get(widgetName, widgetOptions).then(function(widgetConfig) {\n\t\t\t\t$timeout.cancel(timer);\n\t\t\t\tself._renderWidget(widgetConfig);\n\t\t\t\tself._setCache(widgetName, widgetOptions, widgetConfig);\n\t\t\t});\n\t\t},\n\t\t\n\t\t_renderWidget: function(widgetConfig) {\n\t\t\tthis.loading = false;\n\t\t\tthis.widgetConfig = widgetConfig;\n\t\t},\n\t\t\n\t\t_setCache: function(widgetName, widgetOptions, widgetConfig) {\n\t\t\tif (Object.keys(CACHE).length > MAX_CACHE_ITEMS) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar cacheKey = this._createCacheKey(widgetName, widgetOptions);\n\t\t\tCACHE[cacheKey] = widgetConfig;\n\t\t},\n\t\t_getCache: function(widgetName, widgetOptions) {\n\t\t\tvar cacheKey = this._createCacheKey(widgetName, widgetOptions);\n\t\t\treturn CACHE[cacheKey] || null;\n\t\t},\n\t\t_createCacheKey: function(widgetName, widgetOptions) {\n\t\t\twidgetOptions = widgetOptions || {};\n\t\t\tvar optionTokens = Object.keys(widgetOptions).sort().reduce(function(acc, key) {\n\t\t\t\tacc.push(key, JSON.stringify(widgetOptions[key]));\n\t\t\t\treturn acc;\n\t\t\t}, []);\n\t\t\treturn widgetName + ':' + optionTokens.join(':');\n\t\t}\n\t\t\n\t};\n\t\n\tfunction injectStyles() {\n\t\tvar styleEl = document.createElement('style');\n\t\tstyleEl.type = 'text/css';\n\t\tstyleEl.innerHTML = styles;\n\t\tdocument.head.appendChild(styleEl);\t\t\n\t}\n\tif(document.readyState === 'complete' || document.readyState === 'interactive') {\n\t\tinjectStyles();\n\t} else {\n\t\twindow.addEventListener(\"DOMContentLoaded\", injectStyles);\n\t}\n\t\n\treturn {\n\t\ttemplate: templateHtml,\n\t\trestrict: 'E',\n\t\tcontroller: Controller,\n\t\tscope: {},\n\t\tbindToController: {\n\t\t\tname: '<',\n\t\t\toptions: '<?'\n\t\t},\n\t\tcontrollerAs: 'ctrl'\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"7485cf38c3a0301052a7d1fc8840dded","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_update_name":"sp_angular_provider_7485cf38c3a0301052a7d1fc8840dded","sys_updated_by":"admin","sys_created_on":"2021-06-02 18:22:51","name":"spLazyWidget","sys_name":"spLazyWidget","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"16","sys_updated_on":"2024-04-18 07:12:40","sys_tags":"","type":"directive","script":"function(getTemplateUrl, snAttachmentHandler, $timeout, i18n, spAriaUtil, $rootScope, spUtil) {\n    var templateString = \t\t'<div>'+\n\t'<script type=\"text/ng-template\" id=\"/at-mentions.tpl\">' +\n    '<style>' +\n    '.user-list:hover {' +\n     'background-color: #eef8f8;' +\n     '}' +\n    '.user-list{' +\n     'padding: 10px;' +\n    '}' +\n    '.items{' +\n    'border-bottom: 1px solid #e6e9eb;' +\n    'width: 100%;' +\n    'overflow: hidden;' +\n    'text-overflow: ellipsis;' +\n    'white-space: nowrap;' +\n    'cursor: pointer;' +\n    '}' +\n    '.list{' +\n    'display:block;' +\n    'max-height: 52px;' +\n     'cursor: pointer;' +\n    '}' +\n    '</style>' +\n    '<div>'+\n    '<ul ng-if=\"items.length===1 && items[0].termLengthIsZero\" class=\"dropdown-menu scrollable-menu '+\n        'user-list\" style=\"display:block; cursor: pointer\">'+\n    '${Enter the Name of the person you want to mention}'+\n    '</ul>' +\n    '<ul ng-if=\"items.length === 0 &amp;&amp; items.loading &amp;&amp; visible\" class=\"dropdown-menu '+\n\t\t'scrollable-menu list\">' +\n    '<li class=\"user-list\">' +\n        '<span class=\"icon-loading\"></span>' +\n        '<span class=\"user-list\">${Loading...}</span></li></ul>' +\n\n        '<ul ng-if=\"items.length>0 && !items[0].termLengthIsZero\" class=\"dropdown-menu scrollable-menu block padder-t-none padder-b-none\">'+\n        '<li mentio-menu-item=\"item\" ng-repeat=\"item in items\" class=\"ng-scope ng-isolate-scope '+\n            'user-list items\">'+\n            '<div class=\"flex-row items-center\">'+\n            '<sn-avatar primary=\"item\" show-presence=\"true\"></sn-avatar>'+\n            '<span class=\"user-list flex-column\">'+\n                '<span ng-bind-html=\"item.name\"></span>'+\n                '<span ng-if=\"!item.record_is_visible\" class=\"text-muted\">${Cannot see record}</span>'+\n            '</span>'+\n            '</div>'+\n        '</li>'+\n        '</ul>'+\n\n        '<ul ng-if=\"items.length===0 && !items.loading\" class=\"dropdown-menu scrollable-menu ' +\n            'list\">'+\n        '<li class=\"user-list\">'+\n            '<p style=\"text-align:center\">${No users found}</p>'+\n        '</li>'+\n        '</ul>'+\n    '</div>'+\n        '</script>'+\n\t\t\t\t'<div ng-if=\"::accessibilityEnabled\" tabindex=\"0\" role=\"note\">'+\n\t\t\t\t\t'${In the following editor, press Alt F10 to focus on the toolbar. Press Escape to return to the editor}'+\n\t\t\t\t'</div>'+\n\t\t\t\t'<textarea ui-tinymce=\"tinyMCEOptions\"'+\n\t\t\t\t\t'name=\"{{attrs.name}}\"'+\n\t\t\t\t\t'label=\"{{attrs.name}}\"'+\n\t\t\t\t\t'ng-model=\"model\"'+\n\t\t\t\t\t'ng-model-options=\"options\"'+\n\t\t\t        'ng-change=\"onChangeModel()\" rows=\"10\" id=\"{{textareaId}}\"'+\n\t\t\t\t\t'mentio=\"\"'+\n\t\t\t\t\t'mentio-typed-term=\"typedTerm\"'+\n\t\t\t\t\t'mentio-template-url=\"/at-mentions.tpl\"'+\n\t\t\t\t\t'mentio-items=\"members\"'+\n\t\t\t\t\t'mentio-search=\"searchMembersAsync(term)\"'+\n\t\t\t\t\t'mentio-select=\"selectAtMention(item)\"'+\n\t\t\t\t\t'mentio-iframe-element=\"iframeElement\">'+\n\t\t\t\t\t'</textarea>'\n\t\t\t\t'<input ng-file-select=\"attachFiles({files: $files})\"'+\n\t\t\t\t\t'ng-click=\"$event.stopPropagation();\"'+\n\t\t\t\t\t'tabindex=\"-1\"'+\n\t\t\t\t\t'aria-hidden=\"true\"'+\n\t\t\t\t\t'multiple=\"\"'+\n\t\t\t\t\t'type=\"file\"'+\n\t\t\t\t\t'style=\"display: none;\">'+\n\t\t\t\t\t'</input>'+\n\t\t\t\t\t'</div>';\n    return {\n        template: templateString,\n        restrict: 'E',\n        replace: true,\n        scope: {\n            // for paste to attachments, either glideForm or the recordTableName should be provided\n            model: '=ngModel',\n            field: '=?',\n            options: '=ngModelOptions',\n            snBlur: '&',\n            snDisabled: '=?',\n            getGlideForm: '&glideForm',\n            ngChange: '&',\n            attachmentGuid: '=?',\n            recordTableName: '=?',\n            textId: '@?',\n            toolBar: '=?',\n            mentions: '=?'\n        },\n        controller: function($scope, $element, $attrs, $sce, nowAttachmentHandler, $animate, $rootScope, cabrillo, $timeout, snRecordWatcher, spUtil, spAriaUtil, $http, $window, snAttachmentHandler, i18n, $sanitize, snMention) {\n            var isIE11 = !!window.MSInputMethodContext && !!document.documentMode;\n            $scope.accessibilityEnabled = spAriaUtil.g_accessibility === \"true\";\n            $scope.onChangeModel = function() {\n                $timeout(function() {\n                    $scope.ngChange();\n                });\n            }\n\n            $scope.members = [];\n            $scope.members.loading = true;\n\n            function getMembersFromPageContext(members, term) {\n                var globalMembers = NOW.recordMembers || {};\n                var matching = [];\n                var memberKeys = Object.keys(globalMembers);\n                term = term.toLowerCase().trim();\n                // find record members who match the term\n                memberKeys.forEach(function(sysId) {\n                    var member = globalMembers[sysId];\n                    if ((typeof member.name !== \"undefined\" && member.name.toLowerCase().indexOf(term) == 0) || (typeof member.last_name !== \"undefined\" && member.last_name.toLowerCase().indexOf(term) == 0))\n                        matching.push(member);\n                });\n                // append members from network, avoid duplicates\n                members.forEach(function(member) {\n                    if (memberKeys.indexOf(member.sys_id) == -1)\n                        matching.push(member);\n                });\n                return matching;\n            }\n\n\n            //contains a map between a mentioned user and their sys_id\n            // WARNING: This technique isn't going to work if you mention two different people with the\n            //          same name in a single message.\n            //key: User's name\n            //value: sys_id\n            var mentionMap = {};\n\n            $scope.selectAtMention = function(item) {\n                if (item.termLengthIsZero)\n                    return (item.name || \"\") + \"\\n\";\n\n                mentionMap[item.name] = item.sys_id;\n                $rootScope.$broadcast(\"mentionID\", mentionMap);\n                console.log(\"broadcasting\");\n                return \"@[\" + item.name + \"]\";\n\n            };\n\n\n            //Debouncing the name typing input so we aren't hammering the server with requests.\n            var typingTimer;\n\t\t\tif ($scope.mentions) {\n\t\t         $scope.searchMembersAsync = function(term) {\n\t\t             $scope.members = getMembersFromPageContext([], term);\n\t\t             $scope.members.loading = true;\n\t\t             $timeout.cancel(typingTimer);\n\t\t             if (term.length === 0) {\n\t\t                 $scope.members = [{\n\t\t                     termLengthIsZero: true\n\t\t                 }];\n\t\t                 $scope.members.loading = false;\n\t\t             } else {\n\t\t                 typingTimer = $timeout(function() {\n\t\t                     snMention.retrieveMembers($scope.recordTableName, $scope.attachmentGuid, term).then(function(members) {\n\t\t                         $scope.members = getMembersFromPageContext(members, term);\n\t\t                         for (var k = 0; k < $scope.members.length; k++) {\n\t\t                             $scope.members[k].label = $scope.members[k].name;\n\t\t                         }\n\t\t                         $scope.members.loading = false;\n\t\t                     }, function() {\n\t\t                         $scope.members = getMembersFromPageContext([{\n\t\t                             termLengthIsZero: true\n\t\t                         }], term);\n\t\t                         $scope.members.loading = false;\n\t\t                     });\n\t\t                 }, 500);\n\t\t             }\n\t\t         }\n\t\t\t}\n\n            $scope.options = $scope.options || {};\n            var thisEditor = {};\n            var g_form;\n            var field;\n            if (typeof $attrs.glideForm != \"undefined\") {\n                g_form = $scope.getGlideForm();\n            }\n\n            if (typeof $attrs.field != \"undefined\") {\n                field = $scope.field;\n            }\n\n            var guID = new Date().valueOf();\n            $scope.textareaId = ($scope.textId ? $scope.textId.replace('.', '-') : 'ui-tinymce-') + guID;\n\n            var tinyMceSettings = tinyMCE && tinyMCE.DOM && tinyMCE.DOM.settings;\n            if (tinyMceSettings) {\n                tinyMceSettings.lastTinyMceId = $scope.textareaId; // holds id of last rendered tinymce instance\n                tinyMceSettings.onSetAttrib = function(args) {\n                    var elem = $(args.attrElm);\n                    if (args.attrName === 'src' && elem.is('iframe') && args.attrValue.indexOf('javascript') > -1)\n                        elem.removeAttr('src');\n                }\n            }\n\n            var langs = 'cs,de,en,es,fi,fr,fq,he,hu,it,ja,ko,nb,nl,pb,pl,pt,ru,sv,th,tr,zh,zt';\n            var userLanguage = g_lang;\n            if (!userLanguage || langs.indexOf(userLanguage) == -1)\n                userLanguage = g_system_lang;\n\n            if (!userLanguage || langs.indexOf(userLanguage) == -1)\n                userLanguage = 'en'; // if we don't have the language, fall back to english\n\n            // Language strings that need to be converted for TinyMCE to load\n            var languageMap = {\n                pb: 'pt_BR',\n                zh: 'zh_CN',\n                fr: 'fr_FR',\n                fq: 'fr_FR',\n                he: 'he_IL',\n                hu: 'hu_HU',\n                ko: 'ko_KR',\n                nb: 'nb_NO',\n                pt: 'pt_PT',\n                sv: 'sv_SE',\n                th: 'th_TH',\n                zt: 'zh_TW'\n            };\n            userLanguage = languageMap[userLanguage] || userLanguage;\n\n            var setMode = function() {\n                var isReadOnly = g_form.isReadOnly(field.name);\n                thisEditor.setMode(isReadOnly ? 'readonly' : 'design');\n                var body = thisEditor.getDoc().body;\n                body.style.backgroundColor = isReadOnly ? \"#eeeeee\" : \"#fff\";\n\n                // PRB1237925: give whole input appropriate context menu options\n                var doc = thisEditor.getDoc();\n                doc.documentElement.style.height = '90%';\n                doc.body.style.height = '90%';\n\n                $timeout(function(i18n) {\n                    body.setAttribute('contenteditable', !isReadOnly);\n                    body.setAttribute('aria-label', $scope.field.label);\n                    body.setAttribute('aria-required', $scope.field.isMandatory());\n                }, 1000); // longer timeout interval will help with visually complete performance\n            }\n\n            var updateMode = function() {\n                if (typeof thisEditor.setMode == \"function\") {\n                    if (thisEditor.getContainer()) {\n                        setMode();\n                    } else {\n                        thisEditor.on('init', function() {\n                            setMode();\n                        });\n                    }\n                } else {\n                    $timeout(updateMode, 10);\n                }\n            }\n\n            var removeScriptHost = true;\n            if (typeof g_tinymce_remove_script_host !== \"undefined\")\n                removeScriptHost = g_tinymce_remove_script_host;\n\n            var convertURLs = false;\n            if (typeof g_tinymce_convert_urls !== \"undefined\")\n                convertURLs = g_tinymce_convert_urls;\n\n            var relativeURLs = true;\n            if (typeof g_tinymce_relative_urls !== \"undefined\")\n                relativeURLs = g_tinymce_relative_urls;\n\n            function getTableAndSysId() {\n                var result = {};\n                var form = $scope.getGlideForm();\n                if (form) {\n                    var tableName = form.getTableName();\n                    var sysId = form.getSysId();\n                    if (tableName) {\n                        result.table = tableName;\n                        result.sys_id = sysId > -1 ? sysId : $scope.attachmentGuid;\n                    } else {\n                        result.table = form.recordTableName;\n                        result.sys_id = $scope.attachmentGuid || sysId;\n                    }\n                } else {\n                    result.table = $scope.recordTableName;\n                    result.sys_id = $scope.attachmentGuid;\n                }\n\n                return result;\n            }\n\n            function update() {\n                $scope.$applyAsync(function() {\n                    var rawValue = thisEditor.getContent();\n                    var textContent = thisEditor.getContent({\n                        format: 'text'\n                    }).trim();\n                    var content = (textContent || rawValue.indexOf('img') !== -1) ? rawValue : textContent;\n                    // In IE11, only on first drag drop of an image getContent({format: 'raw'}) is returning blob instead of correct src value\n                    // because of which image is incorrectly stored. As a workaround checking for blob content in src and replacing with actual content\n                    if (isIE11 && content.indexOf(\"src=\\\"blob:\") !== -1)\n                        content = thisEditor.getContent();\n\n                    $scope.model = content;\n                    if ($scope.field) {\n                        $scope.field.value = $scope.field.stagedValue = content;\n                    }\n                });\n            }\n\n\n            var toolbar = [\"bold italic underline\", \"fontfamily\", \"alignleft aligncenter alignright alignjustify\", \"bullist numlist\", \"code\"];\n            if ($scope.toolBar)\n                toolbar = $scope.toolBar;\n\n            $scope.tinyMCEOptions = {\n                init_instance_callback: function(editor) {\n                    $scope.iframeElement = editor.iframeElement;\n                },\n\t\t/**\n\t\t* Files served from glide are processed to find and replace \"${...}\".\n\t\t* This can be an issue for third party scripts/libraries that might have these as part of regular expressions.\n\t\t* We use tinymce's cache buster mechanism to append substitue = false, so that glide doesn't garble the script.\n\t\t* @see https://www.tiny.cloud/docs/configure/integration-and-setup/#cache_suffix\n\t\t*/\n\t\tcache_suffix: '?sysparm_substitute=false',\n\t\tmin_height:100,\n\t\theight: '230px',\n                theme: 'silver',\n                menubar: false,\n                language: userLanguage,\n                remove_script_host: removeScriptHost,\n                convert_urls: convertURLs,\n                relative_urls: relativeURLs,\n                statusbar: false,\n                contextmenu:false,\n                plugins: \"codesample code link lists table image powerpaste\",\n                powerpaste_html_import: 'prompt',\n                toolbar: toolbar.join(\" | \"),\n                browser_spellcheck: true,\n                setup: function(ed) {\n                    thisEditor = ed;\n\n                    ed.on('init', function() {\n                        // Remove additional properties added for tinymce dom settings postrender of tinymce\n                        if (tinyMceSettings && ed.id === tinyMceSettings.lastTinyMceId) {\n                            delete tinyMceSettings.onSetAttrib;\n                            delete tinyMceSettings.lastTinyMceId;\n                        }\n                    });\n\n                    ed.addCommand('imageUpload', function(ui, v) {\n                        $scope.clickAttachment();\n                    });\n\n                    ed.ui.registry.addButton('image', {\n                        icon: 'image',\n                        tooltip: 'Insert image',\n                        onAction: function(e) {\n                            ed.execCommand('imageUpload');\n                        },\n                        stateSelector: 'img:not([data-mce-object],[data-mce-placeholder])'\n                    });\n\n                    ed.on('blur', function() {\n                        update();\n                        if (angular.isDefined($scope.snBlur))\n                            $scope.snBlur();\n                    });\n\n                    ed.on('ProgressState', function(e) {\n                        $rootScope.$emit('$sp.html.editor.progress', e);\n                    });\n                },\n\t\timages_upload_handler: function(blobInfo) {\n                    return new Promise(function(resolve, reject) {\n                        var blob = blobInfo.blob();\n                        var fileName = blobInfo.filename();\n                        blob.file_name = \"Pasted image\" + fileName.substr(fileName.lastIndexOf(\".\"));\n                        var data = getTableAndSysId();\n                        if (data.table && data.sys_id) {\n                            thisEditor.setProgressState(true);\n                            snAttachmentHandler.create(data.table, data.sys_id).uploadAttachment(blob, null, {}).then(function(response) {\n                                resolve(\"/sys_attachment.do?sys_id=\" + response.sys_id);\n                                update();\n                                thisEditor.setProgressState(false);\n                            });\n                        } else {\n                            console.warn(\"GlideForm or table and record id is not provided\");\n                            reject();\n                        }\n                    });\n                }\n            };\n\n            if (spUtil.isMobile()) {\n                $scope.tinyMCEOptions.toolbar = _.pull(toolbar, 'image').join(' | ');\n            }\n\n            $scope.attachFiles = function(result) {\n                var data = getTableAndSysId();\n                if (data.table && data.sys_id && result.files.length) {\n                    thisEditor.setProgressState(true);\n                    snAttachmentHandler.create(data.table, data.sys_id).uploadAttachment(result.files[0], null, {}).then(function(response) {\n                        var args = tinymce.extend({}, {\n                            src: encodeURI(\"/sys_attachment.do?sys_id=\" + response.sys_id),\n                            style: \"max-width: 100%; max-height: 480px;\"\n                        });\n                        update();\n                        thisEditor.setProgressState(false);\n                        thisEditor.execCommand('mceInsertContent', false, thisEditor.dom.createHTML('img', args), {\n                            skip_undo: 1\n                        });\n                    });\n                }\n            };\n\n            // If using g_form we don't need to use watchers\n            if (g_form && field) {\n                g_form.$private.events.on('propertyChange', function(type, fieldName, propertyName) {\n                    if (fieldName != field.name)\n                        return;\n\n                    updateMode();\n                });\n\n                updateMode();\n            } else if (typeof $attrs.snDisabled != \"undefined\") {\n                $scope.$watch('snDisabled', function(newValue) {\n                    if (angular.isDefined(newValue) && typeof thisEditor.setMode == \"function\") {\n                        if (thisEditor.getContainer())\n                            thisEditor.setMode(newValue ? 'readonly' : 'design');\n                        else {\n                            thisEditor.on('init', function() {\n                                thisEditor.setMode(newValue ? 'readonly' : 'design');\n                            });\n                        }\n                    }\n                });\n            }\n\n        },\n        link: function(scope, element, attrs) {\n            scope.attrs = attrs;\n            scope.clickAttachment = function() {\n                element.find(\"input\").click();\n            };\n        }\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"75cadef20fa70010c43d008c07767e8b","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/c9f1df5787f50010e0ef0cf888cb0b2c","value":"c9f1df5787f50010e0ef0cf888cb0b2c"},"sys_update_name":"sp_angular_provider_75cadef20fa70010c43d008c07767e8b","sys_updated_by":"admin","sys_created_on":"2020-03-18 10:57:54","name":"spTiny","sys_name":"spTiny","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/c9f1df5787f50010e0ef0cf888cb0b2c","value":"c9f1df5787f50010e0ef0cf888cb0b2c"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"8","sys_updated_on":"2018-10-29 19:55:02","sys_tags":"","type":"directive","script":"function defaultTodoLine() {\n\treturn {\n\t\ttemplate :  '<div class=\"default-todo-line panel b {{tagId}}\">' +\n\t\t\t\t\t'  <span ng-if=\"caption\">' +\n\t\t\t\t\t'    <h4 class=\"todo-action-caption\">{{caption}}</h4>' +\n\t\t\t\t\t'  </span> ' +\n\t\t\t\t\t'  <span ng-if=\"state\">' +\n\t\t\t\t\t'    <div class=\"todo-action-state\">${State} {{state}} </div> ' +\n\t\t\t\t\t'  </span> ' +\n\t\t\t\t\t'  <span ng-if=\"timestamp && !completedBy && !created\" class=\"status\">' + \n\t\t\t\t\t'    ${Completed} <sn-time-ago timestamp=\"timestamp\" />' +\n\t\t\t\t\t'  </span>' +\n\t\t\t\t\t'  <span ng-if=\"timestamp && completedBy && !created\" class=\"status\">' + \n\t\t\t\t\t'    ${Completed by } {{completedBy}} <sn-time-ago timestamp=\"timestamp\" />' +\n\t\t\t\t\t'  </span>' +\n\t\t\t\t\t'  <span ng-if=\"timestamp && created\" class=\"status\">' + \n\t\t\t\t\t'    ${Created} <sn-time-ago timestamp=\"timestamp\" />' +\n\t\t\t\t\t'  </span>' +\n\t\t\t\t\t'  <span ng-if=\"link && linkCaption\">' +\n\t\t\t\t\t'    <h5><a href=\"{{link}}\" target=\"_blank\">{{linkCaption}}</a></h5>' +\n\t\t\t\t\t'  </span>' +\n\t\t\t\t\t'</div>',\n\t\trestrict :  'E',\n\t\treplace :   true,\n\t\tscope :     {\n\t\t\t\t\t\ttimestamp : \"=\",\n\t\t\t\t\t\tcompletedBy : \"@\",\n\t\t\t\t\t\tcreated : \"@\",\n\t\t\t\t\t\tcaption : \"@\",\n\t\t\t\t\t\tstate: \"@\",\n\t\t\t\t\t\tlink : \"@\",\n\t\t\t\t\t\tlinkCaption : \"@\", \n\t\t\t\t\t\ttagId : \"@\"\n\t\t\t\t\t},\n\t\tlink :      function(scope) {\n\t\t\t\t\t\tif(!scope.tagId)\n\t\t\t\t\t\t\tscope.tagId = 'task-completed';\n\t\t\t\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"7927d0b27368230030f331d7caf6a7fd","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_update_name":"sp_angular_provider_7927d0b27368230030f331d7caf6a7fd","sys_updated_by":"admin","sys_created_on":"2018-09-18 05:52:00","name":"defaultTodoLine","sys_name":"defaultTodoLine","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"40","sys_updated_on":"2021-04-27 11:38:51","sys_tags":"","type":"directive","script":"function($timeout, $rootScope) {\n\treturn {\n\t\ttemplate:\n\t\t'<div>' +\n\t\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<fieldset class=\"radio\" role=\"radiogroup\">' +\n\t\t\t\t\t'<legend class=\"sr-only\">' +\n\t\t\t\t\t\t'<span ng-if=\"field.mandatory && !field.value\">${Required} - </span>' +\n\t\t\t\t\t\t'<span ng-if=\"field.mandatory && field.value\">${Required filled} - </span>' +\n\t\t\t\t\t\t'<span>{{c.getAriaLabel(field)}}</span>' +\n\t\t\t\t\t\t'<span ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</span>' +\n\t\t\t\t\t'</legend>' +\n\t\t\t\t\t'<label ng-repeat=\"c in field.choices track by $index\">' +\n\t\t\t\t\t\t'<input ng-class=\"{\\'has-error\\': !field.isMandatoryFilled, \\'autofocus-error\\':!field.isMandatoryFilled}\" aria-describedby=\"details_{{field.sys_id}}\" class=\"autofocus-class\" type=\"radio\" name=\"{{field.sys_id}}\" value=\"{{c.value}}\" aria-checked=\"{{field.value == c.value}}\" ng-model=\"field.value\" ng-model-options=\"{getterSetter: true}\" ng-checked=\"field.value == c.value\" ng-disabled=\"c.isDisabled || field.isReadonly()\" ng-change=\"c.isDisabled || selectChoice(c)\"/>' +\n\t\t\t\t\t\t'<span class=\"sps-radio-label\" style=\"margin-right: 1rem;\">{{c.label}}</span>' +\n\t\t\t\t\t'</label>'+\n\t\t\t\t'</fieldset>' +\n\t\t\t\t\t'<sp-survey-end-notes data=\"data\">' +\n\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n\t\t'</div>',\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\trequire: '?ngModel',\n\t\tscope: {\n\t\t\t'field': '=',\n\t\t\t'mobilePrefix': '=',\n\t\t\t'data': '=',\n\t\t\t'c': '='\n\t\t},\n\t\tcontroller: function($scope) {\n\t\t\t$scope.selectChoice = function(choice) {\n\t\t\t\tif ($scope.data.isKioskSurvey) {\n\t\t\t\t\tfor (var i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice1 = $scope.field.choices[i];\n\t\t\t\t\t    choice1.isDisabled = true;\n\t\t\t\t}\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Update isMandatoryFilled\n\t\t\t   $scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\n\t\t\t}\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"811ce176c3331200e44574e1c1d3ae38","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_811ce176c3331200e44574e1c1d3ae38","sys_updated_by":"admin","sys_created_on":"2016-06-07 20:33:29","name":"spSurveyNumericScale","sys_name":"spSurveyNumericScale","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"2","sys_updated_on":"2023-06-30 07:37:34","sys_tags":"","type":"service","script":"function recentlyViewedFavorites($http) {\n    this.updateLastViewedForFavorite = function(table, recordId) {\n        $http.post('/api/sn_ex_sp/recent_favorites_api?table=' + table + '&recordId=' + recordId).then(function(response) {\n            return response.status;\n        });\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"8121a8e0777f2110fedf8bb7cb5a9967","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_update_name":"sp_angular_provider_8121a8e0777f2110fedf8bb7cb5a9967","sys_updated_by":"admin","sys_created_on":"2023-06-29 13:43:26","name":"recentlyViewedFavorites","sys_name":"recentlyViewedFavorites","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2019-02-05 06:00:36","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\ttemplate: '<div>' +\n\t\t\t\t\t'<table class=\"table hidden-xs\" style=\"margin-bottom:0\">' +\n\t\t\t\t\t\t'<thead>' +\n\t\t\t\t\t\t\t'<tr>' +\n\t\t\t\t\t\t\t\t'<td ng-style=\"{width: questionWidth + \\'%\\'}\" style=\"border-top:0; padding-left:0\"><h4 class=\"question-label\" style=\"margin:0;margin-top:-1px\">${Question}</h4></td>' +\n\t\t\t\t\t\t\t\t'<td class=\"sps-radio-label text-center\" ng-style=\"{width: (100 - questionWidth) + \\'%\\'}\">' +\n\t\t\t\t\t\t\t\t\t'<div style=\"display:inline-block;border-top:0;\" ng-repeat=\"c in templateGroup.choices track by $index\" ng-style=\"{width: choiceWidth + \\'%\\'}\">{{::c}}</div>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'</thead>' +\n\t\t\t\t\t\t'<tbody>' +\n\t\t\t\t\t\t\t'<tr ng-repeat=\"qid in templateGroup.questions track by $index\">' +\n\t\t\t\t\t\t\t\t'<td ng-style=\"{width: questionWidth + \\'%\\'}\" style=\"padding-left:0\" ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\">' +\n\t\t\t\t\t\t\t\t\t'<label class=\"sps-radio-label\">' +\n\t\t\t\t\t\t\t\t\t\t'<span class=\"field-decorations\">' +\n\t\t\t\t\t\t\t\t\t\t'<span ng-show=\"questionsMap[qid].mandatory\" class=\"fa fa-asterisk mandatory\" ng-class=\"{\\'mandatory-filled\\': (questionsMap[qid].value != null && questionsMap[qid].value != undefined && questionsMap[qid].value != \\'\\')}\" title=\"{{::data.parameterizedMsgsMap.mandatory}}\" style=\"padding-right: .25em\" ></span>' +\n\t\t\t\t\t\t\t\t\t\t'<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t'{{::questionsMap[qid].label}}' +\n\t\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::questionsMap[qid].details\" ng-bind-html=\"questionsMap[qid].details\"></div>' +\n\t\t\t\t\t\t\t\t\t'</label>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t\t'<td class=\"text-center\" ng-style=\"{width: (100 - questionWidth) + \\'%\\'}\" ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\">' +\n\t\t\t\t\t\t\t\t\t'<div style=\"display:inline-block;\" ng-style=\"{width: choiceWidth + \\'%\\'}\" ng-repeat=\"c in questionsMap[qid].template.choices track by $index\">' +\n\t\t\t\t\t\t\t\t\t\t'<input ng-if=\"!questionsMap[qid].template.allow_image\" aria-label=\"{{::c.label}}\" aria-checked=\"{{questionsMap[qid].value == c.value}}\" ng-checked=\"questionsMap[qid].value == c.value\" ng-click=\"questionsMap[qid].value = c.value\" type=\"radio\" value=\"{{::c.value}}\" />' +\n\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].template.allow_image && questionsMap[qid].selectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"!questionsMap[qid].unSelectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<img src=\"{{c.selected_image}}?t=small\" alt=\"{{::c.label}}\" style=\"width:64px; height:64px; margin-bottom:12px\" ng-click=\"selectChoice(questionsMap[qid], c)\" ng-style=\"{\\'opacity\\' : (c.value == questionsMap[qid].value) ? \\'1\\' : \\'0.5\\'}\" tabindex=\"0\" class=\"tab_focus\"/>' +\n\t\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].unSelectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<img src=\"{{c.image}}?t=small\" alt=\"{{::c.label}}\" style=\"width:64px; height:64px; margin-bottom:12px\" ng-click=\"selectChoice(questionsMap[qid], c)\" tabindex=\"0\" class=\"tab_focus\"/>' +\n\t\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].template.allow_image && !questionsMap[qid].selectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<input aria-label=\"{{::c.label}}\" aria-checked=\"{{questionsMap[qid].value == c.value}}\" ng-checked=\"questionsMap[qid].value == c.value\" ng-click=\"questionsMap[qid].value = c.value\" type=\"radio\" value=\"{{::c.value}}\" />' +\n\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'</tbody>' +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'<table class=\"table visible-xs\" style=\"margin-bottom:0\">' +\n\t\t\t\t\t\t'<tbody ng-repeat=\"qid in templateGroup.questions track by $index\">' +\n\t\t\t\t\t\t\t'<tr ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\">' +\n\t\t\t\t\t\t\t\t'<th style=\"border-top:0\">' +\n\t\t\t\t\t\t\t\t\t'{{::questionsMap[qid].label}}' +\n\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::questionsMap[qid].details\" ng-bind-html=\"questionsMap[qid].details\"></div>' +\n\t\t\t\t\t\t\t\t'</th>' +\n\t\t\t\t\t\t\t\t'<th style=\"border-top:0\"></th>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t\t'<tr ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\" ng-repeat=\"c in questionsMap[qid].template.choices track by $index\">' +\n\t\t\t\t\t\t\t\t'<td>{{::c.label}}<div class=\"details-text\" ng-if=\"::questionsMap[qid].details\" ng-bind-html=\"questionsMap[qid].details\"></div></td>' +\n\t\t\t\t\t\t\t\t'<td>' +\n\t\t\t\t\t\t\t\t\t'<input ng-if=\"!questionsMap[qid].template.allow_image\" aria-label=\"{{::c.label}}\" aria-checked=\"{{questionsMap[qid].value == c.value}}\" ng-checked=\"questionsMap[qid].value == c.value\" ng-click=\"questionsMap[qid].value = c.value\" type=\"radio\" value=\"{{::c.value}}\" />' +\n\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].template.allow_image\">' +\n\t\t\t\t\t\t\t\t\t\t'<img src=\"{{c.image}}?t=small\" alt=\"{{::c.label}}\" ng-click=\"selectChoice(questionsMap[qid], c)\" ng-style=\"{\\'opacity\\' : (c.value == questionsMap[qid].value) ? \\'1\\' : \\'0.5\\'}\" />' +\n\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'</tbody>' +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'</div>',\n\n\t\tscope: {\n\t\t\ttemplateGroup: '=',\n\t\t\tquestionsMap: '=',\n\t\t\tdata: '=',\n\t\t\tc: '='\n\t\t},\n\n\t\tcontroller: function($scope) {\n\t\t\tvar numChoices = $scope.templateGroup.choices.length;\n\t\t\tif (numChoices > 0 && numChoices <= 5) {\n\t\t\t\t$scope.questionWidth = 40;\n\t\t\t\t$scope.choiceWidth = 100 / numChoices;\n\t\t\t} else if (numChoices > 5 && numChoices <= 15) {\n\t\t\t\t$scope.questionWidth = 25;\n\t\t\t\t$scope.choiceWidth = 100 / numChoices;\n\t\t\t} else {\n\t\t\t\t$scope.questionWidth = 25;\n\t\t\t\t$scope.choiceWidth = 9;\n\t\t\t}\n\n\t\t\tvar unselectChoice = function(choice) {\n\t\t\t\tchoice.image = choice.unselected_image;\n\t\t\t};\n\n\t\t\tvar unselectAllChoices = function(question) {\n\t\t\tif (!question.selectedImageOnly)\n\t\t\t\tquestion.template.choices.forEach(unselectChoice);\n\t\t\telse\n\t\t\t\tquestion.template.choices.forEach(function(choice){choice.image = choice.selected_image});\n\t\t\t};\n\n\t\t\tvar unselectAllChoicesAllQuestions = function() {\n\t\t\t\t$scope.templateGroup.questions.map(function(qid) {return $scope.questionsMap[qid]}).forEach(unselectAllChoices);\n\t\t\t};\n\n\t\t\t$scope.selectChoice = function(question, choice) {\n\t\t\t\tquestion.value = choice.value;\n\t\t\t\tif (question.unSelectedImageAllPresent) {\n\t\t\t\t\tquestion.template.choices.forEach(unselectChoice);\n\t\t\t\t\tchoice.image = choice.selected_image;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar loadChoices = function(question) {\n\t\t\t\tquestion.template.choices.forEach(function(choice) {\n\t\t\t\t\tif (!question.selectedImageOnly && question.value == choice.value) {\n\t\t\t\t\t\tchoice.image = choice.selected_image;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// Do it the first time so that all images show up\n\t\t\tunselectAllChoicesAllQuestions();\n\t\t\t$scope.templateGroup.questions.map(function(qid) {return $scope.questionsMap[qid]}).forEach(loadChoices);\n\t\t},\n\n\t\treplace: true\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"82a71d77531323002d96ddeeff7b12d9","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_82a71d77531323002d96ddeeff7b12d9","sys_updated_by":"admin","sys_created_on":"2019-02-05 06:00:36","name":"mespSurveyTemplate","sys_name":"mespSurveyTemplate","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"1","sys_updated_on":"2019-03-08 11:59:08","sys_tags":"","type":"service","script":"function ActsubRestService($http, $q) {\n\t//CONSTANTS\n\tvar ActsubConst = {};\n\tActsubConst.PREF_MAPPING_FIELD = 'source_table';\n\tActsubConst.NOTI_MAPPING_FIELD = 'table_name';\n\t\n\t//Private members\n\tvar actSubApiBaseUrl = '/api/now/v1/actsub/',\n\t\tlegacyApiBaseUrl = '/api/now/v1/notification/',\n\t\tdata;\n\n\t//Public members\n\treturn {\n\t\tinit: init,\n\t\tgetPreferences: getPreferences,\n\t\tsavePreferences: savePreferences,\n\t\ttoggleAllNotifications: toggleAllNotifications,\n\t\tgetUserNotificationState: getUserNotificationState\n\t};\n\t\n\t//init\n\tfunction init (dataObj) {\n\t\tdata = dataObj;\n\t}\n\n\tfunction _httpService(url, method, payLoad){\n\t\treturn $http({\n\t\t\tmethod: method,\n\t\t\turl: url,\n\t\t\tdata: payLoad\n\t\t});\n\t}\n\n\tfunction getPreferences (subObj) {\n\t\tif (!subObj)\n\t\t\treturn;\n\t\tvar resourceUrl = actSubApiBaseUrl + 'preferences/' + data.liveProfileId + '?subObject=' + subObj.sys_id;\n\t\tif (subObj.framework == 'legacy')\n\t\t\tresourceUrl = legacyApiBaseUrl + 'preference?category=' + subObj.noti_category + '&sysparm_limit=100&sysparm_offset=0';\n\t\treturn _httpService(resourceUrl, 'GET')\n\t\t\t.then(function (resp) {\n\t\t\treturn _transformPerfResponse(resp.data, subObj);\n\t\t});\n\t}\n\n\tfunction _transformPerfResponse (resp, subObj) {\n\t\tvar retObj = {},\n\t\t\tpopulateChannels = true;\n\t\tretObj.activities = [];\n\t\tdata.user_channels = data.user_channels || {};\n\t\tif (subObj.framework == 'legacy') {\n\t\t\tresp.result.preferences.forEach(function (pref) {\n\t\t\t\tif (subObj[ActsubConst.NOTI_MAPPING_FIELD] != pref.notification[ActsubConst.PREF_MAPPING_FIELD])\n\t\t\t\t\treturn;\n\t\t\t\tvar act = {};\n\t\t\t\tact.activity_type_id = pref.notification.sys_id;\n\t\t\t\tact.label = pref.name;\n\t\t\t\tact.pref_code = {};\n\t\t\t\tact.pref_meta = {};\n\t\t\t\tif (pref.records.length) {\n\t\t\t\t\tact.pref_meta.table = pref.records[0].table;\n\t\t\t\t\tact.pref_meta.sys_id = pref.records[0].sys_id;\n\t\t\t\t}\n\t\t\t\tpref.records.forEach(function (pRec) {\n\t\t\t\t\tif (pRec.channel.name.toLowerCase() == 'primary email') {\n\t\t\t\t\t\tif (!pRec.channel.active)\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\tact.pref_code.email = pRec.active;\n\t\t\t\t\t\tif (populateChannels)\n\t\t\t\t\t\t\tdata.user_channels.email = pRec.channel.sys_id;\n\t\t\t\t\t}\n\t\t\t\t\telse {//sms, push etc possible\n\t\t\t\t\t\tact.pref_code[pRec.channel.name] = pRec.active;\n\t\t\t\t\t\tif (populateChannels)\n\t\t\t\t\t\t\tdata.user_channels[pRec.channel.name] = pRec.channel.sys_id;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpopulateChannels = false;\n\t\t\t\tretObj.activities.push(act);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tresp.result.preferences.activities.forEach(function (activity) {\n\t\t\t\tvar act = {};\n\t\t\t\tact.activity_type_id = activity.activity_type_id;\n\t\t\t\tact.label = activity.label;\n\t\t\t\tact.pref_code = {};\n\t\t\t\tif (activity.pref_code.user_default == 1)\n\t\t\t\t\tact.pref_code.email = true;\n\t\t\t\telse\n\t\t\t\t\tact.pref_code.email = false;\n\t\t\t\tretObj.activities.push(act);\n\t\t\t});\n\t\t\tretObj.user = resp.result.preferences.user;\n\t\t\tretObj.sub_object = resp.result.preferences.sub_object;\n\t\t}\n\t\t\n\t\treturn retObj;\n\t}\n\t\n\tfunction savePreferences (acts, sub) {\n\t\tif (sub.framework == 'legacy')\n\t\t\treturn _saveNotiPref(acts);\n\t\telse\n\t\t\treturn _saveActPref(acts, sub);\n\t\t\t\n\t}\n\n\tfunction _saveNotiPref (acts) {\n\t\tvar resourceUrl = legacyApiBaseUrl + 'preference',\n\t\t\t\tpayLoad, promises = [];\n\t\t acts.forEach(function (act) {\n\t\t\t payLoad = {};\n\t\t\t payLoad.preference = {};\n\t\t\t payLoad.preference.notification_id = act.activity_type_id;\n\t\t\t payLoad.preference.channel_id = data.user_channels.email;\n\t\t\t payLoad.preference.active = act.pref_code.email;\n\t\t\t payLoad.preference.table = act.pref_meta.table;\n\t\t\t payLoad.preference.sys_id = act.pref_meta.sys_id;\n\t\t\t promises.push(_httpService(resourceUrl, 'POST', payLoad).then(function (res) {\n\t\t\t\t if (!act.pref_meta.sys_id)\n\t\t\t\t\t act.pref_meta.sys_id = res.data.result.records[0].sys_id;\n\t\t\t }));\t\n\t\t });\n\t\treturn $q.all(promises);\n\t}\n\t\n\tfunction _saveActPref(acts, subObj) {\n\t\tvar resourceUrl = actSubApiBaseUrl + 'preferences',\n\t\t\t\tpayLoad = {};\n\t\tpayLoad.user = subObj.genPreferences.user;\n\t\tpayLoad.sub_object = {};\n\t\tpayLoad.sub_object.sys_id = subObj.sys_id;\n\t\tpayLoad.sub_object.activities = [];\n\t\tacts.forEach(function (act) {\n\t\t\tvar obj = {};\n\t\t\tobj.activity_type_id = act.activity_type_id;\n\t\t\tobj.preferences = {\n\t\t\t\t\"default\" : act.pref_code.email ? 1 : 0\n\t\t\t};\n\t\t\tpayLoad.sub_object.activities.push(obj);\n\t\t});\n\n\t\treturn _httpService(resourceUrl, 'POST', payLoad).then(function (resp) {\n\t\t\treturn resp.data;\n\t\t});\t\n\t}\n\t\n\tfunction toggleAllNotifications (value, onlyActsub) {\n\t\tvar promises = [],\n\t\t\t\tresourceUrl, payLoad;\n\t\t/* As per PM, no need to disable Notifications at Profile level.\n\t\tif (!onlyActsub) {\n\t\t\t//Legacy Notifications\n\t\t\tpayLoad = {\"enable_notifications\": value};\n\t\t\tresourceUrl = legacyApiBaseUrl + 'preference/all';\n\t\t\tpromises.push(_httpService(resourceUrl, 'POST', payLoad));\n\t\t}\n\t\t*/\n\t\tif (data.liveProfileId) {\n\t\t\t//Actsub Notifications\n\t\t\tpayLoad = {\"stream_name\": \"Notification\", \"fanout\": value};\n\t\t\tresourceUrl = actSubApiBaseUrl + 'userstream/'+ data.liveProfileId;\n\t\t\tpromises.push(_httpService(resourceUrl, 'PUT', payLoad));\n\t\t}\n\t\t\n\t\treturn $q.all(promises);\n\t}\n\t\n\tfunction getUserNotificationState () {\n\t\tdata.user_channels = data.user_channels || {};\n\t\t//get User level state\n\t\treturn _httpService(legacyApiBaseUrl + 'preference/channel', 'GET').then(function (resp) {\n\t\t\tresp = resp.data;\n\t\t\tdata.enable_notifications = resp.result ? resp.result.enable_notifications : true;\n\t\t\tif (resp.result && resp.result.channels && resp.result.channels.length) {\n\t\t\t\tresp.result.channels.forEach(function (ch) {\n\t\t\t\t\tif (ch.name.toLowerCase() == 'primary email')\n\t\t\t\t\t\tdata.user_channels.email = ch.sys_id;\n\t\t\t\t\telse\n\t\t\t\t\t\tdata.user_channels[ch.name] = ch.sys_id;\n\t\t\t\t});\n\t\t\t}\n\t\t//then adjust fan_out state according to user preference.\n\t\t\tif (data.fanout_to_stream != data.enable_notifications)\n\t\t\t\ttoggleAllNotifications(!data.fanout_to_stream, true);\n\t\t});\n\t}\n\t\n\t\n}//End","sys_class_name":"sp_angular_provider","sys_id":"8d024d7d14f3a700964f3805bcf69fab","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/27dc6bfb04352210559073c06a02f739","value":"27dc6bfb04352210559073c06a02f739"},"sys_update_name":"sp_angular_provider_8d024d7d14f3a700964f3805bcf69fab","sys_updated_by":"maint","sys_created_on":"2019-02-23 19:57:31","name":"ActsubRestService","sys_name":"ActsubRestService","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"maint","sys_policy":""},{"sys_mod_count":"65","sys_updated_on":"2021-04-23 10:56:18","sys_tags":"","type":"directive","script":"function (i18n) {\n\t\treturn {\n\t\t\ttemplate: '<div class=\"row\">' +\n\t\t\t\t\t\t\t'<div class=\"col-xs-12 col-sm-8 col-md-6\">' +\n\t\t\t\t\t\t\t\t'<div id=\"valueIsInvalid{{field.sys_id}}\">' +\n\t\t\t\t\t\t\t\t\t'<div ng-if=\"field.invalidValue && field.fieldValidatorErrorMsg\" class=\"wrapper-xs alert alert-danger\">' +\n\t\t\t\t\t\t\t\t\t\t'{{field.fieldValidatorErrorMsg}}' +\n\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t'<div ng-if=\"!field.isMandatoryFilled\" class=\"wrapper-xs alert alert-danger\" >{{c.showMandatoryMessage()}}</div>'+\n\t\t\t'</div>' +\n\t\t\t'<label for=\"{{::field.sys_id}}\" class=\"sr-only\">{{c.getAriaLabel(field)}} {{field.value}}</label>' +\n\t\t\t\t\t\t\t\t'<textarea id=\"{{::field.sys_id}}\" aria-describedby=\"details_{{field.sys_id}} valueIsInvalid{{field.sys_id}} notAnswered{{field.sys_id}}\" aria-invalid=\"{{field.invalidValue || !field.isMandatoryFilled}}\" ng-class=\"{\\'has-error\\': field.invalidValue || !field.isMandatoryFilled, \\'autofocus-error\\':field.invalidValue || !field.isMandatoryFilled}\" ng-if=\"field.multiLine\" rows=\"4\" name=\"{{field.name}}\" class=\"form-control autofocus-class\" ng-readonly=\"field.readOnly\" ng-model=\"field.value\" autocomplete=\"off\" ng-change=\"clearinvalid()\" aria-required=\"{{::field.mandatory}}\">' +\n\t\t\t\t\t\t\t\t'</textarea>' +\n\t\t\t\t\t\t\t\t'<input id=\"{{::field.sys_id}}\" aria-describedby=\"details_{{field.sys_id}} valueIsInvalid{{field.sys_id}} notAnswered{{field.sys_id}}\" aria-invalid=\"{{field.invalidValue || !field.isMandatoryFilled}}\" ng-class=\"{\\'has-error\\':field.invalidValue || !field.isMandatoryFilled, \\'autofocus-error\\':field.invalidValue || !field.isMandatoryFilled}\" ng-if=\"!field.multiLine\" name=\"{{field.name}}\" type=\"text\" class=\"form-control autofocus-class\" ng-readonly=\"field.readOnly\" ng-model=\"field.value\" autocomplete=\"off\" ng-change=\"clearinvalid()\" aria-required=\"{{::field.mandatory}}\"/>' +\n\t\t\t                '</div>' +\n\t\t\t\t\t  '</div>',\n\n\t\t\tscope: {\n\t\t\t\t\t'field': '=',\n\t\t\t\t\t'data': '=',\n\t\t\t\t\t'c': '='\n\t\t\t},\n\n\t\t\tcontroller: function($scope) {\n\t\t\t\t$scope.pagination = $scope.c.data.pagination;\n\t\t\t\t$scope.clearinvalid = function() {\n\t\t\t\t\t// Updatge isMandatoryFilled\n\t\t\t\t\t$scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\t\t\t\t\t$scope.field.invalidValue = false;\n\t\t\t\t};\n\t\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"8df1c841533200102bd0ddeeff7b12cc","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_8df1c841533200102bd0ddeeff7b12cc","sys_updated_by":"admin","sys_created_on":"2020-02-04 06:34:01","name":"spSurveyStringField","sys_name":"spSurveyStringField","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2019-02-05 05:59:14","sys_tags":"","type":"directive","script":"function($rootScope) {\n\treturn {\n\t\ttemplate: '<div>' +\n\n\t\t\t\t\t'<div class=\"wrapper-xs row hidden-xs\" ng-class=\"{single_question_survey_image: data.isKioskSurvey}\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"c in field.choices track by $index\" class=\"col-xs-6  wrapper-xs text-center\" ng-class=\"{\\'col-sm-2\\': !data.isKioskSurvey, \\'col-sm-3\\': data.isKioskSurvey, \\'col-md-2\\': data.isKioskSurvey}\" style=\"display:inline-block;\">' +\n\t\t\t\t\t\t\t'<div ng-if=\"(c.selected_image)\">' +\n\t\t\t \t\t\t\t\t'<div ng-if=\"(!field.unSelectedImageAllPresent)\">' +\n\t\t\t \t\t\t\t\t\t'<img src=\"{{c.image}}?t=small\" alt=\"{{::c.label}}\" ng-class = \"{\\'img_size\\' : !data.isKioskSurvey}\" ng-style=\"{\\'opacity\\':c.opacity}\" ng-click=\"c.isDisabled || selectChoice(c)\" ng-disabled=\"{{c.isDisabled}}\" style=\"margin-bottom:12px;\"/>' +\n\t\t\t\t\t\t\t\t\t'<button style=\"overflow: hidden; text-overflow: ellipsis; font-weight:bold\" class=\"btn btn_one_click\"   ng-if=\"c.value == field.value && data.isKioskSurvey\" ng-click=\"selectChoice(c)\" ng-disabled=\"{{c.isDisabled}}\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t\t '<button style=\"overflow: hidden; text-overflow: ellipsis;\" class=\"btn btn-block\" ng-class=\"c.value == field.value ? \\'btn-primary\\' : \\'btn-default\\'\" ng-if=\"!data.isKioskSurvey\" ng-click=\"selectChoice(c)\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t\t'<sp-survey-end-notes data=\"data\" ng-if=\"c.value == field.value\">' +\n\t\t\t\t\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t    \t'<div ng-if=\"(field.unSelectedImageAllPresent)\">' +\n\t\t\t\t\t\t    \t   '<img src=\"{{c.image}}?t=small\" alt=\"{{::c.label}}\" ng-class = \"{\\'img_size\\' : !data.isKioskSurvey}\" ng-click=\"c.isDisabled || selectChoice(c)\" ng-disabled=\"{{c.isDisabled}}\" style=\"margin-bottom:12px;\" ng-style=\"{\\'opacity\\':c.opacity}\"/>' +\n\t\t\t\t\t\t\t\t   '<button style=\"overflow: hidden; text-overflow: ellipsis; font-weight:bold\" class=\"btn btn_one_click\" ng-if=\"c.value == field.value && data.isKioskSurvey\" ng-click=\"selectChoice(c)\" ng-disabled=\"{{c.isDisabled}}\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t   '<button style=\"overflow: hidden; text-overflow: ellipsis;\" class=\"btn btn-block\" ng-class=\"c.value == field.value ? \\'btn-primary\\' : \\'btn-default\\'\" ng-if=\"!data.isKioskSurvey\" ng-click=\"selectChoice(c)\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t\t'<sp-survey-end-notes data=\"data\" ng-if=\"c.value == field.value\">' +\n\t\t\t\t\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'<div ng-if=\"(!c.selected_image)\" style=\"margin: auto;\">' +\n\t\t\t\t\t\t\t\t'<div ng-click=\"c.isDisabled || selectChoice(c)\" ng-disabled=\"{{c.isDisabled}}\" style=\"margin: auto; overflow: hidden; text-overflow: ellipsis; line-height: 64px; align: center; vertical-align: middle; border: 1px solid black; width: 64px; text-align: center; height: 64px; vertical-align: middle; margin-bottom: 12px;\"  title=\"{{::c.label}}\">{{::c.label}}</div>' +\n\t\t\t\t\t\t\t\t'<button style=\"overflow: hidden; text-overflow: ellipsis;\" class=\"btn btn-block\" ng-class=\"c.value == field.value ? \\'btn-primary\\' : \\'btn-default\\'\" ng-click=\"selectChoice(c)\" ng-if=\"!data.isKioskSurvey\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t'<button style=\"overflow: hidden; text-overflow: ellipsis;font-weight:bold\" class=\"btn\"  ng-click=\"selectChoice(c)\" ng-if=\"c.value == field.value && data.isKioskSurvey\" ng-disabled=\"{{c.isDisabled}}\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t'<sp-survey-end-notes data=\"data\"  ng-if=\"c.value == field.value\">' +\n\t\t\t\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"wrapper-xs row visible-xs\">' +\n\t\t\t\t\t\t'<div class=\"col-xs-12 wrapper-sm text-center\">' +\n\t\t\t\t\t\t\t'<div ng-if=\"(mobileChoice.image)\">' +\n\t\t\t\t\t\t\t \t'<img src=\"{{mobileChoice.image}}?t=small\" title=\"{{::mobileChoice.label}}\" alt=\"{{mobileChoice.label}}\" style=\"width:64px; height:64px;\" />' +\n\t\t\t\t\t\t\t '</div>' +\n\t\t\t\t\t\t\t'<div ng-if=\"!(mobileChoice.image)\">' +\n\t\t\t\t\t\t\t \t'<div style=\"margin: auto; overflow: hidden; text-overflow: ellipsis; line-height: 52px; align: center; vertical-align: middle; border: 1px solid black; width: 64px; text-align: center; height: 52px; vertical-align: middle; margin-bottom: 12px;\" title=\"{{::mobileChoice.label}}\">{{mobileChoice.label}}</div>' +\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div ng-repeat=\"c in field.choices track by $index\" class=\"wrapper-xs text-center\">' +\n\t\t\t\t\t\t\t'<button class=\"btn btn-block\" ng-class=\"c.value == field.value ? \\'btn-primary\\' : \\'btn-default\\'\" ng-click=\"selectChoice(c)\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t'<sp-survey-end-notes data=\"data\"  ng-if=\"c.isKioskSurvey\">' +\n                             '</sp-survey-end-notes>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info && field.type != \\'template\\'\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t'</div>',\n\n\t\tscope: {\n\t\t\tfield: '=',\n\t\t\tc: '=',\n\t\t\tdata: '=',\n\t\t\tisMobile: '='\n\t\t},\n\n\t\tcontroller: function($scope) {\n\t\t\tvar unselectChoice = function(choice, firstLoad) {\n\t\t\t\tchoice.image = (choice.selected_image) ? ((!$scope.field.unSelectedImageAllPresent) ? choice.selected_image  : choice.unselected_image) : choice.selected_image;\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\tif (!$scope.field.unSelectedImageAllPresent)\n\t\t\t\t\t\tchoice.opacity = 0.5;\n\t\t\t\t\telse\n\t\t\t\t\t\tchoice.opacity = 1;\n\t\t\t\t} else {\n\t\t\t\t\t if ($scope.data.isKioskSurvey) {\n\t\t\t\t\t\t choice.isDisabled = true;\n\t\t\t\t\t\t if ($scope.field.value != choice.value)\n\t\t\t\t\t\t\t choice.opacity = 0.15;\n\t\t\t\t\t\t else\n\t\t\t\t\t\t\t choice.opacity = 1;\n\t\t\t\t\t } else {\n\t\t\t\t\t\t if (!$scope.field.unSelectedImageAllPresent) {\n\t\t\t\t\t\t\t if ($scope.field.value == choice.value)\n\t\t\t\t\t\t\t\t choice.opacity = 1;\n\t\t\t\t\t\t\t else\n\t\t\t\t\t\t\t\t choice.opacity = 0.5;\n\t\t\t\t\t\t }\n\t\t\t\t\t }\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar unselectAllChoices = function(firstLoad) {\n\t\t\t\tfor (var i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice = $scope.field.choices[i];\n\t\t\t\t\t    unselectChoice(choice, firstLoad);\n\t\t\t\t}\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\tfor (i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice = $scope.field.choices[i];\n\t\t\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\t\t\tif (!$scope.field.selectedImageOnly && $scope.field.value == choice.value) {\n\t\t\t\t\t\t\tchoice.image = choice.selected_image;\n\t\t\t\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ($scope.field.selectedImageOnly && $scope.field.value == choice.value) {\n\t\t\t\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (i === $scope.field.choices.length) {\n\t\t\t\t\t\t$scope.mobileChoice = $scope.field.choices[0];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\n\t\t\t$scope.selectChoice = function(choice) {\n\t\t\t\t$scope.field.value = choice.value;\n\t\t\t\tunselectAllChoices(false);\n\t\t\t\tif (!$scope.field.selectedImageOnly)\n\t\t\t\t\tchoice.image = choice.selected_image;\n\n\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\tif ($scope.data.isKioskSurvey && !$scope.isMobile)\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t};\n\n\t\t\t// Do it the first time so that all images show up\n\t\t\tunselectAllChoices(true);\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"8e579977531323002d96ddeeff7b1258","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_8e579977531323002d96ddeeff7b1258","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:59:14","name":"mespSurveyImageScale","sys_name":"mespSurveyImageScale","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"13","sys_updated_on":"2019-03-07 19:14:56","sys_tags":"","type":"directive","script":"function($timeout, $rootScope) {\n\treturn {\n\t\ttemplate: '<div>' +\n\t\t\t\t\t'<div class=\"hidden-xs\" ng-class=\"{scale_center: data.isKioskSurvey}\">' +\n\t\t\t\t\t\t'<div ng-repeat=\"c in field.choices track by $index\">' +\n\t\t\t\t\t\t\t'<label class=\"sps-scale-radio-label\">'+\n\t\t\t\t\t\t\t'<input type=\"radio\" name=\"{{field.name}}\" elem-id=\"{{::c.sys_id}}\" value=\"{{c.value}}\" aria-checked=\"{{field.value == c.value}}\" ng-model=\"field.value\" ng-checked=\"field.value == c.value\" ng-disabled=\"c.isDisabled || field.isReadonly()\" style=\"margin-right: 1rem;\" ng-change=\"c.isDisabled || selectChoice(c)\" />' +'{{c.label}}'+\n\t\t\t\t\t\t\t'</label>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<sp-survey-end-notes data=\"data\">' +\n\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t'<div class=\"visible-xs \">' +\n\t\t\t\t\t\t'<div ng-repeat=\"c in field.choices track by $index\" class=\"wrapper-xs\">' +\n\t\t\t\t\t\t\t'<label class=\"me-numericscale-div\">'+\n\t\t\t\t\t\t\t\t'<input class=\"me-numericscale-input\" type=\"radio\" name=\"{{field.name}}\" value=\"{{c.value}}\" ng-model=\"field.value\" ng-checked=\"field.value == c.value\" ng-change=\"field.value = c.value\" role=\"radio\" aria-checked=\"{{field.value == c.value}}\"/>' +\n\t\t\t\t\t\t\t\t'<span class=\"me-numericscale-span\" style=\"margin-right: 1rem;\">{{c.label}}</span>' +\n\t\t                        '<span ng-class=\"field.value == c.value ? \\'me-numericscale-selected\\' : \\'\\'\">' +\n\t\t\t\t\t\t\t'</label>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info && field.type != \\'template\\'\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t\t'</div>',\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\trequire: '?ngModel',\n\t\tscope: {\n\t\t\t'field': '=',\n\t\t\t'mobilePrefix': '=',\n\t\t\t'data': '=',\n\t\t\t'c': '='\n\t\t},\n\t\tcontroller: function($scope) {\n\t\t\t$scope.selectChoice = function(choice) {\n\t\t\t\tif ($scope.data.isKioskSurvey) {\n\t\t\t\t\tfor (var i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice1 = $scope.field.choices[i];\n\t\t\t\t\t    choice1.isDisabled = true;\n\t\t\t\t}\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"94d6d577531323002d96ddeeff7b1299","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_94d6d577531323002d96ddeeff7b1299","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:56:59","name":"mespSurveyScale","sys_name":"mespSurveyScale","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2020-02-18 12:05:23","sys_tags":"","type":"directive","script":"function() {\n\n    //Scroll the section to given length (domElementTop - section.scrollTop)\n    function scrollTo(section, domElementTop, duration) {\n        var start = section.scrollTop;\n        var change = domElementTop - start;\n        var currentTime = 0;\n        var increment = 20;\n        var animateScroll = function() {\n            currentTime += increment;\n            var val = easeInOutQuad(currentTime, start, change, duration);\n            section.scrollTop = val;\n            if (currentTime < duration) {\n                setTimeout(animateScroll, increment);\n            }\n        };\n        animateScroll();\n    }\n\n    function easeInOutQuad(currentTime, start, change, duration) {\n        currentTime /= duration / 2;\n        if (currentTime < 1) return change / 2 * currentTime * currentTime + start;\n        currentTime--;\n        return -change / 2 * (currentTime * (currentTime - 2) - 1) + start;\n    };\n\n    return {\n        restrict: 'A',\n        replace: true,\n        link: function(scope, element) {\n            var domEelement = element.get(0);\n            var panelElement = domEelement.querySelector(\".panel-collapse\");\n            scope.collapsing = false;\n            scope.$watch(function() {\n                return panelElement.classList.contains(\"collapsing\");\n            }, function(status) {\n                if (scope.collapsing && !status) {\n                //Only scroll the panel which is opened now.\n                    if (domEelement.classList.contains(\"panel-open\")) {\n                        var sectionElement = document.querySelector(\"section.page\")\n                        scrollTo(sectionElement, domEelement.offsetTop - 60, 200);\n                    }\n                }\n                scope.collapsing = status;\n            });\n        }\n    };\n}","sys_class_name":"sp_angular_provider","sys_id":"9d60d965b7434010ca6db0b5de11a9d3","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/d1c9ebbb04f12210559073c06a02f719","value":"d1c9ebbb04f12210559073c06a02f719"},"sys_update_name":"sp_angular_provider_9d60d965b7434010ca6db0b5de11a9d3","sys_updated_by":"admin","sys_created_on":"2020-02-18 11:50:29","name":"scAccordionScroll","sys_name":"scAccordionScroll","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"90","sys_updated_on":"2016-12-10 07:25:31","sys_tags":"","type":"directive","script":"function(spPreference) {\t\n\tvar type;\n\n\tfunction save(data, sys_id) {\n\t\tvar providers = {};\n\t\tif (data.length) {\n\t\t\tangular.forEach(data, function(codeBlock, key) {\n\t\t\t\tproviders[codeBlock.name] = codeBlock.show;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t});\n\t\t\tspPreference.set(\"wep-\" + type + \"-\" + sys_id, JSON.stringify(providers));\n\t\t}\n\t}\n\n\tfunction load(data, pref) {\n\t\tif (data.length) {\t\t\n\t\t\tvar providers = JSON.parse(pref || '{}');\t\t\t\n\t\t\tangular.forEach(data, function(item) {\n\t\t\t\titem.show = providers[item.name] || false;\t\t\t\t\t\t\t\t\n\t\t\t});\t\t\n\t\t}\t\n\t}\n\n\tfunction clear($select, options) {\n\t\tvar selectize = $select[0].selectize;\n\t\tselectize.clear();\n\t\tselectize.clearOptions();\n\t\tselectize.load(function(callback) {\n\t\t\tcallback(options);\n\t\t});\t\t\n\t}\n\n\tfunction link(scope, element) {\t\t\n\t\ttype = scope.type;\t\t\t\n\t\tvar key = 'name';\n\t\tvar config = {\n\t\t\tvalueField: key,\n\t\t\tlabelField: key,\n\t\t\tsearchField: key,\n\t\t\toptions: scope.options,\n\t\t\tallowEmptyOption: true,\n\t\t\tplaceholder: scope.label || 'Dependencies',\t\t\t\t\t\t\n\t\t\tonChange: function(value) {\n\t\t\t\tangular.forEach(scope.options, function(item) {\n\t\t\t\t\tif (item[key] === value) {\n\t\t\t\t\t\titem.show = true;\n\t\t\t\t\t\tscope.$apply();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t};\n\t\t\n\t\tvar $select = $(element).selectize(config);\n\t\t\n\t\tscope.$on('$sp.wep-' + type, function(e, action, option) {\n\t\t\tif (action === 'close') {\n\t\t\t\t$select[0].selectize.clear();\n\t\t\t\tsave(scope.options, option);\n\t\t\t}\n\n\t\t\tif (action === 'save')\n\t\t\t\tsave(scope.options, option);\n\n\t\t\tif (action === 'load')\n\t\t\t\tload(scope.options, scope.prefs);\n\t\t\t\n\t\t\tif (action === 'clear') \n\t\t\t\tclear($select, scope.options);\n\n\t\t});\n\t\t\n\t\tload(scope.options, scope.prefs);\n\t\t\n\t}\n\n\treturn {\n\t\trestrict: 'E',\n\t\tscope: {\n\t\t\toptions: '=',\n\t\t\tprefs: '=',\n\t\t\tlabel: '=',\n\t\t\ttype: '='\n\t\t},\n\t\ttemplate: '<select class=\"form-control sp-dep\"></select>',\n\t\treplace: true,\n\t\tlink: link\n\t};\n\n}","sys_class_name":"sp_angular_provider","sys_id":"a4a0401a5b2112000d7ec7ad31f91ab7","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"sys_update_name":"sp_angular_provider_a4a0401a5b2112000d7ec7ad31f91ab7","sys_updated_by":"admin","sys_created_on":"2016-02-15 03:04:08","name":"spDepManager","sys_name":"spDepManager","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"850","sys_updated_on":"2021-11-18 11:16:02","sys_tags":"","type":"directive","script":"function(i18n, $rootScope,$timeout,spAriaUtil) {\n    return {\n        template:   '<div ng-repeat=\"page in pages track by $index\" ng-if=\"checkPagination(pages, $index)\">' +\n\t\t\t\t\t\t '<div class=\"assessable-record\" ng-if=\"pagination != \\'none\\'  && (data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') \" >' +\n\t\t\t\t\t\t\t\t'<h3 class=\"metric-type-group-text\" ng-if=\"data.evaluation_method == \\'attestation_v2\\'\">'+\n\t\t\t\t\t\t\t\t\t'{{::page.assessableRecord.metricTypeGroup}}'+\n\t\t\t\t\t\t\t\t'</h3>' +\n                                '<h3 class=\"assessable-record-text\">'+\n\t\t\t\t\t\t\t\t\t'{{::page.assessableRecord.asrName}}'+ \n\t\t\t\t\t\t\t\t'</h3>' +\n\t\t\t\t\t\t'</div>' +\n                        '<div class=\"panel-heading survey-heading\" ng-if=\"pagination != \\'none\\' || $index == 0 && !data.isKioskSurvey\">' +\n                            '<h3 class=\"survey-heading-text\">' +\n                                '<a ng-if=\"::data.trigger_id && (data.evaluation_method == \\'survey\\' || data.evaluation_method == \\'quiz\\') \" class=\"survey-heading\" style=\"font-weight: 100;\" href=\"?id=ticket&table={{::data.trigger_table}}&sys_id={{::data.trigger_id}}\">{{::data.trigger_display}}&nbsp;</a>' +\n                                '<span ng-if=\"pagination == \\'none\\'\">{{::data.title}}</span>' +\n                                '<span ng-if=\"pagination != \\'none\\'\">{{page.display}}&nbsp;</span>'+\n                            '</h3>' +\n\t\t\t\t\t\t\t'<span class=\"category-description\" ng-if=\"(pagination != \\'none\\') &amp;&amp; (page.catDesc &amp;&amp; page.catDesc.length)\" >{{::page.catDesc}}</span>'+\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div class=\"text-center intro-text introduction\" ng-class=\"{\\'wrapper-md\\': !data.isKioskSurvey}\" ng-style=\"{\\'margin-top\\':data.isKioskSurvey ? \\'15px\\' : \\'\\'}\" ng-if= \"data.one_click_survey == \\'true\\' && data.introduction && data.not_show_intro_note == \\'false\\' \">' +\n\t\t\t\t\t\t\t'<span ng-bind-html=\"::data.introduction\"></span>' +\n\t\t\t\t\t\t'</div>' +\n'<div ng-class=\"{\\'wrapper-md\\': !data.isKioskSurvey}\" ng-if=\"((!data.asr[page.assessableRecord.asrId].collapsed) || page.showAsrName == \\'true\\' || pagination != \\'none\\')\">' +\n\t\t\t\t\t\t\t'<div id=\"walkup_lang_picker\" style=\"text-align: justify; text-align-last: right;\">'+\n\t\t\t\t\t\t\t\t'<label ng-if=\"data.showLanguagePicker == \\'true\\' && data.one_click_survey == \\'true\\'\" for=\"spLanguagePicker\">${Language}: </label>'+\n\t\t\t\t\t\t\t\t'<select ng-if=\"data.showLanguagePicker == \\'true\\' && data.one_click_survey == \\'true\\'\" ng-model=\"data.pickedLanguage\" name=\"spLanguagePicker\" id=\"spLanguagePicker\" '+\n\t\t\t\t\t\t\t\t\t'ng-options=\"lang.label for lang in data.languages track by lang.value\" ng-change=\"c.setLanguage()\">'+\n\t\t\t\t\t\t\t\t'</select>'+\n\t\t\t\t\t\t\t'</div>'+\n                            '<!-- Category collapse - show only in no-pagination case -->' +\n\t\t\t\t\t\t\t'<div class=\"\" ng-if=\"pagination == \\'none\\' && pages.length > 1 && (data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') &amp;&amp; page.showAsrName == \\'true\\'\" >' +\n\t\t\t\t\t\t\t\t'<h3 class=\"col-xs-11 category-label\">'+\n\t\t\t\t\t\t\t\t\t'</span>{{::page.assessableRecord.metricTypeGroup}}' +\n\t\t\t\t\t\t\t\t'</h3>' +\n                                '<h3 class=\"col-xs-11 category-label\">'+\n\t\t\t\t\t\t\t\t\t'{{::page.assessableRecord.asrName}}'+ \n\t\t\t\t\t\t\t\t'</h3>' +\n                                '<h3 class=\"col-xs-1 text-right\">' +\n                                    '<a ng-if=\"!data.asr[page.assessableRecord.asrId].collapsed\" href=\"javascript:void(0)\"><span class=\"glyphicon glyphicon-menu-down\" ng-click=\"data.asr[page.assessableRecord.asrId].collapsed = true\"></span></a>' +\n                                    '<a ng-if=\"data.asr[page.assessableRecord.asrId].collapsed\" href=\"javascript:void(0)\"><span class=\"glyphicon glyphicon-menu-right\" ng-click=\"data.asr[page.assessableRecord.asrId].collapsed = false\"></span></a>' +\n                                '</h3>' +\n                            '</div>' +\n                            '<div class=\"wrapper-sm row\" ng-if=\"pagination == \\'none\\' && pages.length > 1 && !data.asr[page.assessableRecord.asrId].collapsed\" ng-style=\"{\\'border-top\\': (($index > 0 && !(page.showAsrName == \\'true\\')) ? \\'1px solid #e6e8ea\\' : \\'\\'), \\'margin-left\\':(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') ? \\'5px\\' : \\'\\' }\">' +\n                                '<h3 class=\"col-xs-11 category-label\" ng-style=\"{\\'font-size\\':(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') ? \\'1.5em\\' : \\'\\' }\">'+\n                                '</span>{{::page.display}}' +\n\t\t\t\t\t\t\t\t'</h3>' +\n                                '<div class=\"col-xs-1 text-right h3_like\" >' +\n                                    '<button class=\"btn btn-link chevron-icon\" ng-click=\"page.collapsed = !page.collapsed\" aria-label=\"{{data.i18n.EXPAND_COLLAPSE + \\': \\' + page.display}}\" aria-expanded=\"{{!page.collapsed}}\" data-toggle=\"tooltip\" data-original-title=\"{{page.collapsed ? data.i18n.EXPAND : data.i18n.COLLAPSE}}\">' +\n\t\t\t\t\t\t\t\t\t\t'<span>' +\n\t\t\t\t\t\t\t\t\t\t\t'<i ng-if=\"!page.collapsed\" class=\"glyphicon glyphicon-menu-down\"></i>' +\n\t\t\t\t\t\t\t\t\t\t\t'<i ng-if=\"page.collapsed\" class=\"glyphicon glyphicon-menu-right\"></i>' +\n\t\t\t\t\t\t\t\t\t\t'</span>' + \n\t\t\t\t\t\t\t\t\t'</button>' +\n                                '</div>' +\n\t\t\t\t\t\t\t\t'<span style=\"margin-left:10px;\" ng-if=\"(page.catDesc &amp;&amp; page.catDesc.length)\">{{::page.catDesc}}</span>'+\n                            '</div>' +\n                            '<div id=\"category-questions-{{::page.id}}\" class=\"collapse\" ng-class=\"(data.asr[page.assessableRecord.asrId].collapsed || page.collapsed) ? \\'\\' : \\'in\\'\" ng-style=\"{\\'margin-left\\':(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') ? \\'30px\\' : \\'\\' }\">' +\n\t\t\t\t\t\t\t'<div ng-if=\"c.showIndicator(page.questions)\" style=\"margin: 2rem 0px 1.5rem;\">' +\n\t\t'<span class=\"fa fa-asterisk mandatory\" title=\"asterisk\" style=\"padding-right: .25rem\"></span>${Indicates required}</div>' +\n                                '<div ng-repeat=\"id in page.questions track by $index\" ng-init=\"field = data.questions.idMap[id]\" ng-if=\"::(data.questions.idMap[id].type != \\'template\\' || data.questions.idMap[id].template.firstQuestion == true || isMobile)\">' +\n                                    '<div class=\"wrapper-sm row\" ng-class=\" { \\'text-center\\': data.isKioskSurvey, \\'form-group\\': !data.isKioskSurvey }\" style=\"margin-left: 0\" ng-if=\"!field.depends_on || c.isAnyDependencySatisfied(field)\">' +\n                                        '<h4 class=\"question-label\" ng-if=\"field.type != \\'checkbox\\' && field.type != \\'signature\\' && field.type != \\'template\\' && field.type != \\'attachment\\'\">' +\n                                            '<span class=\"field-decorations\">' +\n                                                '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" aria-hidden=\"true\" ng-class=\"{\\'mandatory-filled\\': c.isMandatoryFilled(field)}\" style=\"padding-right: .25em\" ></span>' +\n                                                '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                            '</span>' +\n                                            '{{::field.label}}' +\n                                        '</h4>' +\n\t\t\t\t\t\t\t\t\t\t'<div id=\"details_{{field.sys_id}}\" ng-if=\"field.type != \\'checkbox\\' && field.type != \\'signature\\' && field.type != \\'template\\' && field.type != \\'attachment\\'\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n\t\t\t\t\t\t\t\t\t\t'</div>' +\n                                        '<sp-survey-field is-mobile=\"isMobile\" ng-class=\" { \\'text-center\\': data.isKioskSurvey } \" field=\"field\" data=\"data\" c=\"c\" mobile-prefix=\"mobilePrefix\"></sp-survey-field>' +\n\t\t                             '</div> <!-- end form-group -->' +\n                                '</div> <!-- end ng-repeat field in data.questions -->' +\n                            '</div>' +\n                        '</div> <!-- end wrapper-md -->' +\n                        '<!-- Nav Buttons -->' +\n                        '<div class=\"wrapper-md\" ng-if=\"pagination != \\'none\\' || $index == pages.length - 1 && !data.isKioskSurvey\">' +\n                            '<div class=\"row\">' +\n                                '<div class=\"col-xs-6 col-sm-4\" ng-if=\"!isMobile || $index > 0\">' +\n                                    '<div class=\"wrapper-xs\">' +\n                                        '<div ng-if=\"pagination == \\'none\\' || $index == 0\">' +\n                                        \t'<button class=\"btn btn-default hidden-xs\" ng-click=\"cancel(page, c.state)\">${Cancel}</button>' +\n                                        '</div>' +\n                                        '<div ng-if=\"pagination != \\'none\\' && $index > 0\">' +\n                                            '<button class=\"btn btn-default hidden-xs\" ng-click=\"previousPage(c.state)\">${Previous}</button>' +\n                                            '<button class=\"btn btn-default btn-block btn-lg visible-xs\" ng-click=\"previousPage(c.state)\">${Previous}</button>' +\n                                        '</div>' +\n                                    '</div>' +\n                                '</div>' +\n                                '<div class=\"col-xs-6 col-sm-8 text-right\" ng-class=\"(pagination != \\'none\\' && $index > 0) ? \\'\\' : \\'col-xs-12\\'\">' +\n                                    '<div class=\"wrapper-xs hidden-xs\" ng-if=\"!c.isPublic\" style=\"display:inline-block\">' +\n\t\t\t\t\t\t\t\t\t\t'<div ng-if=\"pagination == \\'none\\' || isLastPage(page)\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<button class=\"btn btn-default\" ng-click=\"stringValidation(page, c.state, \\'save\\')\">${Save}</button>' +\n\t\t\t\t\t\t\t\t\t\t'</div>' +\n                                    '</div>' +\n                                    '<div class=\"wrapper-xs\" ng-style=\"{\\'display\\': (!isMobile ? \\'inline-block\\' : \\'\\')}\">' +\n                                        '<div ng-if=\"pagination != \\'none\\' && !isLastPage(page)\">' +\n                                            '<button class=\"btn btn-primary hidden-xs\" ng-click=\"stringValidation(page, c.state, \\'next\\')\" >${Next}</button>' +\n                                            '<button class=\"btn btn-primary btn-block btn-lg visible-xs\" ng-click=\"stringValidation(page, c.state, \\'next\\')\" >${Next}</button>' +\n                                        '</div>' +\n                                        '<div ng-if=\"pagination == \\'none\\' || isLastPage(page)\">' +\n                                            '<button class=\"btn btn-primary hidden-xs\" ng-click=\"stringValidation(page, c.state, \\'submit\\')\" >${Submit}</button>' +\n                                            '<button class=\"btn btn-primary btn-block btn-lg visible-xs\" ng-click=\"stringValidation(page, c.state, \\'submit\\')\" >${Submit}</button>' +\n                                        '</div>' +\n                                    '</div>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n                    '</div> <!-- end ng-repeat category in data.categories -->' +\n                    '<!-- Survey thank you page -->' +\n                    '<div class=\"wrapper-md\" ng-if=\"(c.state === pages.length) && data.successMessage && data.successMessage.length && (!data.isKioskSurvey || isMobile)\">' +\n                        '<div class=\"text-center intro-text\">' +\n\t\t\t\t\t\t\t'<div class=\"wrapper-sm\">' +\n                               '<div class=\"outer-circle\">'+   \n\t\t\t\t\t\t\t\t\t'<span class = \"intro-icon-assessment survey-icon glyphicon icon-article-document\"ng-if=\"(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\')\"></span>'+\n\t\t\t\t\t\t\t\t\t'<span ng-if=\"(data.evaluation_method == \\'survey\\' || data.evaluation_method == \\'quiz\\')\" class=\"survey-icon glyphicon icon-form\"></span>'+\n\t\t\t\t\t\t\t\t'</div>'+\n                            '</div>' +\n                        '</div>' +\n                        '<div class=\"wrapper-sm text-center end-note\">' +\n                            '<h4 role=\"alert\" class=\"description-text\" ng-bind-html=\"trustHtml(data.successMessage)\"></h4>' +\n                        '</div>' +\n                    '</div>',\n        scope: {\n            isMobile: '=',\n            data: '=',\n            c: '='\n\t\t},\n        controller: function($scope, $sce, $timeout) {\n            var init = function() {\n\t\t\t\t$scope.pagination = $scope.data.pagination;\n            \t$scope.mobilePrefix = \"mobile-\";\n\t\t\t\t$scope.pages = [];\n\t\t\t\t$scope.c.originalAction = '';\n\t\t\t\tif($scope.c.data.evaluation_method == 'assessment' || $scope.c.data.evaluation_method == 'attestation_v2' || $scope.c.data.evaluation_method == 'risk_assessment'){\n\t\t\t\t\tif ($scope.pagination == 'question')\n\t\t\t\t\t\t\t $scope.pages = $scope.c.data.questions.idList.map(function(qid) {return {id: qid, questions: [qid], display: $scope.c.data.questions.idMap[qid].category.display, catDesc: $scope.c.data.questions.idMap[qid].category.description,assessableRecord: $scope.c.data.questions.idMap[qid].assessableRecord}});\n\t\t\t\t\t\n\t\t\t\t\telse if ($scope.pagination == 'category')\n\t\t\t\t\t\t$scope.pages = $scope.c.data.categories.idList.map(function(catid) {\n\t\t\t\t\t\t\tvar obj = $scope.c.data.categories.idMap[catid];\n\t\t\t\t\t\t\treturn {id: catid, display: obj.display, questions: obj.questions,\n\t\t\t\t\t\t\tcatDesc: obj.description, assessableRecord: obj.assessableRecord};\t\n                    });\n\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t\t$scope.pages = $scope.c.data.categories.idList.map(function(catid) {\n\t\t\t\t\t\t\tvar obj = $scope.c.data.categories.idMap[catid];\n\t\t\t\t\t\t\treturn {id: catid, display: obj.display, questions: obj.questions,\n\t\t\t\t\t\t\tcatDesc: obj.description, assessableRecord: obj.assessableRecord,showAsrName: obj.showAsrName};\t\n                    });\n\t\t\t\t} else {\n\t\t\t\t\tif ($scope.pagination == 'question')\n\t\t\t\t\t\t$scope.pages = $scope.c.data.questions.idList.map(function(qid) {return {id: qid, questions: [qid], catDesc: $scope.c.data.questions.idMap[qid].category.description,display: $scope.c.data.questions.idMap[qid].category.display}});\t\t\n\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t\t$scope.pages = $scope.c.data.categories.idList.map(function(catid) {\n\t\t\t\t\t\t\tvar category = $scope.c.data.categories.idMap[catid];\n\t\t\t\t\t\t\treturn {id: catid, display: category.display, catDesc: category.description,questions: category.questions};\n\t\t\t\t\t\t});\n\t\t\t\t}\n                var signature = $scope.c.data.signature;\n                if (signature && !$scope.c.isPublic) {\n                    if ($scope.pagination == 'none')\n                        $scope.pages[$scope.pages.length - 1].questions.push(signature.sys_id);\n                    else\n                        $scope.pages.push({id: signature.sys_id, display: $scope.c.data.title, questions: [signature.sys_id]});\n                    $scope.c.data.questions.idMap[signature.sys_id] = {\n                        type: 'signature',\n                        name: 'signature_result',\n                        label: signature.label,\n                        value: signature.value,\n                        sys_id: signature.sys_id,\n                        signType: signature.type,\n                        depends_on: ''\n                    };\n                }\n            };\n            init();\n            var mapReduceAllTrue = function(questions, callback) {\n                return questions.map(function(qid) {\n                    return callback($scope.c.data.questions.idMap[qid]);\n                }).reduce(function(x, y) {\n                    return x && y;\n                }, true);\n            };\n\t\t\t$scope.trustHtml = function(string) {\n\t\t\t\treturn $sce.trustAsHtml(string);\n\t\t\t};\n\t\t\t\n            var disableNextButtonHelper = function(page) {\n                if (!page || !page.questions || !page.questions.length)\n                    return true;\n                return !$scope.isPageValid(page) || !$scope.isPageMandatoryFilled(page);\n            };\n\t\t\t\n            $scope.disableNextButton = function(page) {\n                if ($scope.pagination == 'none')\n                    return $scope.pages.map(function(x) {return disableNextButtonHelper(x)})\n                                .reduce(function(x, y) {return x || y}, false);\n                return disableNextButtonHelper(page);\n            };\n            // Returns true if all questions within this page have a valid response\n            var isPageValidHelper = function(page) {\n                return mapReduceAllTrue(page.questions, function(question) {return !question.invalidValue});\n            };\n            $scope.isPageValid = function(page) {\n                if ($scope.pagination == 'none')\n                    return $scope.pages.map(function(x) {return isPageValidHelper(x)})\n                                    .reduce(function(x, y) {return x && y}, true);\n                return isPageValidHelper(page);\n            };\n            $scope.isSignatureFilled = function(page) {\n                if ($scope.pagination != 'none' && !page.questions.reduce(function(x, y) {return x || $scope.c.data.questions.idMap[y].type == 'signature'}, false))\n                    return true;\n                var signature = $scope.data.signature;\n                if (!signature || signature.type == 'assertion_only')\n                    return true;\n                if (signature.type == 'full_name' && !signature.validated) {\n                    signature.validationCallback = function(validated) {\n                        if (validated)\n\t\t\t\t\t\t\t$scope.submit(page, $scope.c.state);\n\t\t\t\t\t\telse\n                            $scope.c.showSignatureMessage();\n                    };\n                    $scope.c.showSignatureAuthModal();\n                    return false;\n                }\n                if (signature.type == 'checkbox') {\n                    if ($scope.c.data.questions.idMap[signature.sys_id].value != 'true')\n                        return false;\n                    else\n                        $scope.c.data.questions.idMap[signature.sys_id].value = 'checked';\n                }\n                return true;\n            };\n            // Returns true if all mandatory questions within this page are filled\n            var isPageMandatoryFilledHelper = function(page) {\n                var questionsList = page.questions.concat([]);\n                page.questions.forEach(function(qid) {\n                        var question = $scope.c.data.questions.idMap[qid];\n                        // Update isMandatoryFilled\n                        question.isMandatoryFilled = $scope.c.isMandatoryFilled(question);\t\t\t\t\t\t\n                        if (!$scope.isMobile && question.type == 'template' && question.template.firstQuestion) {\n                            var templateGroup = $scope.c.data.templateGroups[question.templateGroup];\n                            questionsList = questionsList.concat(templateGroup.questions.filter(function(tid) {return tid != qid;}));\n\t\t\t\t\t\t\t// updating template group mandatory\n\t\t\t\t\t\t\tquestion.templateMandatoryFilled = $scope.c.calculateTemplateMandatory(templateGroup);\n                        }\n                });\n                return mapReduceAllTrue(questionsList, function(question) {return !question.mandatory || $scope.c.isMandatoryFilled(question)});\n            };\n            $scope.isPageMandatoryFilled = function(page) {\n                if ($scope.pagination == 'none')\n                    return $scope.pages.map(function(x){return isPageMandatoryFilledHelper(x)})\n                                    .reduce(function(x, y) {return x && y}, true);\n                return isPageMandatoryFilledHelper(page);\n            };\n            // Saves questions\n            var saveCurrentQuestions = function(questions, action, updateSuccessMessage) {\n                var formdata = {\"sysparm_instance_id\": $scope.c.data.instanceId, \"sysparm_action\": action};\n                questions.forEach(function(qid) { $scope.c.updateQuestion(qid, formdata) });\n                formdata['percent_answered'] = $scope.c.getPercentAnswered();\n                formdata['hidden_questions'] = $scope.c.data.hiddenQuestions;\t\n\t\t\t\tformdata['original_action'] = $scope.c.data.originalAction;\t\n                if (!!updateSuccessMessage)\n                    formdata['updateSuccessMessage'] = true;\n                $scope.c.submitAjax(formdata);\n            };\n            // Saves questions on current page or all pages depending on pagination setting\n            $scope.saveCurrentPage = function(page, action, updateSuccessMessage) {\n                if ($scope.pagination == 'none')\n                    return saveCurrentQuestions($scope.pages.reduce(function(p1, p2) {return p1.concat(p2.questions)}, []), action, updateSuccessMessage);\n                else if ($scope.pagination == 'question' && !$scope.isMobile) {\n                    var question = $scope.data.questions.idMap[page.questions[0]];\n                    if (question.type == 'template')\n                        return saveCurrentQuestions($scope.data.templateGroups[question.templateGroup].questions, action, updateSuccessMessage);\n                }\n                return saveCurrentQuestions(page.questions, action, updateSuccessMessage);\n            };\n            // Get the next (or) previous navigable page\n            var nextNavigablePage = function(state, forwardDirection) {\n                var current = state;\n                while (1) {\n                    // Get next value within bounds\n                    current = forwardDirection ? current + 1 : current - 1;\n                    if (current <= 0)\n                        return 0;\n                    if (current >= $scope.pages.length)\n                        return $scope.pages.length;\n                    if (!$scope.isMobile && mapReduceAllTrue($scope.pages[current].questions, function(q) {return q.template && !q.template.firstQuestion}))\n                        continue;\n                    if (mapReduceAllTrue($scope.pages[current].questions, function(question) {return !!question.depends_on && !$scope.c.isAnyDependencySatisfied(question)})) {\n                        if (current == $scope.pages.length - 1)\n                            return state;\n                    } else\n                        return current;\n                }\n            };\n            var doValidations = function(page, saveAndExit) {\n                if(!saveAndExit)\n                    $scope.c.focusOnFirstErrorQuestion();\n\n                if (!$scope.isPageValid(page)) {\n                    return false;\n                }\n                if (!saveAndExit && !$scope.isPageMandatoryFilled(page)) {\n                    return false;\n                }\n                if (!saveAndExit && !$scope.isSignatureFilled(page)) {\n                    if ($scope.c.data.signature.type != 'full_name')\n                        $scope.c.showSignatureMessage();\n                    return false;\n                }\n                // DEF0087934: We automatically focus on the first question of the current page after clicking \"Next\".]\n                $scope.c.focusOnFirstQuestion();\n                return true;\n            };\n            var nextPageHelper = function(page, state, action, showSuccessMessage) {\n                if (!$scope.data.isKioskSurvey && (!page || !page.questions || !page.questions.length))\n                    return false;\n                \n                // Clear any existing messages\n                $scope.c.hideInlineErrorMessage();\n                // Always skip validation if clicking cancel button\n                if (action != 'cancel') {\n                    // Only do the validations if the user is not trying to save & exit\n                    var saveAndExit = (action == 'save' && showSuccessMessage);\n                    if ($scope.pagination == 'none') {\n                        if ($scope.pages.reduce(function (x, y) {return x || !doValidations(y, saveAndExit)}, false))\n                            return false;\n                    } else {\n                        if (!doValidations(page, saveAndExit))\n                            return false;\n                    }\n                }\n                // Save page\n                $scope.saveCurrentPage(page, action, !!showSuccessMessage);\n                // Navigate to the next page\n                if (!!showSuccessMessage)\n\t\t\t\t\t$scope.c.state = $scope.pages.length;\n\t\t\t\telse\n\t\t\t\t\t$scope.c.state = nextNavigablePage(state, true);\n\t\t\t\t// DEF0073704: once we get saving/cancelling/submitting page, we should broadcast to 'spSurveyEndNotes' directive to show success message\n\t\t\t\t$timeout(function(){\n\t\t\t\t\tif ($scope.c.state === $scope.pages.length) {\n\t\t\t\t\t\t// Mark $scope.c.showMsgPage to true to tell both views that we have already reached out to the final message page. \n\t\t\t\t\t\t$scope.c.showMsgPage = true;\n\t\t\t\t\t}\n\t\t\t\t\t$scope.$broadcast('update-show-msg', $scope.c.state, $scope.pages.length);\n\t\t\t\t});\n                // Scroll to the top\n\t\t\t\t$('section.page').scrollTop(0);\n            };\n\t\t\t// DEF0073704: every time that window's width got changed, we should update c.state accordingly for either desktop view or mobile view\n\t\t\t// where c.state refers to the index of current page. Note that for mobile view, page index is also the question index.\n\t\t\t$scope.$watch(function() { return $scope.c.isMobile; }, function () {\n\t\t\t\t// If we have already reached out to the final page, then we should keep staying on the final message page.\n\t\t\t\tif ($scope.c.showMsgPage) {\n\t\t\t\t\t$scope.c.state = $scope.pages.length;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// When c.state equals to -1, we should show get started page as always.\n\t\t\t\tif($scope.c.state === -1)\n\t\t\t\t\treturn;\n\t\t\t\tif ($scope.isMobile) {\n\t\t\t\t\t// Changing to mobile view from desktop view\n\t\t\t\t\t// Mobile's pagination is always \"question\", so if desktop view's pagination is also question, then no need to update page index. In this case, page index is always same as question index.\n\t\t\t\t\t// $scope.c.data.pagination will always store the pagination value of desktop view.\n\t\t\t\t\tif ($scope.c.data.pagination === 'question')\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// When changing from desktop view to mobile view, we move to the first question again.\n\t\t\t\t\t$scope.c.state = 0;\n\t\t\t\t} else {\n\t\t\t\t\t// Changing to desktop view from mobile view\n\t\t\t\t\tvar questionIndex = $scope.c.state;\n\t\t\t\t\tvar count = 0;\n\t\t\t\t\t// When pagination is none, then we show all questions/categories in one page for desktop view.\n\t\t\t\t\t// When pagination is category, then we should move to the page that current question is on.\n\t\t\t\t\tif ($scope.pagination === 'category') {\n\t\t\t\t\t\tfor (var i = 0; i < $scope.pages.length; i ++) {\n\t\t\t\t\t\t\tif (questionIndex - $scope.pages[i].questions.length >= 0) {\n\t\t\t\t\t\t\t\tquestionIndex -= $scope.pages[i].questions.length;\n\t\t\t\t\t\t\t\tcount ++;\n\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// When pagination is question and we are changing from mobile view to desktop view, then page index is same as question index, so no need to change page.\n\t\t\t\t\t// $scope.pagination stores current view's pagination value.\n\t\t\t\t\telse if ($scope.pagination === 'question') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t$scope.c.state = count;\n\t\t\t\t}\n\t\t\t});\n\t\t\t// DEF0073704: code refactory\n\t\t\tvar checkPaginationForMobileView = function(pageIndex) {\n\t\t\t\tif ($scope.isMobile) {\n\t\t\t\t\tif ($scope.c.state === pageIndex)\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif ($scope.c.state === 0 && $scope.pagination === 'none')\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\t// DEF0073704: code refactory\n\t\t\tvar checkPaginationForDesktopView = function(pages, pageIndex) {\n\t\t\t\tif (!$scope.isMobile) {\t\t\t\t\t\n\t\t\t\t\tif ($scope.c.state === pageIndex)\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t\n\t\t\t\t\tif ($scope.c.state === 0 && $scope.pagination === 'none')\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif ($scope.data.isKioskSurvey)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\t// DEF0073704: code refactory\n\t\t\t$scope.checkPagination = function(pages, pageIndex) {\n\t\t\t\treturn checkPaginationForMobileView(pageIndex) || checkPaginationForDesktopView(pages, pageIndex);\n\t\t\t};\n\t\t\tvar nextPage = function(page, state) {\n\t\t\t\tnextPageHelper(page, state, 'save');\n\t\t\t\tvar categoryName = $scope.pages[$scope.c.state].display;\n\t\t\t\t$scope.c.updatePageTitle(categoryName);\n\t\t\t\t$scope.c.currentCategory = categoryName;\n\t\t\t}\n\t\t\t\n            $scope.nextPage = function(page, state) {\n\t\t\t\tnextPage(page, state);\n            };\n\t\t\t$scope.submit = function(page, state) {\n\t\t\t\tnextPageHelper(page, state, 'submit', true);\n\t\t\t};\n\t\t\t$rootScope.submit = function(page, state) {\n\t\t\t\tnextPageHelper(page, state, 'submit', true);\n            };\n            $scope.save = function(page, state) {\n                nextPageHelper(page, state, 'save', true);\n            };\n            $scope.cancel = function(page, state) {\n                nextPageHelper(page, state, 'cancel', true);\n            };\n            $scope.previousPage = function(state) {\n                $scope.c.state = nextNavigablePage(state, false);\n                // Scroll to the top\n\t\t\t\t$('section.page').scrollTop(0);\n\t\t\t\t// DEF0087934: We automatically focus on the first question of the current page after clicking \"Previous\".\n\t\t\t\t$scope.c.focusOnFirstQuestion();\n\t\t\t\tvar categoryName = $scope.pages[$scope.c.state].display;\n\t\t\t\t$scope.c.updatePageTitle(categoryName);\n\t\t\t\t$scope.c.currentCategory = categoryName;\n            };\n           $scope.isLastPage = function(page) {\n                var retVal = true;\n                var i;\n                if ($scope.c.state == $scope.pages.length - 1)\n                    return retVal;\n\t\t\t\tvar question = $scope.data.questions.idMap[page.questions[0]];\n\t\t\t\tvar tmpGroup = question.templateGroup;\n                if(!$scope.isMobile \n\t\t\t\t   && $scope.pagination == 'question' \n\t\t\t\t   && question.type == 'template'){\n\t\t\t\t\tvar numQuestionsOnTemplate = $scope.c.data.templateGroups[tmpGroup].questions.length;\n\t\t\t\t\tif($scope.c.state == $scope.pages.length-numQuestionsOnTemplate)\n\t\t\t\t\t\treturn retVal;\n\t\t\t\t}\n                for (i=$scope.c.state + 1; i<$scope.pages.length; i++) {\n                    var nextPage = $scope.pages[i];\n                    if (!mapReduceAllTrue(nextPage.questions, function(question) {return !!question.depends_on && !$scope.c.isAnyDependencySatisfied(question)})) {\n                        retVal = false;\n                        break;\n                    }\n                }\n                return retVal;\n            };\n\t\t\tvar stringQAMapHelper = function(questions) {\n\t\t\t\tvar stringQAMap = {};\n\t\t\t\tquestions.forEach(function(qid) {\n\t\t\t\t\tvar question = $scope.c.data.questions.idMap[qid];\n\t\t\t\t\tif (question.type == 'string')\n\t\t\t\t\t\tstringQAMap[qid] = {validator:question.field_validation, value:question.value};\n\t\t\t\t});\n\t\t\t\treturn stringQAMap;\n\t\t\t};\n\t\t\t$scope.buildStringQAMap = function(page) {\n\t\t\t\tif ($scope.pagination == 'none')\n\t\t\t\t\treturn  stringQAMapHelper($scope.pages.reduce(function(p1, p2) {return p1.concat(p2.questions)}, []));\n\t\t\t\treturn stringQAMapHelper(page.questions);\n\t\t\t};\n\t\t\t$scope.stringValidation = function(page, state, action) {\n\t\t\t\tvar stringQAMap = $scope.buildStringQAMap(page);\n\t\t\t\t// execute server side check_string_validation API, update response in front-end and perform action\n\t\t\t\t$scope.c.server.get({'action': \"check_string_validation\",\"string_qa_map\": JSON.stringify(stringQAMap)}).then(function(response){\n\t\t\t\t\tvar validationResults = JSON.parse(response.data.stringValidationResponse);\n\t\t\t\t\tvar invalidCount = 0;\n\t\t\t\t\tangular.forEach(validationResults, function(value, qid) {\n\t\t\t\t\t\tvar question = $scope.c.data.questions.idMap[qid];\n\t\t\t\t\t\tquestion.invalidValue = validationResults[qid].isInvalidString;\n\t\t\t\t\t\tquestion.fieldValidatorErrorMsg = validationResults[qid].fieldValidatorErrorMsg;\n\t\t\t\t\t\tif (question.invalidValue)\n\t\t\t\t\t\t\tinvalidCount++;\n\t\t\t\t\t});\n\t\t\t\t\t// go ahead with action if no invalid string answer\n\t\t\t\t\t$scope.c.data.originalAction = action;\n\t\t\t\t\tif (invalidCount == 0) {\n\t\t\t\t\t\tif (action == 'save')\n\t\t\t\t\t\t\tnextPageHelper(page, state, 'save', true);\n                                                else if (action == 'submit'){\n                                                    // Trigger submit action for choice/reference question\n                                                    $rootScope.$broadcast('nextOrSubmitClick', 'submit');\n                                                    nextPageHelper(page, state, 'submit', true);\n                                                }\n                                                else if (action == 'next'){\n                                                    // Trigger next action for choice/reference question\n                                                    $rootScope.$broadcast('nextOrSubmitClick', 'next');\n                                                    nextPage(page, state);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\t$scope.c.focusOnFirstErrorQuestion();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t };\n        }\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"aaf3cd03c3602200943974e1c1d3ae87","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_aaf3cd03c3602200943974e1c1d3ae87","sys_updated_by":"admin","sys_created_on":"2016-07-15 19:01:42","name":"spSurveyForm","sys_name":"spSurveyForm","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"78","sys_updated_on":"2016-02-01 19:14:26","sys_tags":"","type":"directive","script":"function($timeout, spUtil) {\n\n\tvar host = spUtil.getHost();\n\n\tfunction link(scope, element) {\n\n\t\tfunction render() {\n\t\t\tvar defOptions = {\t\t\t\t\n\t\t\t\tcontainer: $(element).find('div')[0],\n\t\t\t\ttextarea: $(element).find('textarea')[0],\t\t\t\t\n\t\t\t\tclientSideStorage: false,\n\t\t\t\ttheme: {\n\t\t\t\t\tbase: host + '/scripts/thirdparty/epiceditor/themes/base/epiceditor.css',\n\t\t\t\t\tpreview: host + '/scripts/thirdparty/epiceditor/themes/preview/github.css',\n\t\t\t\t\teditor: host + '/scripts/thirdparty/epiceditor/themes/editor/epic-light.css'\n\t\t\t\t},\n\t\t\t\tautogrow: true,\n\t\t\t\tbutton: false\n\t\t\t};\n\n\t\t\tscope.editor = new EpicEditor(defOptions).load();\t\t\t\t\t\t\n\t\t\tscope.editor[scope.field.length ? 'preview' : 'edit']();\n\n\t\t\tscope.editor.on('update', function(res) {\n\t\t\t\t$timeout(function() {\n\t\t\t\t\tscope.field = res.content;\t\n\t\t\t\t});\t\t\t\t\n\t\t\t})\n\n\t\t\tscope.$on('$destroy', function() {\t\t\t\t\t\t\t\t\n\t\t\t\telement.remove();\t\t\t\t\n\t\t\t})\n\n\t\t\tscope.$on('$sp.widget-edit-panel-css-transition-end', function() {\n\t\t\t\tscope.editor.reflow();\t\n\t\t\t})\n\n\t\t\tscope.$on('$sp.widget-edit-panel-toggle-mode', function(e, mode) {\t\t\t\n\t\t\t\tscope.editor[mode]();\t\t\t\t\n\t\t\t});\n\t\t}\n\t\t\n\t\tvar listener = scope.$on('$sp.widget-edit-panel-css-transition-end', function() {\n\t\t\tlistener();\n\t\t\trender();\t\t\t\n\t\t});\n\t}\n\treturn {\n\t\tscope: {\n\t\t\tfield: '='\t\t\n\t\t},\n\t\tlink: link,\n\t\ttemplate: '<div><div class=\"sp-epiceditor\"></div><textarea style=\"display:none;\">{{field}}</textarea></div>',\n\t\treplace: true\n\t}\n}","sys_class_name":"sp_angular_provider","sys_id":"ab181a505b1112000d7ec7ad31f91ac0","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"sys_update_name":"sp_angular_provider_ab181a505b1112000d7ec7ad31f91ac0","sys_updated_by":"admin","sys_created_on":"2016-01-27 22:42:31","name":"spEpiceditor","sys_name":"spEpiceditor","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"3","sys_updated_on":"2021-02-01 10:32:50","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\ttemplate:\n\t\t\t'<div class=\"col-xs-12 col-sm-12\" style=\"padding: 10px 0 0\">' +\n\t\t\t\t'<div class=\"col-xs-12 col-sm-6\" ng-class=\"{add_info_no_padding: !hasPadding()}\">' +\n\t\t\t\t\t'<span style=\"margin-right: 10px\">' +\n\t\t\t\t\t\t'<a href=\"javascript:void(0)\" role=\"link\">' +\n\t\t\t\t\t\t\t'<span class=\"glyphicon glyphicon-menu-down\" ng-if=\"showAddInfo\" ng-click=\"toggleAddInfo()\" aria-label=\"Hide Additional Information\" role=\"button\"></span>' +\n\t\t\t\t\t\t\t'<span class=\"glyphicon glyphicon-menu-right\" ng-if=\"!showAddInfo\" ng-click=\"toggleAddInfo()\" aria-label=\"Show Additional Information\" role=\"button\"></span>' +\n\t\t\t\t\t\t'</a>' +\n\t\t\t\t\t'</span>' +\n\t\t\t\t\t'<span>' +\n\t\t\t\t\t\t'<h5 id=\"{{::field.add_info_name}}_label\" class=\"question-label\" style=\"display: inline-block\">' +\n\t\t\t\t\t\t\t'{{::field.add_info_label}}' +\n\t\t\t\t\t\t'</h5>' +\n\t\t\t\t\t'</span>' +\n\t\t\t\t\t'<textarea class=\"form-control collapse\" ng-class=\"{in: showAddInfo}\" rows=\"4\" name=\"{{::field.add_info_name}}\" class=\"form-control\" aria-labelledby=\"{{::field.add_info_name}}_label\" ng-model=\"field.add_info\" autocomplete=\"off\">' +\n\t\t\t\t\t'</textarea>' +\n\t\t\t\t'</div>' +\n\t\t\t'</div>',\n\n\t\tscope: {\n\t\t\t'field': '='\n\t\t},\n\n\t\tcontroller: function($scope) {\n\t\t\t$scope.showAddInfo = true;\n\t\t\t$scope.hasPadding = function() {\n\t\t\t\treturn $scope.field.type == \"choice\" || $scope.field.type == \"date\" || $scope.field.type == \"datetime\";\n\t\t\t};\n\t\t\t$scope.toggleAddInfo = function() {\n\t\t\t\t$scope.showAddInfo = !$scope.showAddInfo;\n\t\t\t};\n\t\t\tif (!$scope.field.add_info)\n\t\t\t\t$scope.field.add_info = \"\";\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"ad151d37531323002d96ddeeff7b123b","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_ad151d37531323002d96ddeeff7b123b","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:49:33","name":"mespSurveyAddInfo","sys_name":"mespSurveyAddInfo","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"35","sys_updated_on":"2021-02-01 12:22:50","sys_tags":"","type":"directive","script":"function(i18n, $rootScope) {\n\n    return {\n        template:   '<div ng-repeat=\"page in pages track by $index\" ng-if=\"(isMobile && (c.state == $index || (c.state == 0 && pagination == \\'none\\')))  || (!isMobile && ((c.state == $index || (c.state == 0 && pagination == \\'none\\')) || data.isKioskSurvey))\">' +\n\t\t\t\t\t\t '<div class=\"assessable-record\" ng-if=\"pagination != \\'none\\'  && (data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') \" >' +\n                                '<h3 class=\"assessable-record-text\">'+\n\t\t\t\t\t\t\t\t\t'{{::page.assessableRecord.asrName}}'+ \n\t\t\t\t\t\t\t\t'</h3></div>' +\n                        '<div ng-if=\"pagination != \\'none\\' || $index == 0 && !data.isKioskSurvey\">' +\n                            '<h1 class=\"survey-heading-text me_category_heading\">' +\n                                '<a ng-if=\"::data.trigger_id && (data.evaluation_method == \\'survey\\' || data.evaluation_method == \\'quiz\\') \" class=\"survey-heading\" style=\"font-weight: 100;\" href=\"?id=ticket&table={{::data.trigger_table}}&sys_id={{::data.trigger_id}}\">{{::data.trigger_display}}&nbsp;</a>' +\n                                '<span ng-if=\"pagination == \\'none\\'\">{{::data.title}}</span>' +\n                                '<span ng-if=\"pagination != \\'none\\'\">{{page.display}}&nbsp;</span>'+\n                            '</h1>' +\n\t\t\t\t\t\t\t'<span class=\"category-description\" ng-if=\"(pagination != \\'none\\') &amp;&amp; (page.catDesc &amp;&amp; page.catDesc.length)\" >{{::page.catDesc}}</span>'+\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div class=\"text-center intro-text\" ng-class=\"{\\'wrapper-md\\': !data.isKioskSurvey}\" ng-style=\"{\\'margin-top\\':data.isKioskSurvey ? \\'15px\\' : \\'\\'}\" ng-if= \"data.one_click_survey == \\'true\\' && data.introduction\">' +\n\t\t\t\t\t\t\t'<span ng-bind-html=\"::data.introduction\"></span>' +\n\t\t\t\t\t\t'</div>' +\n'<div ng-class=\"{\\'wrapper-md\\': !data.isKioskSurvey}\" ng-if=\"((!data.asr[page.assessableRecord.asrId].collapsed) || page.showAsrName == \\'true\\' || pagination != \\'none\\')\">' +\n\t\t\t\t\t\t\t'<div id=\"walkup_lang_picker\" style=\"text-align: justify; text-align-last: right;\">'+\n\t\t\t\t\t\t\t\t'<label ng-if=\"data.showLanguagePicker == \\'true\\' && data.one_click_survey == \\'true\\'\" for=\"spLanguagePicker\">${Language}: </label>'+\n\t\t\t\t\t\t\t\t'<select ng-if=\"data.showLanguagePicker == \\'true\\' && data.one_click_survey == \\'true\\'\" ng-model=\"data.pickedLanguage\" name=\"spLanguagePicker\" id=\"spLanguagePicker\" '+\n\t\t\t\t\t\t\t\t\t'ng-options=\"lang.label for lang in data.languages track by lang.value\" ng-change=\"c.setLanguage()\">'+\n\t\t\t\t\t\t\t\t'</select>'+\n\t\t\t\t\t\t\t'</div>'+\n                            '<!-- Category collapse - show only in no-pagination case -->' +\n\t\t\t\t\t\t\t'<div class=\"\" ng-if=\"pagination == \\'none\\' && pages.length > 1 && (data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') &amp;&amp; page.showAsrName == \\'true\\'\" >' +\n                                '<h3 class=\"col-xs-11 category-label\">'+\n\t\t\t\t\t\t\t\t\t'{{::page.assessableRecord.asrName}}'+ \n\t\t\t\t\t\t\t\t'</h3>' +\n                                '<h3 class=\"col-xs-1 text-right\">' +\n                                    '<a ng-if=\"!data.asr[page.assessableRecord.asrId].collapsed\" href=\"javascript:void(0)\" aria-label=\"Hide Contents\"><span class=\"glyphicon glyphicon-menu-down\" ng-click=\"data.asr[page.assessableRecord.asrId].collapsed = true\"></span></a>' +\n                                    '<a ng-if=\"data.asr[page.assessableRecord.asrId].collapsed\" href=\"javascript:void(0) aria-label=\"Show Contents\"><span class=\"glyphicon glyphicon-menu-right\" ng-click=\"data.asr[page.assessableRecord.asrId].collapsed = false\"></span></a>' +\n                                '</h3>' +\n                            '</div>' +\n                            '<div class=\"wrapper-sm row\" ng-if=\"pagination == \\'none\\' && pages.length > 1 && !data.asr[page.assessableRecord.asrId].collapsed\" ng-style=\"{\\'border-top\\': (($index > 0 && !(page.showAsrName == \\'true\\')) ? \\'1px solid #e6e8ea\\' : \\'\\'), \\'margin-left\\':(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') ? \\'5px\\' : \\'\\' }\">' +\n                                '<h3 class=\"col-xs-11 category-label\" ng-style=\"{\\'font-size\\':(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') ? \\'1.5em\\' : \\'\\' }\">'+\n                                '</span>{{::page.display}}' +\n\t\t\t\t\t\t\t\t'</h3>' +\n                                '<h3 class=\"col-xs-1 text-right\">' +\n                                    '<a ng-if=\"!page.collapsed\" href=\"javascript:void(0)\" aria-label=\"Hide Contents\"><span class=\"glyphicon glyphicon-menu-down\" ng-click=\"page.collapsed = true\"></span></a>' +\n                                    '<a ng-if=\"page.collapsed\" href=\"javascript:void(0)\" aria-label=\"Show Contents\"><span class=\"glyphicon glyphicon-menu-right\" ng-click=\"page.collapsed = false\"></span></a>' +\n                                '</h3>' +\n\t\t\t\t\t\t\t\t\t'<span  style=\"margin-left:10px;\" ng-if=\"(page.catDesc &amp;&amp; page.catDesc.length)\">{{::page.catDesc}}</span>'+\n                            '</div>' +\n                            '<div id=\"category-questions-{{::page.id}}\" class=\"collapse\" ng-class=\"(data.asr[page.assessableRecord.asrId].collapsed || page.collapsed) ? \\'\\' : \\'in\\'\" ng-style=\"{\\'margin-left\\':(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\') ? \\'30px\\' : \\'\\' }\">' +\n                                '<div ng-repeat=\"id in page.questions track by $index\" ng-init=\"field = data.questions.idMap[id]\" ng-if=\"::(data.questions.idMap[id].type != \\'template\\' || data.questions.idMap[id].template.firstQuestion == true || isMobile)\">' +\n                                    '<div class=\"wrapper-sm row\" ng-class=\" { \\'text-center\\': data.isKioskSurvey, \\'form-group\\': !data.isKioskSurvey }\" style=\"margin-left: 0\" ng-if=\"!field.depends_on || c.isAnyDependencySatisfied(field)\">' +\n                                        '<h2 class=\"question-label me_question-label\" ng-if=\"field.type != \\'checkbox\\' && field.type != \\'signature\\' && field.type != \\'template\\' && field.type != \\'attachment\\'\">' +\n                                            '<span class=\"field-decorations\">' +\n                                                '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" ng-class=\"{\\'mandatory-filled\\': c.isMandatoryFilled(field)}\" title=\"{{::data.parameterizedMsgsMap.mandatory}}\" style=\"padding-right: .25em\" ></span>' +\n                                                '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                            '</span>' +\n                                            '{{::field.label}}' +\n                                        '</h2>' +\n                                        '<div class=\"details-text\" ng-if=\"::field.details && field.type != \\'checkbox\\' && field.type != \\'signature\\' && field.type != \\'template\\' && field.type != \\'attachment\\'\" ng-bind-html=\"field.details\"></div>' +\n                                        '<mesp-survey-field ng-class=\" { \\'text-center\\': data.isKioskSurvey } \" field=\"field\" data=\"data\" c=\"c\" mobile-prefix=\"mobilePrefix\"></mesp-survey-field>' +\n\t\t                             '</div> <!-- end form-group -->' +\n                                '</div> <!-- end ng-repeat field in data.questions -->' +\n                            '</div>' +\n                        '</div> <!-- end wrapper-md -->' +\n                        '<!-- Nav Buttons -->' +\n                        '<div class=\"wrapper-md\" ng-if=\"pagination != \\'none\\' || $index == pages.length - 1 && !data.isKioskSurvey\">' +\n                            '<div class=\"row\">' +\n                                '<div class=\"col-xs-6 col-sm-4\" ng-if=\"!isMobile || $index > 0\">' +\n                                    '<div class=\"wrapper-xs\">' +\n                                        '<div ng-if=\"pagination == \\'none\\' || $index == 0\">' +\n                                        \t'<button class=\"btn btn-default hidden-xs\" ng-click=\"cancel(page, c.state)\">${Cancel}</button>' +\n                                        '</div>' +\n                                        '<div ng-if=\"pagination != \\'none\\' && $index > 0\">' +\n                                            '<button class=\"btn btn-default hidden-xs\" ng-click=\"previousPage(c.state)\">${Previous}</button>' +\n                                            '<button class=\"btn btn-default btn-block btn-lg visible-xs\" ng-click=\"previousPage(c.state)\">${Previous}</button>' +\n                                        '</div>' +\n                                    '</div>' +\n                                '</div>' +\n                                '<div class=\"col-xs-6 col-sm-8 text-right\" ng-class=\"(pagination != \\'none\\' && $index > 0) ? \\'\\' : \\'col-xs-12\\'\">' +\n                                    '<div class=\"wrapper-xs hidden-xs\" ng-if=\"!c.isPublic\" style=\"display:inline-block\">' +\n\t\t\t\t\t\t\t\t\t\t'<div ng-if=\"pagination == \\'none\\' || isLastPage(page)\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<button class=\"btn btn-default\" ng-click=\"save(page, c.state)\">${Save}</button>' +\n\t\t\t\t\t\t\t\t\t\t'</div>' +\n                                    '</div>' +\n                                    '<div class=\"wrapper-xs\" ng-style=\"{\\'display\\': (!isMobile ? \\'inline-block\\' : \\'\\')}\">' +\n                                        '<div ng-if=\"pagination != \\'none\\' && !isLastPage(page)\">' +\n                                            '<button class=\"btn btn-primary hidden-xs\" ng-click=\"nextPage(page, c.state)\" ng-disabled=\"disableNextButton(page)\">${Next}</button>' +\n                                            '<button class=\"btn btn-primary btn-block btn-lg visible-xs\" ng-click=\"nextPage(page, c.state)\" ng-disabled=\"disableNextButton(page)\">${Next}</button>' +\n                                        '</div>' +\n                                        '<div ng-if=\"pagination == \\'none\\' || isLastPage(page)\">' +\n                                            '<button class=\"btn btn-primary hidden-xs\" ng-click=\"submit(page, c.state)\" ng-disabled=\"disableNextButton(page)\">${Submit}</button>' +\n                                            '<button class=\"btn btn-primary btn-block btn-lg visible-xs\" ng-click=\"submit(page, c.state)\" ng-disabled=\"disableNextButton(page)\">${Submit}</button>' +\n                                        '</div>' +\n                                    '</div>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n                    '</div> <!-- end ng-repeat category in data.categories -->' +\n                    '<!-- Survey thank you page -->' +\n                    '<div class=\"wrapper-md\" ng-if=\"(c.state == pages.length) && data.successMessage && data.successMessage.length  && (!data.isKioskSurvey || isMobile)\">' +\n                        '<div class=\"text-center intro-text\">' +\n\t\t\t\t\t\t\t'<div class=\"wrapper-sm\">' +\n                               '<div class=\"outer-circle\">'+   \n\t\t\t\t\t\t\t\t\t'<span class = \"intro-icon-assessment survey-icon glyphicon icon-article-document\"ng-if=\"(data.evaluation_method == \\'assessment\\' || data.evaluation_method == \\'attestation_v2\\' || data.evaluation_method == \\'risk_assessment\\')\"></span>'+\n\t\t\t\t\t\t\t\t\t'<span ng-if=\"(data.evaluation_method == \\'survey\\' || data.evaluation_method == \\'quiz\\')\" class=\"survey-icon glyphicon icon-form\"></span>'+\n\t\t\t\t\t\t\t\t'</div>'+\n                            '</div>' +\n                        '</div>' +\n                        '<div class=\"wrapper-sm text-center\">' +\n                            '<h4 class=\"description-text\" ng-bind-html=\"data.successMessage\"></h4>' +\n                        '</div>' +\n                    '</div>',\n\n        scope: {\n            pagination: '=',\n            isMobile: '=',\n            data: '=',\n            c: '='\n\t\t},\n\n        controller: function($scope) {\n            var init = function() {\n            \t$scope.mobilePrefix = \"mobile-\";\n\t\t\t\t$scope.pages = [];\n\t\t\t\tif($scope.c.data.evaluation_method == 'assessment' || $scope.c.data.evaluation_method == 'attestation_v2' || $scope.c.data.evaluation_method == 'risk_assessment'){\n\t\t\t\t\tif ($scope.pagination == 'question')\n\t\t\t\t\t\t\t $scope.pages = $scope.c.data.questions.idList.map(function(qid) {return {id: qid, questions: [qid], display: $scope.c.data.questions.idMap[qid].category.display, catDesc: $scope.c.data.questions.idMap[qid].category.description,assessableRecord: $scope.c.data.questions.idMap[qid].assessableRecord}});\n\t\t\t\t\t\n\t\t\t\t\telse if ($scope.pagination == 'category')\n\t\t\t\t\t\t$scope.pages = $scope.c.data.categories.idList.map(function(catid) {\n\t\t\t\t\t\t\tvar obj = $scope.c.data.categories.idMap[catid];\n\t\t\t\t\t\t\treturn {id: catid, display: obj.display, questions: obj.questions,\n\t\t\t\t\t\t\tcatDesc: obj.description, assessableRecord: obj.assessableRecord};\t\n                    });\n\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t\t$scope.pages = $scope.c.data.categories.idList.map(function(catid) {\n\t\t\t\t\t\t\tvar obj = $scope.c.data.categories.idMap[catid];\n\t\t\t\t\t\t\treturn {id: catid, display: obj.display, questions: obj.questions,\n\t\t\t\t\t\t\tcatDesc: obj.description, assessableRecord: obj.assessableRecord,showAsrName: obj.showAsrName};\t\n                    });\n\t\t\t\t} else {\n\t\t\t\t\tif ($scope.pagination == 'question')\n\t\t\t\t\t\t$scope.pages = $scope.c.data.questions.idList.map(function(qid) {return {id: qid, questions: [qid], catDesc: $scope.c.data.questions.idMap[qid].category.description,display: $scope.c.data.questions.idMap[qid].category.display}});\t\t\n\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t\t$scope.pages = $scope.c.data.categories.idList.map(function(catid) {\n\t\t\t\t\t\t\tvar category = $scope.c.data.categories.idMap[catid];\n\t\t\t\t\t\t\treturn {id: catid, display: category.display, catDesc: category.description,questions: category.questions};\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n                var signature = $scope.c.data.signature;\n                if (signature && !$scope.c.isPublic) {\n                    if ($scope.pagination == 'none')\n                        $scope.pages[$scope.pages.length - 1].questions.push(signature.sys_id);\n                    else\n                        $scope.pages.push({id: signature.sys_id, display: $scope.c.data.title, questions: [signature.sys_id]});\n\n                    $scope.c.data.questions.idMap[signature.sys_id] = {\n                        type: 'signature',\n                        name: 'signature_result',\n                        label: signature.label,\n                        value: signature.value,\n                        sys_id: signature.sys_id,\n                        signType: signature.type,\n                        depends_on: ''\n                    };\n                }\n            };\n            init();\n\n            var mapReduceAllTrue = function(questions, callback) {\n                return questions.map(function(qid) {\n                    return callback($scope.c.data.questions.idMap[qid]);\n                }).reduce(function(x, y) {\n                    return x && y;\n                }, true);\n            };\n\n            var disableNextButtonHelper = function(page) {\n                if (!page || !page.questions || !page.questions.length)\n                    return true;\n\n                return !$scope.isPageValid(page) || !$scope.isPageMandatoryFilled(page);\n            };\n\t\t\t\n            $scope.disableNextButton = function(page) {\n                if ($scope.pagination == 'none')\n                    return $scope.pages.map(function(x) {return disableNextButtonHelper(x)})\n                                .reduce(function(x, y) {return x || y}, false);\n                return disableNextButtonHelper(page);\n            };\n\n            // Returns true if all questions within this page have a valid response\n            var isPageValidHelper = function(page) {\n                return mapReduceAllTrue(page.questions, function(question) {return !question.invalidValue});\n            };\n\n            $scope.isPageValid = function(page) {\n                if ($scope.pagination == 'none')\n                    return $scope.pages.map(function(x) {return isPageValidHelper(x)})\n                                    .reduce(function(x, y) {return x && y}, true);\n                return isPageValidHelper(page);\n            };\n\n            $scope.isSignatureFilled = function(page) {\n                if ($scope.pagination != 'none' && !page.questions.reduce(function(x, y) {return x || $scope.c.data.questions.idMap[y].type == 'signature'}, false))\n                    return true;\n\n                var signature = $scope.data.signature;\n                if (!signature || signature.type == 'assertion_only')\n                    return true;\n\n                if (signature.type == 'full_name' && !signature.validated) {\n                    signature.validationCallback = function(validated) {\n                        if (validated)\n                            $scope.submit(page, $scope.c.state);\n                        else\n                            $scope.c.showSignatureMessage();\n                    };\n                    $scope.c.showSignatureAuthModal();\n                    return false;\n                }\n\n                if (signature.type == 'checkbox') {\n                    if ($scope.c.data.questions.idMap[signature.sys_id].value != 'true')\n                        return false;\n                    else\n                        $scope.c.data.questions.idMap[signature.sys_id].value = 'checked';\n                }\n\n                return true;\n            };\n\n            // Returns true if all mandatory questions within this page are filled\n            var isPageMandatoryFilledHelper = function(page) {\n                var questionsList = page.questions.concat([]);\n                if (!$scope.isMobile)\n                    page.questions.forEach(function(qid) {\n                        var question = $scope.c.data.questions.idMap[qid];\n                        if (question.type == 'template' && question.template.firstQuestion) {\n                            var templateGroup = $scope.c.data.templateGroups[question.templateGroup];\n                            questionsList = questionsList.concat(templateGroup.questions.filter(function(tid) {return tid != qid;}));\n                        }\n                    });\n                return mapReduceAllTrue(questionsList, function(question) {return !question.mandatory || $scope.c.isMandatoryFilled(question)});\n            };\n\n            $scope.isPageMandatoryFilled = function(page) {\n                if ($scope.pagination == 'none')\n                    return $scope.pages.map(function(x){return isPageMandatoryFilledHelper(x)})\n                                    .reduce(function(x, y) {return x && y}, true);\n                return isPageMandatoryFilledHelper(page);\n            };\n\n            // Saves questions\n            var saveCurrentQuestions = function(questions, action, updateSuccessMessage) {\n                var formdata = {\"sysparm_instance_id\": $scope.c.data.instanceId, \"sysparm_action\": action};\n                questions.forEach(function(qid) { $scope.c.updateQuestion(qid, formdata) });\n                formdata['percent_answered'] = $scope.c.getPercentAnswered();\n                if (!!updateSuccessMessage)\n                    formdata['updateSuccessMessage'] = true;\n                $scope.c.submitAjax(formdata);\n            };\n\n            // Saves questions on current page or all pages depending on pagination setting\n            $scope.saveCurrentPage = function(page, action, updateSuccessMessage) {\n                if ($scope.pagination == 'none')\n                    return saveCurrentQuestions($scope.pages.reduce(function(p1, p2) {return p1.concat(p2.questions)}, []), action, updateSuccessMessage);\n                else if ($scope.pagination == 'question' && !$scope.isMobile) {\n                    var question = $scope.data.questions.idMap[page.questions[0]];\n                    if (question.type == 'template')\n                        return saveCurrentQuestions($scope.data.templateGroups[question.templateGroup].questions, action, updateSuccessMessage);\n                }\n                return saveCurrentQuestions(page.questions, action, updateSuccessMessage);\n            };\n\n            // Get the next (or) previous navigable page\n            var nextNavigablePage = function(state, forwardDirection) {\n                var current = state;\n                while (1) {\n                    // Get next value within bounds\n                    current = forwardDirection ? current + 1 : current - 1;\n\n                    if (current <= 0)\n                        return 0;\n\n                    if (current >= $scope.pages.length)\n                        return $scope.pages.length;\n\n                    if (!$scope.isMobile && mapReduceAllTrue($scope.pages[current].questions, function(q) {return q.template && !q.template.firstQuestion}))\n                        continue;\n\n                    if (mapReduceAllTrue($scope.pages[current].questions, function(question) {return !!question.depends_on && !$scope.c.isAnyDependencySatisfied(question)})) {\n                        if (current == $scope.pages.length - 1)\n                            return state;\n                    } else\n                        return current;\n                }\n            };\n\n            var doValidations = function(page, saveAndExit) {\n                if (!$scope.isPageValid(page)) {\n                    $scope.c.showInvalidResponseMessage();\n                    return false;\n                }\n\n                if (!saveAndExit && !$scope.isPageMandatoryFilled(page)) {\n                    $scope.c.showMandatoryMessage();\n                    return false;\n                }\n\n                if (!saveAndExit && !$scope.isSignatureFilled(page)) {\n                    if ($scope.c.data.signature.type != 'full_name')\n                        $scope.c.showSignatureMessage();\n                    return false;\n                }\n\n                return true;\n            };\n\n            var nextPageHelper = function(page, state, action, showSuccessMessage) {\n                // Clear any existing messages\n                $scope.c.hideInlineErrorMessage();\n\t\t\t\t\n                // Always skip validation if clicking cancel button\n                if (action != 'cancel') {\n                    // Only do the validations if the user is not trying to save & exit\n                    var saveAndExit = (action == 'save' && showSuccessMessage);\n\n                    if ($scope.pagination == 'none') {\n                        if ($scope.pages.reduce(function (x, y) {return x || !doValidations(y, saveAndExit)}, false))\n                            return false;\n                    } else {\n                        if (!doValidations(page, saveAndExit))\n                            return false;\n                    }\n                }\n\n                // Save page\n                $scope.saveCurrentPage(page, action, !!showSuccessMessage);\n\n                // Navigate to the next page\n                if (!!showSuccessMessage) {\n                    $scope.c.state = $scope.pages.length;\n                    if (action == 'submit')\n                    $scope.$emit(\"$sp.me_take_survey.submitted\", 'true');//Assuming mesp portal widget is used for HR use case.\n                } else\n                    $scope.c.state = nextNavigablePage(state, true);\n\n                // Scroll to the top\n                $('section.page').scrollTop(0);\n            };\n\n            $scope.nextPage = function(page, state) {\n\t\t\t\tnextPageHelper(page, state, 'save');\n            };\n\t\t\t\n\t\t\t$scope.submit = function(page,state) {\n\t\t\t\tnextPageHelper(page, state, 'submit', true);\n\t\t\t};\n\t\t\t\n\t\t\t$rootScope.submit = function(page, state) {\n\t\t\t\tnextPageHelper(page, state, 'submit', true);\n            };\n\n            $scope.save = function(page, state) {\n                nextPageHelper(page, state, 'save', true);\n            };\n            \n            $scope.cancel = function(page, state) {\n                nextPageHelper(page, state, 'cancel', true);\n            };\n\n            $scope.previousPage = function(state) {\n                $scope.c.state = nextNavigablePage(state, false);\n\n                // Scroll to the top\n                $('section.page').scrollTop(0);\n            };\n\n           $scope.isLastPage = function(page) {\n                var retVal = true;\n                var i;\n                if ($scope.c.state == $scope.pages.length - 1)\n                    return retVal;\n\t\t\t\tvar question = $scope.data.questions.idMap[page.questions[0]];\n\t\t\t\tvar tmpGroup = question.templateGroup;\n                if(!$scope.isMobile \n\t\t\t\t   && $scope.pagination == 'question' \n\t\t\t\t   && question.type == 'template'){\n\t\t\t\t\tvar numQuestionsOnTemplate = $scope.c.data.templateGroups[tmpGroup].questions.length;\n\t\t\t\t\tif($scope.c.state == $scope.pages.length-numQuestionsOnTemplate)\n\t\t\t\t\t\treturn retVal;\n\t\t\t\t}\n                for (i=$scope.c.state + 1; i<$scope.pages.length; i++) {\n                    var nextPage = $scope.pages[i];\n\n                    if (!mapReduceAllTrue(nextPage.questions, function(question) {return !!question.depends_on && !$scope.c.isAnyDependencySatisfied(question)})) {\n                        retVal = false;\n                        break;\n                    }\n                }\n\n                return retVal;\n            };\n        }\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"b2d21137531323002d96ddeeff7b128f","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_b2d21137531323002d96ddeeff7b128f","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:40:07","name":"mespSurveyForm","sys_name":"mespSurveyForm","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"1","sys_updated_on":"2016-02-01 23:17:33","sys_tags":"","type":"directive","script":"function($interval, $timeout) {\n\n\treturn {\n\n\t\trestrict: 'A',\n\t\tscope: true,\n\t\tcompile: function() {\n\n\t\t\treturn function(scope, element, attributes) {\n\n\t\t\t\tvar timing,\n\t\t\t\t\ttimingEffect,\n\t\t\t\t\ttimingEffectDivideBy = 4,\n\t\t\t\t\tstart,\n\t\t\t\t\tdirection;\n\n\t\t\t\tif (attributes.direction=='up' || attributes.direction=='down') {\n\t\t\t\t\tdirection = attributes.direction;\n\t\t\t\t} else {\n\t\t\t\t\tdirection = 'up';\n\t\t\t\t}\n\n\t\t\t\tif (attributes.timing) {\n\t\t\t\t\ttiming = attributes.timing;\n\t\t\t\t\ttimingEffect = timing / timingEffectDivideBy;\n\t\t\t\t} else {\n\t\t\t\t\ttiming = 5000;\n\t\t\t\t\ttimingEffect = timing / timingEffectDivideBy / timingEffectDivideBy * 2;\n\t\t\t\t}\n\n\t\t\t\tfunction startInterval(element) {\n\n\t\t\t\t\tvar list = element,\n\t\t\t\t\t\titems = element.find('a'),\n\t\t\t\t\t\titemFirst,\n\t\t\t\t\t\titemLast;\n\n\t\t\t\t\tif (items.length) {\n\t\t\t\t\t\tlist.addClass('active');\n\n\t\t\t\t\t\tstart = $interval(function() {\n\n\t\t\t\t\t\t\titems = list.children('a');\n\n\t\t\t\t\t\t\tif (direction=='up') {\n\t\t\t\t\t\t\t\titemFirst = angular.element(items[0]);\n\t\t\t\t\t\t\t\titemFirst.addClass('fade-out minus-margin-top');\n\t\t\t\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\t\t\t\titemFirst.removeClass('minus-margin-top');\n\t\t\t\t\t\t\t\t\tlist.append(itemFirst);\n\t\t\t\t\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\t\t\t\t\titems.removeClass('fade-out');\n\t\t\t\t\t\t\t\t\t}, timingEffect);\n\n\t\t\t\t\t\t\t\t}, timingEffect);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\titemLast = angular.element(items[items.length -1]);\n\t\t\t\t\t\t\t\titemLast.addClass('fade-out');\n\t\t\t\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\t\t\t\titemLast.addClass('minus-margin-top');\n\t\t\t\t\t\t\t\t\titemLast.removeClass('fade-out');\n\t\t\t\t\t\t\t\t\tlist.prepend(itemLast);\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\t\t\t\t\titems.removeClass('minus-margin-top');\n\t\t\t\t\t\t\t\t\t}, timingEffect);\n\t\t\t\t\t\t\t\t}, timingEffect);\n\t\t\t\t\t\t\t} \n\n\t\t\t\t\t\t}, timing);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn('no items assigned to ticker!');\n\t\t\t\t\t}\n\n\t\t\t\t}\t\t\n\n\t\t\t\tscope.$watch(element, function() {\n\t\t\t\t\tstartInterval(element);\n\t\t\t\t});\n\n\t\t\t\telement.on('$destroy', function() {\n\t\t\t\t\t$interval.cancel(start, 0);\n\t\t\t\t});\n\n\t\t\t\telement.on('mouseover', function() {\n\t\t\t\t\t$interval.cancel(start, 0);\n\t\t\t\t});\n\n\t\t\t\telement.on('mouseout', function() {\n\t\t\t\t\tstartInterval(element);\n\t\t\t\t});\n\n\t\t\t};\n\t\t}\n\n\t};\n};","sys_class_name":"sp_angular_provider","sys_id":"b7ef440ecb11120000f8d856634c9c36","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"sys_update_name":"sp_angular_provider_b7ef440ecb11120000f8d856634c9c36","sys_updated_by":"admin","sys_created_on":"2016-02-01 23:17:08","name":"spTicker","sys_name":"spTicker","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"4","sys_updated_on":"2022-09-19 11:12:16","sys_tags":"","type":"directive","script":"function($timeout) {\n    return {\n        restrict: 'A',\n        link: function(scope, element, attr) {\n            if (scope.$last === true) {\n                $timeout(function() {\n                    scope.makeUibTabAccessible();\n                });\n            }\n\t\t\t/* method for adding appropriate roles for uib tab set template and also handle arrow key navigation\n\t\t\t  for eg.\n\t\t\t\t  <ul role=\"tablist\">\n\t\t\t\t\t  <li role=\"presentation\">\n\t\t\t\t\t\t  <a role=\"tab\"></a>\n\t\t\t\t\t  </li>\n\t\t\t\t  </ul>\n\t\t\t*/\n            scope.makeUibTabAccessible = function() {\n                // For easy reference\n                var keys = {\n                    left: 37,\n                    up: 38,\n                    right: 39,\n                    down: 40\n                };\n                var tabList = element.parent()[0];\n                tabList = angular.element(tabList);\n                tabList.attr(\"role\", \"tablist\");\n                // For each individual tab DIV, set class and aria role attributes\n                var tabContainer = element.parent().parent().find(\".tab-content > div.tab-pane\");\n                tabContainer.attr({\n                    \"role\": \"tabpanel\"\n                });\n                var tabs = tabList.find('li > a');\n                angular.forEach(tabs, function(tab, index) {\n                    var tabParent = angular.element(tab).parent();\n                    var tabElement = angular.element(tab);\n                    var tabId = tabParent.attr(\"heading\").replace(/ /g, '_');\n                    if (tabParent && tabParent.parent() && tabParent.parent()[0] && tabParent.parent()[0].className.includes(\"dropdown-menu\"))\n                        tabId = \"dropdown_menu_\" + tabId;\n\t\t\t\t\t\n                    tabElement.attr({\n                        \"id\": tabId,\n                        \"role\": \"tab\",\n                        \"aria-selected\": \"false\",\n                        \"aria-controls\": tabId + \"panel\",\n                        \"tabindex\": \"-1\"\n                    }).parent().attr(\"role\", \"presentation\");\n                    tabContainer.eq(index).attr({\n                        \"aria-labelledby\": tabId,\n                        \"id\": tabId + \"panel\"\n                    });\n                    // Set key events on tabList item for navigating tabs\n                    tabElement.keyup(function(event) {\n                        var vertical = element.parent().parent().attr(\"vertical\"); // check orientation\n                        var proceed = false;\n                        var key = event.which;\n                        if (vertical === \"true\") {\n                            if (key === keys.up || key === keys.down) {\n                                event.preventDefault(); // need to prevent page scroll\n                                proceed = true;\n                            }\n                        } else {\n                            if (key === keys.left || key === keys.right) {\n                                proceed = true;\n                            }\n                        }\n                        if (proceed && !tabElement.parent().parent()[0].className.includes(\"dropdown-menu\")) { //To avoid if its a dropdown\n                            switch (key) {\n                                case keys.left:\n                                case keys.up:\n                                if (tabElement.parent().prev().prev().length != 0 && tabElement.parent().prev()[0].tagName != \"LI\") {\n                                \ttabElement.parent().prev().prev().find(\"> a\").click();\n                                }\n                                else if (tabElement.parent().prev().length != 0 ) {\n                                \ttabElement.parent().prev().find(\"> a\").click();\n                                \t}\n                                \telse {\n                                \t tabList.find(\"li:last > a\").click();\n                                \t}\n                                 break;\n                                case keys.right:\n                                case keys.down:\n                                if (tabElement.parent().next().next().length != 0 && tabElement.parent().next()[0].tagName != \"LI\") {\n                                \ttabElement.parent().next().next().find(\"> a\").click();\n                                \t}\n                                \telse if (tabElement.parent().next().length != 0)\n                                \t\ttabElement.parent().next().find(\"> a\").click();\n                                \telse {\n                                \t tabList.find(\"li:first > a\").click();\n                                \t }\n                                \t break;\n                                \t }\n                             }\n                     });\n                    // Set the click event for each tab link\n                    tabElement.click(function(event) {\n                        tabList.find(\"> li.active\").find(\"> a\").attr({\n                            \"aria-selected\": \"false\",\n                            \"tabindex\": \"-1\"\n                        });\n                        tabElement.attr({\n                            \"aria-selected\": \"true\"\n                        }).removeAttr(\"tabindex\").focus();\n                    });\n                });\n                // Set initial state for the selected tab\n                tabList.find(\"> li.active\").find(\"> a\").attr({\n                    \"aria-selected\": \"true\"\n                }).removeAttr(\"tabindex\");\n            }\n        }\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"ba2c64e253022010bcd5ddeeff7b12b4","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/d1c9ebbb04f12210559073c06a02f719","value":"d1c9ebbb04f12210559073c06a02f719"},"sys_update_name":"sp_angular_provider_ba2c64e253022010bcd5ddeeff7b12b4","sys_updated_by":"admin","sys_created_on":"2021-03-09 06:05:59","name":"addUibTabAccessibility","sys_name":"addUibTabAccessibility","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":"read"},{"sys_mod_count":"4","sys_updated_on":"2021-02-01 09:42:31","sys_tags":"","type":"directive","script":"function($rootScope, spUtil, $uibModal, $http) {\n\t'use strict';\n\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\ttemplate:   '<span class=\"ref-picker-container\">' +\n\t\t\t\t\t\t'<div class=\"add-on\" ng-if=\"field.value != \\'\\'\">' +\n\t\t\t\t\t\t\t'<button type=\"button\" class=\"btn btn-default bg-white lookup\" ng-click=\"openReference(field)\" aria-label=\"View Information\"><span class=\"fa fa-info-circle\"></span></button>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div class=\"reference\">' +\n\t\t\t\t\t\t\t'<mesp-survey-reference-element field=\"field\" sn-select-width=\"100%\" ref-table=\"field.refTable\" ref-id=\"field.sys_id\" glide-form=\"getGlideForm()\" record-values=\"getEncodedRecordValues()\" sn-disabled=\"field.isReadonly()\"/>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</span>',\n\n\t\tcontroller: function($scope){\n\t\t\t$scope.openReference = function(field) {\n\t\t\t\tvar data = {table: field.ed.reference, sys_id: field.value};\n\t\t\t\tif (angular.isDefined(field.reference_key))\n\t\t\t\t\tdata[field.reference_key] = field.value;\n\t\t\t\telse\n\t\t\t\t\tdata.sys_id = field.value;\n\n\t\t\t\tshowForm(data);\n\t\t\t};\n\n\n\t\t\tfunction showForm(data) {\n\t\t\t\tvar url = spUtil.getWidgetURL(\"widget-form\");\n\n\t\t\t\tvar req = {\n\t\t\t\t\tmethod : 'POST',\n\t\t\t\t\turl : url,\n\t\t\t\t\theaders : {\n\t\t\t\t\t\t'Accept' : 'application/json',\n\t\t\t\t\t\t'x-portal' : $rootScope.portal_id\n\t\t\t\t\t},\n\t\t\t\t\tdata : data\n\t\t\t\t}\n\t\t\t\t$http(req).then(qs, qe);\n\n\t\t\t\tfunction qs(response) {\n\t\t\t\t\tvar r = response.data.result;\n\t\t\t\t\tshowModal(r);\n\t\t\t\t}\n\t\t\t\t// error\n\t\t\t\tfunction qe(error) {\n\t\t\t\t\tconsole.error(\"Error \" + error.status + \" \" + error.statusText);\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tfunction showModal(form) {\n\t\t\t\tvar opts = {\n\t\t\t\t\tsize : 'lg',\n\t\t\t\t\ttemplateUrl : 'sp_form_modal',\n\t\t\t\t\tcontroller : ModalInstanceCtrl,\n\t\t\t\t\tresolve : {}\n\t\t\t\t};\n\n\t\t\t\topts.resolve.item = function() {\n\t\t\t\t\treturn angular.copy({\n\t\t\t\t\t\tform : form\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tvar modalInstance = $uibModal.open(opts);\n\t\t\t\tmodalInstance.result.then(function() {}, function() {});\n\n\t\t\t\t$scope.$on(\"$destroy\", function() {\n\t\t\t\t\tmodalInstance.close();\n\t\t\t\t});\n\n\t\t\t\tvar unregister = $scope.$on('sp.form.record.updated', function(evt, fields) {\n\t\t\t\t\tunregister();\n\t\t\t\t\tunregister = null;\n\t\t\t\t\tmodalInstance.close();\n\n\t\t\t\t\t// Do something here to refresh this record...\n\n\t\t\t\t\tif (evt.stopPropagation)\n\t\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction ModalInstanceCtrl($scope, $uibModalInstance, item) {\n\t\t\t\t$scope.item = item;\n\n\t\t\t\t$scope.ok = function() {\n\t\t\t\t\t$uibModalInstance.close();\n\t\t\t\t};\n\n\t\t\t\t$scope.cancel = function() {\n\t\t\t\t\t$uibModalInstance.dismiss('cancel');\n\t\t\t\t};\n\t\t\t}\n\n\n\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"ba561577531323002d96ddeeff7b122c","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_ba561577531323002d96ddeeff7b122c","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:55:02","name":"mespSurveyReferenceField","sys_name":"mespSurveyReferenceField","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"9","sys_updated_on":"2019-07-30 19:00:23","sys_tags":"","type":"directive","script":"function(dateUtils, $rootScope, $document, spDatePickerUtil, i18n) {\n    var dateFormat = dateUtils.SYS_DATE_FORMAT;\n\tvar dateTimeFormat = dateUtils.SYS_DATE_TIME_FORMAT;\n\n    if ($rootScope.user && $rootScope.user.date_format)\n\t\tdateFormat = $rootScope.user.date_format;\n\t\n\tif ($rootScope.user && $rootScope.user.date_time_format)\t\t\n \t\tdateTimeFormat = $rootScope.user.date_time_format;\n\n    function isValidDate(value, format){\n        if (value === '')\n            return true;\n\n        return dateUtils.getDateFromFormat(value, format) != 0;\n    }\n\n    return {\n        template:\n            '<div class=\"row\"><div class=\"col-xs-12 col-sm-6 col-md-4 question-date-time-field\">' +\n                '<div class=\"wrapper-xs alert alert-danger\" ng-if=\"field.invalidValue\">' +\n                    '${Value is invalid}' +\n                '</div>' +\n                '<div ng-class=\"{\\'input-group\\': !snDisabled, \\'has-error\\': field.invalidValue}\" style=\"width: 100%;\">' +\n                    '<input type=\"text\" name=\"{{field.name}}\" class=\"form-control\" placeholder=\"{{::field.placeholder}}\" ng-model=\"formattedDate\" ng-model-options=\"{updateOn: \\'blur\\', getterSetter: true}\" ng-disabled=\"snDisabled\" aria-label=\"{{::field.label}} Field\"/>' +\n                    '<span class=\"input-group-btn question-calendar-icon\" ng-hide=\"snDisabled\">' +\n                        '<input type=\"hidden\" class=\"datepickerinput\" ng-model=\"formattedDate\" ng-readonly=\"true\" />' +\n                        '<button class=\"btn btn-default question-calendar-button\" type=\"button\" aria-label=\"{{::field.label}} Button\">' +\n                            '<glyph sn-char=\"calendar\" />' +\n                        '</button>' +\n                    '</span>' +\n                '</div>' +\n            '</div>' + '<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' + '</div>',\n        restrict: 'E',\n        replace: true,\n        require: '?ngModel',\n        scope: {\n            field: '=',\n            snDisabled: '=',\n            snIncludeTime: '=',\n            snChange: '&'\n        },\n        link: function(scope, element, attrs, ngModel) {\n            var includeTime = scope.snIncludeTime;\n\t\t\tvar cabrilloButton = {DONE: 1, CANCEL: 0};\n\t\t\tvar cabrilloTitle = document.titleformat;\n\t\t\tvar  initDateTimePicker = true;\n            var format = includeTime ? dateTimeFormat.trim() : dateFormat.trim();\n\t\t\tformat = format.replace(/y/g, 'Y').replace(/d/g, 'D').replace(/a/g, 'A');\t\n\t\t\tvar dp = element.find('.input-group-btn').datetimepicker({\n                keepInvalid: true,\n                pickTime: scope.snIncludeTime === true,\n                format: \"HH:mm:ss\"\n            }).on('dp.change', onDpChange);\n\t\t\t\n\t\t\telement.find('.form-control').on('click', function (e) {\n\t\t\t\tif (!scope.snDisabled) {\n                    element.find('.input-group-btn').click();\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t\treturn ;\n            });\n\n            function closeOnTouch(evt) {\n                if (!jQuery.contains(dp.data('DateTimePicker').widget[0], evt.target)) {\n                        dp.data('DateTimePicker').hide();\n                }\n            }\n\n            function bindTouchClose() {\n\t\t\t\tif (initDateTimePicker) {\n\t\t\t\t\tinitDateTimePicker = false;\n\t\t\t\t\tattachKeyboardEvent(dp.data('DateTimePicker'));\n\t\t\t\t}\n                $document.on('touchstart', closeOnTouch);\n\t\t\t\tonShowDatePickerCabrillo(dp.data('DateTimePicker'));\n            }\n\t\t\t\n\t\t\tfunction attachKeyboardEvent(picker) {\n\t\t\t\tpicker.widget.on('click', '.datepicker .day div', $.proxy(onClickEvt, this, picker));\n\t\t\t}\n\t\t\t\n\t\t\tfunction onClickEvt(picker, e) {\n\t\t\t\tif (snmCabrillo.isNative()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfunction onShowDatePickerCabrillo(picker) {\n\t\t\t\t$(document).find(\".sp-page-root\").addClass(\"hide\");\n\t\t\t\t//event for subscribers to know modal open\n\t\t\t\t$rootScope.$broadcast('mesp.popup.open');\n\t\t\t\t//do not run when not in native app\n\t\t\t\tif (!snmCabrillo.isNative()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tsnmCabrillo.viewLayout.getTitle().then(function(title) {\n\t\t\t\t\tcabrilloTitle = title;\n\t\t\t\t});\n\t\t\t\tsetCabrilloBottomButton(picker);\n\t\t\t\tsetCabrilloTitle(picker);\n\t\t\t\tshowCabrilloButtons(picker);\n\t\t\t}\n\t\t\t\n\t\t\t//Temp hide bottom button, need SC cate team response to event to reset bottom button back\n\t\t\tfunction setCabrilloBottomButton() {\n\t\t\t\tsnmCabrillo.viewLayout.setBottomButtons([], function() {});\n\t\t\t}\n\t\t\t\n\t\t\tfunction showCabrilloButtons(picker) {\n\t\t\t\tvar input = spDatePickerUtil.getSPDateickerInput(picker),\n\t\t\t\tvalue;\n\t\t\n\t\t\t\tvar buttons = [{\n\t\t\t\t\ttitle: scope.translations[\"Cancel\"],\n\t\t\t\t\tbuttonStyle: snmCabrillo.viewLayout.REPLACE_BACK_BUTTON_STYLE,\n\t\t\t\t\tenabled: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: scope.translations[\"Done\"],\n\t\t\t\t\tenabled: true\n\t\t\t\t}];\n\t\t\t\tif (input) {\n\t\t\t\t\tvalue = input.val();\n\t\t\t\t}\n\t\t\t\t//hide Cabrillo top left back button\n \t\t\t\tif(typeof snmCabrillo.viewLayout.hideBackButton == 'function') {\n \t\t\t\t\tsnmCabrillo.viewLayout.hideBackButton();\n \t\t\t\t}\n\t\t\t\tsnmCabrillo.viewLayout.setNavigationBarButtons(buttons, function (buttonIndex) {\n\t\t\t\t\tswitch (buttonIndex) {\n\t\t\t\t\t\tcase cabrilloButton.DONE:\n\t\t\t\t\t\tonClickCabrilloButton(cabrilloButton.DONE, picker, picker.date);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase cabrilloButton.CANCEL:\n\t\t\t\t\t\tonClickCabrilloButton(cabrilloButton.CANCEL, picker, value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tfunction onClickCabrilloButton(button, picker, value) {\n\t\t\t\t$(document).find(\".sp-page-root\").removeClass(\"hide\");\n\t\t\t\t//event for subscribers to reset their header (title, buttons..etc)\n\t\t\t\t$rootScope.$broadcast('mesp.popup.close');\n\t\t\t\t//we can remove below once subscribers handle mesp_header_reset event\n\t\t\t\tsnmCabrillo.viewLayout.setTitle(cabrilloTitle);\n\t\t\t\tsnmCabrillo.viewLayout.setNavigationBarButtons([], null);\n\t\t\t\t//show Cabrillo top left back button\n\t\t\t\tif(typeof snmCabrillo.viewLayout.showBackButton == 'function') {\n\t\t\t\t\tsnmCabrillo.viewLayout.showBackButton();\n\t\t\t\t}\n\t\t\t\tif(button === cabrilloButton.CANCEL || scope.field.stagedValue == \"\") {\n\t\t\t\t\tscope.formattedDate(value);\n\t\t\t\t}\n\t\t\t\tpicker.hide();\n\t\t\t}\n\t\t\t\n\t\t\tfunction setCabrilloTitle(picker) {\n\t\t\t\tif(picker.options.pickTime) {\n\t\t\t\t\tsnmCabrillo.viewLayout.setTitle(i18n.getMessage('Date and time'));\n\t\t\t\t} else {\n\t\t\t\t\tsnmCabrillo.viewLayout.setTitle(i18n.getMessage('Date'));\n\t\t\t\t}\n\t\t\t}\n\n            function unBindTouchClose() {\n                $document.off('touchstart', closeOnTouch);\n            }\n            dp.on('dp.show', bindTouchClose).on('dp.hide', unBindTouchClose);\n\n            function onDpChange(e) {\n                scope.formattedDate(e.date.format(format));\n\n                if (!scope.$root.$$phase)\n                    scope.$apply();\n            }\n\n            function validate(formattedDate) {\n                var field = scope.field;\n                field.invalidValue = false;\n\t\t\t\tvar format = scope.snIncludeTime ? dateTimeFormat.trim() : dateFormat.trim();\n                if (formattedDate == null || formattedDate == '') {\n                    dp.data('DateTimePicker').setValue(new Date());\n                    return '';\n                }\n\n                if (isValidDate(formattedDate, format)) {\n                    var d = dateUtils.getDateFromFormat(formattedDate, format);\n                    dp.data('DateTimePicker').setValue(scope.formattedDate);\n                }\n                else {\n                    field.invalidValue = true;\n                }\n                return formattedDate;\n            }\n\n            if (ngModel) {\n                ngModel.$parsers.push(validate);\n\n                // Called when setting value from g_form.setValue()\n                // Shows a red border if the date isn't formatted properly\n                ngModel.$render = function() {\n                    validate(ngModel.$viewValue);\n                };\n\n                // Connect the input field's ng-model to this directive's ng-model\n                scope.formattedDate = function(formattedValue) {\n                    if (angular.isDefined(formattedValue)) {\n                        ngModel.$setViewValue(formattedValue);\n                        if (scope.snChange) scope.snChange({newValue: formattedValue});\n                    }\n\n                    return ngModel.$viewValue;\n                };\n            } else {\n                scope.formattedDate = function(formattedValue) {\n                    if (angular.isDefined(formattedValue)) {\n                        scope.field.value = validate(formattedValue);\n                        if (scope.snChange) scope.snChange({newValue: formattedValue});\n                    }\n\n                    return scope.field.value;\n                };\n                scope.$watch('field.value', function(newValue, oldValue){\n                    if (newValue != oldValue) {\n                        validate(newValue);\n                    }\n                });\n            }\n\n            scope.$on('$destroy', function() {\n                dp.off('dp.change', onDpChange);\n                unBindTouchClose();\n            });\n\t\t\t\n\t\t\tscope.translations = [];\n\t\t\ti18n.getMessages([\"Enter date in format\", \"Use format\", \"Entered date not valid. Enter date in format\", \"Show calendar\", \"Done\",\n\t\t\"Cancel\"], function(msgs){\n\t\t\t\tscope.translations = msgs;\n\t\t\t});\n        }\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"bb765577531323002d96ddeeff7b1206","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_bb765577531323002d96ddeeff7b1206","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:55:34","name":"mespSurveyDatePicker","sys_name":"mespSurveyDatePicker","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"261","sys_updated_on":"2021-05-13 15:37:49","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\ttemplate: '<div>' +\n\t\t\t\t\t'<table ng-if=\"!isMobile\" class=\"table\" style=\"margin-bottom:0\" role=\"presentation\">' +\n\t\t\t\t\t\t'<thead>' +\n\t\t\t\t\t\t\t'<tr>' +\n\t\t\t\t\t\t\t\t'<td ng-style=\"{width: questionWidth + \\'%\\'}\" style=\"border-top:0; padding-left:0\"><h4 class=\"question-label\" style=\"margin:0;margin-top:-1px\">${Question}</h4></td>' +\n\t\t\t\t\t\t\t\t'<td class=\"sps-radio-label text-center\" ng-style=\"{width: (100 - questionWidth) + \\'%\\'}\">' +\n\t\t\t\t\t\t\t\t        '<div style=\"display:inline-block; overflow-wrap:break-word; border-top:0;\" ng-repeat=\"c in templateGroup.choices track by $index\" ng-style=\"{width: choiceWidth + \\'%\\'}\">{{::c}}</div>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'</thead>' +\n\t\t\t\t\t\t'<div>' +\n\t\t\t\t\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.templateMandatoryFilled\">{{c.showMandatoryMessage()}}</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<tbody>' +\n\t\t\t\t\t\t\t'<tr ng-repeat=\"qid in templateGroup.questions track by $index\">' +\n\t\t\t\t\t\t\t\t'<td ng-style=\"{width: questionWidth + \\'%\\'}\" style=\"padding-left:0\" ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\">' +\n\t\t\t\t\t\t\t\t\t'<span id=\"notAnswered{{questionsMap[qid].sys_id}}\">' +\n\t\t\t\t\t\t\t\t\t\t'<span class=\"sr-only\" ng-if=\"!questionsMap[qid].isMandatoryFilled\">{{c.showMandatoryMessage()}}</span>' +\n\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t'<span class=\"sps-radio-label\">' +\n\t\t\t\t\t\t\t\t\t\t'<span class=\"field-decorations\">' +\n\t\t\t\t\t\t\t\t\t\t'<span ng-show=\"questionsMap[qid].mandatory\" class=\"fa fa-asterisk mandatory\" aria-hidden=\"true\" ng-class=\"{\\'mandatory-filled\\': (questionsMap[qid].value != null && questionsMap[qid].value != undefined && questionsMap[qid].value != \\'\\')}\" style=\"padding-right: .25em\" ></span>' +\n\t\t\t\t\t\t\t\t\t\t'<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t'{{::questionsMap[qid].label}}' +\n\t\t\t\t\t\t\t\t\t\t'<div id=\"details_{{questionsMap[qid].sys_id}}\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::questionsMap[qid].details\" ng-bind-html=\"questionsMap[qid].details\"></div>' +\n\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t\t'<td class=\"text-center\" ng-style=\"{width: (100 - questionWidth) + \\'%\\'}\" ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\">' +\n\t\t\t\t\t\t\t\t\t'<fieldset>' + \n\t\t\t\t\t\t\t\t\t\t'<legend class=\"sr-only\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].mandatory && !questionsMap[qid].value\">${Required} - </span>' +\n\t\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].mandatory && questionsMap[qid].value\">${Required filled} - </span>' +\n\t\t\t\t\t\t\t\t\t\t\t'<span>{{c.getAriaLabel(questionsMap[qid])}}{{\" \"}}</span>' +\n\t\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"!questionsMap[qid].isMandatoryFilled\">{{c.showMandatoryMessage()}}</span>' +\n\t\t\t\t\t\t\t\t\t\t'</legend>' +\n\t\t\t\t\t\t\t\t\t\t'<div style=\"display:inline-block;\" ng-style=\"{width: choiceWidth + \\'%\\'}\" ng-repeat=\"c in questionsMap[qid].template.choices track by $index\">' +\n\t\t\t\t\t\t\t\t\t\t\t'<input name=\"radio-button-{{qid}}\" class=\"template-radio-choice autofocus-class\" ng-if=\"!questionsMap[qid].template.allow_image\" ng-class=\"{\\'autofocus-error\\':!questionsMap[qid].isMandatoryFilled}\" aria-label=\"{{::c.label}}\" aria-checked=\"{{questionsMap[qid].value == c.value}}\" ng-checked=\"questionsMap[qid].value == c.value\" ng-click=\"selectChoice(questionsMap[qid], c)\" type=\"radio\" value=\"{{::c.value}}\" aria-describedby=\"details_{{questionsMap[qid].sys_id}} notAnswered{{questionsMap[qid].sys_id}}\" />' +\n\t\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].template.allow_image && questionsMap[qid].selectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<label>' + \n\t\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"sr-only\">{{c.label}}</span>' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<input aria-describedby=\"details_{{questionsMap[qid].sys_id}}\" ng-class=\"{\\'autofocus-error\\':!questionsMap[qid].isMandatoryFilled}\" name=\"radio-button-{{qid}}\" class=\"autofocus-class\" style=\"opacity: 0; position: absolute;\" aria-checked=\"{{questionsMap[qid].value == c.value}}\" ng-checked=\"questionsMap[qid].value == c.value\" ng-click=\"selectChoice(questionsMap[qid], c)\" type=\"radio\" value=\"{{::c.value}}\" />' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"span-img-choice\" ng-if=\"!questionsMap[qid].unSelectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'<img src=\"{{c.selected_image}}?t=small\" style=\"width:64px; height:64px; margin-bottom:12px\" ng-style=\"{\\'opacity\\' : (c.value == questionsMap[qid].value) ? \\'1\\' : \\'0.5\\'}\"/>' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"span-img-choice\" ng-if=\"questionsMap[qid].unSelectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'<img src=\"{{c.image}}?t=small\" style=\"width:64px; height:64px; margin-bottom:12px\"/>' +\n\t\t\t\t\t\t\t\t\t\t\t\t\t'</span>' +\t\n\t\t\t\t\t\t\t\t\t\t\t\t'</label>' +\n\t\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].template.allow_image && !questionsMap[qid].selectedImageAllPresent\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<input aria-describedby=\"details_{{questionsMap[qid].sys_id}}\" ng-class=\"{\\'autofocus-error\\':!questionsMap[qid].isMandatoryFilled}\" name=\"radio-button-{{qid}}\" aria-label=\"{{::c.label}}\" class=\"template-radio-choice autofocus-class\" aria-checked=\"{{questionsMap[qid].value == c.value}}\" ng-checked=\"questionsMap[qid].value == c.value\" ng-click=\"selectChoice(questionsMap[qid], c)\" type=\"radio\" value=\"{{::c.value}}\" />' +\n\t\t\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t'</fieldset>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'</tbody>' +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'<table ng-if=\"isMobile\" class=\"table\" style=\"margin-bottom:0\">' +\n\t\t\t\t\t\t'<tbody ng-repeat=\"qid in templateGroup.questions track by $index\">' +\n\t\t\t\t\t\t\t'<tr ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\">' +\n\t\t\t\t\t\t\t\t'<th style=\"border-top:0\">' +\n\t\t\t\t\t\t\t\t\t'{{::questionsMap[qid].label}}' +\n\t\t\t\t\t\t\t\t\t'<div id=\"details_{{questionsMap[qid].sys_id}}\">' +\n\t\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::questionsMap[qid].details\" ng-bind-html=\"questionsMap[qid].details\"></div>' +\n\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t'</th>' +\n\t\t\t\t\t\t\t\t'<th style=\"border-top:0\"></th>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t\t'<tr ng-if=\"c.isDependencySatisfiedHelper(questionsMap[qid])\" ng-repeat=\"c in questionsMap[qid].template.choices track by $index\">' +\n\t\t\t\t\t\t\t\t'<td>{{::c.label}}' +\n\t\t\t\t\t\t\t\t'<div id=\"details_{{questionsMap[qid].sys_id}}\">' +\n\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::questionsMap[qid].details\" ng-bind-html=\"questionsMap[qid].details\"></div></div>'+\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t\t'<td>' +\n\t\t\t\t\t\t\t\t\t'<input aria-describedby=\"details_{{questionsMap[qid].sys_id}}\" ng-class=\"{\\'autofocus-error\\':!questionsMap[qid].isMandatoryFilled}\" name=\"radio-button-{{qid}}\" class=\"autofocus-class\" ng-if=\"!questionsMap[qid].template.allow_image\" aria-label=\"{{::c.label}}\" aria-checked=\"{{questionsMap[qid].value == c.value}}\" ng-checked=\"questionsMap[qid].value == c.value\" ng-click=\"selectChoice(questionsMap[qid], c)\" type=\"radio\" value=\"{{::c.value}}\" />' +\n\t\t\t\t\t\t\t\t\t'<span ng-if=\"questionsMap[qid].template.allow_image\">' +\n\t\t\t\t\t\t\t\t\t\t'<img src=\"{{c.image}}?t=small\" alt=\"{{::c.label}}\" ng-click=\"selectChoice(questionsMap[qid], c)\" ng-style=\"{\\'opacity\\' : (c.value == questionsMap[qid].value) ? \\'1\\' : \\'0.5\\'}\" />' +\n\t\t\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'</tbody>' +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'</div>',\n\n\t\tscope: {\n\t\t\ttemplateGroup: '=',\n\t\t\tquestionsMap: '=',\n\t\t\tdata: '=',\n\t\t\tc: '=',\n\t\t\tisMobile: '=',\n\t\t\tfield: '='\n\t\t},\n\n\t\tcontroller: function($scope) {\n\t\t\t// setting initial mandatory filled state for template \n\t\t\t$scope.field.templateMandatoryFilled = true;\n\t\t\tvar numChoices = $scope.templateGroup.choices.length;\n\t\t\tif (numChoices > 0 && numChoices <= 5) {\n\t\t\t\t$scope.questionWidth = 40;\n\t\t\t\t$scope.choiceWidth = 100 / numChoices;\n\t\t\t} else if (numChoices > 5) {\n\t\t\t\t$scope.questionWidth = 15;\n\t\t\t\t$scope.choiceWidth = 100 / numChoices;\n\t\t\t}\n\n\t\t\tvar unselectChoice = function(choice) {\n\t\t\t\tchoice.image = choice.unselected_image;\n\t\t\t};\n\n\t\t\tvar unselectAllChoices = function(question) {\n\t\t\tif (!question.selectedImageOnly)\n\t\t\t\tquestion.template.choices.forEach(unselectChoice);\n\t\t\telse\n\t\t\t\tquestion.template.choices.forEach(function(choice){choice.image = choice.selected_image});\n\t\t\t};\n\n\t\t\tvar unselectAllChoicesAllQuestions = function() {\n\t\t\t\t$scope.templateGroup.questions.map(function(qid) {return $scope.questionsMap[qid]}).forEach(unselectAllChoices);\n\t\t\t};\n\n\t\t\t$scope.selectChoice = function(question, choice) {\n\t\t\t\tquestion.value = choice.value;\n\t\t\t\tif (question.unSelectedImageAllPresent) {\n\t\t\t\t\tquestion.template.choices.forEach(unselectChoice);\n\t\t\t\t\tchoice.image = choice.selected_image;\n\t\t\t\t}\n\t\t\t\t// Update templateMandatoryFilled only on mandatory questions and when the error message not displayed\n\t\t\t\tif(!$scope.field.templateMandatoryFilled && question.mandatory)\n\t\t\t\t    $scope.field.templateMandatoryFilled = $scope.c.calculateTemplateMandatory($scope.templateGroup);\n\t\t\t};\n\n\t\t\tvar loadChoices = function(question) {\n\t\t\t\tquestion.template.choices.forEach(function(choice) {\n\t\t\t\t\tif (!question.selectedImageOnly && question.value == choice.value) {\n\t\t\t\t\t\tchoice.image = choice.selected_image;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// Do it the first time so that all images show up\n\t\t\tunselectAllChoicesAllQuestions();\n\t\t\t$scope.templateGroup.questions.map(function(qid) {return $scope.questionsMap[qid]}).forEach(loadChoices);\n\t\t},\n\n\t\treplace: true\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"bc60324fc3331200e44574e1c1d3ae00","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_bc60324fc3331200e44574e1c1d3ae00","sys_updated_by":"admin","sys_created_on":"2016-06-08 20:08:16","name":"spSurveyTemplate","sys_name":"spSurveyTemplate","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"6","sys_updated_on":"2023-10-13 10:23:25","sys_tags":"","type":"directive","script":"function(){\n\treturn {\n\t\ttemplate:\n\t\t'<nav class=\"cm-pagination\" aria-label=\"Knowledge Pagination\">'+\n\t\t'<ul class=\"pagination\" style=\"cursor:pointer;\">'+\n\t\t'<li ng-class=\"{disabled:currentPage === 1}\" class=\"page-item\">'+\n\t\t'<a ng-click=\"changePage(currentPage - 1)\" class=\"page-link\" href=\"javascript:void(0);\" aria-label=\"Previous\">'+\n\t\t'<i class=\"fa fa-caret-left\" data-toggle=\"tooltip\" title = \"${Previous page}\" aria-hidden=\"true\"></i>'+\n\t\t'<span class=\"sr-only\">${Previous}</span>'+\n\t\t'</a>'+\n\t\t'</li>'+\n\t\t'<li ng-repeat=\"index in displayPages track by $index\" ng-class=\"{active:currentPage === index}\">'+\n\t\t'<a href=\"javascript:void(0);\" ng-click=\"changePage(index)\" aria-current=\"{{currentPage === index ? page : false}}\" aria-label=\"${Page} {{index}}\">{{index}}</a>'+\n\t\t'</li>'+\n\t\t'<li ng-class=\"{disabled:currentPage === pageCount && pageCount != 1}\" class=\"page-item\"> '+\n\t\t'<a ng-click=\"changePage(currentPage + 1)\" class=\"page-link\" href=\"javascript:void(0);\" aria-label=\"Next\">'+\n\t\t'<i class=\"fa fa-caret-right\" data-toggle=\"tooltip\" title = \"${Next page}\" aria-hidden=\"true\"></i>'+\n\t\t'<span class=\"sr-only\">${Next}</span>'+\n\t\t'</a>'+\n\t\t'</li>'+\n\t\t'</ul>'+\n\t\t'</nav>'+\n\t\t'<style>'+\n\t\t'.tooltip-inner {white-space:nowrap;max-width:none;}'+\n\t\t'.tooltip.top{margin-top:-6px;padding-top: 5px;padding-right: 0px;padding-bottom: 5px;padding-left: 0px;}'+\n\t\t'</style>',\n\t\tscope: {\n\t\t\tpagedata:\"=\",\n\t\t\tonPageChange:\"&\",\n\t\t\tgetNextSetCount:\"&\"\n\t\t},\n\n\t\tcontroller : function($scope, $rootScope){\n\t\t\t$scope.countPages = function (totalCount, pageSize) {\n\t\t\t\treturn Math.ceil(totalCount / pageSize);\n\t\t\t};\n\n\t\t\t$scope.setPageRange = function (startIndex) {\n\t\t\t\t$scope.displayPages = [];\n\t\t\t\tvar pageCount = $scope.countPages($scope.pagedata.totalCount, $scope.pagedata.pageSize);\n\t\t\t\tvar end = startIndex + ($scope.pagedata.noOfLinks-1);\n\n\t\t\t\twhile(end > pageCount && pageCount != 1){end--;}\n\n\t\t\t\twhile(startIndex > 0 && startIndex <= end && (pageCount == 1 || end <= pageCount)){\n\t\t\t\t\t$scope.displayPages.push(startIndex++);\n\t\t\t\t}\n\n\t\t\t\t$scope.pageCount = pageCount;\n\t\t\t};\n\n\t\t\tvar unRegReset =$rootScope.$on('sp.kb.updated.pagination.count',function (event,data){\n\t\t\t\t$scope.initialize();\n\t\t\t});\n\n\t\t\tvar startIndex;\n\t\t\t$scope.initialize = function(){\n\t\t\t\t//Initialize the pagination\n\t\t\t\tstartIndex = 1;\n\t\t\t\t$scope.setPageRange(startIndex);\n\t\t\t\t$scope.currentPage = 1;\n\t\t\t\t$scope.page = \"page\";\n\t\t\t}\n\t\t\t$scope.initialize();\n\n\t\t\t$scope.changePage = function (index) {\n\t\t\t\tif(index == $scope.currentPage) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (index < 1 || index > $scope.pageCount) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(index > $scope.currentPage){\n\t\t\t\t\t$scope.currentPage = index;\n\t\t\t\t\tif($scope.pagedata.noOfLinks==1){\n\t\t\t\t\t\tstartIndex += ($scope.pagedata.noOfLinks);\n\t\t\t\t\t\t$scope.setPageRange(startIndex);\n\t\t\t\t\t}else if($scope.currentPage % ($scope.pagedata.noOfLinks-1) == 1 || $scope.pagedata.noOfLinks==2){\n\t\t\t\t\t\tstartIndex += ($scope.pagedata.noOfLinks-1);\n\t\t\t\t\t\t$scope.setPageRange(startIndex);\n\t\t\t\t\t}\n\t\t\t\t}else if(index < $scope.currentPage){\n\t\t\t\t\tif($scope.pagedata.noOfLinks==1 && $scope.currentPage != 1){\n\t\t\t\t\t\tstartIndex -= ($scope.pagedata.noOfLinks);\n\t\t\t\t\t\t$scope.setPageRange(startIndex);\n\t\t\t\t\t}else if(($scope.currentPage % ($scope.pagedata.noOfLinks-1) == 1 || $scope.pagedata.noOfLinks==2)&& $scope.currentPage != 1){\n\t\t\t\t\t\tstartIndex -= ($scope.pagedata.noOfLinks-1);\n\t\t\t\t\t\t$scope.setPageRange(startIndex);\n\t\t\t\t\t}\n\t\t\t\t\t$scope.currentPage = index;\n\t\t\t\t}\n\t\t\t\t$scope.onPageChange({currentPage: $scope.currentPage});\n\t\t\t};\n\n\t\t\tvar unRegPageResult = $rootScope.$on('sp.kb.updated.pagination.articleCount',function (event,data){\n\t\t\t\t$scope.pagedata.totalCount = $scope.pagedata.totalCount+data.count;\n\t\t\t\t$scope.setPageRange(startIndex);\n\t\t\t});\n\n\t\t\t$scope.$on(\"$destroy\", function() {\n\t\t\t\tunRegPageResult();\n\t\t\t\tunRegReset();\n\n\t\t\t});\n\n\t\t}\n\t}\n}","sys_class_name":"sp_angular_provider","sys_id":"beb7565153630300cc376512a2dc3494","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/bab6dea3db20320099f93691f0b8f590","value":"bab6dea3db20320099f93691f0b8f590"},"sys_update_name":"sp_angular_provider_beb7565153630300cc376512a2dc3494","sys_updated_by":"admin","sys_created_on":"2018-01-08 10:10:56","name":"kbPagination","sys_name":"kbPagination","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/bab6dea3db20320099f93691f0b8f590","value":"bab6dea3db20320099f93691f0b8f590"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"14","sys_updated_on":"2024-07-26 11:29:49","sys_tags":"","type":"directive","script":"// <sc-toggle-data sn-data=\"HTML object\" sn-limit=\"\" sn-less-text=\"Read Less\" sn-more-text=\"Read More\"></sc-toggle-data>\nfunction scToggleData(i18n, cabrillo) {\n\t\"use strict\";\n\treturn {\n\t\trestrict: 'E',\n\t\tscope: {\n\t\t\tmoreText: '@snMoreText',\n\t\t\tlessText: '@snLessText',\n\t\t\tlimit: '<snLimit',\n\t\t\tdata: '<snData'\n\t\t\t},\n\n\t\ttemplate: '<now-message key=\"Show more\" value=\"${Show more}\"/>' +\n\t\t\t\t'<now-message key=\"Show less\" value=\"${Show less}\"/>',\n\n\t\tlink: function(scope, elem) {\n\t\t\tvar moreText = scope.moreText ||  i18n.getMessage('Show more');\n\t\t\tvar lessText = scope.lessText || i18n.getMessage('Show less');\n\n\t\t\tvar moreTextCmp = ' <a class=\"read-more\">' + moreText + '</a>';\n\t\t\tvar lessTextCmp = ' <a class=\"read-less\">' + lessText + '</a>';\n\n\t\t\tif (cabrillo.isNative()) {\n\t\t\t\t\tmoreTextCmp = ' <div style=\"display: flex;justify-content: center;align-items: center;\" class=\"m-t\"> <a class=\"btn btn-default read-more\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">' + moreText + '</a></div>';\n\t\t\t\t\tlessTextCmp = ' <div style=\"display: flex;justify-content: center;align-items: center;\" class=\"m-t\"> <a class=\"btn btn-default read-less\" role=\"button\" aria-expanded=\"true\" tabindex=\"0\">' + lessText + '</a></div>';\n\t\t\t}\n\n\t\t\tvar limit = angular.isUndefined(scope.limit) || !scope.limit || scope.limit < 1 ? 150 : scope.limit;\n\t\t\tvar text = angular.isUndefined(scope.data) ? '' : scope.data;\n\t\t\tvar ellipsis = '<span aria-hidden=\"true\">...</span>';\n\n\t\t\tvar textHtml = String(text);\n\t\t\tvar textNonHtml = textHtml.replace(/<([^>\\s]*)[^>]*>/gm, '');\n\t\t\tvar charCount = textNonHtml.length;\n\n\t\t\tif (charCount > limit && cabrillo.isNative())\n\t\t\t\ttextHtml = htmlSubstring(textHtml, limit, ellipsis, moreTextCmp, lessTextCmp);\n\n\t\t\telem.html(textHtml);\n\t\t\telem.find('.read-more').on('click', function() {\n\t\t\t\telem.find('.less-text').hide();\n\t\t\t\telem.find('.more-text').show();\n\t\t\t\telem.find('.read-less').focus();\n\t\t\t\t});\n\n\t\t\telem.find('.read-less').on('click', function() {\n\t\t\t\telem.find('.more-text').hide();\n\t\t\t\telem.find('.less-text').show();\n\t\t\t\telem.find('.read-more').focus();\n\t\t\t\t});\n\n\t\t\tfunction htmlSubstring(textHtml, limit, ellipsis, moreText, lessText) {\n\t\t\t\tvar tags;\n\t\t\t\tvar tagFinder = /<([^>\\s]*)[^>]*>/gm;\n\t\t\t\tvar stack = [];\n\t\t\t\tvar lastTagIndex = 0;\n\t\t\t\tvar result = '';\n\n\t\t\t\t//finding tag in each line\n\t\t\t\twhile ((tags = tagFinder.exec(textHtml)) && limit) {\n\t\t\t\t\t//get the text between previous iteration tag-end index and current iteration tag-start index.\n\t\t\t\t\tvar temp = textHtml.substring(lastTagIndex, tags.index).replace(/\\s\\s+/g,'').substr(0, limit);\n\t\t\t\t\tresult += temp;\n\t\t\t\t\tlimit -= temp.length;\n\t\t\t\t\tlastTagIndex = tagFinder.lastIndex;\t//updating last-index of current iteration\n\n\t\t\t\t\tif (limit) {\n\t\t\t\t\t\tresult += tags[0];\n\t\t\t\t\t\tif (tags[1].indexOf('/') === 0)\n\t\t\t\t\t\t\tstack.pop();\n\t\t\t\t\t\telse if (tags[1].lastIndexOf('/') !== tags[1].length-1)\n\t\t\t\t\t\t\tstack.push(tags[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresult += ellipsis;\n\t\t\t\t//fix the unclosed tags\n\t    \t    while (stack.length) {\n\t    \t    \tresult += '</' + stack.pop() + '>';\n\t    \t    \t}\n\t\t\t\tresult += moreText;\n\n\t    \t    result = '<span class=\"less-text\">' + result +  '</span><span class=\"more-text\" tabindex=\"-1\">' + textHtml + lessText + '</span>';\n\t    \t    return result;\n\n\t\t\t}\n\t\t}\n\t};\n\n}","sys_class_name":"sp_angular_provider","sys_id":"c045f99a0b67320014ea425663673a25","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/d1c9ebbb04f12210559073c06a02f719","value":"d1c9ebbb04f12210559073c06a02f719"},"sys_update_name":"sp_angular_provider_c045f99a0b67320014ea425663673a25","sys_updated_by":"admin","sys_created_on":"2017-06-26 14:02:25","name":"scToggleData","sys_name":"scToggleData","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"51","sys_updated_on":"2021-05-25 18:39:02","sys_tags":"","type":"directive","script":"function spLazyWidget(spUtil, $timeout) {\n\t\n\tvar CACHE = {};\n\tvar MAX_CACHE_ITEMS = 100;\n\tvar SPINNER_DELAY = 300;\n\n\tvar templateHtml = [\n\t\t'<div class=\"lazywidget\" ng-class=\"{loading: ctrl.loading}\">',\n\t\t'\t\t<div class=\"__spinner\">',\n\t\t'\t\t\t<i class=\"fa fa-circle-o-notch fa-2x fa-spin\" aria-hidden=\"true\"></i>',\n\t\t'\t\t</div>',\n\t\t'\t\t<sp-widget widget=\"ctrl.widgetConfig\" ng-if=\"ctrl.widgetConfig\"/>',\n\t\t'</div>'\n\t].join('');\n\t\n\tvar styles = [\n\t\t'.lazywidget > .__spinner {',\n\t\t'\t\ttext-align:center;',\n\t\t'\t\tdisplay: none;',\n\t\t'\t\tcolor:#b7b7b7;',\n\t\t'}',\n\t\t'.lazywidget.loading > .__spinner {',\n\t\t'\t\tdisplay: block;',\n\t\t'}'\n\t].join('');\n\n\tfunction Controller($scope) {\n\t\tthis.loading = false;\n\t\tthis.widgetConfig = null;\n\t\tthis._importWidget(this.name, this.options);\n\t}\n\n\tController.prototype = {\n\n\t\t_importWidget: function(widgetName, widgetOptions) {\n\t\t\tvar self = this;\n\t\t\tvar cachedConfig = this._getCache(widgetName, widgetOptions);\n\t\t\tif (cachedConfig) {\n\t\t\t\tthis._renderWidget(cachedConfig);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar timer = $timeout(function() {\n\t\t\t\t// show spinner only if wait is longer than 300ms\n\t\t\t\tself.loading = true;\n\t\t\t}, SPINNER_DELAY);\n\t\t\tspUtil.get(widgetName, widgetOptions).then(function(widgetConfig) {\n\t\t\t\t$timeout.cancel(timer);\n\t\t\t\tself._renderWidget(widgetConfig);\n\t\t\t\tself._setCache(widgetName, widgetOptions, widgetConfig);\n\t\t\t});\n\t\t},\n\t\t\n\t\t_renderWidget: function(widgetConfig) {\n\t\t\tthis.loading = false;\n\t\t\tthis.widgetConfig = widgetConfig;\n\t\t},\n\t\t\n\t\t_setCache: function(widgetName, widgetOptions, widgetConfig) {\n\t\t\tif (Object.keys(CACHE).length > MAX_CACHE_ITEMS) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar cacheKey = this._createCacheKey(widgetName, widgetOptions);\n\t\t\tCACHE[cacheKey] = widgetConfig;\n\t\t},\n\n\t\t_getCache: function(widgetName, widgetOptions) {\n\t\t\tvar cacheKey = this._createCacheKey(widgetName, widgetOptions);\n\t\t\treturn CACHE[cacheKey] || null;\n\t\t},\n\n\t\t_createCacheKey: function(widgetName, widgetOptions) {\n\t\t\twidgetOptions = widgetOptions || {};\n\t\t\tvar optionTokens = Object.keys(widgetOptions).sort().reduce(function(acc, key) {\n\t\t\t\tacc.push(key, JSON.stringify(widgetOptions[key]));\n\t\t\t\treturn acc;\n\t\t\t}, []);\n\t\t\treturn widgetName + ':' + optionTokens.join(':');\n\t\t}\n\t\t\n\t};\n\t\n\tfunction injectStyles() {\n\t\tvar styleEl = document.createElement('style');\n\t\tstyleEl.type = 'text/css';\n\t\tstyleEl.innerHTML = styles;\n\t\tdocument.head.appendChild(styleEl);\t\t\n\t}\n\n\tif(document.readyState === 'complete' || document.readyState === 'interactive') {\n\t\tinjectStyles();\n\t} else {\n\t\twindow.addEventListener(\"DOMContentLoaded\", injectStyles);\n\t}\n\t\n\treturn {\n\t\ttemplate: templateHtml,\n\t\trestrict: 'E',\n\t\tcontroller: Controller,\n\t\tscope: {},\n\t\tbindToController: {\n\t\t\tname: '<',\n\t\t\toptions: '<?'\n\t\t},\n\t\tcontrollerAs: 'ctrl'\n\t};\n\n}","sys_class_name":"sp_angular_provider","sys_id":"c738b0cec3d4741052a7d1fc8840dde5","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_update_name":"sp_angular_provider_c738b0cec3d4741052a7d1fc8840dde5","sys_updated_by":"admin","sys_created_on":"2021-05-24 19:08:44","name":"spLazyWidget","sys_name":"spLazyWidget","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"346","sys_updated_on":"2021-06-09 07:20:43","sys_tags":"","type":"directive","script":"function($rootScope) {\n\treturn {\n\t\ttemplate: '<div>' +\n\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>' +\n\t\t'</div>' +\n\t\t'<fieldset>' +\n\t\t\t'<legend class=\"sr-only\">' +\n\t\t\t\t'<span ng-if=\"field.mandatory && !field.value\">${Required} - </span>' +\n\t\t\t\t'<span ng-if=\"field.mandatory && field.value\">${Required filled} - </span>' +\n\t\t\t\t'<span>{{c.getAriaLabel(field)}}</span>' +\n\t\t\t\t'<span ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</span>' +\n\t\t\t'</legend>' +\n\t\t\t\t\t'<div  ng-if=\"!isMobile\" class=\"wrapper-xs row\" ng-class=\"{single_question_survey_image: data.isKioskSurvey}\" role=\"radiogroup\">' +\n\t\t\t\t\t\t'<div aria-describedby=\"details_{{field.sys_id}}\" ng-repeat=\"c in field.choices track by $index\" class=\"autofocus-class col-xs-6  wrapper-xs text-center\" ng-class=\"{\\'col-sm-2\\': !data.isKioskSurvey, \\'col-sm-3\\': data.isKioskSurvey, \\'col-md-2\\': data.isKioskSurvey, \\'img-scale-{{::field.sys_id}}\\': true, \\'has-error\\':!field.isMandatoryFilled, \\'autofocus-error\\':!field.isMandatoryFilled}\" style=\"display:inline-block; cursor: pointer;\" role=\"radio\" ng-keydown=\"selectOption($event, $index)\" aria-checked=\"{{field.value == c.value}}\" aria-label=\"{{::c.label}}\" tabindex=\"{{::getTabIndex($index, c)}}\" ng-click=\"chooseOption($index)\">' +\n\t\t\t\t\t\t\t'<div ng-if=\"(c.selected_image)\">' +\n\t\t\t \t\t\t\t\t'<div ng-if=\"(!field.unSelectedImageAllPresent)\">' +\n\t\t\t \t\t\t\t\t\t'<img src=\"{{c.image}}?t=small\" role=\"presentation\" alt=\"\" ng-class = \"{\\'img_size\\' : !data.isKioskSurvey}\" ng-style=\"{\\'opacity\\':c.opacity}\" ng-click=\"c.isDisabled || selectChoice($event, c)\" ng-disabled=\"{{c.isDisabled}}\" style=\"margin-bottom:12px;\"/>' +\n\t\t\t\t\t\t\t\t\t'<button tabindex=\"-1\" style=\"overflow: hidden; text-overflow: ellipsis; font-weight:bold\" class=\"btn btn_one_click\"   ng-if=\"c.value == field.value && data.isKioskSurvey\" ng-click=\"selectChoice($event, c)\" ng-disabled=\"{{c.isDisabled}}\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t\t '<button tabindex=\"-1\" style=\"overflow: hidden; text-overflow: ellipsis;\" class=\"btn btn-default btn-block \" ng-class=\" { \\'btn-primary\\': c.value == field.value }\" ng-if=\"!data.isKioskSurvey\" ng-click=\"selectChoice($event, c)\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t\t'<sp-survey-end-notes data=\"data\" ng-if=\"c.value == field.value\">' +\n\t\t\t\t\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t    \t'<div ng-if=\"(field.unSelectedImageAllPresent)\">' +\n\t\t\t\t\t\t    \t   '<img src=\"{{c.image}}?t=small\" role=\"presentation\"  alt=\"\" ng-class = \"{\\'img_size\\' : !data.isKioskSurvey}\" ng-click=\"c.isDisabled || selectChoice($event, c)\" ng-disabled=\"{{c.isDisabled}}\" style=\"margin-bottom:12px;\" ng-style=\"{\\'opacity\\':c.opacity}\"/>' +\n\t\t\t\t\t\t\t\t   '<button style=\"overflow: hidden; text-overflow: ellipsis; font-weight:bold;\" tabindex=\"-1\" class=\"btn btn_one_click disable_button\" ng-if=\"c.value == field.value && data.isKioskSurvey\" ng-click=\"selectChoice($event, c)\" ng-disabled=\"{{c.isDisabled}}\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t   '<button style=\"overflow: hidden; text-overflow: ellipsis;\" tabindex=\"-1\" class=\"btn btn-default btn-block\" ng-class=\" { \\'btn-primary\\': c.value == field.value } \" ng-if=\"!data.isKioskSurvey\" ng-click=\"selectChoice($event, c)\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t\t'<sp-survey-end-notes data=\"data\" ng-if=\"c.value == field.value\">' +\n\t\t\t\t\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'<div ng-if=\"(!c.selected_image)\" style=\"margin: auto;\">' +\n\t\t\t\t\t\t\t\t'<div ng-click=\"c.isDisabled || selectChoice($event, c)\" ng-disabled=\"{{c.isDisabled}}\" style=\"margin: auto; overflow: hidden; text-overflow: ellipsis; line-height: 64px; align: center; vertical-align: middle; border: 1px solid black; width: 64px; text-align: center; height: 64px; vertical-align: middle; margin-bottom: 12px;\"  title=\"{{::c.label}}\">{{::c.label}}</div>' +\n\t\t\t\t\t\t\t\t'<button style=\"overflow: hidden; text-overflow: ellipsis;\" tabindex=\"-1\" aria-pressed=\"{{c.value == field.value}}\" class=\"btn btn-default btn-block\" ng-class=\" { \\'btn-primary\\': c.value == field.value } \" ng-click=\"selectChoice($event, c)\" ng-if=\"!data.isKioskSurvey\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t'<button style=\"overflow: hidden; text-overflow: ellipsis;font-weight:bold\" class=\"btn\" tabindex=\"-1\"  ng-click=\"selectChoice($event, c)\" ng-if=\"c.value == field.value && data.isKioskSurvey\" ng-disabled=\"{{c.isDisabled}}\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t\t\t\t\t\t\t'<sp-survey-end-notes data=\"data\"  ng-if=\"c.value == field.value\">' +\n\t\t\t\t\t\t\t\t'</sp-survey-end-notes>' +\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div  ng-if=\"isMobile\" class=\"wrapper-xs row\">' +\n\t\t\t\t\t\t'<div class=\"col-xs-12 wrapper-sm text-center\">' +\n\t\t\t\t\t\t\t'<div ng-if=\"(mobileChoice.image)\">' +\n\t\t\t\t\t\t\t \t'<img src=\"{{mobileChoice.image}}?t=small\" title=\"{{::mobileChoice.label}}\" alt=\"{{mobileChoice.label}}\" style=\"width:64px; height:64px;\" />' +\n\t\t\t\t\t\t\t '</div>' +\n\t\t\t\t\t\t\t'<div ng-if=\"!(mobileChoice.image)\">' +\n\t\t\t\t\t\t\t \t'<div style=\"margin: auto; overflow: hidden; text-overflow: ellipsis; line-height: 52px; align: center; vertical-align: middle; border: 1px solid black; width: 64px; text-align: center; height: 52px; vertical-align: middle; margin-bottom: 12px;\" title=\"{{::mobileChoice.label}}\">{{mobileChoice.label}}</div>' +\n\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div ng-repeat=\"c in field.choices track by $index\" class=\"wrapper-xs text-center\">' +\n\t\t\t\t\t\t\t'<button aria-describedby=\"details_{{field.sys_id}}\" class=\"btn btn-default btn-block autofocus-class\" ng-class=\"{ \\'btn-primary\\': c.value == field.value }\" aria-pressed=\"{{c.value == field.value}}\" ng-click=\"selectChoice($event,c)\" title=\"{{::c.label}}\">{{::c.label}}</button>' +\n\t\t'<sp-survey-end-notes data=\"data\"  ng-if=\"c.isKioskSurvey\">' +\n                             '</sp-survey-end-notes>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info && field.type != \\'template\\'\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t\t'</fieldset>' +\n\t\t\t'</div>',\n\n\t\tscope: {\n\t\t\tfield: '=',\n\t\t\tc: '=',\n\t\t\tdata: '=',\n\t\t\tisMobile: '='\n\t\t},\n\n\t\tcontroller: function($scope) {\n\t\t\tvar keys = {\n\t\t\t\tLEFT: 37,\n\t\t\t\tUP: 38,\n\t\t\t\tRIGHT: 39,\n\t\t\t\tDOWN: 40,\n\t\t\t\tSPACE: 32\n\t\t\t};\n\n\t\t\tvar unselectChoice = function(choice, firstLoad) {\n\t\t\t\tchoice.image = (choice.selected_image) ? ((!$scope.field.unSelectedImageAllPresent) ? choice.selected_image  : choice.unselected_image) : choice.selected_image;\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\tif (!$scope.field.unSelectedImageAllPresent)\n\t\t\t\t\t\tchoice.opacity = 0.5;\n\t\t\t\t\telse\n\t\t\t\t\t\tchoice.opacity = 1;\n\t\t\t\t} else {\n\t\t\t\t\t if ($scope.data.isKioskSurvey) {\n\t\t\t\t\t\t choice.isDisabled = true;\n\t\t\t\t\t\t if ($scope.field.value != choice.value)\n\t\t\t\t\t\t\t choice.opacity = 0.15;\n\t\t\t\t\t\t else\n\t\t\t\t\t\t\t choice.opacity = 1;\n\t\t\t\t\t } else {\n\t\t\t\t\t\t if (!$scope.field.unSelectedImageAllPresent) {\n\t\t\t\t\t\t\t if ($scope.field.value == choice.value)\n\t\t\t\t\t\t\t\t choice.opacity = 1;\n\t\t\t\t\t\t\t else\n\t\t\t\t\t\t\t\t choice.opacity = 0.5;\n\t\t\t\t\t\t }\n\t\t\t\t\t }\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar unselectAllChoices = function(firstLoad) {\n\t\t\t\tfor (var i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice = $scope.field.choices[i];\n\t\t\t\t\t    unselectChoice(choice, firstLoad);\n\t\t\t\t}\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\tfor (i=0; i < $scope.field.choices.length; i++) {\n\t\t\t\t\t\tvar choice = $scope.field.choices[i];\n\t\t\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\t\t\tif (!$scope.field.selectedImageOnly && $scope.field.value == choice.value) {\n\t\t\t\t\t\t\tchoice.image = choice.selected_image;\n\t\t\t\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ($scope.field.selectedImageOnly && $scope.field.value == choice.value) {\n\t\t\t\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (i === $scope.field.choices.length) {\n\t\t\t\t\t\t$scope.mobileChoice = $scope.field.choices[0];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\n\t\t\t$scope.selectChoice = function(event, choice) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\t$scope.field.value = choice.value;\n\t\t\t\tunselectAllChoices(false);\n\t\t\t\tif (!$scope.field.selectedImageOnly)\n\t\t\t\t\tchoice.image = choice.selected_image;\n\n\t\t\t\t$scope.mobileChoice = choice;\n\t\t\t\tif ($scope.data.isKioskSurvey && !$scope.isMobile)\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t\n\t\t\t\t// Update isMandatoryFilled\n\t\t\t   $scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\t\t\t\t};\n\n\t\t\t$scope.selectOption = function(event, currentIndex) {\n\t\t\t\tif (event.which == keys.SPACE) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t$scope.selectChoice(event, $scope.field.choices[currentIndex]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar length = $scope.field.choices.length;\n\t\t\t\tvar select = -1;\n\t\t\t\tswitch(event.which) {\n\t\t\t\t\tcase keys.LEFT:\n\t\t\t\t\tcase keys.UP:\n\t\t\t\t\t\tif (currentIndex == 0)\n\t\t\t\t\t\t\tselect = length - 1;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tselect = currentIndex - 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase keys.RIGHT:\n\t\t\t\t\tcase keys.DOWN:\n\t\t\t\t\t\tif (currentIndex == length - 1)\n\t\t\t\t\t\t\tselect = 0;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tselect = currentIndex + 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tif (select == -1)\n\t\t\t\t\treturn;\n\t\t\t\tevent.preventDefault();\n\t\t\t\t$scope.chooseOption(event, select);\n\t\t\t};\n\n\t\t\t$scope.chooseOption = function(event, position) {\n\t\t\t\tvar elements = document.getElementsByClassName(\"img-scale-\" + $scope.field.sys_id);\n\t\t\t\tif (elements && elements[position]) {\n\t\t\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\t\t\telements[i].tabIndex = -1;\n\t\t\t\t\t}\n\t\t\t\t\t$scope.selectChoice(event, $scope.field.choices[position]);\n\t\t\t\t\telements[position].tabIndex = 0;\n\t\t\t\t\telements[position].focus();\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\t$scope.getTabIndex = function(index, choice) {\n\t\t\t\tif ($scope.field.value)\n\t\t\t\t\treturn $scope.field.value === choice.value ? \"0\" : \"-1\";\n\t\t\t\treturn index === 0 ? \"0\" : \"-1\";\n\t\t\t};\n\n\t\t\t// Do it the first time so that all images show up\n\t\t\tunselectAllChoices(true);\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"d1c792f6c3331200e44574e1c1d3ae2d","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_d1c792f6c3331200e44574e1c1d3ae2d","sys_updated_by":"admin","sys_created_on":"2016-06-07 23:45:20","name":"spSurveyImageScale","sys_name":"spSurveyImageScale","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"1","sys_updated_on":"2017-09-22 18:13:13","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"d26cb8355b2322003d1c484c11f91a5d","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_d26cb8355b2322003d1c484c11f91a5d","sys_updated_by":"admin","sys_created_on":"2016-12-08 00:26:38","name":"bmKpiOverview","sys_name":"bmKpiOverview","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"18","sys_updated_on":"2023-05-10 10:13:33","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"d457cac25b0032003d1c484c11f91a62","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_d457cac25b0032003d1c484c11f91a62","sys_updated_by":"admin","sys_created_on":"2017-01-02 21:02:27","name":"bmKpiOverviewTable","sys_name":"bmKpiOverviewTable","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"137","sys_updated_on":"2021-04-25 04:41:08","sys_tags":"","type":"directive","script":"function(i18n) {\n\treturn {\n\t\ttemplate: '<div ng-switch=\"field.type\">' +\n                        '<sp-survey-date-picker ng-switch-when=\"date\" c=\"c\" field=\"field\" sn-disabled=\"false\" ng-model=\"field.value\"></sp-survey-date-picker>' +\n                        '<sp-survey-date-picker ng-switch-when=\"datetime\" c=\"c\" field=\"field\" sn-disabled=\"false\" ng-model=\"field.value\" sn-include-time=\"true\"></sp-survey-date-picker>' +\n                       '<div ng-switch-when=\"choice\" class=\"row\">' +\n                            '<div ng-class=\"{\\'has-error\\': !field.isMandatoryFilled}\" class=\"col-xs-12 col-sm-6\" ng-class=\"{col_centered : data.isKioskSurvey}\" role=\"group\">' +\n\t\t\t\t\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t\t\t\t\t'<div role=\"alert\" class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>'+\n\t\t\t\t\t\t\t'</div>' +\n                                '<sp-survey-choice-list field=\"field\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\" options=\"field.choices\" is-mobile=\"isMobile\"></sp-survey-choice-list>' +\n                            '</div>' +\n\t\t\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t\t\t\t\t'<sp-survey-end-notes data=\"data\"></sp-survey-end-notes>' +\n\t\t\t\t\t\t'</div>' +\n                        '<div ng-switch-when=\"boolean\">' +\n                            '<sp-survey-scale field=\"field\" is-mobile=\"isMobile\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\"></sp-survey-scale>' +\n                        '</div>' +\n                        '<div ng-switch-when=\"numericscale\">' +\n                            '<sp-survey-numeric-scale field=\"field\" is-mobile=\"false\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\" ng-if=\"!isMobile\"></sp-survey-numeric-scale>' +\n                            '<sp-survey-scale field=\"field\" ng-if=\"isMobile\" is-mobile=\"isMobile\" data=\"data\" c=\"c\" mobile-prefix=\"mobilePrefix\"></sp-survey-scale>' +\n                        '</div>' +\n                        '<sp-survey-string-field ng-switch-when=\"string\" field=\"field\" data=\"data\" c=\"c\"></sp-survey-string-field>' +\n                        '<sp-survey-checkbox ng-switch-when=\"checkbox\" c=\"c\" field=\"field\" mobile-prefix=\"mobilePrefix\" is-mobile=\"isMobile\"></sp-survey-checkbox>' +\n                        '<sp-survey-multiple-checkbox ng-switch-when=\"multiplecheckbox\" c=\"c\" field=\"field\"></sp-survey-multiple-checkbox>' +\n                        '<sp-survey-number-field ng-switch-when=\"long\" c=\"c\"  is-mobile=\"isMobile\" field=\"field\"></sp-survey-number-field>' +\n                        '<sp-survey-number-field ng-switch-when=\"percentage\" c=\"c\" is-mobile=\"isMobile\" show-percentage=\"true\" field=\"field\"></sp-survey-number-field>' +\n                        '<sp-survey-scale ng-switch-when=\"scale\" field=\"field\" is-mobile=\"isMobile\" mobile-prefix=\"mobilePrefix\" data=\"data\" c=\"c\"></sp-survey-scale>' +\n                        '<div ng-switch-when=\"reference\" class=\"row\">' +\n                            '<div class=\"col-xs-12 col-sm-6\">' +\n\t\t\t\t\t\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t\t\t\t\t\t'<div role=\"alert\" class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>'+\n\t\t\t\t\t\t\t\t'</div>' +\n                                '<sp-survey-reference-field c=\"c\" is-mobile=\"isMobile\" field=\"field\" ng-class=\"{\\'field-has-reference\\': field.value != \\'\\', \\'field-empty-reference\\': field.value == \\'\\'}\"></sp-survey-reference-field>' +\n                            '</div>' +\n\t\t\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n                        '</div>' +\n                        '<sp-survey-image-scale ng-switch-when=\"imagescale\" field=\"field\" c=\"c\" data=\"data\" is-mobile=\"isMobile\"></sp-survey-image-scale>' +\n                        '<sp-survey-ranking-select-box ng-switch-when=\"ranking\" field=\"field\"></sp-survey-ranking-select-box>' +\n                        '<div ng-switch-when=\"attachment\" ng-init=\"c.setupAttachmentHandler(field)\">' +\n\t\t\t\t\t\t\t'<div id=\"notAnswered{{field.sys_id}}\">' +\n\t\t\t\t\t\t\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>'+\n\t\t\t\t\t\t\t'</div>' +\n                            '<div ng-if=\"!isMobile\" >' +\n                                '<h4 class=\"question-label\" style=\"display:inline-block;\" ng-if=\"field.type == \\'attachment\\'\">' +\n                                    '<span class=\"field-decorations\">' +\n                                        '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" aria-hidden=\"true\" ng-class=\"{\\'mandatory-filled\\': c.isMandatoryFilled(field)}\"' +\n                                        'style=\"padding-right: .25em\" ></span>' +\n                                        '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                    '</span>' +\n                                    '{{::field.label}}' +\n                                    '<sp-survey-attachment-button c=\"c\" field=\"field\" attachment-handler=\"field.attachmentHandler\" style=\"margin-left:20px\"></sp-survey-attachment-button>' +\n                                '</h4>' +\n\t\t\t\t\t\t\t\t'<div id=\"details_{{field.sys_id}}\">' +\n\t\t\t\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n\t\t\t\t\t\t\t\t'</div>' +\n                            '</div>' +\n                            '<div ng-if=\"isMobile\" class=\"row\">' +\n                                '<div class=\"col-xs-11\">' +\n                                    '<h4 class=\"question-label\" style=\"display:inline-block;\" ng-if=\"field.type == \\'attachment\\'\">' +\n                                        '<span class=\"field-decorations\">' +\n                                            '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" aria-hidden=\"true\" ng-class=\"{\\'mandatory-filled\\': c.isMandatoryFilled(field)}\"' +\n                                            'style=\"padding-right: .25em\" ></span>' +\n                                            '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                        '</span>' +\n                                        '{{::field.label}}' +\n                                    '</h4>' +\n\t\t\t\t\t\t\t\t\t'<div id=\"details_{{field.sys_id}}\">' +\n                                    '<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n\t\t\t\t\t\t\t\t\t'</div>' +\n                                '</div>' +\n                                '<div class=\"col-xs-1\">' +\n                                    '<h4><sp-survey-attachment-button c=\"c\" field=\"field\" attachment-handler=\"field.attachmentHandler\"></sp-survey-attachment-button></h4>' +\n                                '</div>' +\n                            '</div>' +\n                            '<sp-survey-attachment-list></sp-survey-attachment-list>' +\n                            '<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n                        '</div>' +\n                        '<div ng-switch-when=\"template\">' +\n                            '<div ng-if=\"isMobile\">' +\n                                '<h4 class=\"question-label\">' +\n                                    '<span class=\"field-decorations\">' +\n                                        '<span ng-show=\"field.mandatory\" class=\"fa fa-asterisk mandatory\" aria-hidden=\"true\" ng-class=\"{\\'mandatory-filled\\': (field.value != null && field.value != undefined && field.value != \\'\\')}\"  style=\"padding-right: .25em\" ></span>' +\n                                        '<span ng-repeat=\"decoration in field.decorations track by $index\" class=\"decoration {{ decoration.icon }}\" title=\"{{ decoration.text }}\"></span>' +\n                                    '</span>' +\n                                    '{{::field.label}}' +\n                                '</h4>' +\n                                '<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n                                '<sp-survey-scale ng-if=\"!field.template.allow_image\" field=\"field\" is-mobile=\"isMobile\" mobile-prefix=\"mobilePrefix\"></sp-survey-scale>' +\n                                '<sp-survey-image-scale ng-if=\"field.template.allow_image\" field=\"field\" c=\"c\" data=\"data\" is-mobile=\"true\"></sp-survey-image-scale>' +\n                            '</div>' +\n                            '<div ng-if=\"!isMobile\">' +\n                                '<sp-survey-template template-group=\"data.templateGroups[field.templateGroup]\" is-mobile=\"isMobile\" questions-map=\"data.questions.idMap\" field=\"field\" c=\"c\" data=\"data\"></sp-survey-template>' +\n                            '</div>' +\n                        '</div>' +\n                        '<div ng-switch-when=\"signature\">' +\n                            '<div ng-if=\"field.signType != \\'checkbox\\'\" ng-bind-html=\"field.label\"></div>' +\n                            '<div class=\"row\" ng-switch=\"field.signType\">' +\n                                '<sp-survey-checkbox ng-switch-when=\"checkbox\" html-label=\"true\" c=\"c\" field=\"field\" mobile-prefix=\"mobilePrefix\" is-mobile=\"isMobile\"></sp-survey-checkbox>' +\n                                '<div class=\"col-xs-12 col-sm-4\" ng-switch-when=\"full_name\">' +\n                                    '<input ng-if=\"field.value != \\'\\'\" class=\"form-control\" type=\"text\" ng-model=\"field.value\" disabled />' +\n                                    '<input ng-if=\"field.value == \\'\\'\" class=\"form-control\" type=\"text\" ng-model=\"field.value\" />' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n                        '<div ng-switch-default></div>' +\n                    '</div>',\n\n        scope: {\n            field: '=', \n            data: '=',\n            c: '=',\n            mobilePrefix: '=',\n            isMobile: '='\n\t\t}\n    }\n}","sys_class_name":"sp_angular_provider","sys_id":"d9e214f6c3202200943974e1c1d3ae87","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_d9e214f6c3202200943974e1c1d3ae87","sys_updated_by":"admin","sys_created_on":"2016-07-14 20:49:39","name":"spSurveyField","sys_name":"spSurveyField","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"107","sys_updated_on":"2021-04-22 06:40:22","sys_tags":"","type":"directive","script":"function(cabrillo, $rootScope, $timeout, i18n, spAriaUtil) {\n\t'use strict';\n\treturn {\n\t\trestrict: 'E',\n\t\tscope: {\n\t\t\t'field': '=',\n\t\t\t'attachmentHandler': '=',\n\t\t\t'c': '='\n\t\t},\n\t\ttemplate: function() {\n\t\t\tvar inputTemplate;\n\t\t\tif (cabrillo.isNative()) {\n\t\t\t\tinputTemplate = '<a href=\"#\" elem-id=\"{{::field.sys_id}}_attachment_add\" ng-click=\"showAttachOptions()\" class=\"panel-button sp-attachment-add\"><span class=\"glyphicon glyphicon-camera\"></span></a>';\n\t\t\t} else {\n\t\t\t\tinputTemplate = '<label style=\"cursor:pointer; font-size:22px; margin-top:-6px; position:relative; bottom:-6px;\">' +\n\t\t\t\t\t\t\t\t\t'<input type=\"file\" multiple=\"true\" ng-file-select=\"attachmentHandler.onFileSelect($files)\" class=\"sp-attachments-input sr-only\" tabindex=\"-1\"/>' +\n\t\t\t\t\t\t\t\t\t'<button aria-describedby=\"details_{{field.sys_id}} notAnswered{{field.sys_id}}\" ng-class=\"{\\'has-error\\': !field.isMandatoryFilled, \\'autofocus-error\\':!field.isMandatoryFilled}\" elem-id=\"{{::field.sys_id}}_attachment_add\" style=\"color: inherit\" ng-click=\"attachmentHandler.openSelector($event)\" class=\"sp-attachment-add autofocus-class wrapper-xs btn-link btn chevron-icon\" aria-required=\"{{::field.mandatory}}\" data-toggle=\"tooltip\" data-placement=\"top\" data-original-title=\"${Choose attachments}\" aria-label=\"{{c.getAriaLabel(field)}}\">' +\n\t\t\t\t\t\t\t\t\t\t'<span class=\"glyphicon glyphicon-paperclip\"></span>' +\n\t\t\t\t\t\t\t\t\t'</button>' +\n\t\t\t\t\t\t\t\t\t'</label>';\n\t\t\t}\n\t\t\treturn [\n\t\t\t\t'<span class=\"file-upload-input\">',\n\t\t\t\t\tinputTemplate,\n\t\t\t\t'</span>'\n\t\t\t].join('');\n\t\t},\n\t\tcontroller: function($element, $scope) {\n\t\t\t$scope.attachmentClassNames = 'btn-default attachment-btn btn-primary icon-paperclip icon-camera list-group-btn';\n\n\t\t\t$scope.showAttachOptions = function() {\n\t\t\t\tvar handler = $scope.attachmentHandler;\n\n\t\t\t\tcabrillo.attachments.addFile(\n\t\t\t\t\thandler.tableName,\n\t\t\t\t\thandler.tableId,\n\t\t\t\t\tnull,\n\t\t\t\t\t{maxWidth: 1000, maxHeight: 1000}\n\t\t\t\t).then(function(data) {\n\t\t\t\t\thandler.getAttachmentList();\n\t\t\t\t\t$rootScope.$broadcast(\"added_attachment\");\n\t\t\t\t}, function() {\n\t\t\t\t\tconsole.log('Failed to attach new file');\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.$on('attachment_select_files', function(e) {\n\t\t\t\t$timeout(function() {\n\t\t\t\t\t$($element).find('.sp-attachments-input').click();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tfunction focusOnAttachmentIcon(questionId) {\n\t\t\t\tvar paperclip = $($element).find(\"[elem-id='\"+ questionId +\"_attachment_add']\")[0];\n\t\t\t\tif (paperclip) {\n\t\t\t\t\tpaperclip.focus();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$scope.$on('survey.attachment.upload.success', function(evt, args) {\n\t\t\t\t\n\t\t\t\t// Update isMandatoryFilled\n\t\t\t   $scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\n\n\t\t\t\t// timeout is required for screen reader to pick up the message once file upload prompt is dismissed\n\t\t\t\t$timeout(function() {\n\t\t\t\t    spAriaUtil.sendLiveMessage(i18n.getMessage('Attachment uploaded successfully'));\n\t\t\t\t}, 2000);\n\t\t\t});\n\n\t\t\t$scope.$on('survey.attachment.delete.success', function(evt, args) {\n\n\t\t\t\t// Update isMandatoryFilled\n\t\t\t   $scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\n\t\t\t\t// timeout is required for screen reader to pick up the message once deletion confirmation modal is dismissed\n\t\t\t\t$timeout(function() {\n\t\t\t\t    spAriaUtil.sendLiveMessage(i18n.getMessage('Attachment deleted successfully'));\n\t\t\t\t}, 2000);\n\t\t\t});\n\n\t\t\t$scope.$on('survey.attachment.list.update', function(evt, args) {\n\t\t\t\t// Focus should move back to attachment icon\n\t\t\t\tvar targetQuestionId = args.questionSysId;\n\t\t\t\tif (targetQuestionId === $scope.field.sys_id) {// Make sure it's the same question\n\t\t\t\t\tfocusOnAttachmentIcon(targetQuestionId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}\n","sys_class_name":"sp_angular_provider","sys_id":"dae369f2c3331200e44574e1c1d3aeeb","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_dae369f2c3331200e44574e1c1d3aeeb","sys_updated_by":"admin","sys_created_on":"2016-06-07 19:56:21","name":"spSurveyAttachmentButton","sys_name":"spSurveyAttachmentButton","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"209","sys_updated_on":"2021-04-27 11:38:51","sys_tags":"","type":"directive","script":"function() {\n\treturn {\n\t\ttemplate:\n\t\t'<div class=\"container-fluid\">' +\n\t\t'<div class=\"row\">' +\n\t\t'<div class=\"col-xs-12 col-sm-6\">' +\n\t\t'<div id=\"notAnswered{{field.sys_id}}\" >' +\n\t\t'<div class=\"wrapper-xs alert alert-danger\" ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</div>' +\n\t\t'</div>' +\n\t\t'<fieldset>' +\n\t\t\t'<legend class=\"sr-only\">' +\n\t\t\t\t'<span ng-if=\"field.mandatory && !c.isMandatoryFilled(field)\">${Required} - </span>' +\n\t\t\t\t'<span ng-if=\"field.mandatory && c.isMandatoryFilled(field)\">${Required filled} - </span>' +\n\t\t\t\t'<span>{{c.getAriaLabel(field)}} ${ {{field.choices.length}} choices}</span>' +\n\t\t\t\t'<span ng-if=\"!field.isMandatoryFilled\">{{c.showMandatoryMessage()}}</span>' +\n\t\t\t'</legend>' +\n\t\t\n\t\t'<ul style=\"list-style-type: none;padding:0\" class=\"sps-ranking-list\">'+\n\t\t\t'<li class=\"row\" ng-repeat=\"c in field.choices track by $index\" style=\"border: 1px solid #ccc;border-radius: 5px;margin-bottom: 5px;\">'+\n\t\t\t\t'<div class=\"col-xs-2 wrapper-xs\" style=\"position:static\">' +\n\t\t\t\t\t'<select ng-class=\"{\\'has-error\\': !field.isMandatoryFilled, \\'autofocus-error\\':!field.isMandatoryFilled}\" elem-id=\"{{::c.sys_id}}\" name=\"{{c.name}}\" aria-label=\"{{::c.label}}\" ng-change=\"onSelectChange(c)\" autocomplete=\"off\" aria-describedby=\"details_{{field.sys_id}}\" class=\"form-control autofocus-class\" style=\"padding:3px;\" sn-select-width=\"auto\" ng-model=\"c.value\" ng-disabled=\"field.isReadonly()\">' +\n\t\t\t\t\t\t'<option value=\"-1\" ng-selected=\"c.value == -1\" aria-label=\"${Please select a rank}\"></option> '+\n\t\t\t\t\t\t'<option ng-repeat=\"i in field.choices track by $index\" value=\"{{$index + 1}}\" ng-selected=\"$index + 1 == c.value\">{{$index + 1}}</option> ' +\n\t\t\t\t\t'</select>'+\n\t\t\t\t'</div>' +\n\t\t\t\t'<div class=\"col-xs-9 wrapper-sm\" style=\"position:static\" aria-hidden=\"true\"><span id=\"label_{{::c.sys_id}}\" class=\"sps-checkbox-label\">{{c.label}}</span></div>' +\n\t\t\t\t'<div class=\"col-xs-1 wrapper-sm\" style=\"position:static;\" aria-hidden=\"true\"><span class=\"fa fa-bars pull-right wrapper-xs\"></span></div>'+\n\t\t\t'<li>'+\n\t\t'</ul>' +\n\t\t'</fieldset>' +\n\t\t'</div>' +\n\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n\t\t'</div>' +\n\t\t'</div>',\n\t\tcontroller: function($scope) {\n\t\t\t$scope.field.choices.sort(function(a, b) {return a.value - b.value;});\n\t\t\tfunction swap(a, i, j) {\n\t\t\t\tif (i < 0 || i >= a.length || j < 0 || j >= a.length)\n\t\t\t\t\treturn;\n\t\t\t\tvar temp = a[i];\n\t\t\t\ta[i] = a[j];\n\t\t\t\ta[j] = temp;\n\t\t\t}\n\t\t\tfunction getCurrentPosition(sys_id) {\n\t\t\t\tvar lis = $($scope.element).find('li');\n\t\t\t\tfor (var i=0; i<lis.length; i++) {\n\t\t\t\t\tvar spanId = $(lis[i]).find('span').attr('id').slice(\"label_\".length);\n\t\t\t\t\tif (spanId && spanId.trim().indexOf(sys_id.trim()) == 0)\n\t\t\t\t\t\treturn (i + 1);\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\t$scope.onSelectChange = function(choice) {\n\t\t\t\t$scope.field.choices.forEach(function(c) {\n\t\t\t\t\tif (c.value == choice.value && c.sys_id != choice.sys_id)\n\t\t\t\t\t\tc.value = '-1';\n\t\t\t\t});\n\t\t\t\tvar oldValue = getCurrentPosition(choice.sys_id);\n\t\t\t\tvar order = $scope.sortable.toArray();\n\t\t\t\tswap(order, parseInt(choice.value) - 1, parseInt(oldValue) - 1);\n\t\t\t\t$scope.sortable.sort(order);\n\t\t\t\t// Auto focus on the last modified action item after changing position\n\t\t\t\tvar rankToIndex = choice.value - 1;\n\t\t\t\tvar lastModifiedChoice = angular.element($($scope.element).find('select')[rankToIndex]);\n\t\t\t\tlastModifiedChoice.focus();\n\t\t\t\t$scope.field.isMandatoryFilled = $scope.c.isMandatoryFilled($scope.field);\n\t\t\t}\n\t   },\n\t\tlink: function(scope, element) {\n\t\t\tvar sortable = new Sortable($(element).find('ul')[0], {\n\t\t\t\tonUpdate: function () {\n\t\t\t\t\tvar rankList = $(element).find('select');\n\t\t\t\t\tfor(var i = 0; i < rankList.length; i++) {\n\t\t\t\t\t\trankList[i].value = i + 1;\n\t\t\t\t\t\t$(rankList[i]).triggerHandler('change');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tsetTimeout(function() {\n\t\t\t\t$(element).find('li').mouseenter(function(elem) {\n\t\t\t\t\t$(this).addClass('hovered');\n\t\t\t\t})\n\t\t\t\t$(element).find('li').mouseleave(function(elem) {\n\t\t\t\t\t$(this).removeClass('hovered');\n\t\t\t\t})\n\t\t\t}, 10);\n\t\t\tscope.sortable = sortable;\n\t\t\tscope.element = element;\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"db7a2cc36700220097eeff5557415a23","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_db7a2cc36700220097eeff5557415a23","sys_updated_by":"admin","sys_created_on":"2016-06-20 20:38:56","name":"spSurveyRankingSelectBox","sys_name":"spSurveyRankingSelectBox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"161","sys_updated_on":"2023-05-10 10:13:04","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"e021a7f75b5032003d1c484c11f91a56","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_e021a7f75b5032003d1c484c11f91a56","sys_updated_by":"admin","sys_created_on":"2017-01-21 00:19:28","name":"bmDownloadButton","sys_name":"bmDownloadButton","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"19","sys_updated_on":"2018-09-28 20:32:58","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"e077faa45b1032003d1c484c11f91a68","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_e077faa45b1032003d1c484c11f91a68","sys_updated_by":"admin","sys_created_on":"2017-01-10 19:03:48","name":"bmKpiViewToggles","sys_name":"bmKpiViewToggles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"9","sys_updated_on":"2021-07-22 13:56:57","sys_tags":"","type":"directive","script":"function ($timeout) {\n\treturn {\n\t\trestrict: 'C',\n\t\tscope: true,\n\t\tlink: function (scope, element) {\n\t\t\t\tif (angular.isFunction(element.select2)) {\n\t\t\t\t\telement.css(\"opacity\", 0);\n\t\t\t\t\t$timeout(function() {\n\t\t\t\t\t\telement.css(\"opacity\", 1);\n\t\t\t\t\t\telement.select2();\n\t\t\t\t\t\telement.parent().find(\".select2-focusser\").attr(\"aria-expanded\", false);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\n\t\t\t\telement.on(\"select2-open\", function() {\n\t\t\t\t\tif (element.data('select2').search.val() === \" \")\n\t\t\t\t\t    element.select2(\"search\", \"\");\n\n\t\t\t\t\telement.parent().find(\".select2-focusser\").attr(\"aria-expanded\", true);\n\n\t\t\t\t});\n\n\t\t\t\telement.on(\"select2-close\", function() {\n\t\t\t\t\telement.parent().find(\".select2-focusser\").attr(\"aria-expanded\", false);\n\t\t\t\t});\n\t\t}\n\t}\n}","sys_class_name":"sp_angular_provider","sys_id":"e225f8b43b0523008ed00d8044efc4fe","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/d1c9ebbb04f12210559073c06a02f719","value":"d1c9ebbb04f12210559073c06a02f719"},"sys_update_name":"sp_angular_provider_e225f8b43b0523008ed00d8044efc4fe","sys_updated_by":"admin","sys_created_on":"2018-10-06 23:38:10","name":"scBasicSelect","sys_name":"scBasicSelect","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":"read"},{"sys_mod_count":"13","sys_updated_on":"2022-11-12 20:12:31","sys_tags":"","type":"directive","script":"function invokeMultiLevelParentFunc($rootScope, $timeout) {\n\t\"use strict\";\n\treturn {\n\t\trestrict: 'A',\n\t\tscope: {\n\t\t\tinvokeEvents: '@',\n\t\t\tinvokeEventHandlers: '@',\n\t\t\tinvokeWithModel: '='\n\t\t},\n\t\tlink: function (scope, elem, attrs) {\n\t\t\tvar eventsToHandle = attrs.invokeEvents.split(',').map(function(eItem){\n\t\t\t\treturn eItem.trim();\n\t\t\t});\n\t\t\tvar eventHandlers = attrs.invokeEventHandlers.split(',').map(function(ehItem){\n\t\t\t\treturn ehItem.trim();\n\t\t\t});\n\n\t\t\teventsToHandle.forEach(function (e, index) {\n\t\t\t\telem.bind(e, function ($event) {\n\t\t\t\t\tif (typeof $rootScope[eventHandlers[index]] === 'function') {\n\t\t\t\t\t\t$event.stopPropagation();\n\t\t\t\t\t\t$rootScope[eventHandlers[index]]($event, scope.invokeWithModel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"e3a88e3a67031110e5d816f688f922d7","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_update_name":"sp_angular_provider_e3a88e3a67031110e5d816f688f922d7","sys_updated_by":"admin","sys_created_on":"2022-11-12 18:17:45","name":"invokeMultiLevelParentFunc","sys_name":"invokeMultiLevelParentFunc","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"135","sys_updated_on":"2021-04-22 06:28:15","sys_tags":"","type":"directive","script":"function($timeout, i18n, $rootScope) {\n\treturn {\n\t\ttemplate: \n\t\t'<select name=\"{{field.name}}\" autocomplete=\"off\" sn-select-width=\"auto\" ng-model=\"field.value\" ng-disabled=\"c.isDisabled || field.isReadonly()\" aria-label=\"{{::field.aria_label}}\" ng-change=\"c.isDisabled || selectChoice(c)\" ng-readonly=\"field.readOnly\" aria-required=\"{{::field.mandatory}}\">' +\n\t\t\t'<option ng-repeat=\"c in field.choices track by $index\" value=\"{{c.value}}\" ng-selected=\"isSelected(c)\">{{c.label + getChoicePrice(c, variable)}}</option> ' +\n\t\t'</select>',\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\trequire: '?ngModel',\n\t\tscope: {\n\t\t\t'field' : '=',\n\t\t\t'options': '=?',\n\t\t\t'data': '=',\n\t\t\t'c': '=',\n\t\t\t'isMobile': '=',\n\t\t},\n\n\t\tcontroller: function ($scope, $element) {\n\t\t\tvar chooseLabel = '-- ' + i18n.getMessage(\"Choose\") + ' --';\n\t\t\tif ($scope.field.choices.length < 1 || $scope.field.choices[0].label != chooseLabel)\n\t\t\t\t$scope.field.choices = [{label: chooseLabel, value: '', sys_id: 'NONESYSID'}].concat($scope.field.choices);\n\t\t\t$scope.selectChoice = function(choice) {\n\t\t\t\tif ($scope.data.isKioskSurvey && !$scope.isMobile) {\n\t\t\t\t\tchoice.isDisabled = true;\n\t\t\t\t\t$rootScope.submit($scope.page, $scope.c.state);\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\t$scope.isSelected = function(choice) {\n\t\t\t\tvar isSelected = $scope.field.value === choice.value\n\t\t\t\tif(isSelected){\n\t\t\t\t    $scope.selectedlabel = choice.label \n\t\t\t\t}\n\t\t\t\treturn isSelected;\n\t\t\t}\n\t\t\t$scope.$on('nextOrSubmitClick', function(e){\n\t\t\t\tif (!$scope.field.value && $scope.field.mandatory)\n\t\t\t\t\t$element.parent().find('.select2-focusser').addClass('autofocus-error');\n\t\t\t})\n\t\t},\n\t\t\n\t\tlink: function (scope, element, attrs, ngModel) {\n\t\t\tvar field = scope.field;\n\t\t\tvar fieldOptions;\n\t\t\tscope.$watchCollection('field.optionStack', function() {\n\t\t\t\tscope.options = applyOptionStack(fieldOptions, field.optionStack);\n\t\t\t});\n\n\t\t\tsetDefaultOptions();\n\n\t\t\tif (field.choices) {\n\t\t\t\tsetChoiceOptions(field.choices);\n\t\t\t}\n\t\t\t\n\t\t\tfunction setDefaultOptions() {\n\t\t\t\tsetChoiceOptions([{\n\t\t\t\t\tvalue: scope.field.value,\n\t\t\t\t\tlabel: scope.field.displayValue || scope.field.placeholder\n\t\t\t\t}]);\n\t\t\t}\n\n\t\t\tfunction setChoiceOptions(options) {\n\n\t\t\t\t// force string values\n\t\t\t\tif (options) {\n\t\t\t\t\toptions.forEach(function(option) {\n\t\t\t\t\t\toption.value = String(option.value);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tfieldOptions = options;\n\t\t\t\tscope.options = applyOptionStack(options, scope.field.optionStack);\n\t\t\t}\n\n\t\t\tfunction applyOptionStack(options, optionStack) {\n\t\t\t\tif (!optionStack || optionStack.length == 0) {\n\t\t\t\t\treturn options;\n\t\t\t\t}\n\t\t\t\tvar newOptions = angular.copy(options);\n\t\t\t\tif (!newOptions) {\n\t\t\t\t\tnewOptions = [];\n\t\t\t\t}\n\t\t\t\toptionStack.forEach(function(item) {\n\t\t\t\t\tswitch (item.operation) {\n\t\t\t\t\t\tcase 'add':\n\t\t\t\t\t\t\tvar newOption = {\n\t\t\t\t\t\t\t\tlabel: item.label,\n\t\t\t\t\t\t\t\tvalue: item.value\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (typeof item.index === 'undefined') {\n\t\t\t\t\t\t\t\tnewOptions.push(newOption);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewOptions.splice(item.index, 0, newOption);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'remove':\n\n\t\t\t\t\t\t\t// normalize comparison to string values\n\t\t\t\t\t\t\tvar itemValue = String(item.value);\n\t\t\t\t\t\t\tfor (var i = 0, iM = newOptions.length; i < iM; i++) {\n\t\t\t\t\t\t\t\tvar optionValue = String(newOptions[i].value);\n\t\t\t\t\t\t\t\tif (optionValue !== itemValue) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnewOptions.splice(i, 1);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'clear':\n\t\t\t\t\t\t\tnewOptions = [];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn newOptions;\n\t\t\t}\n\n\t\t\tfunction setModelValue(){\n\t\t\t\tupdateMandatoryFilled();\n\t\t\t\tngModel.$setViewValue(element.val());\n\t\t\t}\n\n\t\t\tif (angular.isFunction(element.select2)) {\n\t\t\t\telement.css(\"opacity\", 0);\n\n\t\t\t\t$timeout(function() {\n\t\t\t\t\telement.css(\"opacity\", 1);\n\t\t\t\t\telement.select2({\n\t\t\t\t\t\tallowClear: false,\n\t\t\t\t\t\twidth: '100%'\n\t\t\t\t\t});\n\n\t\t\t\t\t// Set the select2 value when the viewValue changes\n\t\t\t\t\tngModel.$render = function(){\n\t\t\t\t\t\telement.select2('val', ngModel.$viewValue);\n\t\t\t\t\t\telement.val(ngModel.$viewValue);\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t// Enable up or down key functionality to open the select\n\t\t\t\t\telement.parent().find(\".select2-focusser\").on(\"keydown\", function(e) {\n\t\t\t\t\t\tif ((e.which === 40 || e.which === 38))\n\t\t\t\t\t\t\telement.select2('open');\n\t\t\t\t\t});\n\t\t\t\t// Hard-setting an aria-label on the focused input, so both the question name and selected option can be announced by screen reader\n\t\t\t\tvar select2Focusser = $(element).parent().find('.select2-focusser');\n\t\t\t\tselect2Focusser.removeAttr('aria-labelledby');\n\t\t\t\tselect2Focusser.attr('aria-label', getAriaLabel());\n\t\t\t\tselect2Focusser.attr(\"aria-describedby\", \"details_\" + scope.field.sys_id);\n\t\t\t\tselect2Focusser.addClass(\"autofocus-class\")\n\t\t\t\t});\n\n\t\t\t\telement.on('change', function() {\n\t\t\t\t// Hard-setting an aria-label on the focused input, so both the question name and selected option can be announced by screen reader\n\t\t\t\t// Update aria-label ASAP (out of $timeout) - JAWS purpose. DEF0193081\n\t\t\t\tsetAttrsForSelect2Focusser();\n\t\t\t\t\tscope.$evalAsync(setModelValue);\n\t\t\t\t});\n\n\t\t\t\t// If the choices change, set the selected value.\n\t\t\t\tscope.$watch('snChoices', function(newValue, oldValue){\n\t\t\t\t\tif (angular.isDefined(newValue) && newValue != oldValue) {\n\t\t\t\t// Hard-setting an aria-label on the focused input, so both the question name and selected option can be announced by screen reader\n\t\t\t\t// Update aria-label ASAP (out of $timeout) - JAWS purpose. DEF0193081\n                   setAttrsForSelect2Focusser()\t\t\t\t\n\t\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\t\tsetModelValue();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t}\n\t\t\t\n\t\t\tfunction getAriaLabel() {\n\t\t\t\tvar label = scope.c.getAriaLabel(field);\n\t\t\t\tif(field.value) { // \"-- choose --\" has no value\n\t\t\t\t\tlabel += \" \" + scope.selectedlabel\n\t\t\t\t}\n\t\t\t\treturn label;\n\t\t\t}\n\t\t\t\n\t\t\tfunction setAttrsForSelect2Focusser() {\n\t\t\t\tvar select2Focusser = element.parent().find(\".select2-focusser\")\n\t\t\t\tselect2Focusser.attr(\"aria-label\", getAriaLabel());\n\t\t\t\tselect2Focusser.attr(\"aria-describedby\", \"details_\" + scope.field.sys_id);\n\t\t\t}\n\t\t\t\n\t\t\tfunction updateMandatoryFilled() {\n\t\t\t\t// if is not mandatory question or field has value, update isMandatoryFilled to true\n\t\t\t\tfield.isMandatoryFilled = !field.mandatory || field.value;\n\t\t\t\tvar select2Focusser = element.parent().find(\".select2-focusser\")\n\t\t\t\tif(field.isMandatoryFilled){\n\t\t\t\t\tselect2Focusser.removeClass(\"autofocus-error\")\n\t\t\t\t}else{\n\t\t\t\t\tselect2Focusser.addClass(\"autofocus-error\")\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"e614a9f2c3331200e44574e1c1d3ae60","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_e614a9f2c3331200e44574e1c1d3ae60","sys_updated_by":"admin","sys_created_on":"2016-06-07 19:57:38","name":"spSurveyChoiceList","sys_name":"spSurveyChoiceList","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"29","sys_updated_on":"2019-04-01 18:34:18","sys_tags":"","type":"directive","script":"function (i18n) {\n\t\tvar inner = '<div class=\"wrapper-xs alert alert-danger\" ng-if=\"field.invalidValue\">' +\n\t\t\t\t\t\t'${Value is invalid or out of range}' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"wrapper-xs\" ng-if=\"field.isConverted\">' +\n\t\t\t\t\t\t'${The input value has been adjusted to an integer}' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<span class=\"hidden-xs\">' +\n\t\t\t\t\t\t'<input class=\"form-control\" aria-label=\"{{::field.label}}\" ng-model=\"field.value\" ng-change=\"validate()\" style=\"width:75px;margin-right:5px;padding:3px 6px;display:inline-block;\" minvalue=\"{{::field.minValue}}\" maxvalue=\"{{::field.maxValue}}\"/>' +\n\t\t\t\t\t\t'<span ng-if=\"showPercentage || field.type == \\'percentage\\'\">%</span>' +\n\t\t\t\t\t\t'<span class=\"wrapper-sm\">${Range}: {{::field.minValue}} - {{::field.maxValue}}</span>' +\n\t\t\t\t\t'</span>' +\n\t\t\t\t\t'<span class=\"visible-xs\">' +\n\t\t\t\t\t\t'<input class=\"form-control question-number-field-border\" aria-label=\"{{::field.label}}\" ng-model=\"field.value\" ng-change=\"validate()\" style=\"width:149px;margin-right:5px;padding:3px 6px;display:inline-block;margin-left:2px;height:40.6px;border-radius:5px;\" minvalue=\"{{::field.minValue}}\" maxvalue=\"{{::field.maxValue}}\" placeholder=\"${Range} : {{::field.minValue}} - {{::field.maxValue}} {{::showPercentage || field.type == \\'percentage\\' ? \\'%\\' : \\'\\' }}\" />' +\n\t\t\t\t\t'</span>';\n\t\treturn {\n\t\t\ttemplate: '<div>' +\n\t\t\t\t\t\t'<div class=\"hidden-xs\">' + inner + '</div>' +\n\t\t\t\t\t\t'<div class=\"visible-xs\">' + inner + '</div>' +\n\t\t\t\t\t\t'<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>' +\n\t\t\t\t\t  '</div>',\n\n\t\t\tscope: {\n\t\t\t\t\t'field': '=',\n\t\t\t\t\t'showPercentage': '='\n\t\t\t},\n\n\t\t\tcontroller: function($scope) {\n\t\t\t \t$scope.validate = function() {\n\t\t\t \t\tvar field = $scope.field;\n\t\t\t\t\tif ($scope.isFloat(field.value) === true && field.value >= 0) {\n\t\t\t\t\t\tfield.value = Math.floor(field.value);\n\t\t\t\t\t\tfield.isConverted = true;\n\t\t\t\t\t} else\n\t\t\t\t\t\tfield.isConverted = false;\n\t\t\t\t\tif (field.value == '') {\n\t\t\t\t\t\tfield.invalidValue = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (isNaN(field.value)) {\n\t\t\t\t\t\tfield.invalidValue = true;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar value = parseFloat(field.value);\n\t\t\t\t\tvar maxValue = parseInt(field.maxValue);\n\t\t\t\t\tvar minValue = parseInt(field.minValue);\n\t\t\t\t\t// Set this variable if the entered value is out of either max or min value\n\t\t\t\t\tfield.invalidValue = (!isNaN(maxValue) && value > maxValue) || (!isNaN(minValue) && value < minValue);\n\t\t\t \t};\n\t\t\t\t$scope.isFloat = function(n) {\n\t\t\t\t\treturn n % 1 !== 0;\n\t\t\t\t};\n\t\t\t}\n\t\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"f0369177531323002d96ddeeff7b12a2","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_f0369177531323002d96ddeeff7b12a2","sys_updated_by":"admin","sys_created_on":"2019-02-05 05:54:19","name":"mespSurveyNumberField","sys_name":"mespSurveyNumberField","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"79","sys_updated_on":"2022-10-18 16:00:17","sys_tags":"","type":"directive","sys_class_name":"sp_angular_provider","sys_id":"f145f6645b1032003d1c484c11f91ac4","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_update_name":"sp_angular_provider_f145f6645b1032003d1c484c11f91ac4","sys_updated_by":"admin","sys_created_on":"2017-01-10 18:48:24","name":"bmKpiFilters","sys_name":"bmKpiFilters","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"sys_created_by":"admin","sys_policy":"protected"},{"sys_mod_count":"52","sys_updated_on":"2021-04-22 07:53:05","sys_tags":"","type":"directive","script":"function() {\n    return {\n        template:\n        '<div  ng-if=\"!isMobile\">' +\n               '<label style=\"display: inline-flex;\">' +\n                '<input class=\"autofocus-class\" type=\"checkbox\" elem-id=\"{{::field.sys_id}}\" name=\"{{field.name}}\" aria-label=\"{{c.getAriaLabel(field)}}\" aria-describedby=\"details_{{field.sys_id}}\" aria-checked=\"{{field.value}}\" ng-model=\"field.value\" ng-true-value=\"\\'true\\'\" ng-false-value=\"\\'false\\'\" ng-model-options=\"{getterSetter: true}\" ng-disabled=\"c.isDisabled || field.isReadonly() || field.readOnly\" ng-click=\"c.isDisabled ||selectChoice(c)\" aria-required=\"{{::field.mandatory}}\"/>' +\n                '<h4 ng-if=\"!htmlLabel\" id=\"{{::field.sys_id}}_label\" class=\"question-label\" style=\"margin: 0 0.5em 0;\">{{field.label}}</h4>' +\n                '<h4 ng-if=\"htmlLabel\" id=\"{{::field.sys_id}}_label\" class=\"question-label\" style=\"margin: 0 0.5em 0;\" ng-bind-html=\"field.label\"></h4>' +\n                '<div id=\"details_{{field.sys_id}}\">' +\n                '<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n                '</div>' +\n               '</label>' +\n          '</div>' +\n\t\t  '<div  ng-if=\"isMobile\" class=\"row\">' +\n               '<label style=\"display: inline-flex;\">' +\n                '<div class=\"col-xs-2\">' +\n                    '<h4><input class=\"autofocus-class\" type=\"checkbox\" elem-id=\"{{::mobilePrefix}}{{::field.sys_id}}\" name=\"{{field.name}}\" aria-label=\"{{c.getAriaLabel(field)}}\"aria-describedby=\"details_{{field.sys_id}}\" aria-checked=\"{{field.value}}\" ng-model=\"field.value\" ng-true-value=\"\\'true\\'\" ng-false-value=\"\\'false\\'\" ng-model-options=\"{getterSetter: true}\" ng-disabled=\"field.isReadonly() || field.readOnly\" aria-required=\"{{::field.mandatory}}\"/></h4>' +\n                '</div>' +\n                '<div class=\"col-xs-11\">' +\n                    '<h4 ng-if=\"!htmlLabel\" id=\"{{::mobilePrefix}}{{::field.sys_id}}_label\" class=\"question-label\">{{field.label}}</h4>' +\n                    '<h4 ng-if=\"htmlLabel\" id=\"{{::mobilePrefix}}{{::field.sys_id}}_label\" class=\"question-label\" ng-bind-html=\"field.label\"></h4>' +\n\t\t\t\t\t'<div id=\"details_{{field.sys_id}}\">' +\n\t\t\t\t\t\t'<div class=\"details-text\" ng-if=\"::field.details\" ng-bind-html=\"field.details\"></div>' +\n\t\t\t\t\t'</div>' +\n                '</div>' +\n                '</label>' +\n            '</div>' +\n            '<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>',\n        scope: {\n            field: '=',\n            htmlLabel: '=',\n            mobilePrefix: '=',\n            isMobile: '=',\n\t\t\tc: '='\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"f34da576c3331200e44574e1c1d3ae05","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_update_name":"sp_angular_provider_f34da576c3331200e44574e1c1d3ae05","sys_updated_by":"admin","sys_created_on":"2016-06-07 20:38:39","name":"spSurveyCheckbox","sys_name":"spSurveyCheckbox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/67ac5062db10220035417878f0b8f5c4","value":"67ac5062db10220035417878f0b8f5c4"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"0","sys_updated_on":"2019-01-14 03:25:02","sys_tags":"","type":"directive","script":"function () {\n\treturn {\n\t\trestrict: 'E',\n\t\treplace: true,\n\t\tscope: {\n\t\t\ticon: \"@\",\n\t\t\tfname: \"@\",\n\t\t\text: \"@\"\n\t\t},\n\t\ttemplate: \"<svg><use xlink:href='{{iconName}}'></use></svg>\",\n\t\tlink: function(scope){\n\t\t\t//File icon mapping\n\t\t\tvar fileIcons = {\n\t\t\t\txls: 'cm-icon-xls',\n\t\t\t\txlsx: 'cm-icon-xls',\n\t\t\t\tdoc: 'cm-icon-doc',\n\t\t\t\tdocx: 'cm-icon-doc',\n\t\t\t\tpdf: 'cm-icon-pdf',\n\t\t\t\tjpg: 'cm-icon-jpg',\n\t\t\t\tjpeg: 'cm-icon-jpg',\n\t\t\t\tpng: 'cm-icon-png',\n\t\t\t\tbmp: 'cm-icon-bmp',\n\t\t\t\tgif: 'cm-icon-gif',\n\t\t\t\tzip: 'cm-icon-zip',\n\t\t\t\ttxt: 'cm-icon-txt',\n\t\t\t\trtf: 'cm-icon-txt',\n\t\t\t\tppt: 'cm-icon-ppt',\n\t\t\t\tpptx: 'cm-icon-ppt',\n\t\t\t\terr: 'cm-icon-err',\n\t\t\t\tdef: 'cm-icon-doc'\n\t\t\t};\n\t\t\tscope.$watch('fname', function(){\n\t\t\t\tif(scope.fname){\n\t\t\t\t\tvar ext = scope.fname.substr((~-scope.fname.lastIndexOf(\".\") >>> 0) + 2);\n\t\t\t\t\tif(ext)\n\t\t\t\t\t\text = ext.toLowerCase();\n\t\t\t\t\tscope.iconName = '#' + (fileIcons[ext] ? fileIcons[ext] : fileIcons.def);\n\t\t\t\t}\n\t\t\t});\n\t\t\tscope.$watch('ext', function(){\n\t\t\t\tif(scope.ext){\n\t\t\t\t\tscope.iconName = '#' + (fileIcons[scope.ext] ? fileIcons[scope.ext] : fileIcons.def);\t\n\t\t\t\t}\n\t\t\t});\n\t\t\tscope.$watch('icon', function(){\n\t\t\t\tif(scope.icon){\n\t\t\t\t\tscope.iconName = '#' + scope.icon;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"f9e06b68530323008bd7ddeeff7b12cb","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/bab6dea3db20320099f93691f0b8f590","value":"bab6dea3db20320099f93691f0b8f590"},"sys_update_name":"sp_angular_provider_f9e06b68530323008bd7ddeeff7b12cb","sys_updated_by":"admin","sys_created_on":"2019-01-14 03:25:02","name":"kmIcon","sys_name":"kmIcon","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/bab6dea3db20320099f93691f0b8f590","value":"bab6dea3db20320099f93691f0b8f590"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"14","sys_updated_on":"2019-04-01 17:18:19","sys_tags":"","type":"directive","script":"function() {\n\treturn {\n\t\ttemplate: '<div class=\"input-group-checkbox question-multi-choice-field\">' +\n                   '<div ng-repeat=\"c in field.choices track by $index\">' +\n\t\t\t\t\t  '<div class=\"hidden-xs\">' +\n\t\t\t\t\t\t  '<input type=\"checkbox\" name=\"{{::c.name}}\" elem-id=\"{{::c.sys_id}}\" aria-label=\"{{::c.label}}\" aria-checked=\"{{c.selected}}\" ng-model=\"c.selected\" />' +\n\t\t\t\t\t\t  '<label for=\"{{::c.sys_id}}\" class=\"sps-checkbox-label\" style=\"margin-left: 1em;\">{{::c.label}}</label>' +\n\t\t\t\t\t   '</div>' +\n                   \n\t\t\t\t\t    '<div class=\"row visible-xs\">' +\n                           '<div class=\"col-xs-1\">' +\n                               '<label class=\"type-checkbox-label\"> <input class=\"type-checkbox-input\" type=\"checkbox\" name=\"{{::c.name}}\" elem-id=\"{{::c.sys_id}}\" aria-label=\"{{::c.label}}\" aria-checked=\"{{c.selected}}\" ng-model=\"c.selected\" aria-labelledby=\"{{::c.sys_id}_label\"/>' +\n                                   '<span class=\"type-checkbox-span\" style=\"margin-right: 1rem;\"/>' +\n                               '</label>' +\n                            '</div>' +\n                            '<div class=\"col-xs-11\" style=\"padding-top: 6px;\">' +\n                                '<div id=\"{{::c.sys_id}}_label\" class=\"sps-checkbox-label mesp_question_label\" ng-bind-html=\"c.label\"></div>' +\n                            '</div>' +\n                        '</div>' + \n\t\t\t\t  '<sp-survey-add-info ng-if=\"field.allow_add_info\" field=\"field\"></sp-survey-add-info>'\n\t};\n}","sys_class_name":"sp_angular_provider","sys_id":"fee79d77531323002d96ddeeff7b1264","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_update_name":"sp_angular_provider_fee79d77531323002d96ddeeff7b1264","sys_updated_by":"admin","sys_created_on":"2019-02-05 06:01:42","name":"mespSurveyMultipleCheckbox","sys_name":"mespSurveyMultipleCheckbox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/317b09fb535323002d96ddeeff7b121b","value":"317b09fb535323002d96ddeeff7b121b"},"sys_created_by":"admin","sys_policy":""}]}