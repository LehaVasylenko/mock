{"result":[{"template":"<!-- Nav bar menu items starts-->\n<nav class=\"navbar-inverse instance-{{c.data.instanceId}}\" aria-label=\"Primary\" role=\"navigation\">\n  <!-- Piece above searchbar -->\n  <div class=\"clearfix\">\n    <div class=\"navbar-header nav-container\">\n    <!-- Header search widget for Mobile View -->\n      <div ng-if=\"data.showTypeAheadSearch && (showMobileMenuOnDesktop || mobileDevice)\">\n        <div class=\"mobile-header-search\" ng-show=\"showSearchbarOnMobile\">\n          <div class=\"mobile-header-search-back\"  ng-click=\"hideSearchBar1()\">\n            <i class=\"fa fa-arrow-left\"></i>\n          </div>\n          <div id=\"searchBox\" class=\"full-width\" >\n            <sp-widget widget=\"data.typeAheadSearch\"></sp-widget>\n          </div>\n        </div>\n      </div>\n      <!-- Logo -->\n      <a class=\"navbar-brand\" ng-if=\"!portal.logo && !showSearchbarOnMobile\" href=\"?id={{::portal.homepage_dv}}\" aria-label=\"{{::portal.title}}\"><span>{{::portal.title}}</span></a>\n\t    <a class=\"navbar-brand navbar-brand-logo\"\n           ng-if=\"portal.logo && !showSearchbarOnMobile\"\n           href=\"?id={{::portal.homepage_dv}}\"\n           aria-label=\"{{::portal.title}}${ - Home Page}\"\n           data-toggle=\"tooltip\"\n           data-placement=\"bottom\"\n           data-title=\"{{::portal.title}}${ - Home}\">\n        <img ng-src=\"{{::portal.logo}}\" alt=\"{{::portal.title}}${ - Home Page}\"/>\n      </a>\n\n      <!-- Mobile Navigation View -->\n      <div ng-if=\"(showMobileMenuOnDesktop || mobileDevice) && !showSearchbarOnMobile\">\n        <!-- Header search icon for Mobile View -->\n        <div class=\"gt-menu-item\" ng-if=\"data.showTypeAheadSearch\">\n          <div ng-show=\"!data.excludeSeachForPages.includes(newPageId)\" class=\"mobile-header-search-icon-wrapper\">\n            <div ng-if=\"!showSearchbarOnMobile\" class=\"mobile-header-search-icon\" ng-click=\"showSearchBarMobile()\" >\n              <i class=\"fa fa-search searchprimary\"></i>\n            </div>\n          </div>\n        </div>\n        <!-- Toggle Button (Hamburger Menu for Mobile View) -->\n        <button type=\"button\" \n                class=\"sub-navbar-overflow-entry-button\"\n                aria-label=\"${Show menu primary navigation}\" \n                data-toggle=\"tooltip\"\n                data-placement=\"auto bottom\" \n                data-original-title=\"${Show Menu}\"\n                ng-click=\"toggleMobileMenuVisibility($event)\">\n          <div ng-if=\"!isMobileViewOnDesktopExpanded\">\n             <span class=\"label label-as-badge label-primary\">{{data.todoCount + data.requestCount + cartItemCount}}</span>\n             <span class=\"icon-bar\"></span>\n             <span class=\"icon-bar\"></span>\n             <span class=\"icon-bar\"></span>\n          </div>\n        </button>\n\n        <!-- Mobile menu items dialog modal-->\n      \t<div ng-show=\"isMobileViewOnDesktopExpanded\" id = \"mobile-menu-items-modal\" ng-include=\"'polaris-menuitems-mobileview'\"></div>\n      \n      </div>\n\n      <!-- Header Navbar -->\n      <div ng-if=\"!(showMobileMenuOnDesktop || mobileDevice)\" class=\"navbar-right\">\n        <div class=\"height-adjust\">\n          <ul class=\"nav navbar-nav\">\n            <li class=\"hidden-xs sp-loading-indicator la-sm\" ng-class=\"{'invisible': !loadingIndicator}\" >\n               <div></div>\n               <div></div>\n               <div></div>\n            </li>\n            \n            <!-- Header search widget for desktop view -->\n            <li class=\"gt-menu-item\" ng-if=\"data.showTypeAheadSearch\" >\n              <div ng-show=\"!data.excludeSeachForPages.includes(newPageId)\" class=\"desktop-headersearch-wrapper\">\n                <div id=\"searchBox\" class=\"hide-search visibility-collapse desktop-headersearch\">\n                  <sp-widget widget=\"data.typeAheadSearch\"></sp-widget>\n                </div>\n                <div aria-expanded=\"false\" class=\"desktop-headersearch-icon\" id=\"searchbox-icon\" ng-click=\"showAndExpandSearch()\" tabindex = \"0\" aria-label=\"${Show search box}\">\n                  <i class=\"fa fa-search searchprimary\"></i>\n                </div>\n              </div>\n            </li>\n            \n            <li class=\"gt-menu-item sparkle-nav\" ng-if=\"!hideSparkle\">\n              <sp-widget widget=\"data.sparkle\"></sp-widget>\n            </li>\n\n            <li class=\"gt-menu-item\" id=\"more-items\" role=\"presentation\" ng-if=\"data.showMoreItems\" >\n              <a ng-if=\"(data.moreItems.length === 1) && (data.moreItems[0].label !== data.moreItems[0].shortLabel)\"\n                 href=\"{{data.moreItems[0].href}}\"\n                 data-toggle=\"tooltip\"\n                 data-placement=\"bottom\"\n                 data-original-title=\"${{{data.moreItems[0].label}}}\"\n                 aria-label=\"${{{data.moreItems[0].label}}}\"\n                 >\n                <span ng-bind-html=\"'${' + data.moreItemsTitle + '}'\" aria-hidden=\"true\"></span>\n              </a>\n              <a ng-if=\"(data.moreItems.length === 1) && (data.moreItems[0].label === data.moreItems[0].shortLabel)\"\n                 href=\"{{data.moreItems[0].href}}\"\n                 aria-label=\"${{{data.moreItems[0].label}}}\"\n                 >\n                <span ng-bind-html=\"'${' + data.moreItemsTitle + '}'\" aria-hidden=\"true\"></span>\n              </a>\n              <a href\n                 ng-if=\"data.moreItems.length > 1\"\n                 id=\"more-items-button\"\n                 data-toggle=\"dropdown\"\n                 data-target=\"more-items-dropdown\"\n                 data-placement=\"bottom\"\n                 aria-label=\"${{{data.moreItemsTitle}}}\"\n                 >\n                <span ng-bind-html=\"'${' + data.moreItemsTitle + '}'\" aria-hidden=\"true\"></span>\n                <i class=\"fa collapse-margin m-l-xs fa-caret-down\"></i>\n              </a>\n              <ul id=\"more-items-dropdown\" ng-if=\"data.moreItems.length > 1\" class=\"dropdown-menu\"\n                   aria-label=\"${{{data.moreItemsTitle}}}\">\n                <li role=\"presentation\"\n                    ng-repeat=\"item in data.moreItems\"\n                    class=\"ng-scope dropdown-menu-line header-menu-item\">\n                  <a ng-if=\"item.label !== item.shortLabel\"\n                     href=\"{{item.href}}\"\n                     data-toggle=\"tooltip\"\n                     data-placement=\"bottom\"\n                     data-original-title=\"${ {{item.label}} }\"\n                     aria-label=\"{{item.label}}\"\n                    >\n                    <span ng-bind-html=\"'${' + item.shortLabel + '}'\" aria-hidden=\"true\"></span>\n                  </a>\n                  <a ng-if=\"item.label === item.shortLabel\"\n                     href=\"{{item.href}}\"\n                     aria-label=\"{{item.label}}\"\n                     >\n                    <span ng-bind-html=\"'${' + item.shortLabel + '}'\" aria-hidden=\"true\"></span>\n                  </a>\n                </li>\n              </ul>\n            </li>\n            \n            <!-- Cart, tours, and Wishlist -->\n              <li class=\"gt-menu-item\" >\n                <sp-widget widget=\"data.top.menu\" id=\"menu_item\"></sp-widget>\n              </li>  \n              <li class=\"gt-menu-item\" aria-label=\"Language Selector\">\n                <sp-widget widget=\"::data.langSelector\"></sp-widget>\n              </li>\n            \n            <li>\n              <div sp-navbar-toggle=\"\" class=\"navbar-right\" id=\"sp-nav-bar\" >\n                <ul ng-if=\"::(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)\" class=\"nav navbar-nav\">\n                  <li class=\"login\"><a href ng-click=\"openLogin()\">${Login}</a></li>\n                </ul>\n                <ul ng-if=\"::user.logged_in\" class=\"nav navbar-nav\">\n                  <!-- chat, avatar, and logout -->\n                  <li class=\"dropdown hidden-xs\">\n                    <a href=\"javascript:void(0)\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n                      <span class=\"navbar-avatar\"><sn-avatar class=\"avatar-small-medium\" primary=\"avatarProfile\" /></span>\n                      <span class=\"visible-lg-inline\">{{::user.name}}</span>\n                    </a>\n                    <ul class=\"dropdown-menu\">\n                      <li><a ng-href=\"?id={{::data.supportProfilePortal}}\">${Profile}</a></li>\n                      <li class=\"logout\"><a href=\"{{::portal.logoutUrl}}\">${Logout}</a></li>\n                    </ul>\n                  </li>\n                  <li class=\"visible-xs-block\"><a ng-href=\"?id={{::data.supportProfilePortal}}\"><span class=\"navbar-avatar\"><sn-avatar class=\"avatar-small-medium\" primary=\"avatarProfile\" /></span>{{::user.name}}</a></li>\n                  <li class=\"visible-xs-block logout\"><a href=\"{{::portal.logoutUrl}}\">${Logout}</a></li>\n                </ul>\n              </div>\n            </li>\n\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n      \n  <!-- Sub Navbar on Desktop -->\n  <div class=\"navbar-collapse sub-navbar clearfix collapse collapsed hidden-xs\"\n       ng-class=\"{ 'in': expanded, 'collapsed': !expanded, 'sub-navbar--mobile-view': showMobileMenuOnDesktop }\"\n       ng-if=\"data.showSubHeader\">\n    <div>\n      <sp-widget widget=\"data.sub.menu\"></sp-widget>\n    </div>\n  </div>\n\n  <!-- Analytics -->\n  <div ng-if=\"data.analyticsSupportEnabled\">\n    <widget id=\"cda-site-analytics\" options=\"{'enable_logging': false}\"></widget>\n  </div>\n</nav>","css":"$sp-space--xxs: 2px !default;\n$sp-space--xs: 4px !default;\n$sp-space--sm: 8px !default;\n$sp-space--md: 12px !default;\n$sp-space--lg: 16px !default;\n$sp-space--xl: 24px !default;\n$sp-space--3xl: 40px !default;\n$background-primary : $body-bg !default;\n$font-size-md: 16px !default;\n$font-size-large: 20px !default;\n$font-size-xl: 24px !default;\n$brand-primary-darker: darken($brand-primary,16) !default;\n\n#searchBox .btn{\n  padding : 0px $sp-space--lg;\n}\n\n.dropdown-menu.empty-dropdown.ng-scope,.dropdown-menu.cart-dropdown.custom-drop-down,.dropdown-menu.wishlist-menu.custom-drop-down {\n  background-color: transparent !important;\n  padding-bottom: 0 !important;\n  padding-left: 0 !important;\n  padding-right: 0 !important;\n}\n\n\n.navbar-inverse {\n  margin-bottom: 0px;\n  border-radius: 0px; \n  background-color: $navbar-inverse-bg;\n  .navbar-header {\n    &.nav-container {\n      width: 100%;\n\n      .sub-navbar-overflow-entry-button {\n        position: relative;\n        float: right;\n        margin: $sp-space--md $sp-space--lg $sp-space--md 0;\n        padding: $sp-space--sm 1rem;\n        background-color: transparent;\n        background-image: none;\n        border: .1rem solid transparent;\n        border-radius: $border-radius-base;\n        border-color: rgba(255, 255, 255, .25);\n\n       .label {\n         float: right;\n         margin-right: -$sp-space--xs;\n         margin-top: -$sp-space--sm;\n         padding: $sp-space--xxs $sp-space--xs;\n       }\n\n       .label-as-badge {\n          font-size: $font-size-xs;\n          position: relative;\n          top: -$sp-space--xxs;\n          left: $sp-space--xxs;\n          padding: $sp-space--xxs $sp-space--xs;\n          margin-left: 0;\n          background-color: $btn-danger-bg;\n          color: $background-primary;\n        }\n\n        .icon-bar {\n          display: block;\n          width: 2.2rem;\n          height: .2rem;\n          border-radius: $border-radius-small;\n          background-color: $background-primary;\n        }\n        .icon-bar + .icon-bar {\n          margin-top: $sp-space--xs;\n        }\n      }\n    }\n\n    .mobile-view-on-desktop {\n    \tposition: absolute;\n      z-index: 999;\n      /* 60px is height of the header strip */\n      top: 60px;\n      right: 0;\n      min-height: 500px;\n      max-width: 400px;\n      background-color: $navbar-inverse-bg;\n      box-shadow: 5px 5px 5px $navbar-inverse-link-color;\n      color: $navbar-inverse-link-color;\n\n      .mobile-view-navbar {\n         list-style: none;\n         padding: 0 $sp-space--sm;\n         margin: 0;\n         display: flex;\n         flex-direction: column;\n         border-top: 1px solid darken($navbar-inverse-link-color, 45%);\n\n         .main-header-items {\n           list-style: none;\n           padding: $sp-space--md 0 0 $sp-space--lg;\n           margin: 0;\n           display: flex;\n           flex-direction: column;\n\n           & > li {\n             &:not(:last-child) {\n               padding-top: $sp-space--lg;\n             }\n             // Cart, tours, and Wishlist (Mobile View)\n             .nav.navbar-nav {\n               display: flex;\n               flex-direction: column;\n\n               li {\n                 padding-top: $sp-space--lg;\n               }\n             }\n           }\n         }\n\n         .mobile-mega-menu-entry {\n           margin: 0 -$sp-space--sm;\n           padding: $sp-space--xl $sp-space--lg;\n           background-color: $sp-navbar-divider-color;\n           \n           .dropdown-menu {\n           \tbackground-color: transparent;\n           }\n         }\n         .separator {\n           margin: 20px -$sp-space--sm;\n           border-top: 1px solid darken($navbar-inverse-link-color, 30%);\n         }\n\n         li > a {\n           color: $navbar-inverse-link-color;\n           padding: 0;\n\n           &:hover, &:focus {\n             color: $navbar-inverse-link-hover-color !important;\n             background-color: transparent;\n           }\n           &:focus {\n             box-shadow: inset 0 0 0 0.1rem $navbar-inverse-link-hover-color;\n             padding: $sp-space--xs;\n             border: 0.5px solid $navbar-inverse-link-color;\n             border-radius: $border-radius-base;\n           }\n         }\n        .header-menu-item > a{\n        \tpadding: $sp-space--md $sp-space--sm;\n        }\n       }\n\n      .impersonate-and-logout {\n          div > ul > li:first-child {\n            height: 0;\n\n            ul.dropdown-menu {\n              width: 400px;\n              display: block;\n              z-index: inherit;\n              background-color: $navbar-inverse-bg;\n              box-shadow: none;\n              border-radius: 0;\n              padding-left: $sp-space--xxs;\n              padding-bottom: $sp-space--lg;\n\n              li > a {\n                line-height: 2;\n\n                &:hover, &:focus {\n                  color: $navbar-inverse-link-hover-color !important;\n                  background-color: transparent;\n                }\n                &:focus {\n                  box-shadow: inset 0 0 0 0.1rem $navbar-inverse-link-hover-color;\n                  padding: $sp-space--xs;\n                  margin-left: $sp-space--lg;\n                  border: 0.5px solid $navbar-inverse-link-color;\n                  border-radius: $border-radius-base;\n                  width: fit-content;\n                }\n              }\n              li:first-child {\n                display: none;\n              }\n           }\n         }\n       }\n     }\n\n    .navbar-brand {\n      margin: 0;\n      height: 60px;\n      padding: $sp-logo-margin-y 0px $sp-space--sm $sp-space--lg;\n      img, span {\n        margin: 0;\n        display: block;\n        max-height: $sp-logo-max-height;\n        max-width: $sp-logo-max-width;\n        position: relative;\n        top: 50%;\n        -webkit-transform: translateY(-50%);\n        -ms-transform: translateY(-50%);\n        transform: translateY(-50%);\n\tpadding-right: $sp-space--sm;\n      }\n    }\n\n    .navbar-right .dropdown-menu > li > a {\n      &:hover, &:focus {\n        background-color: darken($navbar-inverse-bg, 8%);\n      }\n\n      &:focus {\n        border: 0.5px solid $navbar-inverse-link-color;\n        border-radius: $border-radius-base;\n        box-shadow: inset 0 0 0 0.1rem $navbar-inverse-link-hover-color;\n      }\n    }\n  }\n  .dropdown-menu > li > a {\n    color: $navbar-inverse-link-color;\n  }\n  .dropdown-toggle:focus {\n  \toutline: thin dotted;\n    outline: 5px auto -webkit-focus-ring-color;\n  }\n  .sub-navbar {\n    background-color: $sp-navbar-divider-color;\n    border: none;\n    width: 100%;\n   \n    #cart-dropdown, #wishlist-menu {\n      display: none;\n      ~ * {\n        display: none !important;\n      }\n    }\n    .navbar-nav > li > a[href=\"?id=sc_cart\"], .navbar-nav > li > a[href=\"?id=sc_wishlist\"] {\n      display: none !important;\n    }\n    .gtd-dropdown-container {\n      display: none;\n    }\n    .open > a, .open > a:focus {\n      background-color: darken($sp-navbar-divider-color, 8%);\n    }\n    #cart-dropdown {\n      display: none;\n      :after {\n        content: \"\\f0d7\";\n        vertical-align: baseline;\n        width: auto;\n        height: auto;\n        border: none;\n        margin-left: sp-space--xs !important;\n        display: inline-block;\n        font: normal normal normal $font-size-small/1 FontAwesome;\n        font-size: inherit;\n        text-rendering: auto;\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n      }\n    }\n   \n    .dropdown-menu {\n      background-color: $sp-navbar-divider-color;\n      > li > a:hover, > li > a:focus {\n        background-color: darken($sp-navbar-divider-color, 8%);\n\tbox-shadow:unset;\n      }\n    }\n  }\n  .dropdown-menu {\n    background-color: rgba($navbar-inverse-bg, 0.97);\n    border: none;\n    &.case-menu {\n      right: 0;\n      left: auto;\n      padding: 0;\n      width: 450px;\n      background: $background-primary;\n      overflow-y: hidden;\n    }\n  }\n  > .open > a:hover, > .open > a:focus  {\n    background-color: darken($navbar-invese-bg, 8%);\n  }\n  .fa-caret-down {\n    vertical-align: middle;\n    margin-top: $sp-space--xxs;\n  }\n  .caret:before {\n    content: \"\\f0d7\";\n  }\n  .caret {\n    vertical-align: baseline;\n    width: auto;\n    height: auto;\n    border: none;\n    margin-left: $sp-space--xs !important;\n    display: inline-block;\n    font: normal normal normal $font-size-small/1 FontAwesome;\n    font-size: inherit;\n    text-rendering: auto;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n  .label-as-badge {\n    font-size: $font-size-xs;\n    position: relative;\n    top: -$sp-space--sm;\n    left: -$sp-space--xxs;\n    padding: -$sp-space--xxs $sp-space--xs;\n    margin-left: 0;\n    background-color: $btn-danger-bg;\n    color: $background-primary;\n  }\n  .navbar {\n    transition: 250ms opacity ease-in-out; \n    -webkit-transition: 250ms opacity ease-in-out; \n    border: 0;\n  }\n  .navbar-fade {\n    opacity: 0.4;\n  }\n  .navbar-collapse {\n    padding-right: 0px;\n  }\n  .case-menu {\n    div#widget-tabs-2 {\n      border: none;\n      > .panel-heading {\n        border: none;\n        border-bottom: 1px solid $border-tertiary;\n      }\n    }\n  }\n\n  ul.nav.navbar-nav {\n    // Hiding the loading indicator from Header Menu base system widget\n    div.header-loader {\n       display: none;\n    }\n    li.sp-loading-indicator {\n       padding-top: $sp-space--xl;\n       margin-top: $sp-space--xxs;\n    }\n  }\n  \n  #more-items-dropdown {\n    overflow: visible;\n  }\n\n  .cart-dropdown, .wishlist-menu, .gtd-dropdown-container .empty-dropdown {\n    width: 350px;\n    padding: 0;\n    z-index: 1000;\n    border-top-left-radius: $border-radius-base !important;\n    border-top-right-radius: $border-radius-base !important;\n\n    ul {\n      max-height: 300px;\n      overflow: auto;\n    }\n\n    .subtotal {\n      display: block;\n    }\n\n    .item-image {\n      padding: 0;\n      margin: 0;\n      text-align: center;\n      max-width:100%;\n      height:auto;\n    }\n    label, p {\n      padding: 0;\n      margin: 0;\n    }\n    .media {\n      padding: 0;\n      margin: 0;\n    }\n    .media-left > a {\n      display: block;\n      width: 48px;\n      max-width: 48px;\n    }\n    .media-body {\n      label {\n        font-weight: bold;\n      }\n    }\n    li.media {\n      border-top: 1px solid #cccccc;\n      padding: 1rem;\n    }\n    .panel {\n      margin: 0;\n    }\n    .panel .panel-body {\n      padding: 0;\n    }\n    .btn-clear {\n      color: #333;\n      background-color: $background-primary;\n    }\n    p.quantity-price {\n      padding-top: $sp-space--xs;\n      span {\n        color: $text-muted;\n        padding-right: $sp-space--xs;\n      }\n    }\n    .align-right {\n      text-align: right;\n    }\n  }\n\n  .item-added-tooltip, wishlist-item-added-tooltip {\n    width: 184px;\n    font-size: $font-size-small;\n  }\n\n  .gtd-dropdown-container {\n    .empty-tour-content {\n      text-align: center;\n      margin: $sp-space--3xl $sp-space--lg;\n    }\n    .dropdown-menu li {\n      a {\n        cursor: pointer;\n      }\n      min-width: 20em;\n    }\n    .label-as-badge {\n      width: 12px;\n      height: 12px;\n      display: inline-block;\n      padding: 0px;\n      padding-top: $sp-space--xxs;\n    }\n    .badge-container {\n      display: inline-block;\n      width: 12px;\n    }\n  }\n\n}\n@media screen and (min-width: 768px) {\n  .navbar-inverse {\n    .navbar-right > .navbar-nav > div {\n      float: left;\n    }\n    .navbar-right {\n      margin-right: $sp-space--sm;\n      > ul {\n        display: -webkit-box;\n        display: -moz-box;\n        display: box;\n\n        -moz-box-orient: horizontal;\n        box-orient: horizontal; \n        -webkit-box-orient: horizontal;\n      }\n      .navbar-nav > li > a {\n        padding-right: $sp-space--md;\n        padding-left: $sp-space--md;\n      }\n      .header-menu-item > a{\n        \tpadding: $sp-space--sm;\n        }\n    }\n    .navbar-avatar {\n      margin-top: -$sp-space--xs;\n    }\n    a#todos_popup {\n      padding-left:0px;\n    }\n    .navbar-nav .open .dropdown-menu > li > a {\n      padding: 10px 20px;\n    }\n    .navbar-header {\n      position:relative;\n      .dropdown-toggle {\n        height: 60px;\n      }\n      .navbar-nav  > li  > a {\n        padding-top: 20px;\n        padding-bottom: 20px;\n        max-height:50px;\n        padding-right: $sp-space--md;\n        padding-left: $sp-space--md;\n      }\n    }\n    .temp-mobile {\n      display: inline-block;\n    }\n    .sub-navbar {\n      display: flex;\n      padding-left: 0;\n    }\n\n    .sub-navbar--mobile-view {\n      max-height: 0px;\n      /* Using !important here as we are overriding bootstrap style */\n      overflow-y: hidden !important;\n    }\n    .navbar-nav  > li  > a {\n\t\tpadding-top: 20px;\n\t\tpadding-bottom: 20px;\n\t}\n  }\n}\n\n// Search bar styles in the header (Should always be in the center)\n.header-search {\n   @media screen and (min-width: 768px) {\n      position: absolute;\n      left: 37%;\n      margin: $sp-space--md 0;\n      width: 20%;\n   }\n\n   @media (min-width : 320px) and (max-width : 767px) {\n      margin-top: 0 !important;\n      padding-bottom: 10px;\n      float: right;\n      width: 100%;\n   }\n\n   @media (min-width : 768px) and (max-width: 867px) {\n      left: 23% !important;\n   }\n\n   @media (min-width : 868px) and (max-width: 1024px) {\n      left: 27% !important;\n   }\n\n   @media (min-width : 1025px) and (max-width: 1200px) {\n      left: 30% !important;\n   }\n\n   @media (min-width : 1201px) and (max-width: 1400px) {\n      left: 33% !important;\n   }\n}\n\n@media (min-width : 320px) and (max-width : 767px) {\n  .navbar-inverse {\n    .dropdown-menu.case-menu {\n      width: 100%;\n    }\n    .navbar-toggle {\n      border-color: rgba(255, 255, 255, .25);\n    }\n    .navbar-toggle:focus {\n      -webkit-box-shadow: 0rem 0rem 0.5rem #1f8476 \n    }\n    .navbar-nav {\n      display: block;\n      margin: 0;\n\n      .open .dropdown-menu > li > a {\n        padding: 5px 30px;\n      }\n    }\n    .sub-navbar {\n      padding: 0px 0px;\n    }\n    .upper-collapse {\n      width: 100%;\n      padding-bottom: 0px;\n    }\n    .navbar-collapse {\n      padding-top: 0px;\n      padding-left: 0px;\n      overflow: hidden;\n      ul {\n        margin: 0;\n      }\n    }\n    .navbar-header.nav-container {\n      .sub-navbar-overflow-entry-button {\n        float: none;\n        position: absolute;\n        right: 0;\n      }\n      .mobile-view-on-desktop {\n        min-width: 100%;\n        // max-width: 100%; is needed for 400% zoom-level in WCAG resolution\n        max-width: 100%;\n        top: 60px;\n        box-shadow: none;\n\n        .impersonate-and-logout {\n           div > ul > li:first-child {\n             height: auto;\n           }\n         }\n      }\n      .mobile-view-on-desktop.search-visible {\n         top: 53px;\n      }\n\n      > ul {\n        display: inline-block;\n        padding: 10px 10px 0 0;\n        float: right;\n        margin: 0;\n      }\n      > li {\n        display: inline-block; \n      }\n    }\n    .height-adjust {\n      padding: $sp-space--sm 0px;\n      margin-bottom: $sp-space--md;\n    }\n    .popup-edit {\n      background: $background-primary;\n      position: fixed;\n      top:0; \n      height:100%;\n      margin-top: 0;\n      max-height:100%;\n      width:100%\n    }\n    .navbar-collapse-label {\n      float: right;\n      margin-right: -5px;\n      margin-top: -7px;\n    }\n    button > span.label {\n      padding: .2em .5em .2em;\n    }\n  }\n  .nav > li > a {\n  \tpadding-left: 0px;\n  }\n}\n.navbar-right{\n  .nav{\n    .dropdown{\n      .tooltip{\n        .tooltip-inner{\n        \tword-wrap:unset;\n        }\n      }\n    }\n  }\n}\n\n/* Header search */\ninput[name=\"q\"]::placeholder {\n  font-size: $font-size-md !important;\n}\n\ninput[name=\"q\"],.search-combobox--header .input-container__input{\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.desktop-headersearch-wrapper {\n  display:flex;\n  justify-content: end;\n  padding: $sp-space--md 0px $sp-space--md $sp-space--md;\n\n  .desktop-headersearch-icon {\n    padding: $sp-space--sm $sp-space--sm $sp-space--sm $sp-space--sm;\n    color: $navbar-inverse-link-color;\n    float: right;\n    &:hover {\n      color: $navbar-inverse-link-hover-color;\n    } \n    &:focus {\n      box-shadow: inset 0 0 0 0.1rem $navbar-inverse-link-hover-color;\n      border: 0.5px solid $navbar-inverse-link-color;\n      border-radius: $border-radius-base;\n    }\n  }\n  .hide-search {\n    width: 80px;\n    transition: width 0.5s ease-in-out;\n  }\n  .visibility-collapse {\n    visibility: collapse;\n  }\n  .show-search {\n    width: 400px !important;\n    transition: width 0.5s ease-in-out;\n    visibility: visible;\n  }\n}\n.mobile-header-search-icon-wrapper {\n  float: none;\n  position: absolute;\n  right: 60px;\n  padding: $sp-space--md;\n\n  .mobile-header-search-icon{\n    color: $navbar-inverse-link-color;\n    padding: $sp-space--xs;\n    &:hover {\n      color: $navbar-inverse-link-hover-color;\n    }\n  }\n}\n.mobile-header-search {\n  display: flex;\n  height: 6rem;\n  padding: $sp-space--md $sp-space--lg 0px $sp-space--lg;\n\n  .mobile-header-search-back {\n    font-size: $font-size-large;\n    padding: $sp-space--xs;\n    margin: 0px $sp-space--md $sp-space--lg 0px;\n    align-self: center;\n    .fa {\n    \tcolor: $navbar-inverse-link-color;\n       \t&:hover {\n      \t\tcolor: $navbar-inverse-link-hover-color;\n    \t}\n    }\n  }\n  .full-width {\n    width: 100%;\n  }\n}\n\n/* Mobile menu modal */\n#mobile-menu-items-modal{\n  color: $navbar-inverse-link-color;\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 25;\n  overflow: auto;\n  background-color: $brand-primary-darker;\n  \n  a {\n  \tcolor: $navbar-inverse-link-color;\n  }\n  li {\n    padding-left: $sp-space--md;\n    .fa {\n    \tfont-size: $font-size-xl;\n      margin-right: $sp-space--md;\n    }\n  }\n  li > a:focus {\n    box-shadow: inset 0 0 0 0.1rem $navbar-inverse-link-hover-color;\n    padding: $sp-space--xs;\n    border: 0.5px solid $navbar-inverse-link-color;\n    border-radius: $border-radius-base;\n  }\n  .dropdown-menu {\n    background-color: transparent;\n  }\n  .mobile-menu-modal-list {\n    list-style-type: none;\n    padding: $sp-space--sm;\n  }\n  .user-profile-mobile {\n    font-size: $font-size-large;\n    font-weight: 600;\n  }\n  .line-separator-categories {\n    margin-top: 0px;\n    margin-bottom: $sp-space--lg;\n    width: 100%;\n    text-align: left;\n    margin-left: 0;\n  }\n  .tree-mobile {\n    display: flex;\n    margin: 0 $sp-space--lg $sp-space--lg $sp-space--lg;\n  }\n  .result-heading-mobile {\n    display: flex;\n    align-items: center;\n    font-style: normal;\n    font-weight: 600;\n    font-size: $font-size-md;\n    line-height: 23px;\n    gap: $sp-space--md;\n    padding: $sp-space--md $sp-space--lg;\n  }\n  .close-modal-button {\n    display: flex;\n    justify-content: right;\n    margin-right: $sp-space--lg;\n    margin-top: $sp-space--lg;\n    \n    path {\n    \tfill: $navbar-inverse-link-color;\n    }\n  }\n  .mobile-list-item {\n    margin: $sp-space--xs 0px;\n    padding: $sp-space--md;\n  }\n  .avatar-container .avatar.soloAvatar .sub-avatar {\n    font-size: $font-size-large;\n  }\n  .user-profile-menu-item {\n    font-size: $font-size-large;\n    padding: $sp-space--md;\n    margin: $sp-space--xs 0px;\n  }\n  .mobile-menu-icon {\n    font-size: $font-size-xl;\n    vertical-align: sub;\n  }\n  .guest-avatar {\n    height: 42px;\n    width: 42px;\n    border-radius: 50%;\n    text-align: center;\n    display: inline-block;\n    vertical-align: middle;\n    border-color: $border;\n    background-color: $background-tertiary;\n  }\n  .guest-avatar-icon {\n    color: $brand-primary;\n    font-size: $font-size-xl;\n    vertical-align: -webkit-baseline-middle;\n    margin: 0px !important;\n  }\n  .show-more-item{\n  \tmargin-bottom: $sp-space--lg;\n\t}\n  hr {\n  \tborder-color: $brand-primary;\n  }\n  .navbar-avatar {\n    margin-right: $sp-space--md !important;\n  }\n}\n","internal":"false","roles":"","link":"function pspHeaderLink(scope, element, attrs, controller) {\n    $(element).on('click', 'a.navbar-brand', function(e) {\n        scope.expanded = false;\n    });\n    $(element).on('click.nav', '.navbar-collapse.in', function(e) {\n        var target = $(e.target);\n        if (target.is('a') && !target.hasClass(\"dropdown-toggle\") && target.siblings('.dropdown-menu').length == 0) {\n            // collapse mobile nav if clicked an anchor that isn't a dropdown toggle\n            scope.expanded = false;\n            return;\n        }\n\n        // if neither target nor parent is an anchor or the parent anchor is a dropdown-toggle, do nothing\n        if (!target.parent().is('a') || target.parent().hasClass(\"dropdown-toggle\") || target.parent().siblings('.dropdown-menu').length > 0)\n            return;\n\n        // collapse mobile nav if target is part of a submenu\n        if (target.parents(\"ul.dropdown-menu\").length > 0) {\n            scope.expanded = false;\n            return;\n        }\n\n        // collapse mobile nav is target is part of the dropdown\n        if (target.parents(\"div.navbar-collapse\").length > 0)\n            scope.expanded = false;\n    });\n    $(element).on('keydown', '.dropdown-menu > .header-menu-item', function(e) {\n        var target = e.target;\n        if (target.localName === 'a') {\n            if (e.keyCode === 37 || e.keyCode === 39) {\n                e.preventDefault();\n                $(target).parents('li').removeClass('open');\n                $(target).parents('li').find('a').focus();\n            } else if (e.keyCode === 9) {\n                $(target).parents('li').removeClass('open');\n            }\n        }\n    });\n\n    $('body').click(function(event) {\n        if ($(event.target).text() !== controller.toursTranslation && !$(event.target).is(\"[aria-expanded]\") && scope.isMobileViewOnDesktopExpanded)\n            scope.toggleMobileMenuVisibility();\n    });\n\n    // Closing mobile navigation menu after hitting Tab key on Logout option to focus on next DOM element on the page.\n    $(document).on('keydown', 'ul > li.logout > a[href*=\"logout\"]', function(keyDownEvent) {\n        var TAB_KEY_VALUE = 'Tab';\n\n        if (keyDownEvent.key === TAB_KEY_VALUE && scope.mobileDevice) {\n            scope.$applyAsync(function() {\n                scope.toggleMobileMenuVisibility();\n            });\n        }\n    });\n    $(document).on('keydown', 'ul > li.login', function(keyDownEvent) {\n        var TAB_KEY_VALUE = 'Tab';\n\n        if (keyDownEvent.key === TAB_KEY_VALUE && scope.mobileDevice) {\n            scope.$applyAsync(function() {\n                scope.toggleMobileMenuVisibility();\n            });\n        }\n    });\n    // Helper function to handle the arrow key navigation in the header\n    function handleKeyPressEvents(e) {\n        var target = e.target;\n        var querySelector;\n        if ($(this).hasClass('main-header-item'))\n            querySelector = 'li.main-header-item';\n        else if ($(this).hasClass('gt-menu-item'))\n            querySelector = 'li.gt-menu-item';\n\n        if (target.localName === 'a') {\n            var currentMenuItem = $(target).parents('li');\n            var parentUL = currentMenuItem.parents('ul');\n            var allMenuItems = parentUL.children(querySelector);\n            var firstMenuItem = allMenuItems.first();\n            var lastMenuItem = allMenuItems.last();\n            var menuItemToFocus;\n\n            // Only Side arrow keys should work for gt-menu-item and only vertical arrow keys should work for main-header-item\n            if (querySelector === 'li.gt-menu-item' && !(e.keyCode === 37 || e.keyCode === 39 || e.keyCode === 9))\n                return;\n            else if (querySelector === 'li.main-header-item' && !(e.keyCode === 38 || e.keyCode === 40))\n                return;\n\n            if (querySelector === 'li.gt-menu-item') {\n                if (e.keyCode === 9) {\n                    $(target).parents('li').removeClass('open');\n                    return;\n                } else {\n                    e.preventDefault();\n                    currentMenuItem.removeClass('open');\n                }\n            } else\n                e.preventDefault();\n\n            if (e.keyCode === 37 || e.keyCode === 38) {\n                var previousMenuItem = currentMenuItem.prevAll(querySelector);\n                currentMenuItem.prevAll(querySelector).first();\n                //enable circular navigation\n                menuItemToFocus = previousMenuItem.length ? previousMenuItem : lastMenuItem;\n                menuItemToFocus.find('a').focus();\n            } else if (e.keyCode === 39 || e.keyCode === 40) {\n                var nextMenuItem = currentMenuItem.nextAll(querySelector).first();\n                //enable circular navigation\n                menuItemToFocus = nextMenuItem.length ? nextMenuItem : firstMenuItem;\n                menuItemToFocus.find('a').focus();\n            }\n        }\n    }\n\n    // Handler to focus the first element of More Items dropdown on pressing Space/Enter/Down Arrow key.\n    $(element).on('keydown', '#more-items-button', function(e) {\n        if (e.keyCode === 32 || e.keyCode === 13 || e.keyCode === 40) {\n            e.preventDefault();\n            var target = e.target;\n            var moreItemsDropdown = '#more-items-dropdown';\n            $(target).click();\n            $(moreItemsDropdown).find('li.header-menu-item a:first').focus();\n        }\n    });\n\n    // Capturing the arrow key navigation in mega menu for both desktop and mobile view  \n    $(element).on('keydown', '.gt-menu-item, .main-header-item', handleKeyPressEvents);\n\n    var rateLimitedCallback = debounce(function() {\n        scope.$apply(function() {\n            // update current scope based on the new innerWidth and let angular update the view.\n            scope.mobileDevice = controller.data.isMobile || (window.innerWidth <= controller.MOBILE_DEVICE_SCREEN_WIDTH);\n        });\n    }, 250);\n\n    $(window).resize(rateLimitedCallback);\n\n    // This helper returns a function, that, as long as it continues to be invoked, will not\n    // be triggered. The function will be called after it stops being called for\n    // N milliseconds. If `immediate` is passed, trigger the function on the\n    // leading edge, instead of the trailing.\n    function debounce(func, wait, immediate) {\n        var timeout;\n        return function() {\n            var context = this,\n                args = arguments;\n            var later = function() {\n                timeout = null;\n                if (!immediate) func.apply(context, args);\n            };\n            var callNow = immediate && !timeout;\n            clearTimeout(timeout);\n            timeout = setTimeout(later, wait);\n            if (callNow) func.apply(context, args);\n        };\n    }\n}","description":"","sys_updated_on":"2024-10-09 09:54:36","sys_class_name":"sp_header_footer","sys_id":"3552f974845a1110f87767389929c604","sys_updated_by":"admin","docs":"","public":"true","client_script":"function pspHeaderController($rootScope, $scope, $window, spUtil, $location, $uibModal, cabrillo, $timeout, i18n, spContextManager,spAriaUtil) {\n    var c = this;\n    $scope.avatarProfile = {\n\t\tuserID: $scope.user.sys_id,\n\t\tname: $scope.user.name,\n\t\tinitials: $window.NOW.user_initials\n\t  };\n\t  if ($window.NOW.user_avatar) {\n\t\t$scope.avatarProfile.userImage = $window.NOW.user_avatar;\n\t  }\n    // Events fired from/to $rootScope for responsive mobile view.\n    c.SHOW_MOBILE_MEGA_MENU = 'showMobileMegaMenu';\n    c.SHOW_MOBILE_MENU_ON_DESKTOP = 'showMobileMenuOnDesktop';\n    c.TOGGLE_MOBILE_MENU_VISIBILITY = 'toggleMobileMenuVisibility';\n\n    $scope.showSearchBar = true;\n    $scope.userID = $scope.user.sys_id;\n    $scope.popupType = c.data.isMobile ? 'collapse' : 'dropdown';\n    $scope.expanded = false;\n    $scope.isMobileViewOnDesktopExpanded = false;\n\tvar flag = 0;\n    // $scope.loadingIndicator = $rootScope.loadingIndicator;\n\n    /* Below 2 scope variables (showMobileMenuOnDesktop, showMobileMegaMenu) have counterparts in EC Navigation widget also.\n     So whenever we set these variables, make sure to emit an event on rootScope to update them in the former widget as well. */\n\n    // Determines whether to show mobile view on desktop due to oveflow of items in sub navigation bar of header.\n    $scope.showMobileMenuOnDesktop = false;\n    // Used to hide global navigation tools on mobile while showing mega menu topics in right panel.\n    $scope.showMobileMegaMenu = false;\n\n    c.MOBILE_DEVICE_SCREEN_WIDTH = 767;\n    $scope.mobileDevice = c.data.isMobile || ($window.innerWidth <= c.MOBILE_DEVICE_SCREEN_WIDTH);\n\n    if (cabrillo.isNative())\n        $scope.isViewNative = true;\n\n    $scope.isCategorySelectedOnMobileMegaMenu = false;\n    $rootScope.$on('categorySelectedOnMobileMegaMenu', function(event, isCategorySelected) {\n        $scope.isCategorySelectedOnMobileMegaMenu = isCategorySelected;\n    });\n    $scope.newPageId = c.data.initialPageId;\n    $scope.showSearchbarOnMobile = false;\n    \n    c.getContainer = function(){\n\t\t  return $(\".\" + \"instance\" + \"-\" + c.data.instanceId);\n\t  };\n\n    $scope.showSearchBarMobile = function() {\n      $scope.showSearchbarOnMobile = true;\n      $timeout(function() {\n        $scope.focusOnSearchBar();\n      });\n    };\n\n    $scope.hideSearchBarMobile = function() {\n        $scope.showSearchbarOnMobile = false;\n        $scope.$apply();\n    };\n\n\n    document.addEventListener('focus', (event) => {\n\tvar  currentlyFocusedElement = event.target;\n\tif(flag ==1)\n\t{\n\t\tif(currentlyFocusedElement.name!= 'search' &&  currentlyFocusedElement!=c.getContainer().find('input[name=\"q\"]')[0] && currentlyFocusedElement!=c.getContainer().find('sn-search-combobox')[0]){\n\t\t\tvar typeaheadSearchDiv = c.getContainer().find('#searchBox');\n\t\t\ttypeaheadSearchDiv.removeClass(\"show-search\").addClass('hide-search');\n\t\t\t$timeout(function() {\n\t\t\t\t// visibility should be hidden after the collapsing animation, hence the timeout\n\t\t\t\ttypeaheadSearchDiv.addClass('visibility-collapse');\n\t\t\t\tc.getContainer().find('#searchbox-icon').removeClass('hidden');\n\t\t\t}, 500);\n\t\t\tflag =0;\n\t\t}\n\t}\n    }, true);\n\n    $scope.focusOnSearchBar = function() {\n\t\tflag=1;\n      // focus on the search widget input box, and add a blur event\n      if (c.data.aisEnabled) {\n        var searchBox = c.getContainer().find('sn-search-combobox')[0];\n\t\tif ($scope.mobileDevice)\n        searchBox.addEventListener('blur', $scope.onSearchBoxBlur);\n        $timeout(function() {\n          searchBox.shadowRoot.childNodes[0].shadowRoot.childNodes[0].querySelector('input').focus();\n        }, 500);\n      } else {\n        var searchBox = c.getContainer().find('input[name=\"q\"]')[0];\n\t\tif ($scope.mobileDevice)\n        searchBox.addEventListener('blur', $scope.onSearchBoxBlur);\n\t\t\t\tsearchBox.addEventListener('keydown',(event)=>$scope.onSearchBoxTab(event));\n        searchBox.focus();\n      }\n    };\n\t\n\t\t$scope.onSearchBoxTab = function(event){\n\t\t\t$timeout(function() {\n\t\t\t\tif(event.keyCode==9){\n            var searchIcon =  c.getContainer().find('#searchbox-icon');\n\t\t\t\t\t\tsearchIcon.focus();\n\t\t\t\t}        \n        }, 525);\n\t\t\n\t\t};\n\n    $scope.showAndExpandSearch = function(event) {\n      // show typeahead search widget and hide search icon on Desktop view\n\t\t\tspAriaUtil.sendLiveMessage(i18n.getMessage(\"button expanded\"));\n      c.getContainer().find('#searchBox').removeClass('hide-search').addClass('show-search').removeClass('visibility-collapse');\n\t    c.getContainer().find('#searchbox-icon').addClass('hidden');\n      $scope.focusOnSearchBar();\n    };\n\n    $scope.onSearchBoxBlur = function(event) {\n     \t$scope.hideSearchBarMobile();\n    };\n\n    $scope.getUrlParameters = function(parameter, decode, staticURL) {\n      var url = staticURL ? staticURL : $location.url();\n      var currLocation = (url.length) ? url : window.location.search;\n      if (!currLocation || !currLocation.split(\"?\") || currLocation.split(\"?\").length < 2)\n        return '';\n      var paramArr = currLocation.split(\"?\")[1].split(\"&\");\n      var numOfParams = paramArr.length;\n      for (var i = 0; i < numOfParams; i++) {\n        param = paramArr[i].split(\"=\");\n        if (param[0] === parameter)\n          return (decode) ? decodeURIComponent(param[1]) : param[1];\n      }\n      return '';\n    };\n\n    $scope.$on(\"$sp.service_catalog.cart.count\", function($evt, count) {\n        $scope.cartItemCount = count;\n    });\n\n    $scope.$on(\"$locationChangeSuccess\", function(event, data) {\n      $scope.newPageId = $scope.getUrlParameters(\"id\", true, data);\n        if (c.data.isMobile) {\n            if ($('div#popup_todos_mobile').is(\":visible\"))\n                $('li > a#todos_popup').click();\n            else if ($('div#popup_cases_mobile').is(\":visible\"))\n                $('li > a#cases_popup').click();\n        } else {\n            $('li.open > a#cases_popup').click();\n            $('li.open > a#todos_popup').click();\n        }\n\n      // hide modal-div on location change\n      if($scope.isMobileViewOnDesktopExpanded){\n        $scope.isMobileViewOnDesktopExpanded = false;\n        $scope.expanded = false;\n        $scope.showMobileMegaMenu = false;\n        $rootScope.$emit(c.SHOW_MOBILE_MEGA_MENU, false);\n      }\n    });\n\n    $scope.openLogin = function() {\n        $scope.modalInstance = $uibModal.open({\n            templateUrl: 'spPolarisModalLogin',\n            scope: $scope\n        });\n\n        var pageRoot = angular.element('.sp-page-root');\n        $scope.modalInstance.rendered.then(function() {\n            var $uibModalStack = $injector.get('$uibModalStack');\n            var modalObj = $uibModalStack.getTop();\n            var modal = modalObj.value.modalDomEl;\n\n            modal.attr('aria-label', modal.find('.panel-title').html());\n            modal.attr('aria-modal', 'true');\n            pageRoot.attr('aria-hidden', 'true');\n        });\n\n        $scope.modalInstance.closed.then(function() {\n            pageRoot.attr('aria-hidden', 'false');\n        });\n    };\n\n    $rootScope.$on(\"update.searchpage\", function(e, searchPage) {\n        $scope.searchPage = searchPage;\n    });\n\n    $rootScope.$on('sp.avatar_changed', function() {\n        $scope.userID = '';\n        $timeout(function() {\n            $scope.userID = $scope.user.sys_id;\n        });\n    });\n\n    $rootScope.$on(c.SHOW_MOBILE_MENU_ON_DESKTOP, function(event, showMobileMenuOnDesktop) {\n        if (!showMobileMenuOnDesktop && $scope.showMobileMenuOnDesktop) {\n            $scope.isMobileViewOnDesktopExpanded = false;\n        }\n        $scope.showMobileMenuOnDesktop = showMobileMenuOnDesktop;\n    });\n\n    $rootScope.$on(c.SHOW_MOBILE_MEGA_MENU, function(event, showMobileMegaMenu) {\n        $scope.showMobileMegaMenu = showMobileMegaMenu;\n    });\n\n    $scope.toggleMobileMenuVisibility = function(event) {\n        if (event) {\n            event.stopPropagation();\n        }\n        $scope.isMobileViewOnDesktopExpanded = !$scope.isMobileViewOnDesktopExpanded;\n        $scope.expanded = false;\n        $scope.showMobileMegaMenu = false;\n        $rootScope.$emit(c.SHOW_MOBILE_MEGA_MENU, false);\n    };\n\n    $rootScope.$on(c.TOGGLE_MOBILE_MENU_VISIBILITY, function() {\n        $scope.toggleMobileMenuVisibility();\n    });\n\n    $scope.isHomepage = function() {\n        if (!$scope.page.id)\n            return true;\n\n        if ($scope.page.id == $scope.portal.homepage_dv)\n            return true;\n\n        return false;\n    };\n\n    $scope.hideSparkle = $scope.hideSparkle || !$scope.data.showSparkle || ($window.innerWidth <= 992);\n\n}","sys_created_on":"2021-10-22 17:18:47","sys_name":"Portal Polaris Header","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/e9276da055525110f87724327a36ce96","value":"e9276da055525110f87724327a36ce96"},"id":"portal-polaris-header","field_list":"","sys_created_by":"maint","static":"false","sys_mod_count":"13","demo_data":"","option_schema":"","sys_tags":"","script":"(function() {\n    data.isMobile = gs.isMobile();\n    data.instanceId = $sp.getDisplayValue(\"sys_id\");\n\n    data.login_page = $sp.getValue('login_page');\n\n    data.langSelector = GlidePluginManager.isActive('com.glide.i18n') ? $sp.getWidget('sp-lang-selector') : \"\";\n    \n\tdata.showSubHeader = true;\n  var portalRecord = $sp.getPortalRecord();\n  var urlSuffix=portalRecord.getValue(\"url_suffix\");\n\t// Load the Secondary Menu Widget\n\n    var qsConfig = $sp.getValue(\"quick_start_config\");\n    var qsConfigJson = qsConfig ? JSON.parse(qsConfig)[0] : {};\n    if(qsConfigJson.headerSearch && qsConfigJson.headerSearch.display_search === true){\n      data.excludeSeachForPages = [];\n      if (qsConfigJson.headerSearch.exclude_search_for_pages)\n            data.excludeSeachForPages = qsConfigJson.headerSearch.exclude_search_for_pages.split(\",\");\n      data.aisEnabled = $sp.isAISearchEnabled();\n      if (data.aisEnabled) {\n          var typeAheadOptions = {\n              search_application: portalRecord.getValue('search_application'),\n              disable_all_suggestions: false\n          };\n          if (qsConfigJson.headerSearch.search_placeholder_text)\n              typeAheadOptions.placeholder = gs.getMessage(qsConfigJson.headerSearch.search_placeholder_text);\n      }\n      else {\n          var typeAheadOptions = {\n              size: 'md',\n              color: 'default'\n          };\n          if (qsConfigJson.headerSearch.search_placeholder_text)\n              typeAheadOptions.title = gs.getMessage(qsConfigJson.headerSearch.search_placeholder_text);\n      }\n      data.typeAheadSearch = $sp.getWidget('typeahead-search', typeAheadOptions);\n\t  }\n\t  data.showTypeAheadSearch = (data.typeAheadSearch && data.typeAheadSearch.sys_id ? true : false) && qsConfigJson.headerSearch && qsConfigJson.headerSearch.display_search === true;\n\t\n\n    var showSubHeaderString = qsConfigJson.showSubHeader;\n    if (!gs.nil(showSubHeaderString))\n        switch (showSubHeaderString.toUpperCase()) {\n            case \"ON_LOG_IN\":\n                data.showSubHeader = gs.isLoggedIn();\n                break;\n            case \"NEVER\":\n                data.showSubHeader = false;\n                break;\n            case \"ALWAYS\":\n            default:\n                data.showSubHeader = true;\n                break;\n        }\n\n    //Initialize menu objects\n    data.sub = {};\n    data.top = {};\n\n    var menu = $sp.getValue(\"sp_rectangle_menu\");\n\n    if (!gs.nil(menu)) {\n\n        data.sub.menu = $sp.getWidgetFromInstance(menu);\n\n        //Copy sub menu to top menu, we want cart up top and menu items in the sub nav\n        data.top.menu = JSON.parse(JSON.stringify(data.sub.menu));\n\n        //Fetching My Items menu item sys_id\n        var configOptions = JSON.parse((data.top.menu && data.top.menu.options && data.top.menu.options.widget_parameters) || '{}');\n        data.moreItemsSysId = (configOptions.enable_more_items && configOptions.enable_more_items.sysId) || '';\n\n        var subMenu = data.sub.menu;\n        var moreItems;\n        if (subMenu && subMenu.data) {\n            subMenu.data.replace = true;\n            // Hide login if menu already has link to login\n            data.hasLogin = false;\n            var subMenuDataItems = (subMenu.data.menu && subMenu.data.menu.items) || [];\n            for (var i in subMenuDataItems) {\n\n                var item = subMenuDataItems[i];\n                if (item.sys_id === data.moreItemsSysId)\n                    moreItems = item;\n                if (item.type === 'page' && item.sp_page === data.login_page)\n                    data.hasLogin = true;\n            }\n        }\n\n        if (moreItems && moreItems.items)\n            data.moreItems = moreItems.items;\n        if (moreItems && data.moreItems && moreItems.label) {\n            // Removing items with no label\n            data.moreItems = data.moreItems.filter(function(moreItem) {\n                return moreItem.label;\n            });\n\n            // Truncating label of items exceeding 60 character limit\n            data.moreItems.forEach(function(moreItem) {\n                moreItem.shortLabel = (moreItem.label.length > 60) ? (moreItem.label.substring(0, 60) + '...') : moreItem.label;\n            });\n        }\n    \n    data.showMoreItems = (moreItems && moreItems.label && data.moreItems && configOptions.enable_more_items) ? (data.moreItems.length > 0 && configOptions.enable_more_items.value) : false;\n    if (data.showMoreItems)\n        data.moreItemsTitle = data.moreItems.length === 1 ? data.moreItems[0].shortLabel : moreItems.label;\n\t\t\n\t\t\n\t//Clean up items that don't belong\n    subMenu.data.cartWidget = {};\n    subMenu.options.enable_cart = false;\n    subMenu.options.enable_wishlist = false;\n    subMenu.data.showTours = false;\n    subMenu.data.menuType = 'SUB';\n\n    // Make this true to show Tours menu in main header\n    data.top.menu.data.showTours = true;\n    data.top.menu.data.hasLogin = data.hasLogin;\n    data.top.menu.data.menuType = 'TOP';\n\n    if(data.top.menu.sys_id === '756957db43f5ed1011a4ebdffab8f243'){\n\t\t\tif (data.top.menu && data.top.menu.data && data.top.menu.data.menu && data.top.menu.data.menu.items){\n\t\t\t\tdata.sub.menu.data.menu.items = data.sub.menu.data.menu.items.filter(function(item) {\n\t\t\t\t\t\treturn item.type != 'scripted';\n\t\t\t\t});\n\t\t\t\tdata.top.menu.data.menu.items = data.top.menu.data.menu.items.filter(function(item) {\n\t\t\t\t\t\treturn item.type == 'scripted';\n\t\t\t\t});\n\t\t\t}\n\t\t}\t\n\t\telse {\n\t\t\t if (data.top.menu && data.top.menu.data && data.top.menu.data.menu && data.top.menu.data.menu.items)\n        data.top.menu.data.menu.items = [];\n\t\t}\n\t}\n    // Analytics\n    data.analyticsSupportEnabled = new GlidePluginManager().isActive('com.sn_content_analytics') && new GlidePluginManager().isActive('com.sn_content_delivery') && !sn_cd.cd_ContentDelivery.isContentPreview($sp);\n\n    data.supportProfilePortal = new sn_sppolaris_theme.UserProfileUtil().getProfileURL(urlSuffix);\n\n    data.loginWidget = $sp.getWidgetFromInstance('login-modal');\n  \n\tdata.initialPageId = $sp.getParameter('id');\n\tif (!data.initialPageId)\n\t\tdata.initialPageId = '';\n\n\ttry {\n\t\tdata.showSparkle = !gs.isMobile() && $sp.isNowAssistEnabled();\n\t} catch (e) {\n\t\tdata.showSparkle = false\n\t}\n\tif (data.showSparkle)\n\t\tdata.sparkle = $sp.getWidget('now_assist_sparkle_icon');\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/e9276da055525110f87724327a36ce96","value":"e9276da055525110f87724327a36ce96"},"servicenow":"false","sys_update_name":"sp_header_footer_3552f974845a1110f87767389929c604","data_table":"sp_instance","name":"Portal Polaris Header","category":"standard","controller_as":"c","sys_policy":""},{"template":"<div class=\"scrub-footer\" ng-if=\"c.data.footer\" ng-init=\"portalFooterLoaded()\">\n  \n  <!-- Top Container -->\n  <div class=\"sf-main\" ng-if=\"c.data.footer.menus.navigation_links.length || c.data.smallScreen\">\n    \n    <!-- Logo Container -->\n    <div class=\"sf-logo-container\" ng-if=\"c.data.footer.logo.content || c.data.smallScreen\" ng-style=\"c.sfLogoContainerCSS\">\n      <img class=\"sf-logo\"\n           ng-if=\"c.data.footer.logo.imageUrl\"\n           alt=\"brand-logo\"\n           ng-src={{c.data.footer.logo.imageUrl}}\n           ng-style=\"c.sfLogoCSS\">\n      <div class=\"sf-logo-content\" ng-show=\"c.data.footer.logo.content\">\n        <p ng-repeat=\"line in c.data.footer.logo.content\">{{line}}</p>\n      </div>\n    </div>\n    \n    <!-- Navigation Links Container -->\n    <div class=\"sf-links-container\" id=\"sf-links-container\">\n      <div class=\"masonry-root\">\n        <div class=\"sf-menu masonry-cell\" ng-repeat=\"menu in c.data.footer.menus.navigation_links\" ng-if=\"!menu.items.length\" ng-style=\"c.masonryCellCSS\">\n          <div class=\"sf-link\">\n            <a class=\"sitemap-link\" ng-click=\"portalFooterClicked($event, 'Navigation Menu Clicked - '+ menu.label)\" ng-href={{menu.href}} ng-attr-target={{menu.url_target}}>{{menu.label}}</a>\n          </div>\n        </div>\n        <div class=\"sf-menu masonry-cell\" ng-repeat=\"menu in c.data.footer.menus.navigation_links\" ng-if=\"menu.items.length>0\" ng-style=\"c.masonryCellCSS\">\n          <div class=\"sf-menu-label\" ng-if=\"menu.items.length\" ng-attr-id={{menu.sysId}} role=\"heading\" aria-level=2>\n            {{menu.label}}\n          </div>\n          <ul >\n            <li class=\"sf-link\" role=\"listitem\" ng-repeat=\"link in menu.items\">\n            <a class=\"sitemap-link\" ng-click=\"portalFooterClicked($event, 'Navigation Menu Link Clicked - '+ link.label)\" ng-href={{link.href}} ng-attr-target={{link.url_target}} aria-label = \"{{link.label}} {{menu.label}}\">{{link.label}}</a>\n          </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n  \n  <hr ng-if=\"c.data.footer.menus.navigation_links.length\" aria-hidden=\"true\">\n  \n  <!-- Bottom Container -->\n  <div class=\"sf-bottom\" ng-if=\"(c.data.footer.menus.bottom_links && c.data.footer.menus.bottom_links.length) || (c.data.footer.menus.social_icons && c.data.footer.menus.social_icons.length) || c.data.footer.copyright\">\n    \n    <!-- Branding when no Navigation Links-->\n    <div class=\"sf-bottom-left\" ng-style=\"c.sfBottomLeftCSS\">\n      <div class=\"sf-logo-container\" ng-if=\"(!c.data.footer.logo.content || (!c.data.footer.menus.navigation_links.length && c.data.footer.logo.content)) && !c.data.smallScreen\" ng-style=\"c.sfLogoContainerCSS\">\n        <img class=\"sf-logo\"\n             ng-if=\"c.data.footer.logo.imageUrl\"\n             alt=\"brand-logo\"\n             ng-style=\"c.sfLogoCSS\"\n             ng-src={{c.data.footer.logo.imageUrl}}>\n        <div class=\"sf-logo-content\" ng-show=\"c.data.footer.logo.content\">\n          <p ng-repeat=\"line in c.data.footer.logo.content\">{{line}}</p>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"sf-bottom-right\" ng-style=\"c.sfBottomRightCSS\">\n      <!-- Bottom Links Container -->\n      <ul class=\"sf-bottom-links \">\n        <li class=\"sf-bottom-link\" ng-repeat=\"link in c.data.footer.menus.bottom_links\">\n          <a class=\"footer-link\" ng-click=\"portalFooterClicked($event, 'Bottom Icon Clicked - '+ link.label)\" ng-href={{link.href}} ng-attr-target={{link.url_target}}>{{link.label}}</a>\n        </li>\n      </ul>\n      \n      <!-- Social Icons Container -->\n      <ul class=\"sf-social-icons\">\n        <li class=\"sf-social-icon\" ng-repeat=\"icon in c.data.footer.menus.social_icons\" >\n          <a class=\"social-icon\"\n             ng-href={{icon.href}}\n             title={{icon.label}}\n             ng-click=\"portalFooterClicked($event, 'Social Icon Clicked - '+ icon.label)\"\n             ng-class=\"'fa fa-' + icon.glyph\"\n             ng-attr-target={{icon.url_target}}\n             aria-label={{icon.label}}\n             ng-style=\"c.sfSocialIconsCSS\">\n          </a>\n        </li>\n      </ul>\n      \n      <!-- Copyright -->\n      <div class=\"sf-copyright\">\n        {{c.data.footer.copyright}}\n      </div>\n    </div> \n  </div>\n        \n    \n</div>","css":"$color-light: darken($gray-lighter,5) !default;\r\n$sp-space--xxs: 0.2rem !default;\r\n$sp-space--xs: 0.4rem !default;\r\n$sp-space--sm: 0.8rem !default;\r\n$sp-space--md: 1.2rem !default;\r\n$sp-space--lg: 1.6rem !default;\r\n$sp-space--xl: 2.4rem !default;\r\n$sp-space--xxl: 3.2rem !default;\r\n$font-size-xs: ceil(($font-size-base * 0.75)) !default;\r\n\r\n\r\n.scrub-footer{\r\n  background: $navbar-inverse-bg;\r\n  /* Top Container */\r\n  .sf-main{\r\n    display: flex;\r\n    color: $navbar-inverse-link-color;\r\n    margin-top: $sp-space--xxl;\r\n    .sf-links-container{\r\n      flex: 1.5;\r\n      padding-top: $sp-space--xl;\r\n      padding-left: $sp-space--xl;\r\n      .masonry-root{\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        .sf-menu{\r\n          padding: 0 $sp-space--sm $sp-space--md;\r\n          flex-grow: 1;\r\n          text-align: start;\r\n          .sf-menu-label{\r\n            color: $navbar-inverse-link-hover-color;\r\n            font-size: $font-size-base;\r\n            font-weight: bold;\r\n            padding-bottom: $sp-space--lg;\r\n          }\r\n          .sf-link {\r\n            padding-bottom: $sp-space--lg;\r\n            a {\r\n              display: inline-block;\r\n              color: $color-light;\r\n              font-size: $font-size-small;\r\n              word-break: break-word;\r\n              &:hover {\r\n                color: $navbar-inverse-link-hover-color;\r\n              }\r\n              &:focus {\r\n                outline: $sp-space--xxs solid $navbar-inverse-link-hover-color !important;\r\n                outline-offset: .5rem;\r\n                box-shadow: none;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  /* Logo Container */\r\n  .sf-logo-container{\r\n    padding: $sp-space--xl $sp-space--xl $sp-space--sm $sp-space--lg;\r\n    width: 25%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    .sf-logo{\r\n      align-self: baseline;\r\n      max-width: 10rem;\r\n      max-height: 8rem;\r\n    }\r\n    .sf-logo-content{\r\n      padding: $sp-space--lg 0 0;\r\n      font-size: $sp-space--md;\r\n      color: $color-light;\r\n      word-break: break-word;\r\n      p{\r\n        margin: 0 !important;\r\n      }\r\n    }\r\n  }\r\n  hr{\r\n    width: 98%;\r\n    border: .1rem solid $gray;\r\n    margin: auto;\r\n  }\r\n\r\n  /* Bottom Container */\r\n  .sf-bottom{\r\n    display: flex;\r\n    color: $color-light;\r\n    font-size: $font-size-xs;\r\n    justify-content: space-between;\r\n    .sf-bottom-right{\r\n      display: flex;\r\n      align-items: center;\r\n      margin-right: $sp-space--sm;\r\n      .sf-bottom-links{\r\n        display: flex;\r\n        .sf-bottom-link a {\r\n          color: $color-light;\r\n          font-size: $font-size-xs;\r\n          &:hover {\r\n            color: $navbar-inverse-link-hover-color;\r\n          }\r\n          &:focus {\r\n            outline: $sp-space--xxs solid $navbar-inverse-link-hover-color !important;\r\n            outline-offset: $sp-space--xxs;\r\n            box-shadow: none;\r\n          }\r\n        }\r\n      }\r\n      .sf-social-icons{\r\n        display: flex;\r\n        .sf-social-icon a {\r\n          color: $color-light;\r\n          font-size: $font-size-large;\r\n          &:hover{\r\n            color: $navbar-inverse-link-hover-color;\r\n          }\r\n          &:focus {\r\n            outline: $sp-space--xxs solid $navbar-inverse-link-hover-color !important;\r\n            outline-offset: $sp-space--xs;\r\n            box-shadow: none;\r\n          }\r\n        }\r\n      }\r\n      .sf-bottom-link,\r\n      .sf-social-icon,\r\n      .sf-copyright{\r\n        padding: 1rem 1.15rem;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nul {\r\n    list-style-type: none;\r\n  \tmargin-bottom:0 !important;\r\n  \tpadding:0;\r\n}\r\n\r\n@media screen and (max-width: 63.5rem){\r\n  .scrub-footer{\r\n    .sf-main{\r\n      flex-direction: column;\r\n      .sf-links-container{\r\n        padding-top: 1rem;\r\n        padding-left: 1rem;\r\n        .masonry-root{\r\n          flex-direction: row;\r\n        }\r\n      }\r\n    }\r\n    .sf-logo-container{\r\n      width: 100%;\r\n    }\r\n    .sf-bottom{\r\n      flex-direction: column;\r\n      .sf-bottom-right{\r\n        flex: 1;\r\n        flex-direction: column;\r\n        padding-left: 1rem;\r\n        align-items: flex-start !important;\r\n        .sf-bottom-links, .sf-social-icons{\r\n          flex-wrap: wrap;\r\n          .sf-social-icon{\r\n            padding: 1rem 2.5rem 1rem 1.15rem;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n","internal":"false","roles":"","link":"function link(scope, element, attrs, controller) {\n\n}","description":"","sys_updated_on":"2024-03-26 11:32:02","sys_class_name":"sp_header_footer","sys_id":"5cf9e3234305ce107b228dc226b8f2a2","sys_updated_by":"admin","docs":"","public":"true","client_script":"api.controller = function($scope, $window, snAnalytics) {\n\t/* widget controller */\n\tvar c = this;\n\tvar isIE = window.navigator.userAgent.indexOf('Trident/') !== -1;\n\tc.masonryCellCSS = {};\n\tc.sfLogoContainerCSS = {};\n\tc.sfLogoCSS = {};\n\tc.sfBottomLeftCSS = {};\n\tc.sfBottomRightCSS = {};\n\tc.sfSocialIconsCSS = {};\n\n    function init() {\n        if (window.screen.width < 1024)\n            c.data.smallScreen = true;\n        setTimeout(function() {\n            applyMasonryOnLoad();\n        });\n    }\n\n\tvar applyMasonryOnLoad = function() {\n\t\tvar masonryRoot = $('.masonry-root');\n\t\tvar maxColumns = hasNestedItems(c.data.footer.menus.navigation_links) ? 5: 8;\n\t\tvar noOfColumns =Math.min( Math.floor(masonryRoot.innerWidth() / convertRemToPixel(minimumWidthRem())), maxColumns);\n\t\tvar masonryCell = masonryRoot.children();\n\t\tvar masonryCellSize = masonryCell.size();\n\t\tif (masonryCellSize > 0) {\n\t\t\tvar flexBasisVal = noOfColumns > masonryCellSize ? (100 / masonryCellSize + '%') : (100 / noOfColumns + '%');\n\t\t\tc.masonryCellCSS = {};\n\t\t\tc.masonryCellCSS['flex-grow'] = '0';\n\t\t\tc.masonryCellCSS['flex-shrink'] = '0';\n\n\t\t\tif (isIE) {\n\t\t\t\tc.masonryCellCSS['flex-grow'] = '1';\n\t\t\t\tc.masonryCellCSS['flex-basis'] = 'auto';\n\t\t\t\tc.masonryCellCSS['max-width'] = flexBasisVal;\n\t\t\t} else\n\t\t\t\tc.masonryCellCSS['flex-basis'] = flexBasisVal;\n\t\t}\n\t\tif (!c.data.smallScreen) {\n\t\t\tif (!c.data.footer.logo.content) {\n\t\t\t\tc.sfLogoContainerCSS.padding =  '1rem 2rem';\n\t\t\t\tc.sfLogoCSS['max-height'] = '4rem';\n\t\t\t}\n\t\t\tif (!c.data.footer.menus.navigation_links.length) {\n\t\t\t\tc.sfBottomLeftCSS['display'] =  'flex';\n\t\t\t\tc.sfBottomLeftCSS['flex-basis'] =  '40%';\n\t\t\t\tc.sfLogoContainerCSS['width'] =  '100%';\n\t\t\t\tc.sfBottomRightCSS['align-items'] = 'flex-end';\n\t\t\t\tc.sfBottomRightCSS['padding-bottom'] = '1rem';\n\t\t\t\tc.sfLogoCSS['max-height'] = '8rem';\n\t\t\t}\n\t\t}\n\t\tif(c.data.footer.menus.social_icons_color){\n\t\t\tc.sfSocialIconsCSS['color'] = c.data.footer.menus.social_icons_color;\n\t\t}\n\t};\n\n    function minimumWidthRem() {\n        var minColWidth = 22;\n        if ($window.innerWidth <= 700)\n            minColWidth = 15; //mobile\n        if ($window.innerWidth > 700 && $window.innerWidth <= 820)\n            minColWidth = 20; //tablet\n        if ($window.innerWidth > 820 && $window.innerWidth < 1060)\n            minColWidth = 15; //laptop\n        return minColWidth;\n    }\n\n    function convertRemToPixel(rem) {\n        return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);\n    }\n\n    var hasNestedItems = function(items){\n      for(var i=0; i<items.length;i++)\n        if(items[i].items.length > 0)\n          return true;\n\n      return false;\n    }\n\n\tvar viewport = angular.element($window);\n\tviewport.bind('resize', function(){\n\t\tif(Object.keys(c.data.footer).length)\n\t\t\tapplyMasonryOnLoad();\n\t});\n\n\tif(Object.keys(c.data.footer).length)\n\t\tinit();\n\n    $scope.portalFooterLoaded = function() {\n        var payload = {};\n        payload.name = \"Portal Footer loaded\";\n        payload.data = {};\n        snAnalytics.addEvent(payload);\n    };\n    $scope.portalFooterClicked = function(e, type) {\n        var payload = {};\n        payload.name = \"Portal Footer clicked\";\n        payload.data = {'element_clicked': type};\n        snAnalytics.addEvent(payload);\n    };\n};","sys_created_on":"2024-03-26 11:31:18","sys_name":"Portal Polaris Footer","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/e9276da055525110f87724327a36ce96","value":"e9276da055525110f87724327a36ce96"},"id":"portal-polaris-footer","field_list":"","sys_created_by":"admin","static":"false","sys_mod_count":"0","demo_data":"","option_schema":"","sys_tags":"","script":"(function() {\n\tdata.footer = {};\n\tvar details = {};\n\tvar quick_start_config = $sp.getValue(\"quick_start_config\");\n\tif (quick_start_config) {\n\t\ttry{\n\t\t\tvar config = JSON.parse(quick_start_config)[0];\n\t\t\tvar footerConfig = config.footer ? config.footer : {};\n\t\t\tif(Object.keys(footerConfig).length){\n\t\t\t\tvar localizedOrgInfo = [],\n\t\t\t\t\t\tlen = footerConfig.org_info ? footerConfig.org_info.length : 0;\n\t\t\t\tdetails.logo = {};\n\t\t\t\tdetails.logo.imageUrl = footerConfig.logo_img_name;\n\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\tlocalizedOrgInfo[i] = gs.getMessage(footerConfig.org_info[i]);\n\t\t\t\tdetails.logo.content = len > 0 ? localizedOrgInfo : '';\n\t\t\t\tdetails.copyright = footerConfig.copyright ? gs.getMessage(footerConfig.copyright): \"\";\n\t\t\t\tdetails.menus = {};\n\t\t\t\tdetails.menus.bottom_links = [];\n\t\t\t\tvar sys_id = '',\n\t\t\t\t\t\tmenuItems = {};\n\t\t\t\t// Bottom Links\n\t\t\t\tsys_id = footerConfig.footer_links_menu_sys_id;\n\t\t\t\tmenuItems = $sp.getMenuItems(sys_id);\n\t\t\t\tdetails.menus.bottom_links = menuItems;\n\t\t\t\t// Navigation Links\n\t\t\t\tdetails.menus.navigation_links = [];\n\t\t\t\tsys_id = footerConfig.sitemap_links_menu_sys_id;\n\t\t\t\tmenuItems = $sp.getMenuItems(sys_id);\n\t\t\t\tdetails.menus.navigation_links = menuItems;\n\t\t\t\t// Social Icons\n\t\t\t\tdetails.menus.social_icons = [];\n\t\t\t\tsys_id = footerConfig.social_links_menu_sys_id;\n\t\t\t\tmenuItems = $sp.getMenuItems(sys_id);\n\t\t\t\tdetails.menus.social_icons = menuItems;\n\t\t\t\tif(footerConfig.social_icons_color)\n\t\t\t\tdetails.menus.social_icons_color = footerConfig.social_icons_color;\n\t\t\t}\n\t\t}catch(e){\n\t\t\tgs.addErrorMessage(gs.getMessage(\"The Quick start configuration contains an invalid configuration for the footer\"));\n\t\t}\n\t}\n\tdata.footer = details;\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/e9276da055525110f87724327a36ce96","value":"e9276da055525110f87724327a36ce96"},"servicenow":"false","sys_update_name":"sp_header_footer_5cf9e3234305ce107b228dc226b8f2a2","data_table":"sp_instance","name":"Portal Polaris Footer","category":"custom","controller_as":"c","sys_policy":""},{"template":"<div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-xs-12 text-center legalFooter\" ng-if=\"data.footer\">\n        ${ServiceNow Confidential. © ServiceNow, Inc. All rights reserved.}\n      </div>\n    </div>\n  </div>","css":".legalFooter {\n  padding-bottom : 20px; \n}","internal":"false","roles":"","link":"","description":"","sys_updated_on":"2017-12-19 23:20:36","sys_class_name":"sp_header_footer","sys_id":"64407ec3532332000d620d0323dc3436","sys_updated_by":"admin","docs":"","public":"false","client_script":"function() {\n  /* widget controller */\n  var c = this;\n}","sys_created_on":"2017-06-29 02:14:56","sys_name":"LegalFooter","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"id":"","field_list":"","sys_created_by":"admin","static":"false","sys_mod_count":"6","demo_data":"","option_schema":"","sys_tags":"","script":"(function() {\n\n\tvar id = $sp.getParameter('id');\n\tdata.footer = gs.nil(id) || id === 'details';\n\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3ad18693db92220004997878f0b8f516","value":"3ad18693db92220004997878f0b8f516"},"servicenow":"true","sys_update_name":"sp_header_footer_64407ec3532332000d620d0323dc3436","data_table":"sp_instance","name":"LegalFooter","category":"","controller_as":"c","sys_policy":""},{"template":"<div>\n  <!-- To-dos, Cases popup for mobile view -->\n  <div ng-if=\"data.isMobile\" class=\"popup-edit popover bottom\" id=\"popup_todos_mobile\">\n    <sp-widget widget=\"::data.todoCaseList\"></sp-widget>\n  </div>\n  <div ng-if=\"data.isMobile\" class=\"popup-edit popover bottom\" id=\"popup_cases_mobile\">\n    <sp-widget widget=\"::data.caseList\"></sp-widget>\n  </div>\n  <!-- Nav bar menu items starts-->\n  <nav class=\"navbar-inverse\" ng-class=\"::{'navbar':!isViewNative, 'is-native': isViewNative}\" role=\"navigation\">\n    <div ng-show=\"::!isViewNative\" class=\"navbar-header\">\n      <a class=\"navbar-brand\" ng-if=\"::!portal.logo\" href=\"?id={{::portal.homepage_dv}}\"><span>{{::portal.title}}</span></a>\n      <a class=\"navbar-brand navbar-brand-logo\" ng-if=\"::portal.logo\" href=\"?id={{::portal.homepage_dv}}\">\n        <img ng-src=\"{{::portal.logo}}\" alt=\"{{::portal.title}}\"/>\n      </a>\n      <button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#sp-nav-bar\">\n        <span ng-show=\"data.todoCount > 0\" class=\"label label-as-badge label-primary navbar-collapse-label\">{{data.todoCount}}</span>\n        <span class=\"sr-only\">${Toggle navigation}</span>\n        <span class=\"icon-bar\"></span>\n        <span class=\"icon-bar\"></span>\n        <span class=\"icon-bar\"></span>\n      </button>\n    </div>\n   <div class=\"navbar-header typeahead-search\">\n      <sp-widget widget=\"data.typeahead\"></sp-widget>\n   </div>\n    <div sp-navbar-toggle=\"\" class=\"collapse navbar-collapse navbar-right\" id=\"sp-nav-bar\">\n      <!-- Include The Menu -->\n      <ul ng-if=\"::user.logged_in\" class=\"nav navbar-nav\">\n        <!-- Fix to show loading indicator at first place in the menu bar-->\n        <li>\n          <a>\n            <div class=\"header-loader\" ng-show=\"loadingIndicator\" id=\"hr_loading_indicator\">\n              <div class=\"hidden-xs sp-loading-indicator la-sm\">\n                <div></div>\n                <div></div>\n                <div></div>\n              </div>\n            </div>\n          </a>\n        </li>\n        <!--  To-Dos  -->\n        <li ng-if=\"data.isHrCoreActive\">\n          <a href=\"javascript:void(0)\" data-toggle=\"{{popupType}}\" id=\"todos_popup\" data-target=\"{{todosPopupId}}\" aria-label=\"${To-dos}\">\n            <span ng-bind-html=\"'${To-dos}'\" aria-hidden=\"true\"></span>\n            <span ng-show=\"data.todoCount > 0\" class=\"label label-as-badge label-primary\">{{data.todoCount}}</span>\n          </a>\n          <div ng-if=\"!data.isMobile\" class=\"dropdown-menu case-menu\" >\n            <sp-widget widget=\"::data.todoCaseList\"></sp-widget>\n          </div>\n        </li>\n        <!--  Cases  -->\n        <li ng-if=\"data.isHrCoreActive\">\n          <a href=\"javascript:void(0)\" data-toggle=\"{{popupType}}\" id=\"cases_popup\" data-target=\"{{casesPopupId}}\" aria-label=\"${Cases}\">\n            <span ng-bind-html=\"'${Cases}'\" aria-hidden=\"true\"></span>\n          </a>\n          <div ng-if=\"!data.isMobile\" class=\"dropdown-menu case-menu\" >\n            <sp-widget widget=\"::data.caseList\"></sp-widget>\n          </div>\n        </li>\n      </ul>\n      <sp-widget widget=\"data.menu\"></sp-widget>\n      <ul ng-if=\"::(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)\" class=\"nav navbar-nav\">\n        <li><a href ng-click=\"openLogin()\">${Login}</a>\n        </li>\n      </ul>\n      <ul ng-if=\"::user.logged_in\" class=\"nav navbar-nav\">\n        <!-- chat, avatar, and logout -->\n        <li ng-if=\"data.chatSupportEnabled == true && data.isHrCoreActive\"><a target=\"chat\" href=\"/$chat_support.do?queueID=fde232209f22120047a2d126c42e70ab\"><i alt=\"${Chat with HR}\" class=\"fa fa-comments-o\"></i> ${Chat with HR}</a>\n        </li>\n        <li ng-if=\"data.isHrCoreActive\">\n          <a href=\"mailto:{{data.email}}\"><i alt=\"${Email HR}\" class=\"fa fa-envelope-o\"></i> ${Email HR}</a>\n        </li>\n        <li class=\"dropdown hidden-xs\">\n          <a href=\"javascript:void(0)\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n            <span class=\"navbar-avatar\"><sn-avatar class=\"avatar-small-medium\" show-presence=\"false\" primary=\"user.sys_id\" /></span>\n            <span class=\"visible-lg-inline\" aria-hidden=\"true\">{{user.name}}</span>\n          </a>\n          <ul class=\"dropdown-menu\">\n            <li><a href=\"{{data.link}}\">${Profile}</a>\n            </li>\n            <li><a href=\"{{::portal.logoutUrl}}\">${Logout}</a>\n            </li>\n          </ul>\n        </li>\n        <li class=\"visible-xs-block\"><a href=\"{{data.link}}\"><span class=\"navbar-avatar\"><sn-avatar class=\"avatar-small-medium\" show-presence=\"false\" primary=\"user.sys_id\" /></span><span aria-hidden=\"true\">{{user.name}}</span></a>\n        </li>\n        <li class=\"visible-xs-block\"><a href=\"{{::portal.logoutUrl}}\">${Logout}</a>\n        </li>\n      </ul>\n    </div>\n  </nav>\n</div>","css":".dropdown-menu.case-menu {\n    right: auto;\n    left: 0;\n    padding: 0;\n    width: 450px;\n    background: $color-lightest;\n    overflow-y: hidden;\n}\n\n.label-as-badge {\n  font-size: 12px;\n  margin-left: 5px;\n}\n\n.navbar {\n  transition: 250ms opacity ease-in-out; \n  -webkit-transition: 250ms opacity ease-in-out; \n  border: 0;\n  border-bottom: 4px solid $sp-navbar-divider-color;\n}\n\n.navbar-fade {\n  opacity: 0.4;\n}\n\n.navbar-inverse .navbar-toggle {\n  border-color: rgba(255, 255, 255, 0.25);\n}\n\n.nav > li > a {\n  max-height: 56px;\n}\n\n.navbar-brand {\n  height: 50px;\n  padding: 0;\n}\n\n.navbar-brand img, .navbar-brand span {\n  margin-left: $sp-logo-margin-x;\n  margin-right: $sp-logo-margin-x;\n  margin-top: $sp-logo-margin-y;\n  margin-bottom: $sp-logo-margin-y;\n  display: block;\n  max-height: $sp-logo-max-height;\n  max-width: $sp-logo-max-width;\n  position: relative;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n  -ms-transform: translateY(-50%);\n  transform: translateY(-50%);\n}\n.breadcrumb-container {\n  background-color: $panel-bg;\n}\n\n/* for mobile app */\n.navbar-inverse.is-native {\n  background-color: #405060;\n}\n\nnav{\n margin-bottom: 0px;\n border-radius: 0px; \n}\n\n.navbar-collapse {\n  padding-right: 0px;\n}\n\n.case-menu div#widget-tabs-2 {\n\tborder: none;\n}\n\n.case-menu div#widget-tabs-2 &gt; .panel-heading {\n\tborder: none;\n  bottom-border: 1px solid $border;\n}\n\nul.nav.navbar-nav>div.header-loader{\n\tdisplay: none;\n}\n\n.typeahead-search {\n  width: 13%;\n  padding-top:13px;\n}\n\n/* Fix for Service Portal - Header Poorly Aligned in Safari */\n@media screen and (min-width: 768px) {\n  .navbar-collapse {\n    display: flex !important;\n  }\n}\n\n\n@media (min-width : 320px) and (max-width : 360px) {\n  .dropdown-menu.case-menu {\n    width: 320px;\n  }\n}\n\n@media (min-width : 360px) and (max-width : 450px) {\n  .dropdown-menu.case-menu {\n    width: 360px;\n  }\n}\n\n@media (min-width : 320px) and (max-width : 767px) {\n  .typeahead-search {\n    width: 100%;\n  }\n  .navbar-nav {\n    display:block;\n    margin-top:0px;\n    margin-bottom:0px;\n  }\n  .popup-edit {\n    background: $color-lightest;\n    position: fixed;\n    top:0; \n    height:100%;\n    margin-top: 0;\n    max-height:100%;\n    width:100%\n  }\n  .navbar-collapse-label {\n    float: right;\n    margin-right: -5px;\n    margin-top: -7px;\n  }\n  button>span.label {\n    padding: .2em .5em .2em;\n  }  \n}\n\n@media (min-width : 768px) and (max-width : 1024px) {\n  .navbar-nav > li > a {\n    padding:20px 10px;\n  }\n}","internal":"false","roles":"","link":"function(scope, element) {\t\n\t$(element).on('click.nav','.navbar-collapse.in',function(e) {\t\n\t\tvar target = $(e.target);\n\t\tif (target.is('a')) {\n\t\t\t// collapse mobile nav if clicked an anchor\n\t\t\t$(this).removeClass('in').addClass('collapse');\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// if neither target nor parent is an anchor, do nothing\n\t\tif (!target.parent().is('a'))\n\t\t\treturn;\n\t\t\n\t\t// collapse mobile nav if target is part of a submenu\n\t\tif (target.parents(\"ul.dropdown-menu\").length > 0)\n\t\t\t$(this).removeClass('in').addClass('collapse');\n\t});\n}","description":"","sys_updated_on":"2021-01-19 07:38:16","sys_class_name":"sp_header_footer","sys_id":"a8d107b473131300c629e1e54cf6a703","sys_updated_by":"admin","docs":"","public":"false","client_script":"function ($rootScope, $scope, snRecordWatcher, spUtil, $location, $uibModal, cabrillo, $timeout) {\n\tvar c = this;\n\t$scope.userID = $scope.user.sys_id;\n\t$scope.todosPopupId = c.data.isMobile?'#popup_todos_mobile':'';\n\t$scope.casesPopupId = c.data.isMobile?'#popup_cases_mobile':'';\n\t$scope.popupType = c.data.isMobile?'collapse':'dropdown';\n\n\tif (cabrillo.isNative())\n\t\t$scope.isViewNative = true;\n\t\n\t$scope.$on(\"$locationChangeSuccess\", function(event, data){\n\t\tif(c.data.isMobile){\n\t\t\tif($('div#popup_todos_mobile').is(\":visible\"))\n\t\t\t\t$('li > a#todos_popup').click();\n\t\t\telse if($('div#popup_cases_mobile').is(\":visible\"))\n\t\t\t$('li > a#cases_popup').click();\n\t\t} else {\n\t\t\t$('li.open > a#cases_popup').click();\n\t\t\t$('li.open > a#todos_popup').click();\t\n\t\t}\n\t})\n\n\t$scope.$on('sp_loading_indicator', function(e, value) {\n\t\t$scope.loadingIndicator = value;\n\t});\n\t\n\t/* Record Watchers */ \n\tspUtil.recordWatch($scope, \"sn_hr_core_task\", \"assigned_to=\" + $scope.userID, function(watcherUpdate) {\n\t\tif ($scope.isRelevantRecordUpdate(watcherUpdate.data, 'sn_hr_core_task'))\n\t\t\t$scope.reloadHeader($scope.data.ACTION_TODO_COUNT);\n\t});\n\t\n\tspUtil.recordWatch($scope, \"sn_hr_core_case\", \"opened_for=\" + $scope.userID, function(watcherUpdate) {\n\t\tif ($scope.isRelevantRecordUpdate(watcherUpdate.data, 'sn_hr_core_case'))\n\t\t\t$scope.reloadHeader($scope.data.ACTION_TODO_COUNT);\n\t});\n\t\n\tspUtil.recordWatch($scope, \"sysapproval_approver\", \"approver=\" + $scope.userID, function(watcherUpdate) {\n\t\tif ($scope.isRelevantRecordUpdate(watcherUpdate.data, 'sysapproval_approver'))\n\t\t\t$scope.reloadHeader($scope.data.ACTION_TODO_COUNT);\n\t});\n\t\n\t$scope.reloadHeader = function(actionName) {\n\t\tc.data.action = actionName || c.data.ACTION_LOAD_CASES;\n\t\tc.server.update();\n\t};\n\t\n\t$scope.openPopUp = function() {\n\t\tvar url = \"$chat_support.do?queueID=\" + $scope.data.connect_support_queue_id;\n\t\tvar popup = window.open (url, \"popup\", \"width=900, height=600\"); \n\t};\n\n\t$scope.openLogin = function () {\n\t\t$scope.modalInstance = $uibModal.open({\n\t\t\ttemplateUrl: 'modalLogin',\n\t\t\tscope: $scope\n\t\t});\n\t};\n\t\n\t$rootScope.$on(\"update.searchpage\", function(e, searchPage){\n\t\t$scope.searchPage = searchPage;\n  });\n\t\n\t$rootScope.$on('sp.avatar_changed', function() {\n\t\t$scope.userID = \"\";\n\t\t$timeout(function(){\n\t\t\t$scope.userID = $scope.user.sys_id;\n\t\t});\n\t});\n\n\t$scope.isHomepage = function() {\n\t\tif (!$scope.page.id)\n\t\t\treturn true;\n\n\t\tif ($scope.page.id == $scope.portal.homepage_dv)\n\t\t\treturn true;\n\n\t\treturn false;\n\t};\n\t\n\t$scope.isRelevantRecordUpdate = function(watcherData, tableName) {\n\t\tvar operation = watcherData.operation;\n\t\tif (operation == 'delete')\n\t\t\treturn true;\n\t\t\n\t\tif (watcherData.record) {\n\t\t\tvar active = watcherData.record.state.value;\n\t\t\tvar activeChanged = watcherData.changes.indexOf('active') >= 0;\n\t\t\tvar state = watcherData.record.state.value;\n\t\t\tvar stateChanged = watcherData.changes.indexOf('state') >= 0;\n\t\t\tvar userChanges = false;\n\t\t\t\n\t\t\t//Check if user changes\n\t\t\tif (tableName == 'sysapproval_approver')\n\t\t\t\tuserChanges = watcherData.changes.indexOf('approver') >= 0;\n\t\t\telse if (tableName == 'sn_hr_core_task')\n\t\t\t\tuserChanges = watcherData.changes.indexOf('assigned_to') >= 0;\n\t\t\telse if (tableName == 'sn_hr_core_case')\n\t\t\t\tuserChanges = watcherData.changes.indexOf('opened_for') >= 0;\n\n\t\t\t//Check insertion\n\t\t\tif (operation == 'insert') {\n\t\t\t\tif (tableName == 'sysapproval_approver')\n\t\t\t\t\treturn state == 'requested';\n\t\t\t\telse if (tableName == 'sn_hr_core_task')\n\t\t\t\t\treturn active && (state == '10' || state == '18');\n\t\t\t\telse if (tableName == 'sn_hr_core_case')\n\t\t\t\t\treturn active && state == '20';\n\t\t\t}\n\t\t\telse if (operation == 'update') {\n\t\t\t\tif (tableName == 'sysapproval_approver')\n\t\t\t\t\treturn stateChanged || userChanges;\n\t\t\t\telse if (tableName == 'sn_hr_core_task' || tableName == 'sn_hr_core_case')\n\t\t\t\t\treturn activeChanged || stateChanged || userChanges;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t};\n\t\n\t$(document).ready(function() {\n\t\t$scope.reloadHeader();\t\t\t\t\n\t});\t\n}","sys_created_on":"2018-07-12 09:51:19","sys_name":"HRMadrid Header","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"id":"hrmadrid-header","field_list":"","sys_created_by":"admin","static":"false","sys_mod_count":"42","demo_data":"","option_schema":"","sys_tags":"","script":"(function () {\n\tdata.ACTION_TODO_COUNT = 'update_todo_count';\n\tdata.ACTION_LOAD_CASES = 'load_cases';\n\tdata.isMobile = gs.isMobile();\n\tvar isHrCoreActive = GlidePluginManager().isActive('com.sn_hr_core');\n\tif (isHrCoreActive) {\n\t\tdata.isHrCoreActive = true;\n\t\t//Load To-dos count\n\t\tif (!input || input.action == data.ACTION_TODO_COUNT) {\n\t\t\tdata.todoCount = new sn_hr_sp.hr_DashboardUtil().getHeaderTodoCount();\n\t\t\tif (input)\n\t\t\t\treturn;\n\t\t}\n\t\t//Load To-dos widget if requested\n\t\tif (input && input.action == data.ACTION_LOAD_CASES) {\n\t\t\tdata.todoCaseList = $sp.getWidget('hrk-header-case-list', {isTodoList : true});\n\t\t\tdata.caseList = $sp.getWidget('hrk-header-case-list', {isTodoList : false});\n\t\t\tif (input)\n\t\t\treturn;\n\t\t} \t\n\n\t\t// HR Profile\n\t\tvar gr = new GlideRecord('sn_hr_core_profile');\n\t\tgr.addQuery('user', gs.getUserID());\n\t\tgr.query();\n\t\tif (!gr.next() && new GlideRecord('sys_user').get(gs.getUserID())) {\n\t\t\tgr.setValue('user', gs.getUserID());\n\t\t\tgr.insert();\n\t\t}\n\t\tdata.email = gs.getProperty('sn_hr_core.hr_email');\n\t}\n\t// populate the 'data' object\n\tdata.link = '?id=hri_user_profile&sys_id='+ gs.getUserID();\n\n\t// Check for chat properties\n\tdata.chatSupportEnabled = gs.getProperty('glide.connect.enabled', 'false') == 'true' && gs.getProperty('glide.connect.support.enabled', 'false') == 'true';\n\n\t// Defines the support queue ID that will be linked to by the Live Chat link in header\n\tdata.login_page = $sp.getValue('login_page');\n\tvar menu = $sp.getValue(\"sp_rectangle_menu\");\n\tdata.menu = $sp.getWidgetFromInstance(menu);\n\tif (data.menu && data.menu.data) {\n\t\tdata.menu.data.replace = true;\n\t\t// Hide login if menu already has link to login\n\t\tdata.hasLogin = false;\n\t\tif (data.menu.data.menu.items) {\n\t\t\tfor(var i in data.menu.data.menu.items) {\n\t\t\t\tvar item = data.menu.data.menu.items[i];\n\t\t\t\tif (item.type == 'page' && item.sp_page == data.login_page)\n\t\t\t\t\tdata.hasLogin = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdata.loginWidget = $sp.getWidgetFromInstance('login-modal');\n\tdata.typeahead = $sp.getWidgetFromInstance('typeahead-search');\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"servicenow":"false","sys_update_name":"sp_header_footer_a8d107b473131300c629e1e54cf6a703","data_table":"sp_instance","name":"HRMadrid Header","category":"","controller_as":"c","sys_policy":""},{"template":"<!-- Nav bar menu items starts-->\n<nav class=\"navbar-inverse\" aria-label=\"Primary\" role=\"navigation\">\n\n  <!-- Piece above searchbar -->\n\n  <div class=\"clearfix\">\n    <div class=\"navbar-header nav-container\">\n\n      <!-- Logo -->\n      <a class=\"navbar-brand\" ng-if=\"::!portal.logo\" href=\"?id={{::portal.homepage_dv}}\" aria-label=\"{{::portal.title}}\"><span>{{::portal.title}}</span></a>\n      <a class=\"navbar-brand navbar-brand-logo\" ng-if=\"::portal.logo\" href=\"?id={{::portal.homepage_dv}}\" aria-label=\"{{::portal.title}}${ - Home Page}\" data-toggle=\"tooltip\" data-placement=\"bottom\" data-title=\"{{::portal.title}}${ - Home}\">\n        <img ng-src=\"{{::portal.logo}}\" alt=\"{{::portal.title}}${ - Home}\"/>\n      </a>\n\n      <!-- Toggle Button -->\n      <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-collapse\" ng-class=\"(expanded) ? 'in' : 'collapsed'\" ng-click=\"expanded = !expanded\" aria-expanded=\"{{expanded ? true: false}}\" ng-style=\"{'background-color' : (expanded) ? '#333' : 'transparent'}\" aria-label=\"{{expanded ? '${Hide menu primary navigation}' : '${Show menu primary navigation}'}}\" data-toggle=\"tooltip\" data-placement=\"auto bottom\" data-original-title=\"{{expanded ? '${Hide Menu}' : '${Show Menu}'}}\">\n        <span ng-show=\"(data.todoCount + data.requestCount + cartItemCount) > 0\" class=\"label label-as-badge label-primary navbar-collapse-label\">{{data.todoCount + data.requestCount + cartItemCount}}</span>\n        <span class=\"sr-only\">${Toggle navigation}</span>\n        <span class=\"icon-bar\"></span>\n        <span class=\"icon-bar\"></span>\n        <span class=\"icon-bar\"></span>\n      </button>\n\n      <!-- Search Bar Desktop -->\n      <div class=\"header-search navbar-header col-sm-3\" ng-if=\"showSearchBar\">\n        <sp-widget widget=\"data.typeahead\"></sp-widget>\n      </div>\n\n      <!-- Header Navbar -->\n      <div class=\"navbar-collapse upper-collapse navbar-right collapse collapsed\" ng-class=\"(expanded) ? 'in' : 'collapsed'\" aria-expanded=\"false\">\n        <div class=\"height-adjust\">\n          <ul class=\"nav navbar-nav\" role=\"menubar\" aria-orientation=\"horizontal\">\n            <li class=\"hidden-xs\" ng-show=\"loadingIndicator\">  \n              <a> \n                <div class=\"header-loader\" id=\"hr_loading_indicator\"> \n                  <div class=\"hidden-xs sp-loading-indicator la-sm\"> \n                    <div></div> \n                    <div></div> \n                    <div></div> \n                  </div> \n                </div> \n              </a> \n            </li> \n            <li class=\"visible-xs-block m-t-sm m-b-sm\">\n              <a href=\"{{data.link}}\" ng-class=\"getClass(data.link)\" aria-label=\"{{user.name}} ${profile}\" role=\"menuitem\">\n                <span class=\"navbar-avatar\"><sn-avatar class=\"avatar-small-medium\" show-presence=\"false\" primary=\"user.sys_id\" /></span>\n                <span class=\"visible-xs-inline\">{{user.name}}</span>\n              </a>\n            </li>        \n            <li class=\"hidden-xs header-menu-item\" role=\"presentation\" ng-if=\"data.showTodos\">\n              <a href=\"?id=hrm_todos_page\" ng-class=\"getClass('?id=hrm_todos_page')\" id=\"todos_link\"  aria-label=\"${To-dos}, {{c.todoCountTranslation}}\" role=\"menuitem\">\n                <span ng-bind-html=\"'${To-dos}'\"></span>\n                <span ng-show=\"data.todoCount\" class=\"label label-as-badge label-primary\">{{data.todoCount}}</span>\n              </a>\n            </li>\n            <li class=\"hidden-xs header-menu-item\" role=\"presentation\" ng-if=\"data.showRequests\">\n              <a href=\"?id=my_requests\" id=\"cases_popup\" aria-label=\"${Requests}\" role=\"menuitem\"> <!-- TODO: Link for requests -->\n                <span ng-bind-html=\"'${Requests}'\" aria-hidden=\"true\"></span>\n                <span ng-show=\"data.requestCount\" class=\"label label-as-badge label-primary\">{{data.requestCount}}</span>\n              </a>\n            </li>\n            <li>\n            \t<sp-widget widget=\"data.top.menu\" id=\"menu_item\"></sp-widget>\n            </li>\n            \n            <li class=\"visible-xs\" ng-if=\"data.isHrCoreActive\" ng-if=\"data.showTodos\">\n              <a href=\"?id=hrm_todos_page\" id=\"todos_mobile\" aria-label=\"${To-dos}, {{data.todoCountTranslation}}\" role=\"menuitem\">\n                <span ng-bind-html=\"'${To-dos}'\" aria-hidden=\"true\"></span>\n                <span ng-show=\"data.todoCount\" class=\"label label-as-badge label-primary\">{{data.todoCount}}</span>\n              </a>\n            </li>\n            <li class=\"visible-xs\" ng-if=\"data.showRequests\">\n              <a href=\"?id=my_requests\" id=\"requests_mobile\" aria-label=\"${Requests}\" role=\"menuitem\">\n                <span ng-bind-html=\"'${Requests}'\" aria-hidden=\"true\"></span>\n                <span ng-show=\"data.requestCount\" class=\"label label-as-badge label-primary\">{{data.requestCount}}</span>\n              </a>\n            </li>\n          </ul>\n          <!-- Avatar and its drop down -->\n          <div class=\"avatar-drop-down header-menu-item\">\n            <sp-widget widget=\"data.avatarDropDown\" id=\"avatar_drop_down\" ></sp-widget>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  \n  <!-- Sub Navbar -->\n\n  <div class=\"navbar-collapse sub-navbar clearfix collapse collapsed\" ng-class=\"(expanded) ? 'in' : 'collapsed'\" aria-expanded=\"false\">\n    <div class=\"height-adjust\">\n      <sp-widget widget=\"data.sub.menu\"></sp-widget>\n      <ul ng-if=\"::(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)\" class=\"nav navbar-nav\">\n        <li><a href ng-click=\"openLogin()\">${Login}</a>\n        </li>\n      </ul>\n      <div class=\"hidden-xs\" ng-if=\"data.chatSupportEnabled == true || isVAActive\">\n          <button class=\"btn chat-btn\" ng-click=\"toggleChat()\" id=\"va_chat\" aria-label=\"{{showChat ? '${Hide Chat Window}' : '${Show Chat Window}'}}\" aria-pressed=\"{{showChat ? true : false}}\" ng-class=\"mobileDevice?'active-chat':'inactive-chat'\">\n            <span ng-bind-html=\"'${Chat}'\" aria-hidden=\"true\"></span>\n            <span ng-if=\"mobileDevice && showChat\" class=\"chat-active\" ng-bind-html=\"'${Active}'\" aria-hidden=\"true\"></span>\n          </button>\n      </div>\n    </div>\n  </div>\n\n  <!-- Analytics -->\n  <div ng-if=\"data.analyticsSupportEnabled\">\n    <widget id=\"cda-site-analytics\" options=\"{'enable_logging': false}\"></widget>\n  </div>\n</nav>","css":"\r\n.navbar-inverse {\r\n  margin-bottom: 0px;\r\n  border-radius: 0px; \r\n  background-color: $navbar-inverse-bg;\r\n  .navbar-header {\r\n    &.nav-container{\r\n      width: 100%;\r\n    }\r\n    .navbar-brand {\r\n      margin: 0;\r\n      height: 60px;\r\n      padding: $sp-logo-margin-y 0px 10px $sp-logo-margin-x;\r\n      img, span {\r\n        margin: 0;\r\n        display: block;\r\n        max-height: $sp-logo-max-height;\r\n        max-width: $sp-logo-max-width;\r\n        position: relative;\r\n        top: 50%;\r\n        -webkit-transform: translateY(-50%);\r\n        -ms-transform: translateY(-50%);\r\n        transform: translateY(-50%);\r\n      }\r\n    }\r\n    #hr_loading_indicator {\r\n      margin-top: 5px;\r\n    }\r\n    .navbar-right .dropdown-menu > li > a {\r\n      &:hover, &:focus {\r\n        background-color: darken($navbar-inverse-bg, 8%);\r\n        color: $navbar-inverse-link-hover-color;\r\n      }\r\n    }\r\n  }\r\n  .dropdown-toggle:focus {\r\n  \toutline: thin dotted;\r\n    outline: 5px auto -webkit-focus-ring-color;\r\n  }\r\n  .sub-navbar {\r\n    background-color: $sp-navbar-divider-color;\r\n    border: none;\r\n    width: 100%;\r\n    a, .chat-btn {\r\n      padding: 10px 15px;\r\n    }\r\n    .chat-btn {\r\n      color: $navbar-inverse-link-color;\r\n      background-color: $sp-navbar-divider-color;\r\n    }\r\n    .chat-btn:focus {\r\n      box-shadow: inset 0 0 0 0.1rem #fff;\n      border-radius: .2rem;\n      background-color: transparent;\r\n      color: $navbar-inverse-link-hover-color;\r\n    }\r\n    .chat-btn:hover {\r\n      outline: 0 !important;\r\n      background-color: transparent;\r\n      color: $navbar-inverse-link-hover-color;\r\n    }\r\n    #cart-dropdown, #wishlist-menu {\r\n      display: none;\r\n      ~ * {\r\n        display: none !important;\r\n      }\r\n    }\r\n    .navbar-nav > li > a[href=\"?id=sc_cart\"], .navbar-nav > li > a[href=\"?id=sc_wishlist\"] {\r\n      display: none !important;\r\n    }\r\n    .gtd-dropdown-container {\r\n      display: none;\r\n    }\r\n    .open > a, .open > a:focus {\r\n      background-color: darken($sp-navbar-divider-color, 8%);\r\n    }\r\n    #cart-dropdown {\r\n      display: none;\r\n      :after {\r\n        content: \"\\f0d7\";\r\n        vertical-align: baseline;\r\n        width: auto;\r\n        height: auto;\r\n        border: none;\r\n        margin-left: 5px !important;\r\n        display: inline-block;\r\n        font: normal normal normal 14px/1 FontAwesome;\r\n        font-size: inherit;\r\n        text-rendering: auto;\r\n        -webkit-font-smoothing: antialiased;\r\n        -moz-osx-font-smoothing: grayscale;\r\n      }\r\n    }\r\n    .dropdown-menu {\r\n      background-color: $sp-navbar-divider-color;\r\n      > li > a:hover, > li > a:focus {\r\n        background-color: darken($sp-navbar-divider-color, 8%);\r\n      }\r\n    }\r\n  }\r\n  .dropdown-menu {\r\n    border: none;\r\n    &.case-menu {\r\n      right: 0;\r\n      left: auto;\r\n      padding: 0;\r\n      width: 450px;\r\n      background: $color-lightest;\r\n      overflow-y: hidden;\r\n    }\r\n  }\r\n  > .open > a:hover, > .open > a:focus  {\r\n    background-color: darken($navbar-invese-bg, 8%);\r\n  }\r\n  .fa-caret-down {\r\n    vertical-align: middle;\r\n    margin-top: 2px;\r\n  }\r\n  .caret:before {\r\n    content: \"\\f0d7\";\r\n  }\r\n  .caret {\r\n    vertical-align: baseline;\r\n    width: auto;\r\n    height: auto;\r\n    border: none;\r\n    margin-left: 5px !important;\r\n    display: inline-block;\r\n    font: normal normal normal 14px/1 FontAwesome;\r\n    font-size: inherit;\r\n    text-rendering: auto;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n  }\r\n  .label-as-badge {\r\n    font-size: 1.2rem;\r\n    margin-left: 5px;\r\n    background-color: $primary;\r\n  }\r\n  .navbar {\r\n    transition: 250ms opacity ease-in-out; \r\n    -webkit-transition: 250ms opacity ease-in-out; \r\n    border: 0;\r\n  }\r\n  .navbar-fade {\r\n    opacity: 0.4;\r\n  }\r\n  .navbar-collapse {\r\n    padding-right: 0px;\r\n  }\r\n  .case-menu {\r\n    div#widget-tabs-2 {\r\n      border: none;\r\n      > .panel-heading {\r\n        border: none;\r\n        bottom-border: 1px solid $border;\r\n      }\r\n    }\r\n  }\r\n  ul.nav.navbar-nav > div.header-loader {\r\n    display: none;\r\n  }\r\n  \r\n  .cart-dropdown, .wishlist-menu, .gtd-dropdown-container .empty-dropdown {\r\n    width: 350px;\r\n    padding: 0;\r\n    z-index: 1000;\r\n    border-top-left-radius: 4px !important;\r\n    border-top-right-radius: 4px !important;\r\n\r\n    ul {\r\n      max-height: 300px;\r\n      overflow: auto;\r\n    }\r\n\r\n    .subtotal {\r\n      display: block;\r\n    }\r\n\r\n    .item-image {\r\n      padding: 0;\r\n      margin: 0;\r\n      text-align: center;\r\n      max-width:100%;\r\n      height:auto;\r\n    }\r\n    label, p {\r\n      padding: 0;\r\n      margin: 0;\r\n    }\r\n    .media {\r\n      padding: 0;\r\n      margin: 0;\r\n    }\r\n    .media-left > a {\r\n      display: block;\r\n      width: 48px;\r\n      max-width: 48px;\r\n    }\r\n    .media-body {\r\n      label {\r\n        font-weight: bold;\r\n      }\r\n    }\r\n    li.media {\r\n      border-top: 1px solid #cccccc;\r\n      padding: 1rem;\r\n    }\r\n    .panel {\r\n      margin: 0;\r\n    }\r\n    .panel .panel-body {\r\n      padding: 0;\r\n    }\r\n    .btn-clear {\r\n      color: #333;\r\n      background-color: #fff;\r\n    }\r\n    p.quantity-price {\r\n      padding-top: 0.5rem;\r\n      span {\r\n        color: $text-muted;\r\n        padding-right: 0.5rem;\r\n      }\r\n    }\r\n    .align-right {\r\n      text-align: right;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  .item-added-tooltip, wishlist-item-added-tooltip {\r\n    width: 184px;\r\n    font-size: 14px;\r\n  }\r\n\r\n  .gtd-dropdown-container {\r\n    .empty-tour-content{\r\n      text-align: center;\r\n      margin:40px 20px;\r\n    }\r\n    .dropdown-menu li {\r\n      a {\r\n        cursor: pointer;\r\n      }\r\n      min-width: 20em;\r\n    }\r\n    .label-as-badge{\r\n      width: 12px;\r\n      height: 12px;\r\n      display: inline-block;\r\n      padding: 0px;\r\n      padding-top: 2px;\r\n    }\r\n    .badge-container {\r\n      display: inline-block;\r\n      width: 12px;\r\n    }\r\n  }\r\n\r\n}\r\n@media screen and (min-width: 768px) {\r\n  .navbar-inverse {\r\n    .navbar-right > .navbar-nav > div {\r\n      float: left;\r\n    }\r\n    .navbar-right {\r\n      > ul {\r\n        display: -webkit-box;\r\n        display: -moz-box;\r\n        display: box;\r\n\r\n        -moz-box-orient: horizontal;\r\n        box-orient: horizontal; \r\n        -webkit-box-orient: horizontal;\r\n      }\r\n      .navbar-nav > li > a {\r\n        padding-right: 10px;\r\n        padding-left: 10px;\r\n      }\r\n    }\r\n    .navbar-avatar {\r\n      margin-top: -7px;\r\n    }\r\n    a#todos_popup {\r\n      padding-left:0px;\r\n    }\r\n    .navbar-nav .open .dropdown-menu > li > a {\r\n      padding: 10px 20px;\r\n    }\r\n    .navbar-header {\r\n      position:relative;\r\n      .dropdown-toggle {\r\n        height: 60px;\r\n      }\r\n    }\r\n    .temp-mobile {\r\n      display: inline-block;\r\n    }\r\n    .sub-navbar {\r\n      display: flex;\r\n      padding-left: 0;\r\n    }\r\n    .header-search {\r\n      margin: 13px 0;\r\n      width: 26%;\r\n    }\r\n  }\r\n}\r\n@media (min-width : 320px) and (max-width : 767px) {\r\n  .navbar-inverse {\r\n    .dropdown-menu.case-menu {\r\n      width: 100%;\r\n    }\r\n    .navbar-toggle {\r\n      border-color: rgba(255, 255, 255, .25);\r\n      &:hover, &:focus {\r\n        background-color: transparent;\r\n      }\r\n    }\r\n    .navbar-nav {\r\n      display:block;\r\n      margin-top:0px;\r\n      margin-bottom:0px;\r\n      .open .dropdown-menu > li > a {\r\n        padding: 5px 30px;\r\n      }\r\n    }\r\n    .sub-navbar {\r\n      padding: 0px 0px;\r\n    }\r\n    .upper-collapse {\r\n      width: 100%;\r\n      padding-bottom: 0px;\r\n    }\r\n    .navbar-collapse {\r\n      padding-top: 0px;\r\n      padding-left: 0px;\r\n      overflow: hidden;\r\n      ul {\r\n        margin: 0;\r\n      }\r\n    }\r\n    .header-search {\r\n      margin-top: 0 !important;\r\n      padding-bottom: 10px;\r\n      float: left;\r\n      width: 100%;\r\n    }\r\n    .navbar-header {\r\n      > ul {\r\n        display: inline-block;\r\n        padding: 10px 10px 0 0;\r\n        float: right;\r\n        margin: 0;\r\n      }\r\n      > li {\r\n        display: inline-block; \r\n      }\r\n    }\r\n    .height-adjust {\r\n      padding: 10px 0px;\r\n      margin-bottom: 10px;\r\n    }\r\n    .popup-edit {\r\n      background: $color-lightest;\r\n      position: fixed;\r\n      top:0; \r\n      height:100%;\r\n      margin-top: 0;\r\n      max-height:100%;\r\n      width:100%\r\n    }\r\n    .navbar-collapse-label {\r\n      float: right;\r\n      margin-right: -5px;\r\n      margin-top: -7px;\r\n    }\r\n    button > span.label {\r\n      padding: .2em .5em .2em;\r\n    }\r\n  }\r\n}\r\n\r\n@media screen and (min-width: 768px) {\r\n  \t.avatar-drop-down,.avatar-drop-down > div{\r\n  \t\tdisplay: inline;\r\n\t}\r\n}\r\n","internal":"false","roles":"","link":"function escHeaderLink(scope, element) {\n\t$(element).on('click', 'a.navbar-brand', function(e) {\n\t\tscope.expanded = false;\n\t});\n\t$(element).on('click.nav','.navbar-collapse.in',function(e) {\n\t\tvar target = $(e.target);\n\t\tif (target.is('a') && !target.hasClass(\"dropdown-toggle\") && target.siblings('.dropdown-menu').length == 0) {\n\t\t\t// collapse mobile nav if clicked an anchor that isn't a dropdown toggle\n\t\t\tscope.expanded = false;\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// if neither target nor parent is an anchor or the parent anchor is a dropdown-toggle, do nothing\n\t\tif (!target.parent().is('a') || target.parent().hasClass(\"dropdown-toggle\") || target.parent().siblings('.dropdown-menu').length > 0)\n\t\t\treturn;\n\t\t\n\t\t// collapse mobile nav if target is part of a submenu\n\t\tif (target.parents(\"ul.dropdown-menu\").length > 0) {\n\t\t\tscope.expanded = false;\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// collapse mobile nav is target is part of the dropdown\n\t\tif (target.parents(\"div.navbar-collapse\").length > 0)\n\t\t\tscope.expanded = false;\n\t});\n\t$(element).on('keydown','.dropdown-menu > .header-menu-item',function(e){\n\t\tvar target = e.target;\n\t\tif (target.localName == 'a') {\n\t\t\tif(e.keyCode == 37) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$(target).parents('li').removeClass('open');\n\t\t\t\t$(target).parents('li').find('a').focus();\n\t\t\t} else if(e.keyCode == 39) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$(target).parents('li').removeClass('open');\n\t\t\t\t$(target).parents('li').find('a').focus();\n\t\t\t}\n\t\t\tif(e.keyCode == 9) {\n\t\t\t\t$(target).parents('li').removeClass('open');\n\t\t\t}\n\t\t}\n\t});\n\t\n\t$(element).on('keydown','.header-menu-item',function(e){\n\t\tvar target = e.target;\n\t\tif (target.localName == 'a') {\n\t\t\tvar currentMenuItem = $(target).parents('li');\n\t\t\tvar parentUL = currentMenuItem.parents('ul');\n\t\t\tvar allMenuItems = parentUL.children('li:visible');\n\t\t\tvar firstMenuItem = allMenuItems.first();\n\t\t\tvar lastMenuItem = allMenuItems.last();\n\t\t\tvar menuItemToFocus;\n\t\t\t\n\t\t\tif(e.keyCode == 37) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcurrentMenuItem.removeClass('open');\n\t\t\t\tvar previousMenuItem = currentMenuItem.prevAll('li:visible').first();\n\t\t\t\t//enable circular navigation\n\t\t\t\tmenuItemToFocus = previousMenuItem.length ? previousMenuItem : lastMenuItem;\n\t\t\t\tmenuItemToFocus.find('a').focus();\n\t\t\t} else if(e.keyCode == 39) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcurrentMenuItem.removeClass('open');\n\t\t\t\tvar nextMenuItem = currentMenuItem.nextAll('li:visible').first();\n\t\t\t\t//enable circular navigation\n\t\t\t\tmenuItemToFocus = nextMenuItem.length ? nextMenuItem : firstMenuItem;\n\t\t\t\tmenuItemToFocus.find('a').focus();\n\t\t\t}\n\t\t\t\n\t\t\tif(e.keyCode == 9) {\n\t\t\t\t$(target).parents('li').removeClass('open');\n\t\t\t}\n\t\t}\n\t});\n\t\n}","description":"","sys_updated_on":"2021-08-09 08:32:04","sys_class_name":"sp_header_footer","sys_id":"bda7abc623882300fb0c949e27bf6544","sys_updated_by":"admin","docs":"","public":"false","client_script":"function escHeaderController($rootScope, $scope, $window, spUtil, $location, $uibModal, cabrillo, $timeout, i18n,spContextManager) {\n\tvar c = this;\n\t\n\tc.evaluateSearchWidgetVisibility = function() {\n\t\tvar currentUrl = $location.url();\n\t\tvar isChanged = false;\n\t\tif (c.data.hideSearchOnHomepage) {\n\t\t\t// hide on home page\n\t\t\tif(currentUrl.endsWith(c.data.dashboardSuffix) || currentUrl.endsWith(c.data.portalSuffix)) {\n\t\t\t\t$scope.showSearchBar = false;\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t\telse\n\t\t\t\t$scope.showSearchBar = true;\t\n\t\t}\n    \n\t\tif(currentUrl.indexOf(\"id=lf\") !== -1 || isChanged)\n\t\t    $scope.showSearchBar = false;\n\t\telse\n\t\t    $scope.showSearchBar = true;\n\t}\n\t\n\t$scope.showSearchBar = true;\n\t$scope.userID = $scope.user.sys_id;\n\t$scope.todosPopupId = c.data.isMobile?'#popup_todos_mobile':'';\n\t$scope.casesPopupId = c.data.isMobile?'#popup_cases_mobile':'';\n\t$scope.popupType = c.data.isMobile?'collapse':'dropdown';\n\t$scope.expanded = false;\n\t$scope.cartItemCount = 0;\n\t$scope.isVAActive = c.data.isVAActive;\n\t\n\tc.todoCountTranslation = i18n.format(c.data.todoCountLabel, String(c.data.todoCount));\n\n\tvar MOBILE_DEVICE_SCREEN_WIDTH = 767;\n\t$scope.mobileDevice = c.data.isMobile || ($window.innerWidth < MOBILE_DEVICE_SCREEN_WIDTH);\n\t$scope.showChat = false;\n\tif (!$scope.showChat)\n\t\t$('div.sp-ac-container').hide();\n\t$scope.toggleChat = function() {\n\t\tvar alreadyIntegratedChat = $('div.conversation-button-container').length > 0;\n\t\tspContextManager.getContextForKey('agent-chat', true).then(function(context) {\n\t\t\tcontext = context || {};\n\t\t\tcontext.show_ask_a_question_prechat = false;\n\t\t\tspContextManager.updateContextForKey('agent-chat', context);\n\t\t});\n\t\t$('a#va_chat').toggleClass(' active-chat');\n\t\tvar isOpen = $('button.sp-ac-btn.open').length !=0;\n\t\tvar isVisible = $('button.sp-ac-btn.closed').is(\":visible\");\n\t\t$scope.showChat = (isVisible)? isVisible : !$scope.showChat;\n\t\tif(alreadyIntegratedChat){\n\t\t\t$scope.$$postDigest(function(){\n\t\t\t\t$('div.conversation-button-container button.help-button').trigger('click');\n\t\t\t});\n\t\t} else if($scope.showChat){\n\t\t\t$('div.sp-ac-container').show();\n\t\t\tif (!isOpen) {\n\t\t\t$scope.$$postDigest(function(){\n\t\t\t\t$('button.sp-ac-btn').trigger('click');\n\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\t$('div.sp-ac-container').hide();\n\t\t\tif (isOpen) {\n\t\t\t$scope.$$postDigest(function(){\n\t\t\t\t$('button.sp-ac-btn').trigger('click');\n\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tif (cabrillo.isNative())\n\t\t$scope.isViewNative = true;\n\t\n\n\t$scope.$on(\"$sp.service_catalog.cart.count\", function($evt, count) {\n\t\t$scope.cartItemCount = count;\n\t});\n\n\t$scope.$on(\"$locationChangeSuccess\", function(event, data){\n\t\tif(c.data.isMobile){\n\t\t\tif($('div#popup_todos_mobile').is(\":visible\"))\n\t\t\t\t$('li > a#todos_popup').click();\n\t\t\telse if($('div#popup_cases_mobile').is(\":visible\"))\n\t\t\t\t$('li > a#cases_popup').click();\n\t\t} else {\n\t\t\t$('li.open > a#cases_popup').click();\n\t\t\t$('li.open > a#todos_popup').click();\t\n\t\t}\n\t\tc.evaluateSearchWidgetVisibility();\n\t});\n\n\t$scope.$on('sp_loading_indicator', function(e, value) {\n\t\t$scope.loadingIndicator = value;\n\t});\n\n\tc.processWatchers = function(watcher){\n\t\tsetTimeout($scope.reloadHeader,20);\n\t};\n\n\t/* Record Watchers */ \n\tif (c.data.recordWatchers && c.data.recordWatchers.length > 0) {\n\t\tangular.forEach(c.data.recordWatchers, function(watcher) {\n\t\t\tspUtil.recordWatch($scope, watcher.table, watcher.filter, c.processWatchers);\n\t\t});\n\t}\n\n\t$scope.reloadHeader = function(actionName) {\n\t\tc.data.action = actionName || c.data.ACTION_TODO_COUNT;\n\t\tif(c.data.action== c.data.ACTION_TODO_COUNT)\n\t\t\tc.server.get({action:c.data.action}).then(function(resp){\n\t\t\t\tc.data.todoCount = resp.data.todoCount;\n\t\t\t\tc.todoCountTranslation = i18n.format(c.data.todoCountLabel, String(c.data.todoCount));\n\t\t\t});\n\t\telse\n\t\t\tc.server.update();\t\n\t};\n\n\t$scope.openLogin = function () {\n\t\t$scope.modalInstance = $uibModal.open({\n\t\t\ttemplateUrl: 'modalLogin',\n\t\t\tscope: $scope\n\t\t});\n\t};\n\n\t$rootScope.$on(\"update.searchpage\", function(e, searchPage){\n\t\t$scope.searchPage = searchPage;\n\t});\n\n\t$rootScope.$on('sp.avatar_changed', function() {\n\t\t$scope.userID = \"\"; \n\t\t$timeout(function(){\n\t\t\t$scope.userID = $scope.user.sys_id;\n\t\t});\n\t});\n\n\t$scope.isHomepage = function() {\n\t\tif (!$scope.page.id)\n\t\t\treturn true;\n\n\t\tif ($scope.page.id == $scope.portal.homepage_dv)\n\t\t\treturn true;\n\n\t\treturn false;\n\t};\n\n\t$(document).ready(function() {\n\t\t$scope.reloadHeader();\n\t});\n\t\n\tc.evaluateSearchWidgetVisibility();\n\n\t//remove nested ul to fix screen reader issue\n\t$timeout(function () {\n\t\tvar cartToursWrapper = $('.navbar-header .v'+ scope.data.top.menu.sys_id);\n\t\t\n\t\tif (!cartToursWrapper.length)\n\t\t\treturn;\n\t\t\n\t\tvar menu = cartToursWrapper.parent().parent();\n\t\tvar menuItems = cartToursWrapper.children();\n\t\tmenu.append(menuItems);\n\t\tcartToursWrapper.parent().remove();\n\t}, 1000);\n}","sys_created_on":"2018-08-22 16:36:06","sys_name":"ESC Header","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"id":"esc-header","field_list":"","sys_created_by":"admin","static":"false","sys_mod_count":"791","demo_data":"","option_schema":"","sys_tags":"","script":"(function () {\n\tdata.ACTION_TODO_COUNT = 'update_todo_count';\n\tdata.ACTION_LOAD_CASES = 'load_cases';\n\tdata.isMobile = gs.isMobile();\n\n\tdata.isVAActive = new GlidePluginManager().isActive(\"com.glide.cs.chatbot\");\n\n\tdata.chatSupportEnabled = new sn_hr_sp.hr_PortalUtil().isChatSupportEnabled();\n\n\t//Load To-dos count\n\tif (!input || input.action == data.ACTION_TODO_COUNT) {\n\t\tvar myTodosCountObject= new sn_hr_sp.todoPageUtils().getMyTodosCount();\n\t\tdata.todoCount = myTodosCountObject.todoCount;\n\t\tdata.todoCountLabel = gs.getMessage(\"{0} to-dos remaining\");\n\t\tdata.recordWatchers = myTodosCountObject.recordWatchers;\n\n\t\t// avoid consecutive calls \n\t\tif(input)\n\t\t\treturn ;\n\t}\n\n\tdata.isHrCoreActive = GlidePluginManager().isActive(\"com.sn_hr_core\");\n\n\tif (data.isHrCoreActive && gs.getProperty('sn_hr_core.esc.create_hrprofile.override', 'true') === \"true\") {\n\n\t\t// HR Profile\n\t\tvar hrProfileGr = new GlideRecord('sn_hr_core_profile');\n\t\thrProfileGr.addQuery('user', gs.getUserID());\n\t\thrProfileGr.setLimit(1);\n\t\thrProfileGr.query();\n\t\tif (!hrProfileGr.hasNext() && gs.getUserID() && new GlideRecord('sys_user').get(gs.getUserID())) {\n\t\t\thrProfileGr.setValue('user', gs.getUserID());\n\t\t\thrProfileGr.insert();\n\t\t}\n\t}\n\n\t// populate the 'data' object\n\tdata.link = '?id=hri_user_profile&sys_id='+ gs.getUserID();\n\n\t// Defines the support queue ID that will be linked to by the Live Chat link in header\n\tdata.login_page = $sp.getValue('login_page');\n\n\tvar menu = $sp.getValue(\"sp_rectangle_menu\");\n\t//Initialize menu objects\n\tdata.sub = {};\n\tdata.top = {};\n\tdata.sub.menu = $sp.getWidgetFromInstance(menu);\n\n\t//Copy sub menu to top menu, we want cart up top and menu items in the sub nav\n\n\tdata.top.menu = JSON.parse(JSON.stringify(data.sub.menu));\n\tif (data.sub.menu && data.sub.menu.data) {\n\t\tdata.sub.menu.data.replace = true;\n\t\t// Hide login if menu already has link to login\n\t\tdata.hasLogin = false;\n\t\tif (data.sub.menu.data.menu.items) {\n\t\t\tfor(var i in data.sub.menu.data.menu.items) {\n\t\t\t\tvar item = data.sub.menu.data.menu.items[i];\n\t\t\t\tif (item.type == 'page' && item.sp_page == data.login_page)\n\t\t\t\t\tdata.hasLogin = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif(data.top.menu) {\n\t    if(data.top.menu.options && data.top.menu.options.widget_parameters) {\n\t\tvar configOptions = JSON.parse(data.top.menu.options.widget_parameters);\n\t\tdata.hideSearchOnHomepage = configOptions.exclude_search_on_homepage.value;\n\t\tdata.showRequests = configOptions.enable_requests.value;\n\t\tdata.showTodos = configOptions.enable_tasks.value;\n\t    } else {\n\t\tdata.hideSearchOnHomepage = false;\n\t\tdata.showRequests = false;\n\t\tdata.showTodos = false;\n\t    }\n\t    if(data.top.menu.data) {\n\t\tdata.top.menu.data.menu.items = [];\n\t    }\n\t}\n\n\tif (data.hideSearchOnHomepage) {\n\t\tdata.homepage = $sp.getValue('homepage');\n\t\tvar gr = new GlideRecord('sp_page');\n\t\tgr.get(data.homepage);\n\t\tdata.dashboardSuffix = gr.getValue(\"id\");\n\t\tdata.portalSuffix = $sp.getPortalRecord().getDisplayValue(\"url_suffix\");\n\t}\n\n\t// Analytics\n\tdata.analyticsSupportEnabled = new GlidePluginManager().isActive('com.sn_content_analytics') && new GlidePluginManager().isActive('com.sn_content_delivery') && !sn_cd.cd_ContentDelivery.isContentPreview($sp);\n\n\t//Clean up items that don't belong\n\tif (data.sub.menu && data.sub.menu.data) {\n\t    data.sub.menu.data.cartWidget = {};\n\t    data.sub.menu.data.showTours = false;\n\t}\n\tif (data.sub.menu && data.sub.menu.options) {\n\t    data.sub.menu.options.enable_cart = false;\t\t\n\t}\n\n\tdata.loginWidget = $sp.getWidgetFromInstance('login-modal');\n\tvar typeAheadOptions = {};\n\ttypeAheadOptions.refresh_page_on_search_submission = false;\n\ttypeAheadOptions.title = gs.getMessage(\"Search the portal\");\n\tif($sp.isAISearchEnabled())\n\t\ttypeAheadOptions.disable_all_suggestions = ($sp.getParameter('disableAllSuggestions') == 'true');\n\tdata.typeahead = $sp.getWidget('typeahead-search', typeAheadOptions);\n\tdata.avatarDropDown = $sp.getWidget('profile-with-drop-down',{\"profile_url\": data.link, \"show_xs_avatar\": false});\n\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d1da2705b021200a4656ede91f91ab6","value":"3d1da2705b021200a4656ede91f91ab6"},"servicenow":"true","sys_update_name":"sp_header_footer_bda7abc623882300fb0c949e27bf6544","data_table":"sp_instance","name":"ESC Header","category":"hr","controller_as":"c","sys_policy":""},{"template":"<div>\n  <nav id=\"responsiveNav\" class=\"navbar-inverse\" ng-class=\"::{'navbar':!isViewNative, 'is-native': isViewNative}\"\n       role=\"navigation\" aria-label=\"${Primary}\">\n    <div ng-show=\"::!isViewNative\" class=\"navbar-header\">\n<a class=\"navbar-brand\" ng-if=\"::!portal.logo\" href=\"?id={{::portal.homepage_dv}}\"><span ng-bind=\"portal.title\"></span></a>\n      <a class=\"navbar-brand navbar-brand-logo\" ng-if=\"::portal.logo\" ng-href=\"?id={{::portal.homepage_dv}}\" ng-click=\"collapse()\" aria-label=\"{{::logoText}}\">\n        <img ng-src=\"{{::portal.logo}}\" title=\"{{::portal.title}}\" alt=\"{{::portal.title}} ${Logo}\" />\n      </a>\n      <button ng-if=\"data.hasMenuItems || (!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin) || user.logged_in\" type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-placement=\"bottom\" data-toggle-second=\"tooltip\" data-original-title=\"{{::data.toggleMsg}}\" data-target=\"#sp-nav-bar\" aria-haspopup=\"menu\">\n        <span class=\"sr-only\">${Toggle navigation}</span>\n        <span class=\"icon-bar\"></span>\n        <span class=\"icon-bar\"></span>\n        <span class=\"icon-bar\"></span>\n      </button>\n    </div>\n\n    <div sp-navbar-toggle=\"\" class=\"collapse navbar-right\" id=\"sp-nav-bar\" role=\"navigation\">\n      <!-- Include The Menu -->\n      <sp-widget widget=\"::data.menu\"></sp-widget>\n\t  <!-- Language Selector Menu -->\n      <sp-widget widget=\"::data.langSelector\"></sp-widget>\n      <ul ng-if=\"(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)\" class=\"nav navbar-nav\" role=\"presentation\">\n        <li role=\"presentation\"><a href ng-click=\"::openLogin()\">${Login}</a></li>\n      </ul>\n      <ul ng-if=\"user.logged_in\" class=\"nav navbar-nav\">\n        <!-- chat, avatar, and logout -->\n        <li ng-if=\"::(data.connect_support_queue_id && !isAgentChatConfigured)\"><a href ng-click=\"openPopUp()\" role=\"button\">${Live Chat}</a></li>\n        <li ng-if=\"showAvatar\" class=\"hidden-xs hidden-sm dropdown\">\n          <a href class=\"toggle-dropdown\" data-toggle=\"dropdown\" aria-expanded=\"false\" aria-label=\"{{::data.profileBtnMsg}}: {{::user.name}}\" id=\"profile-dropdown\"  role=\"button\" aria-haspopup=\"true\">\n            <span class=\"navbar-avatar\" aria-hidden=\"true\"><sn-avatar class=\"avatar-small-medium\" primary=\"avatarProfile\" /></span>\n            <span class=\"visible-lg-inline\">{{::user.name}}</span>\n          </a>\n          <ul class=\"dropdown-menu\" aria-label=\"{{::data.profileBtnMsg}}\">\n            <li><a tabindex=\"-1\" ng-href=\"?id=user_profile&sys_id={{::user.sys_id}}\">${Profile}</a></li>\n            <li ng-if=\"::!(isViewNative || isViewNativeTablet)\"><a tabindex=\"-1\" href=\"{{::portal.logoutUrl}}\">${Logout}</a></li>\n          </ul>\n        </li>\n        <li ng-if=\"showSMAvatar\" class=\"visible-xs-block visible-sm-block\"><a ng-href=\"?id=user_profile&sys_id={{::user.sys_id}}\" ng-click=\"collapse()\">\n          <span class=\"navbar-avatar\"><sn-avatar class=\"avatar-small-medium\" primary=\"avatarProfile\" /></span>{{::user.name}}</a>\n        </li>\n        <li ng-if=\"::!(isViewNative || isViewNativeTablet)\" class=\"visible-xs-block visible-sm-block\"><a ng-href=\"{{::portal.logoutUrl}}\" ng-click=\"collapse()\">${Logout}</a></li>\n      </ul>\n    </div>\n  </nav>\n</div>","css":".navbar {\n  transition: 250ms opacity ease-in-out;\n  -webkit-transition: 250ms opacity ease-in-out;\n  border: 0;\n  border-bottom: 4px solid $sp-navbar-divider-color;\n}\n\n.navbar-fade {\n  opacity: 0.4;\n}\n\n.navbar-inverse .navbar-toggle {\n  border-color: rgba(255, 255, 255, 0.25);\n}\n\nheader[role=\"banner\"],\n.nav > li > a {\n  max-height: 60px;\n}\n\n.nav > li > a span.fa{\n  margin-left: 0.2rem;\n}\n\n.responsive-tablet {\n  .nav > li > a {\n    padding-right: 0.5rem;\n    padding-left: 0.5rem;\n  }\n}\n\n.navbar-brand {\n  max-height: 60px;\n  padding: 0;\n  padding-bottom: 0.5rem;\n}\n\n.navbar-brand img, .navbar-brand span {\n  margin-left: $sp-logo-margin-x;\n  margin-right: $sp-logo-margin-x;\n  margin-top: $sp-logo-margin-y;\n  margin-bottom: $sp-logo-margin-y;\n  display: block;\n  max-height: $sp-logo-max-height;\n  max-width: $sp-logo-max-width;\n  position: relative;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n  -ms-transform: translateY(-50%);\n  transform: translateY(-50%);\n  overflow: hidden;\n}\n\n.responsive-tablet {\n  .navbar-brand img, .navbar-brand span {\n    max-width: $sp-logo-mobile-max-width;\n  }\n}\n\n.breadcrumb-container {\n  background-color: $panel-bg;\n}\n\n/* for mobile app */\n.navbar-inverse.is-native {\n  background-color: #405060;\n}\n\nnav {\n  margin-bottom: 0px;\n  border-radius: 0px;\n\n .toggle-dropdown {\n    height: 60px;\n  }\n\n}\n\n.navbar-right {\n  padding-right: 0px;\n  padding-left: 7px;\n}\n\n.navbar-nav {\nmargin: 0px;\n}\n\n// PRB711244: Dropdown menu is scrollable when too many items\n.scrollable-dropdown {\n  max-height: 80vh;\n  overflow: auto;\n  height: auto;\n}\n\n.is-native {\n .scrollable-dropdown {\n  max-height: 100vh;\n  overflow: scroll;\n  height: auto;\n\t}\n}\n\n\n/* PRB923910: Fix for Service Portal - Header Poorly Aligned in Safari */\n.responsive-desktop {\n  .navbar-right {\n    display: flex !important;\n    height: auto !important;\n  }\n}\n\n.responsive-tablet {\n  .navbar-toggle {\n    display: block;\n  }\n  .navbar-header {\n    float: none;\n  }\n  .navbar-left,.navbar-right {\n    float: none !important;\n  }\n  .navbar-nav {\n    float: none !important;\n  }\n  .navbar-nav > li {\n    float: none;\n  }\n  .navbar-nav > li > a {\n    padding-top: 1rem ;\n    padding-bottom: 1rem;\n  }\n}","internal":"false","roles":"","link":"function(scope, element) {\n\tvar prevFocusIndex = -1;// This is used for prev focus of nav-bar(avatar) drop down items when its visible.\n\tvar KEY = {\n\t\tTAB : 9,\n\t\tENTER : 13,\n\t\tESC : 27,\n\t\tSPACE_BAR : 32,\n\t\tLEFT : 37,\n\t\tUP : 38,\n\t\tRIGHT : 39,\n\t\tDOWN : 40\n\t}\n\t\n\tfunction isMDScreenSize() {\n\t\treturn window.matchMedia('(max-width: 992px)').matches;\n\t}\n\t\n\tvar navbarContainer = $('#sp-nav-bar');\n\tnavbarContainer.on('shown.bs.collapse', function () {\n\t\t$('a:visible', navbarContainer).first().focus();\n\t});\n\t\n\t$(document).keyup(function(event) {\n\t\tvar mdScreenSize = isMDScreenSize();\n\t\tif (event.which == KEY.TAB || event.which == KEY.LEFT || event.which == KEY.RIGHT) { //tab key handler + arrow keys\n\t\t\tif (!mdScreenSize && $(event.target).parents(\".dropdown-menu\").length == 0) { //if we are NOT inside a dropdown...\n\t\t\t\t//close the dropdowns\n\t\t\t\t$(\".dropdown.open\", $(element)).removeClass(\"open\");\n\t\t\t\t$(\"[data-toggle='dropdown']\", $(element)).attr(\"aria-expanded\", \"false\");\n\t\t\t\tprevFocusIndex = -1;\n\t\t\t}\n\t\t} else if(event.which == KEY.UP || event.which == KEY.DOWN) {\n\t\t\tvar parent = $(event.target).parents('.dropdown-menu');\n\t\t\t\n\t\t\t// To support custom drop downs like cart and wish list.\n\t\t\tif (parent.hasClass('custom-drop-down')) return;\n\t\t\t\n\t\t\tif (parent.length) {\n\t\t\t\tvar items = $(parent).find('li a, li button');\n\t\t\t\tif (!items.length)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar index = items.index(items.filter(':focus'));\n\t\t\t\tif(index == -1) return;\n\t\t\t\t\n\t\t\t\tif (prevFocusIndex == index) {\n\t\t\t\t\tif (index == 0)\n\t\t\t\t\t\tindex = items.length - 1;\n\t\t\t\t\telse if (index == items.length - 1)\n\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\titems[index].focus();\n\t\t\t\t} else if (event.which == KEY.UP && index == 0 && prevFocusIndex == -1) { // to handle newly opened dropdown on keyup\n\t\t\t\t\tindex = items.length - 1;\n\t\t\t\t\titems[index].focus();\n\t\t\t\t}\n\t\t\t\tprevFocusIndex = index;\n\t\t\t\n\t\t\t} else {\n\t\t\t\t// Upon down/up arrow key event from the menu target element,\n        // focus the first/last menu item to be consistent with click behavior and conform to standard menubar pattern below\n\t\t\t\t// https://www.w3.org/TR/wai-aria-practices/examples/menubar/menubar-1/menubar-1.html\n\t\t\t\tif ($(event.target).is('[data-toggle=\"dropdown\"]')) {\n\t\t\t\t\tvar parent = $(event.target).parent().find('.dropdown-menu');\n\t\t\t\t\t\n\t\t\t\t\t// To support custom drop downs like cart and wish list.\n\t\t\t\t\tif (parent.hasClass('custom-drop-down')) return;\n\t\t\t\t\t\n\t\t\t\t\tvar items = $(parent).find('li a, li button');\n\t\t\t\t\tif (!items.length) return;\n\t\t\t\t\t\n\t\t\t\t\tvar index = -1;\n\t\t\t\t\tif(event.which == KEY.DOWN) //down\n\t\t\t\t\t\tindex = 0;\n\t\t\t\t\telse if(event.which == KEY.UP) //up\n\t\t\t\t\t\tindex = items.length > 0 ? items.length-1 : 0;\n\t\t\t\t\t\n\t\t\t\t\titems[index].focus();\n\t\t\t\t\tprevFocusIndex = index;\n\t\t\t\t\t\n\t\t\t\t}\t\t\n\t\t\t}\n\t\t}\n\t\t// on esc/close of the menu, reset the index\n\t\tif(event.which == KEY.ESC) {\n\t\t\tprevFocusIndex = -1;\n\t\t\tif (mdScreenSize && $('.navbar-right').attr(\"aria-expanded\")) {\n\t\t\t\tcloseMobileMenu();\n\t\t\t\t\n\t\t\t\tif ($(event.target).parents(\".navbar-right\").length > 0)\n\t\t\t\t\t$('.navbar-toggle').focus();\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (event.which == KEY.ENTER || event.which == KEY.SPACE_BAR)\n\t\t\t$(event.target).parent(\".dropdown.open\").find(\"ul.dropdown-menu li:first-child a\").focus();\n\t});\n\n\t$(element).on('click.nav','.navbar-collapse.in',function(e) {\n\t\tvar target = $(e.target);\n\t\tif (target.is('a')) {\n\t\t\tif (target.hasClass('sp-menu-has-items'))\n\t\t\t\treturn; // menu item has a submenu, so just toggle it\n\n\t\t\t// collapse mobile nav if clicked an anchor\n\t\t\t$(this).removeClass('in').addClass('collapse');\n\t\t\treturn;\n\t\t}\n\n\t\tif (target.parent().hasClass(\"toggle-dropdown\")) {\n\t\t\t// collapse mobile nav if parent has toggle-dropdown class\n\t\t\t$(this).removeClass('in').addClass('collapse');\n\t\t\treturn;\n\t\t}\n\n\t\t// if neither target nor parent is an anchor, do nothing\n\t\tif (!target.parent().is('a'))\n\t\t\treturn;\n\n\t\t// collapse mobile nav if target is part of a submenu\n\t\tif (target.parents(\"ul.dropdown-menu\").length > 0)\n\t\t\t$(this).removeClass('in').addClass('collapse');\n\t});\n\n\t// clicking outside the mobile menu should close the mobile menu\n\t$(document).on('click', function(e) {\n\t\tvar target = $(e.target);\n\t\tif (target.parents('.navbar-right').length == 0) {\n\t\t\tcloseMobileMenu();\n\t\t}\n\t});\n\t\n\t// Close the mobile menu when focus goes out of the menu\n\t$('.navbar-right').on('keydown', 'a', function(event) {\n\t\tif (($(this).is($('.navbar-right a').last()) && event.which == KEY.TAB && !event.shiftKey) || ($(this).is($('.navbar-right a').first()) && event.which == KEY.TAB && event.shiftKey)) {\n\t\t\tcloseMobileMenu();\n\t\t\tsetTimeout(function () {\n\t\t\t\twindow.scrollBy(0,-200);\n\t\t\t});\n\t\t}\n\t});\n\t\n\tfunction closeMobileMenu() {\n\t\t$('.navbar-right').collapse('hide');\n\t}\n}","description":"","sys_updated_on":"2025-05-07 08:48:37","sys_class_name":"sp_header_footer","sys_id":"bf5ec2f2cb10120000f8d856634c9c0c","sys_updated_by":"admin","docs":"","public":"true","client_script":"function ($rootScope, $scope, snRecordWatcher, spUtil, $location, $uibModal, cabrillo, $timeout, $window, i18n) {\n\n\t$scope.logoText = i18n.format(i18n.getMessage('Go to {0} Homepage'), $scope.portal.title);\n\t$scope.collapse = function() {\n\t\t$rootScope.$emit('sp-navbar-collapse');\n\t}\n\n\t$scope.avatarProfile = {\n\t\tuserID: $scope.user.sys_id,\n\t\tname: $scope.user.name,\n\t\tinitials: $window.NOW.user_initials\n\t};\n\n\tif ($window.NOW.user_avatar) {\n\t\t$scope.avatarProfile.userImage = $window.NOW.user_avatar;\n\t}\n\n\tif (cabrillo.isNative()) {\n\t\tif ($window.innerWidth < 767) {\n\t\t\t$scope.isViewNative = true;\n\t\t} else {\n\t\t\t$scope.isViewNativeTablet = true;\n\t\t}\n\t}\n\n\n\t$scope.openPopUp = function() {\n\t\tvar url = \"$chat_support.do?queueID=\" + $scope.data.connect_support_queue_id;\n\t\tvar popup = window.open (url, \"popup\", \"width=900, height=600\");\n\t};\n\n\t$scope.openLogin = function () {\n\t\t$scope.modalInstance = $uibModal.open({\n\t\t\ttemplateUrl: 'modalLogin',\n\t\t\tscope: $scope\n\t\t});\n\n\t\tvar pageRoot = angular.element('.sp-page-root');\n\t\t$scope.modalInstance.rendered.then(function() {\n\t\t\tvar $uibModalStack = $injector.get('$uibModalStack');\n\t\t\tvar modalObj = $uibModalStack.getTop();\n\t\t\tvar modal = modalObj.value.modalDomEl;\n\n\t\t\tmodal.attr('aria-label', modal.find('.panel-title').html());\n\t\t\tmodal.attr('aria-modal', 'true');\n\t\t\tpageRoot.attr('aria-hidden', 'true');\n\t\t});\n\n\t\t$scope.modalInstance.closed.then(function() {\n\t\t\tpageRoot.attr('aria-hidden', 'false');\n\t\t});\n\t};\n\n\tvar mdScreenSize = isMDScreenSize();\n\t$scope.showSMAvatar = isMDScreenSize();\n\t$scope.showAvatar = !isMDScreenSize();\n\n\t$scope.isAgentChatConfigured = g_has_agent_chat_config;\n\n\tvar nav = document.getElementById('responsiveNav');\n\n\tfunction isMDScreenSize() {\n\t\tif (nav)\n\t\t\treturn nav.classList.contains('responsive-tablet');\n\t\telse return false;\n\t}\n\n\tfunction updateResponsiveClasses(width) {\n\t\tif (width <= 992) {\n\t\t\tnav.classList.add('responsive-tablet');\n\t\t\tnav.classList.remove('responsive-desktop');\n\t\t} else {\n\t\t\tnav.classList.add('responsive-desktop');\n\t\t\tnav.classList.remove('responsive-tablet');\n\t\t}\n\t\tif(mdScreenSize !== isMDScreenSize() && (!$scope.showSMAvatar || !$scope.showAvatar)){\n\t\t\t$scope.showSMAvatar = true;\n\t\t\t$scope.showAvatar = true;\n\t\t}\n\t}\n\n\tvar observer = new ResizeObserver(function(entries) {\n\t\tif (entries && entries[0]) {\n\t\t\tupdateResponsiveClasses(entries[0].contentRect.width);\n\t\t}\n\t});\n\tobserver.observe(nav);\n\n\t$rootScope.$on('sp.avatar_changed', function(evt, obj) {\n\t\t$scope.userID = \"\";\n\t\t$scope.newAvatarId = obj.newAvatarId;\n\t\t$timeout(function(){\n\t\t\t$scope.userID = $scope.user.sys_id;\n\t\t\t$(\"#profile-dropdown .sub-avatar\").css(\"background-image\", 'url(\"' + $scope.newAvatarId + '.iix?t=small\")');\n\t\t});\n\t});\n\n\t$scope.isHomepage = function() {\n\t\tif (!$scope.page.id)\n\t\t\treturn true;\n\n\t\tif ($scope.page.id == $scope.portal.homepage_dv)\n\t\t\treturn true;\n\n\t\treturn false;\n\t};\n\n}\n\t\t","sys_created_on":"2015-12-16 23:21:34","sys_name":"Stock Header","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"id":"","field_list":"","sys_created_by":"admin","static":"false","sys_mod_count":"707","demo_data":"","option_schema":"","sys_tags":"","script":"// Defines the support queue ID that will be linked to by the Live Chat link in header\ndata.connect_support_queue_id = $sp.getValue('sp_chat_queue');\ndata.login_page = $sp.getValue('login_page');\ndata.profileBtnMsg = gs.getMessage(\"User options\");\ndata.toggleMsg = gs.getMessage(\"Toggle navigation\");\nvar menu = $sp.getValue(\"sp_rectangle_menu\");\ndata.menu = $sp.getWidgetFromInstance(menu);\ndata.langSelector = pm.isActive('com.glide.i18n')? $sp.getWidget('sp-lang-selector') : \"\";\nif (data.menu && data.menu.data) {\n\tdata.menu.data.replace = true;\n\t// Hide login if menu already has link to login\n\tdata.hasLogin = false;\n\tif (data.menu.data.menu.items) {\n\t\tdata.hasMenuItems = data.menu.data.menu.items.length > 0;\n\t\tfor(var i in data.menu.data.menu.items) {\n\t\t\tvar item = data.menu.data.menu.items[i];\n\t\t\tif (item.type == 'page' && item.sp_page == data.login_page)\n\t\t\t\tdata.hasLogin = true;\n\t\t}\n\t}\n}\n\ndata.loginWidget = $sp.getWidgetFromInstance('login-modal');\n","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"servicenow":"true","sys_update_name":"sp_header_footer_bf5ec2f2cb10120000f8d856634c9c0c","data_table":"sp_instance","name":"Stock Header","category":"standard","controller_as":"","sys_policy":""},{"template":"<div class=\"scrub-footer\" ng-if=\"c.data.footer && c.data.footer.sysId && showFooter\">\n\n   <!-- Menu Section -->\n  <div class=\"sf-main\"  ng-if=\"(c.data.footer.logo && (c.data.footer.logo.imageUrl || c.data.footer.logo.content)) || (c.data.footer.menus.navigation_links.length)\">\n\n    <!-- Logo Section -->\n    <div class=\"sf-logo-container\" ng-if=\"c.data.footer.logo\">\n      <img ng-if=\"c.data.footer.logo.imageUrl\"\n           ng-src={{c.data.footer.logo.imageUrl}}\n           alt=\"${Footer logo}\"\n           class=\"sf-logo image-flex\">\n      <div class=\"sf-logo-content\">\n         <p ng-bind-html=\"c.data.footer.logo.content\"></p>\n      </div>\n    </div>\n\n     <!-- Menu links Section -->\n    <div class=\"sf-links-container\" id=\"sf-links-container\">\n      <div class=\"masonry-root\">\n      <div class=\"sf-group masonry-cell\"\n           ng-if=\"menu.menuItems.length\"\n           ng-repeat=\"menu in c.data.footer.menus.navigation_links\"\n           on-finish-repeat=\"ngRepeatFinishedNavLinks\" >\n         <div class=\"sf-group-title\" ng-attr-id={{menu.sysId}}>\n            {{menu.title}}\n         </div>\n        <div class=\"sf-links\" role=\"list\" aria-label=\"{{menu.title}}\">\n        <div class=\"sf-link\" role=\"listitem\" ng-repeat=\"link in menu.menuItems\">\n          <a ng-href={{link.href}} ng-class=\"{'new_window': link.isExternalLink}\" ng-attr-target=\"{{(link.isExternalLink) ? '_blank' : undefined}}\">{{link.label}}</a>\n         </div>\n        </div>\n      </div>\n      </div>\n    </div>\n  </div>\n  <!-- Footer Bottom Section -->\n  <div class=\"sf-bottom\" ng-if=\"(c.data.footer.menus.bottom_links && c.data.footer.menus.bottom_links.length) || (c.data.footer.menus.social_icons && c.data.footer.menus.social_icons.length) || c.data.footer.copyright\">\n    <div class=\"sf-bottom-left\">\n      <div ng-repeat=\"menu in c.data.footer.menus.bottom_links\" on-finish-repeat=\"ngRepeatFinishedNavLinks\" class=\"inline-block\">\n       <div class=\"sf-bottom-link\" ng-repeat=\"link in menu.menuItems\">\n          <a ng-href={{link.href}} ng-class=\"{'external-link': link.isExternalLink}\" ng-attr-target=\"{{(link.isExternalLink) ? '_blank' : undefined}}\">{{link.label}}</a>\n         </div>\n      </div>\n    </div>\n\n    <div class=\"sf-bottom-right\">\n      <div class=\"sf-social-icons\">\n        <div ng-repeat=\"menu in c.data.footer.menus.social_icons\" on-finish-repeat=\"ngRepeatFinishedNavLinks\" class=\"inline-block\">\n         <a class=\"sf-social-icon\" ng-class=\"'fa fa-' + link.glyph + (link.isExternalLink ? ' external-link' : '')\"\n               ng-attr-target=\"{{(link.isExternalLink) ? '_blank' : undefined}}\"\n               title={{link.label}}\n               ng-href={{link.href}}\n               ng-repeat=\"link in menu.menuItems\"\n               aria-label=\"{{link.label}}\"></a>\n        </div>\n      </div>\n      <div class=\"sf-copyright\">{{c.data.footer.copyright}}</div>\n    </div>\n   </div>\n</div>","css":"$footer-main-title-font-size: $font-size-md !default;\n$footer-main-link-font-size: $font-size-small !default;\n$footer-bottom-font-size: ceil(($font-size-base * 0.75)); !default; // $font-size-xs\n$sp-space--xxl: 32px !default;\n\n.scrub-footer {\n  .sf-main {\n    background: $sp-navbar-divider-color;\n    display: flex;\n    color: $navbar-inverse-link-color;\n    margin-top: $sp-space--xxl;\n    border-top: 1px solid darken($sp-navbar-divider-color, 15%);\n\n    /* Logo section */\n    .sf-logo-container {\n      width: 277px;\n      padding: 2rem 0;\n      .sf-logo {\n        max-width: 100%;\n        padding: 1rem 1.4rem;\n        display: block;\n      }\n      .sf-logo-content {\n        padding: 1rem 1.4rem;\n        word-break: break-word;\n        font-size: 1.2rem;\n      }\n    }\n\n    /* Group link section */\n    .sf-links-container {\n      flex: 1;\n      padding-top: 3.4rem;\n      .sf-group {\n        width: 22rem;\n        padding: 0 1.4rem 3.2rem;\n        .sf-group-title {\n          color: $navbar-inverse-link-color;\n          font-size: $footer-main-title-font-size;\n          font-weight: bold;\n          padding-bottom: 1.6rem;\n        }\n        .sf-link {\n          padding-bottom: 1.6rem;\n          a {\n            display: inline-block;\n            color: $navbar-inverse-link-color;\n            opacity: 0.7;\n            font-size: $footer-main-link-font-size;\n            word-break: break-word;\n            &:hover {\n              color: $navbar-inverse-link-hover-color;\n            }\n            &:focus {\n              outline: 2px solid $navbar-inverse-link-color;\n              outline-offset: 5px;\n              box-shadow: none;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /* Footer bottom section */\n  .sf-bottom {\n    background: $navbar-inverse-bg;\n    color: $navbar-inverse-link-color;\n    font-size: $footer-bottom-font-size;\n    display: flex;\n    border-top: 1px solid darken($navbar-inverse-bg, 15%);\n    .sf-bottom-left {\n      flex: 1;\n      .sf-bottom-link a {\n        color: $navbar-inverse-link-color;\n        font-size: $footer-bottom-font-size;\n        &:hover {\n          color: $footer-link-hover-color;\n        }\n        &:focus {\n          outline: 2px solid $navbar-inverse-link-color;\n          outline-offset: 5px;\n          box-shadow: none;\n        }\n      }\n    }\n    .sf-bottom-right {\n      display: flex;\n      .sf-social-icons {\n        padding: 27px 0;\n        .sf-social-icon {\n          color: $navbar-inverse-link-color;\n          padding: 0;\n          margin: 0 0.8rem;\n          font-size: $font-size-large;\n          &:focus {\n            outline: 2px solid $navbar-inverse-link-color;\n            outline-offset: 5px;\n            box-shadow: none;\n          }\n        }\n      }\n    }\n  }\n\n  .sf-bottom-link,\n  .sf-copyright {\n    display: inline-block;\n    padding: 27px 11.5px;\n  }\n  .inline-block {\n    display: inline-block;\n  }\n}\n\n/* Masonry layout */\n.masonry-root {\n  display: flex;\n  flex-direction: column;\n  flex-wrap: wrap;\n}\n\n /* IE 10-11 specific Class to override */\n@media screen and (-ms-high-contrast: active),\n  (-ms-high-contrast: none) {\n  .masonry-root {\n    max-height: 100% !important;\n    .masonry-cell {\n      display: -ms-inline-flexbox;\n      flex-direction: column;\n      -ms-flex-wrap: wrap;\n\n      .sf-group-title {\n        width: 100%;\n      }\n    }\n\n    &:after {\n      content: \"\";\n      clear: both;\n      display: table;\n    }\n  }\n}\n\n@media (max-width: 850px) {\n  .scrub-footer {\n    .sf-main .sf-links-container .sf-group {\n      width: 15rem;\n      padding-bottom: 22px;\n    }\n\n    .sf-bottom {\n      padding: 18px 11px;\n      .sf-bottom-link {\n        padding: 0 8px 11px 8px;\n      }\n      .sf-bottom-right .sf-social-icons {\n        flex: 1;\n        padding: 0;\n        .sf-social-icon {\n          margin: 0 8px 0.8rem 0.8rem;\n        }\n      }\n      .sf-bottom-left {\n        display: block;\n      }\n      .sf-copyright {\n        padding: 0 18px;\n      }\n    }\n    .sf-links-container {\n      padding-top: 3.4rem;\n    }\n    .sf-separator {\n      flex: 0;\n    }\n  }\n}\n\n\n@media (max-width: 430px) {\n  .scrub-footer {\n    .sf-main, .sf-bottom {\n      display: block;\n    }\n    .sf-main {\n      flex-direction: column;\n      .sf-links-container {\n        padding-top: 0;\n        .sf-group {\n          width: 15rem;\n       }\n      }\n    }\n  }\n}","internal":"false","roles":"","link":"function link(scope, element, attrs, controller) {\n    $(element).on(\"keydown\", \".masonry-root\", scope.handleFooterKeyboardEvent);\n}","description":"","sys_updated_on":"2024-09-05 09:36:47","sys_class_name":"sp_header_footer","sys_id":"ce046d5773603010c94f54eb7df6a7ec","sys_updated_by":"admin","docs":"","public":"false","client_script":"api.controller = function($scope, $window, $location) {\n    /* widget controller */\n    var c = this;\n    var isIE = window.navigator.userAgent.indexOf('Trident/') !== -1;\n    c.data.footer = {};\n    c.data.isFooterFixed = false;\n  \n    $scope.$on('ngRepeatFinishedNavLinks', function(ngRepeatFinishedEvent) {\n      init();\n    });\n    \n    function init() {\n\n        if (c.data.footer && c.data.footer.menus) {\n            Object.keys(c.data.footer.menus).forEach(function(menuType) {\n                var menuSection = c.data.footer.menus[menuType];\n                if (menuSection) {\n                    menuSection.forEach(function(menu) {\n                        menu.menuItems = transformMenuItems(menu.menuItems);\n                    });\n                }\n            });\n        }\n\n        applyMasonryOnLoad();\n    }\n\n   /**\n     * Used for capturing positions of columns in the Footer masonry layout.\n     * navigationMap : an object with key as left offset in pixel & value as array of footer links located at that left offset.\n     */\n    c.DELTA_OFFSET = 24;\n    $scope.navigationMap = {};\n    $scope.keyboardNavRowIndex = 0;\n    $scope.keyboardNavColIndex = 0;\n\n    /**\n     * This function provides keyboard navigation within Footer\n     * @param {Object} event - keyboard event object\n     * @see {@link c.initialiseKeyboardNav}\n     * @todo change event.which to event.key after end of support for IE11.\n     */\n    $scope.handleFooterKeyboardEvent = function (event) {\n        // If Shift + Tab on 1st link, let default DOM order take control of K/B Navigation & reset c.shiftKeyPressed.\n        c.shiftKeyPressed = event.shiftKey;\n        var isShiftTabPressedOnFirstLink = c.shiftKeyPressed && event.which === 9 && $scope.keyboardNavRowIndex === 0 && $scope.keyboardNavColIndex === 0;\n        if (isShiftTabPressedOnFirstLink || event.which === 16) {\n            c.shiftKeyPressed = isShiftTabPressedOnFirstLink ? false : c.shiftKeyPressed;\n            return;\n        }\n        var navMapKeys = Object.keys($scope.navigationMap);\n\n        // If Tab key is pressed on last masonry link and no bottom links are available, let default DOM order take control of K/B Navigation\n        var isLastRow = ($scope.keyboardNavRowIndex === $scope.navigationMap[navMapKeys[$scope.keyboardNavColIndex]].length - 1);\n        var isLastColumn = ($scope.keyboardNavColIndex === navMapKeys.length - 1);\n        var isOnlyTabKeyPress = (event.which === 9 && !c.shiftKeyPressed);\n        var areBottomLinksPresent = _.get(c.data.footer, 'menus.bottom_links[0].menuItems.length', 0) > 0 || _.get(c.data.footer, 'menus.social_icons.menuItems.length', 0) > 0;\n        if (isLastRow && isLastColumn && isOnlyTabKeyPress && !areBottomLinksPresent) {\n          $scope.keyboardNavRowIndex = 0;\n          $scope.keyboardNavColIndex = 0;\n          return;\n        }\n\n        event.preventDefault();\n        switch (event.which) {\n            case 32: // fall through, click on space or enter key\n            case 13:\n                $(event.target)[0].click();\n                break;\n\n            case 37: // Left arrow key press\n                $scope.keyboardNavRowIndex = 0;\n                // if on 1st column, go to last column. Otherwise decrease the column to the left one\n                $scope.keyboardNavColIndex = ($scope.keyboardNavColIndex === 0) ? navMapKeys.length - 1 : $scope.keyboardNavColIndex - 1;\n                break;\n\n            case 38: // Up arrow key press\n                var currentRowIndex = $scope.keyboardNavRowIndex;\n                var currentColIndex = $scope.keyboardNavColIndex;\n                // if not on 1st row, move up a row, otherwise set current row to last link of the column\n                $scope.keyboardNavRowIndex = (currentRowIndex === 0) ? ($scope.navigationMap[navMapKeys[currentColIndex]].length - 1) : (currentRowIndex - 1);\n                break;\n\n            case 39: // Right arrow key press\n                $scope.keyboardNavRowIndex = 0;\n                // if not last column, move to next column, else move to 1st column\n                $scope.keyboardNavColIndex = ($scope.keyboardNavColIndex + 1 < navMapKeys.length) ? ($scope.keyboardNavColIndex + 1) : 0;\n                break;\n\n            case 40: // Down arrow key press\n                currentRowIndex = $scope.keyboardNavRowIndex;\n                currentColIndex = $scope.keyboardNavColIndex;\n                // if on last row, go to 1st row, else move down one row\n                $scope.keyboardNavRowIndex = (currentRowIndex === $scope.navigationMap[navMapKeys[currentColIndex]].length - 1) ? 0 : (currentRowIndex + 1);\n                break;\n\n            case 9:\n                // if shift + tab\n                if (c.shiftKeyPressed) {\n                    if ($scope.keyboardNavRowIndex != 0) {\n                        $scope.keyboardNavRowIndex--;\n                    }\n                    // if it is 0th row\n                    else {\n                        $scope.keyboardNavColIndex--;\n                        $scope.keyboardNavRowIndex = $scope.navigationMap[navMapKeys[$scope.keyboardNavColIndex]].length - 1;\n                    }\n                }\n                // only tab\n                else {\n                    // if not on the last row of current column, then increment the row\n                    if ($scope.navigationMap[navMapKeys[$scope.keyboardNavColIndex]].length != $scope.keyboardNavRowIndex + 1) {\n                        $scope.keyboardNavRowIndex++;\n                    }\n                    // if on the last row\n                    else {\n                        // if on last row of last column, then  move to 1st bottom link\n                        if ($scope.keyboardNavColIndex === navMapKeys.length - 1) {\n                            $('.scrub-footer .sf-bottom a').first().focus();\n                            $scope.keyboardNavRowIndex = 0;\n                            $scope.keyboardNavColIndex = 0;\n                            return;\n                        }\n                        // but not the last column, then increment column & go to row 0 of next column.\n                        $scope.keyboardNavRowIndex = 0;\n                        $scope.keyboardNavColIndex++;\n                    }\n                }\n                break;\n        }\n        $scope.navigationMap[navMapKeys[$scope.keyboardNavColIndex]][$scope.keyboardNavRowIndex].focus();\n    };\n\n    /**\n     * Helper function for c.initialiseKeyboardNav\n     * Searches existing column offsets in range of currentOffset ± DELTA_OFFSET\n     * and returns index of the nearest column offset, else -1.\n     * @param {Array} columnOffsets - array of left offsets of columns\n     * @param {string} currentOffset - current element's left offset\n     * @see {@link c.initialiseKeyboardNav}\n     */\n    var columnSearch = function (columnOffsets, currentOffset) {\n        var start = 0,\n            end = columnOffsets.length - 1;\n        while (start <= end) {\n            var mid = Math.floor((start + end) / 2);\n\n            if ((Number(columnOffsets[mid]) - c.DELTA_OFFSET <= currentOffset) && (currentOffset <= Number(columnOffsets[mid]) + c.DELTA_OFFSET))\n                return mid;\n\n            else if (Number(columnOffsets[mid]) + c.DELTA_OFFSET < currentOffset)\n                start = mid + 1;\n            else\n                end = mid - 1;\n        }\n        return -1;\n    };\n\n    /**\n     * This function identifies columns from the masonry layout and stores in navigationMap object\n     */\n    c.initialiseKeyboardNav = function () {\n        $scope.navigationMap = {};\n        var allFooterLinks = $('.masonry-root').find('a');\n        for (var index = 0; index < allFooterLinks.length; index++) {\n            var currentLink = allFooterLinks.get(index);\n            if ($scope.navigationMap.hasOwnProperty(currentLink.offsetLeft))\n                $scope.navigationMap[currentLink.offsetLeft].push(currentLink);\n            else {\n                var _navKeys = Object.keys($scope.navigationMap);\n                var _currentOffset = currentLink.offsetLeft;\n                var _closestColumn = columnSearch(_navKeys, _currentOffset);\n                if (_closestColumn !== -1) {\n                    $scope.navigationMap[String(_navKeys[_closestColumn])].push(currentLink);\n                } else {\n                    $scope.navigationMap[_currentOffset] = [currentLink];\n                }\n            }\n        }\n    };\n\n    /* Util functions :: Start */\n    var isExternalLink = (function() {\n        var absoluteLinkRegx = new RegExp('^(?:[a-z]+:)?//', 'i');\n        return function(url) {\n            return (url && absoluteLinkRegx.test(url) && url.indexOf(window.location.host) == -1);\n        };\n    })();\n    function transformMenuItems(menuItems) {\n        var filteredItems = [];\n        if (menuItems)\n            menuItems.forEach(function(menuItem) {\n                if (menuItem.href) {\n                    menuItem.isExternalLink = isExternalLink(menuItem.href);\n                    filteredItems.push(menuItem);\n                }\n            });\n        return filteredItems;\n    }\n    /* Util functions :: End */\n\n    /* Mansonry Layout Utils :: Start */\n    var masonryHeight = 0;\n    var applyMasonryOnLoad = function() {\n        var masonryRoot = $('.masonry-root');\n        var noOfColumns = Math.floor(masonryRoot.innerWidth() / convertRemToPixel(minimumWidthRem()));\n        var masonryCell = masonryRoot.children();\n        var masonryCellSize = masonryCell.size();\n        var sfLogoContainer = $('.sf-logo-container');\n        \n        masonryCell.each( function(){\n                $(this).css('order', '1');\n                $(this).css('flex-basis', 'auto');\n                $(this).css('display', '');\n            });\n        if (noOfColumns < masonryCellSize) {\n            masonryRoot.css('height', 'auto');\n            masonryRoot.css('flex-direction','column');\n            masonryRoot.css('justify-content', 'flex-start');\n\n            if(noOfColumns > 1) {\n                var columns = divideMasonryCellsInColumns(masonryCell, noOfColumns);\n\n                // ...and conquer\n                var order = 0;\n                columns.forEach(function(column) {\n                    column.cells.forEach(function(cell) {\n                        cell.css('order', order++);\n                    });\n                    // set flex-basis of the last cell to fill the\n                    // leftover space at the bottom of the column\n                    // to prevent the first cell of the next column\n                    // to be rendered at the bottom of this column\n                    if (column.cells.length)\n                        column.cells[column.cells.length - 1].css('flex-basis', column.cells[column.cells.length - 1].innerHeight() + masonryHeight - column.height + 'px');\n                });\n                setTimeout(function(){\n                    columns = divideMasonryCellsInColumns(masonryCell, noOfColumns);\n                    masonryRoot.css('height', masonryHeight + 1);\n                    if (isIE) {\n                        masonryRoot.css('flex-wrap', '');\n                    }\n                });\n            }\n        } else {\n            masonryRoot.css('height', 'auto');\n            masonryRoot.css('flex-direction','row');\n\n            // Space all cells evenly\n            if(isIE){\n              masonryRoot.css('display', 'flex');\n              masonryRoot.css('flex-wrap', 'nowrap');\n            }\n            $('.masonry-cell').each( function(){\n                $(this).css('order', '1');\n                $(this).css('flex-basis', 'auto');\n\n                // Space all cells evenly\n                $(this).css('flex-basis', 100/(masonryCellSize) + '%');\n                if(isIE){\n                  $(this).css('display', 'block');\n                }\n            });\n        }\n        \n        //This overrides default behaviour for non-fixed footer when this specific widget is used\n        if(!c.data.isFooterFixed) {\n            $('.page').css('display','flex');\n            $('.page').css('flex-direction','column');\n            $('.body').css('flex','1 0 auto');\n        }\n        setTimeout(function () {\n            c.initialiseKeyboardNav();\n\n            c.HEADER_HEIGHT = parseFloat($window.getComputedStyle($('header')[0]).height);\n            c.FOOTER_HEIGHT = parseFloat($window.getComputedStyle($('footer')[0]).height);\n            $('main.body').css('min-height', 'calc(100vh - ' + (c.HEADER_HEIGHT + c.FOOTER_HEIGHT) + 'px)');\n        });\n\n        $('footer').attr({\n            'role': 'contentinfo',\n            'aria-label': 'Employee Center Footer',\n            'tabindex': '-1'\n        });\n\n        $('footer').focus(function () {\n            $('footer').attr({\n               'style': 'border:none;box-shadow:none;'\n            });\n        });\n\n        $('footer').blur(function () {\n            $('footer').removeAttr('style');\n        });\n    };\n\n    function divideMasonryCellsInColumns(masonryCell, noOfColumns) {\n        masonryHeight = 0;\n        var columns = Array.from(new Array(noOfColumns)).map(function(column) {\n                return {\n                    'cells': new Array(),\n                    'height': 0\n                };\n            });\n\n            masonryCell.each( function(){\n                var minHeight;\n                columns.forEach(function(column, i) {\n                    if (!i || minHeight > column.height)\n                        minHeight = column.height;\n                });\n\n                var column = columns.find(function(column) {\n                    return column.height === minHeight;\n                });\n                column.cells.push($(this));\n                column.height += $(this).innerHeight();\n                if(column.height > masonryHeight) {\n                    masonryHeight = column.height;\n                }\n            });\n        return columns;\n    }\n\n    /*\n     * Return width of navigation group based on device resolution\n     */\n    function minimumWidthRem() {\n        var minColWidth = 22;\n        if ($window.innerWidth <= 850)\n            minColWidth = 15; // if tablet resolution\n        return minColWidth;\n    }\n\n    /*\n     * Converts rem to pixel. `getComputedStyle` is supported in IE 11 as well\n     */\n    function convertRemToPixel(rem) {\n        return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);\n    }\n\n\n    // Subscribe to resize\n    var resizeWindow = function() {\n        applyMasonryOnLoad();\n    };\n    var appWindow = angular.element($window);\n    appWindow.bind('resize', _.debounce(resizeWindow, 500));\n\n    // To detect text-only zoom\n    var fontSize = getComputedStyle(document.documentElement).fontSize;\n    setInterval(function() {\n        var currentFontSize = getComputedStyle(document.documentElement).fontSize;\n        if(fontSize !== currentFontSize) {\n            fontSize = currentFontSize;\n            applyMasonryOnLoad();\n        }\n    }, 500);\n\n    /* Mansonry Layout Utils :: END */\n\n    function loadData() {\n        c.data.action = \"loadData\";\n        c.server.update();\n    }\n    $scope.$applyAsync(loadData);\n    \n    // No Footer for ViewAs Pages\n    c.evaluateFooterVisibilityForViewAs = function () {\n      var currentUrl = $location.url();\n      var params = $location.search();\n      $scope.showFooter = true;\n      if ((params && params.id && currentUrl.includes(\"ec_view_as\")))\n        $scope.showFooter = false;\n    };\n    \n    $scope.$on('sp_loading_indicator', function(e, value) {\n      $scope.loadingIndicator = value;\n      // Evaluate footer visibility once the page has completed loading.\n      if(!value)\n        c.evaluateFooterVisibilityForViewAs();\n    });\n};","sys_created_on":"2021-06-10 05:40:47","sys_name":"Employee Center Footer","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"id":"employee-center-footer","field_list":"","sys_created_by":"admin","static":"true","sys_mod_count":"742","demo_data":"","option_schema":"","sys_tags":"","script":"(function() {\n  /* populate the 'data' object */\n  /* e.g., data.table = $sp.getValue('table'); */\n\n    if (input && input.action == \"loadData\") {\n        data.footer = new sn_ex_sp.EmployeeCenterFooterUtil().getFooterDetails($sp);\n        data.isFooterFixed = new sn_ex_sp.EmployeeCenterFooterUtil().isFooterFixed($sp.getPortalRecord().sys_id + '');\n  }\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"servicenow":"false","sys_update_name":"sp_header_footer_ce046d5773603010c94f54eb7df6a7ec","data_table":"sp_instance","name":"Employee Center Footer","category":"custom","controller_as":"c","sys_policy":""},{"template":"<!-- Nav bar menu items starts-->\n<nav class=\"navbar-inverse\" aria-label=\"Primary\" role=\"navigation\" ng-if=\"!showViewAsHeader\">\n\n  <!-- Piece above searchbar -->\n  <div class=\"clearfix\">\n    <div class=\"navbar-header nav-container\" ng-class=\"{'nav-mobile' : showMobileMenuOnDesktop || mobileDevice}\">\n\n      <!-- Logo -->\n      <a class=\"navbar-brand\" ng-if=\"::!portal.logo\" href=\"?id={{::portal.homepage_dv}}\" aria-label=\"{{::portal.title}}\"><span>{{::portal.title}}</span></a>\n\t    <a class=\"navbar-brand navbar-brand-logo\"\n           ng-if=\"::portal.logo\" href=\"?id={{::portal.homepage_dv}}\"\n           aria-label=\"{{::portal.title}} - ${Home Page}\"\n           data-toggle=\"tooltip\"\n           data-placement=\"bottom\"\n           data-title=\"{{::portal.title}} - ${Home Page}\">\n        <img ng-src=\"{{::portal.logo}}\" alt=\"{{::portal.title}} - ${Home Page}\"/>\n      </a>\n\n      <!-- Search Bar Desktop -->\n      <div ng-class=\"mobileDevice ? 'header-search-mobile' : 'header-search'\" ng-show=\"showSearchBar && !mobileDevice\">\n        <sp-widget widget=\"data.typeahead\"></sp-widget>\n      </div>\n\n      <div ng-if=\"!(showMobileMenuOnDesktop || mobileDevice)\" class=\"hidden-xs sp-loading-indicator la-sm\" role=\"presentation\" ng-class=\"{'invisible': !loadingIndicator}\">\n          <div></div>\n          <div></div>\n          <div></div>\n      </div>\n\n      <div ng-if=\"data.showSparkle\">\n        <sp-widget widget=\"data.sparkle\"></sp-widget>\n      </div>\n\n      <!-- Esc Notifications Bell widget -->\n      <div ng-if=\"data.isNotificationsActive && (showMobileMenuOnDesktop || mobileDevice)\" class=\"main-header-item\">\n        <sp-widget widget=\"data.notificationsBellWidget\"></sp-widget>\n      </div>\n\n      <!-- Mobile Navigation View -->\n      <div class=\"mobile-top-navigation\" ng-if=\"showMobileMenuOnDesktop || mobileDevice\">\n        <!-- Toggle Button (Hamburger Menu for Mobile View) -->\n        <button type=\"button\" \n                class=\"sub-navbar-overflow-entry-button\"\n                ng-class=\"isMobileViewOnDesktopExpanded ? 'close-icon-visible' : ''\"\n                aria-label=\"{{isMobileViewOnDesktopExpanded ? '${Hide menu}' : '${Show menu}'}}\" \n                aria-expanded=\"{{isMobileViewOnDesktopExpanded}}\" \n                data-toggle=\"tooltip\"\n                data-placement=\"auto bottom\"\n                data-original-title=\"{{isMobileViewOnDesktopExpanded ? '${Hide Menu}' : '${Show Menu}'}}\"\n                ng-click=\"toggleMobileMenuVisibility($event)\">\n          <div ng-if=\"!isMobileViewOnDesktopExpanded\">\n\t     <!-- showing count as '9+' when the count is more than '9' -->\n             <span class=\"label label-as-badge label-primary\">{{((data.mobileViewTodoCount + cartItemCount + data.assetAttestaionCount) > 9) ? '9+' : (data.mobileViewTodoCount + cartItemCount + data.assetAttestaionCount) }}</span>\n             <span class=\"icon-bar\"></span>\n             <span class=\"icon-bar\"></span>\n             <span class=\"icon-bar\"></span>\n          </div>\n          <i class=\"fa fa-close\" ng-if=\"isMobileViewOnDesktopExpanded\"></i>\n        </button>\n\n        <div class=\"mobile-view-on-desktop\"\n             ng-class=\"mobileDevice && showSearchBar ? 'search-visible' : ''\"\n             ng-show=\"isMobileViewOnDesktopExpanded\"\n             ng-click=\"handleMobileViewClick($event)\"\n             role=\"presentation\">\n            <div class=\"height-adjust\">\n               <ul class=\"mobile-view-navbar\">\n                 <!-- Mega Menu & Login functionality (Mobile View) -->\n                 <li class=\"mobile-mega-menu-entry\">\n                    <sp-widget widget=\"data.escNavigation\"></sp-widget>\n                    <ul ng-if=\"::(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)\" class=\"nav navbar-nav\">\n                       <li><a href ng-click=\"openLogin()\">${Login}</a></li>\n                    </ul>\n                 </li>\n                 <li>\n                   <div class=\"main-header-items header-nav-item\" ng-if=\"!showMobileMegaMenu\">\n                    <div class=\"main-header-item\" ng-if=\"data.showAssets\">\n                       <a class=\"header-item\" href=\"?id=my_assets\" id=\"assets\" aria-label=\"${My Assets}, {{c.attestaionCountTranslation}}\">\n                        <span ng-bind-html=\"'${My Assets}'\" aria-hidden=\"true\"></span>\n                        <span ng-show=\"data.assetAttestaionCount\" class=\"label label-as-badge label-primary\">{{data.assetAttestaionCount}}</span>\n                       </a>\n                     </div>\n                     <div class=\"main-header-item\" ng-if=\"data.showTodos\">\n                       <a class=\"header-item\" href=\"?id=hrm_todos_page\" id=\"todos_mobile\" aria-label=\"${My Tasks}, {{c.todoCountTranslation}}\">\n                         <span ng-bind-html=\"'${My Tasks}'\" aria-hidden=\"true\"></span>\n                         <span ng-show=\"data.todoCount\" class=\"label label-as-badge label-primary\">{{data.todoCount}}</span>\n                       </a>\n                     </div>\n                     <div class=\"main-header-item\" ng-if=\"data.showRequests\">\n                       <a class=\"header-item\" href=\"?id=my_requests\" id=\"requests_mobile\" aria-label=\"${My Requests}\">\n                        <span ng-bind-html=\"'${My Requests}'\" aria-hidden=\"true\"></span>\n                        <span ng-show=\"data.requestCount\" class=\"label label-as-badge label-primary\">{{data.requestCount}}</span>\n                       </a>\n                     </div>\n                     <div class=\"main-header-item\" ng-if=\"data.isFavoritesEnabled\">\n                       <a class=\"header-item\" href=\"?id=favorites_list\" id=\"favorites_mobile\" aria-label=\"${My Favorites}\">\n                        <span ng-bind-html=\"'${My Favorites}'\" aria-hidden=\"true\"></span>\n                       </a>\n                     </div>\n                     <!-- Experience Feedback Header Menu item widget -->\n                     <div class=\"main-header-item\" ng-if=\"showMobileMenuOnDesktop && exFeedbackActive\">\n                       <sp-widget widget=\"data.headerFeedbackWidget\"></sp-widget>\n                     </div>\n                     <div class=\"main-header-item\" ng-if=\"data.showMoreItems\" ng-repeat=\"item in data.moreItems\">\n                       <a ng-if=\"item.label !== item.shortLabel\"\n                          href=\"{{item.href}}\"\n                          data-toggle=\"tooltip\"\n                          data-placement=\"bottom\"\n                          data-original-title=\"{{item.label}}\"\n                          aria-label=\"{{item.label}}\"\n                          class=\"header-item\">\n                          <span ng-bind-html=\"item.shortLabel\" aria-hidden=\"true\"></span>\n                       </a>\n                       <a ng-if=\"item.label === item.shortLabel\"\n                          href=\"{{item.href}}\"\n                          aria-label=\"{{item.label}}\"\n                          class=\"header-item\">\n                          <span ng-bind-html=\"item.shortLabel\" aria-hidden=\"true\"></span>\n                       </a>\n                     </div>\n                     <!-- Cart, tours, and Wishlist (Mobile View) -->\n                     <div>\n                        <sp-widget widget=\"data.top.menu\" id=\"menu_item\"></sp-widget>\n                     </div>\n                   </div>\n                 </li>\n                 <li class=\"separator\" ng-if=\"!showMobileMegaMenu\"></li>\n                 <li class=\"m-l-sm main-header-item\" ng-if=\"c.data.voluntarySurveyIsActive\">\n                   <widget id=\"listening_posts_give_feedback_mega_menu\"></widget>\n                 </li>\n                 <li class=\"separator\" ng-if=\"!showMobileMegaMenu && c.data.voluntarySurveyIsActive\"></li>\n                 <!-- User Profile -->\n                 <li class=\"m-t-sm m-b-sm header-nav-item user-name\" ng-if=\"!showMobileMegaMenu\">\n                    <a href=\"{{data.link}}\" ng-class=\"getClass(data.link)\" aria-label=\"{{user.name}} ${profile}\">\n                      <span class=\"navbar-avatar\"><sn-avatar class=\"avatar-small-medium\" show-presence=\"false\" primary=\"user.sys_id\" /></span>\n                      <span>{{user.name}}</span>\n                    </a>\n                 </li>\n               </ul>\n               <!-- Avatar (User profile Dropdown) with only Impersonate & Logout options -->\n               <div class=\"impersonate-and-logout header-nav-item\" ng-if=\"!showMobileMegaMenu\">\n                 <sp-widget widget=\"data.avatarDropDown\"></sp-widget>\n               </div>\n          </div>\n        </div>\n      </div>\n\n      <div ng-class=\"mobileDevice ? 'header-search-mobile' : 'header-search'\" ng-show=\"showSearchBar && mobileDevice\">\n        <sp-widget widget=\"data.typeahead\"></sp-widget>\n      </div>\n      \n      <!-- Header Navbar -->\n      <div ng-if=\"!(showMobileMenuOnDesktop || mobileDevice)\" class=\"navbar-right\">\n        <div class=\"height-adjust header-group\" aria-label=\"${Header menu}\">\n          <div class=\"nav navbar-nav header-menu\">\n            <div class=\"gt-menu-item\" ng-if=\"data.showAssets\">\n                <a href=\"?id=my_assets\" id=\"assets\" aria-label=\"${My Assets}, {{c.attestaionCountTranslation}}\">\n                    <span ng-bind-html=\"'${My Assets}'\" aria-hidden=\"true\"></span>\n                    <span ng-show=\"data.assetAttestaionCount\" class=\"label label-as-badge label-primary\">{{data.assetAttestaionCount}}</span>\n                </a>\n            </div>\n            <div class=\"gt-menu-item\" ng-if=\"data.showTodos\">\n              <a href=\"?id=hrm_todos_page\" ng-class=\"getClass('?id=hrm_todos_page')\" id=\"todos_link\"  aria-label=\"${My Tasks}, {{c.todoCountTranslation}}\">\n                <span ng-bind-html=\"'${My Tasks}'\"></span>\n                <span ng-show=\"data.todoCount\" class=\"label label-as-badge label-primary\">{{data.todoCount}}</span>\n              </a>\n            </div>\n            <div class=\"gt-menu-item\" ng-if=\"data.showRequests\">\n              <a href=\"?id=my_requests\" id=\"cases_popup\" aria-label=\"${My Requests}\"> <!-- TODO: Link for requests -->\n                <span ng-bind-html=\"'${My Requests}'\" aria-hidden=\"true\"></span>\n                <span ng-show=\"data.requestCount\" class=\"label label-as-badge label-primary\">{{data.requestCount}}</span>\n              </a>\n            </div>\n            <div class=\"gt-menu-item\" ng-if=\"data.isFavoritesEnabled\">\n               <a href=\"?id=favorites_list\" id=\"favorites\" aria-label=\"${My favorites}\"> \n                 <span ng-bind-html=\"'${My Favorites}'\" aria-hidden=\"true\"></span>\n           \t   </a>         \n            </div>\n            <!-- Esc Notifications Bell Menu item widget -->\n            <div ng-if=\"data.isNotificationsActive\" class=\"main-header-item\">\n              <sp-widget widget=\"data.notificationsBellWidget\"></sp-widget>\n            </div>\n            <div class=\"gt-menu-item more-menu-position\" id=\"more-items\" ng-if=\"data.showMoreItems\">\n              <a ng-if=\"(data.moreItems.length === 1) && (data.moreItems[0].label !== data.moreItems[0].shortLabel)\"\n                 href=\"{{data.moreItems[0].href}}\"\n                 target=\"{{data.moreItems[0].url_target}}\"\n                 data-toggle=\"tooltip\"\n                 data-placement=\"bottom\"\n                 data-original-title=\"{{data.moreItems[0].label}}\"\n                 aria-label=\"{{data.moreItems[0].label}}\">\n                <span ng-bind-html=\"data.moreItemsTitle\" aria-hidden=\"true\"></span>\n              </a>\n              <a ng-if=\"(data.moreItems.length === 1) && (data.moreItems[0].label === data.moreItems[0].shortLabel)\"\n                 href=\"{{data.moreItems[0].href}}\"\n                 target=\"{{data.moreItems[0].url_target}}\"\n                 ng-click=\"navEvent($event, data.moreItems[0].href)\"\n                 aria-label=\"{{data.moreItems[0].label}}\">\n                <span ng-bind-html=\"data.moreItemsTitle\" aria-hidden=\"true\"></span>\n              </a>\n              <a href\n                 ng-if=\"data.moreItems.length > 1\"\n                 id=\"more-items-button\"\n                 aria-haspopup=\"true\"\n                 data-toggle=\"dropdown\"\n                 data-target=\"more-items-dropdown\"\n                 data-placement=\"bottom\"\n                 aria-label=\"{{data.moreItemsTitle}}\" role=\"button\">\n                <span ng-bind-html=\"data.moreItemsTitle\" aria-hidden=\"true\"></span>\n                <span class=\"fa collapse-margin m-l-xs fa-caret-down\"></span>\n              </a>\n              <ul id=\"more-items-dropdown\" ng-if=\"data.moreItems.length > 1\" class=\"dropdown-menu\"\n                  aria-label=\"{{data.moreItemsTitle}}\">\n                <li role=\"presentation\"\n                    ng-repeat=\"item in data.moreItems\"\n                    class=\"ng-scope dropdown-menu-line header-menu-item\">\n                  <a ng-if=\"item.label !== item.shortLabel\"\n                     href=\"{{item.href}}\"\n                     target=\"{{item.url_target}}\"\n                     data-toggle=\"tooltip\"\n                     data-placement=\"bottom\"\n                     data-original-title=\"{{item.label}}\"\n                     aria-label=\"{{item.label}}\">\n                    <span ng-bind-html=\"item.shortLabel\" aria-hidden=\"true\"></span>\n                  </a>\n                  <a ng-if=\"item.label === item.shortLabel\"\n                     href=\"{{item.href}}\"\n                     target=\"{{item.url_target}}\"\n                     aria-label=\"{{item.label}}\">\n                    <span ng-bind-html=\"item.shortLabel\" aria-hidden=\"true\"></span>\n                  </a>\n                </li>\n              </ul>\n            </div>\n          </div>\n          <!-- Avatar and its drop down (Desktop) -->\n          <div class=\"avatar-drop-down gt-menu-item\" role=\"presentation\">\n            <sp-widget widget=\"data.avatarDropDown\" id=\"avatar_drop_down\" ></sp-widget>\n          </div>\n          <!-- Cart, tours, and Wishlist -->\n          <div class=\"gt-menu-item\" role=\"presentation\">\n            <sp-widget widget=\"data.top.menu\" id=\"menu_item\"></sp-widget>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- LP Voluntary Feedback Widget-->\n    <div ng-if=\"!(showMobileMenuOnDesktop || mobileDevice) && c.data.voluntarySurveyIsActive\">\n      <widget id=\"listening_posts_voluntary_feedback\"></widget>\n    </div>\n    \n  </div>\n  \n  <!-- Sub Navbar on Desktop -->\n  <div class=\"navbar-collapse sub-navbar clearfix collapse collapsed hidden-xs\"\n       ng-class=\"{ 'in': expanded, 'collapsed': !expanded, 'sub-navbar--mobile-view': showMobileMenuOnDesktop }\">\n    <div>\n      <sp-widget widget=\"data.escNavigation\"></sp-widget>\n      <ul ng-if=\"::(!user.logged_in && page.id != portal.login_page_dv && !data.hasLogin)\" class=\"nav navbar-nav\">\n        <li><a href ng-click=\"openLogin()\">${Login}</a>\n        </li>\n      </ul>\n\n    </div>\n  </div>\n\n  <!-- Analytics -->\n  <div ng-if=\"data.analyticsSupportEnabled\">\n    <widget id=\"cda-site-analytics\" options=\"{'enable_logging': false}\"></widget>\n  </div>\n</nav>\n\n\n<nav class=\"navbar-inverse\" aria-label=\"Primary\" role=\"navigation\" ng-if=\"showViewAsHeader\">\n    <div class=\"clearfix\">\n      <div class=\"navbar-header nav-container\">\n\n      <!-- Logo -->\n        <a class=\"navbar-brand\" ng-if=\"::!portal.logo\" href=\"?id=ec_view_as_search&viewAs=true\" aria-label=\"${Employee Center View As Home}\"><span>${Employee Center View As Home}</span></a>\n        <a class=\"navbar-brand navbar-brand-logo \"\n           ng-if=\"::portal.logo\" href=\"?id=ec_view_as_search&viewAs=true\"\n           aria-label=\"{{::portal.title}}${ - View As Home Page}\"\n           data-toggle=\"tooltip\"\n           data-placement=\"bottom\"\n           data-title=\"{{::portal.title}}${ - View As Home}\">\n        <img ng-src=\"{{::portal.logo}}\" alt=\"{{::portal.title}}${ - View As Home Page}\"/>\n      </a>\n      </div>\n  </div>\n</nav>\n\n <!-- Experience Feedback Widget-->\n    <div ng-if=\"!(showMobileMenuOnDesktop || mobileDevice) && exFeedbackActive\">\n      <sp-widget widget=\"data.modalWidget\"></sp-widget>\n    </div>\n<sp-widget widget=\"c.data.perfWidget\"></sp-widget>","css":"$sp-box-shadow--md: 0 4px 8px 0 rgba(56, 56, 56, 0.25) !default;\n\n@mixin -link-hover {\n  cursor: pointer;\n  background-color: darken($navbar-inverse-bg, 5%);\n  border-radius: $border-radius-base;\n  color: $navbar-inverse-link-hover-color;\n}\n\n@mixin -link-focus {\n  outline: 1.5px solid $navbar-inverse-link-color;\n  border: none;\n  border-radius: $border-radius-base;\n  box-shadow: inset 0 0 0 0.1rem #fff;\n  background-color: darken($navbar-inverse-bg, 10%);\n  color: $navbar-inverse-link-hover-color;\n}\n\n@mixin -link-decoration {\n  text-decoration: underline;\n  text-decoration-color: $navbar-inverse-link-color;\n  text-decoration-style: solid;\n  text-decoration-thickness: 1.5px;\n  text-underline-offset: 2px;\n}\n\n@mixin -focus-visible-mouse-ua {\n  border: none;\n  outline: none;\n  box-shadow: none;\n}\n\n@mixin -focus-visible-keyboard-ua {\n  outline: 1.5px solid $navbar-inverse-link-color;\n  border: none;\n  border-radius: $border-radius-base;\n  box-shadow: inset 0 0 0 0.1rem #fff;\n}\n\n.header-item {\n  text-decoration: none;\n  color: $navbar-inverse-link-color;\n  padding: $sp-space--md;\n  display:list-item;\n}\n\n.loading-indicator {\n  padding-top: $sp-space--xl;\n  margin-top: $sp-space--xxs;\n}\n\n.header-menu {\n  display: flex;\n  flex-direction: row;\n  line-height: 3.7;\n}\n\n.gt-menu-item>a {\n  text-decoration: none;\n  color: $navbar-inverse-link-color;\n  padding: 19px 10px;\n}\n\n.more-menu-position {\n  position: relative;\n}\n\n.navbar-inverse {\n  margin-bottom: 0px;\n  border-radius: 0px;\n  background-color: $navbar-inverse-bg;\n  position: relative;\n\n  .navbar-header {\n    &.nav-container {\n      width: 100%;\n      display: flex;\n      flex-wrap: wrap;\n      justify-content: end;\n\n      .sub-navbar-overflow-entry-button {\n        position: relative;\n        float: right;\n        margin: 1.3rem 1.5rem 1.3rem 0;\n        padding: .9rem 1rem;\n        background-color: transparent;\n        background-image: none;\n        border: .1rem solid transparent;\n        border-radius: .4rem;\n        border-color: rgba($navbar-inverse-link-color, .25);\n\n        .label {\n          float: right;\n          margin-right: -.5rem;\n          margin-top: -.7rem;\n          padding: .2em .5em .2em;\n        }\n\n        .label-as-badge {\n          font-size: 1.2rem;\n          position: relative;\n          top: -$sp-space--xxs;\n          left: $sp-space--xxs;\n          padding: $sp-space--xxs 5px;\n          margin-left: 0;\n          background-color: $btn-danger-bg;\n          color: $text-white;\n        }\n\n        .icon-bar {\n          display: block;\n          width: 2.2rem;\n          height: .2rem;\n          border-radius: .1rem;\n          background-color: $navbar-inverse-link-color;\n        }\n\n        .icon-bar+.icon-bar {\n          margin-top: .4rem;\n        }\n\n        &.close-icon-visible {\n          margin-bottom: 0;\n          padding: 0.6rem 1rem;\n        }\n\n        .fa.fa-close {\n          vertical-align: -6%;\n          font-size: 20px;\n          width: 22px;\n          color: $navbar-inverse-link-color;\n        }\n      }\n    }\n\n    .gt-menu-item>a,\n    .gt-menu-item>div>ul>li>a,\n    .navbar-nav>li>a {\n      &:hover {\n        @include -link-hover;\n      }\n\n      &:focus {\n        @include -link-focus;\n      }\n\n      &:focus:not(:focus-visible) {\n        @include -focus-visible-mouse-ua;\n      }\n\n      &:focus-visible {\n        @include -focus-visible-keyboard-ua;\n      }\n    }\n    .navbar-nav>.open>a {\n      @include -link-focus;\n    }\n\n    .mobile-view-on-desktop {\n      top: 60px;\n      position: absolute;\n      right: 0;\n      z-index: 1001; // keep it bigger than 1000 - DEF0360746\n      min-height: 600px;\n      max-width: 400px;\n      background-color: $navbar-inverse-bg;\n      box-shadow: $sp-box-shadow--md;\n\n      .mobile-view-navbar {\n        list-style: none;\n        padding: 0 8px;\n        margin: 0;\n        display: flex;\n        flex-direction: column;\n\n        .main-header-items {\n          padding-inline-start: 0.4rem !important;\n          padding-inline-end: 0.4rem !important;\n          list-style: none;\n          padding-top: 11px;\n          margin: 0;\n          display: flex;\n          flex-direction: column;\n\n          &>li>div>ul, &>div>div>ul {\n            width: 100%;\n\n            &>li, &>div>a {\n              width: 100%;\n\n              &>a>span {\n\n                &:hover {\n                  @include -link-hover;\n                }\n\n                &:focus {\n                  @include -link-focus;\n                }\n\n                &:focus:not(:focus-visible) {\n                  @include -focus-visible-mouse-ua;\n                }\n\n                &:focus-visible {\n                  @include -focus-visible-keyboard-ua;\n                }\n              }\n            }\n          }\n\n          &>li>a, &>ul>li>a, &>div>a {\n            display: block;\n            padding: $sp-space--md;\n\n            &:hover {\n              @include -link-hover;\n\n              &>a {\n                color: $navbar-inverse-link-hover-color;\n              }\n            }\n\n            &:focus {\n              @include -link-focus;\n            }\n\n            &:focus:not(:focus-visible) {\n              @include -focus-visible-mouse-ua;\n            }\n\n            &:focus-visible {\n              @include -focus-visible-keyboard-ua;\n            }\n\n            // Cart, tours, and Wishlist (Mobile View)\n            .nav.navbar-nav {\n              display: flex;\n              flex-direction: column;\n            }\n          }\n        }\n\n        .mobile-mega-menu-entry {\n          margin: 0 -8px;\n          border-bottom: 1px solid darken($sp-navbar-divider-color, 15%)\n        }\n\n        .separator {\n          margin: 20px -8px;\n          border-top: 1px solid darken($navbar-inverse-bg, 15%);\n        }\n\n        li>a {\n          color: $navbar-inverse-link-color;\n\n          &:hover {\n            @include -link-hover;\n          }\n\n          &:focus {\n            @include -link-focus;\n          }\n\n          &:focus:not(:focus-visible) {\n            @include -focus-visible-mouse-ua;\n          }\n\n          &:focus-visible {\n            @include -focus-visible-keyboard-ua;\n          }\n        }\n\n        li.user-name {\n          margin: 0 0.4rem 0 0.4rem;\n\n          &>a {\n            display: block;\n            padding: 0 $sp-space--md;\n            height: $sp-space--xl * 2;\n\n            &>span.navbar-avatar {\n              line-height: $sp-space--sm * 7;\n            }\n\n            &>span:not(.navbar-avatar) {\n              line-height: 4.5rem;\n            }\n          }\n\n          &:hover {\n            @include -link-hover;\n\n            &>a {\n              color: $navbar-inverse-link-hover-color;\n            }\n          }\n\n          &:focus {\n            @include -link-focus;\n          }\n\n          &:focus:not(:focus-visible) {\n            @include -focus-visible-mouse-ua;\n          }\n\n          &:focus-visible {\n            @include -focus-visible-keyboard-ua;\n          }\n        }\n      }\n\n      .impersonate-and-logout {\n        div>ul>li:first-child {\n          & > a#profile-dropdown {\n            display: none;\n          }\n\n          ul.dropdown-menu {\n            width: 400px;\n            display: block;\n            z-index: inherit;\n            background-color: $navbar-inverse-bg;\n            box-shadow: none;\n            border-radius: 0;\n            padding-left: 2px;\n            padding-bottom: 16px;\n\n            li>a {\n              margin: 0 $sp-space--md 0 $sp-space--md;\n              padding: $sp-space--md;\n\n              &:hover {\n                @include -link-hover;\n\n                &>a {\n                  color: $navbar-inverse-link-hover-color;\n                }\n              }\n\n              &:focus {\n                @include -link-focus;\n\n                &>a {\n                  border: none;\n                  box-shadow: none;\n                }\n              }\n\n              &:focus:not(:focus-visible) {\n                @include -focus-visible-mouse-ua;\n              }\n\n              &:focus-visible {\n                @include -focus-visible-keyboard-ua;\n              }\n            }\n\n            li:first-child {\n              display: none;\n            }\n          }\n        }\n\n        div>ul>li>a {\n          margin: 0 $sp-space--md 0 $sp-space--md;\n          padding: $sp-space--md;\n\n          &:hover {\n            @include -link-hover;\n\n            &>a {\n              color: $navbar-inverse-link-hover-color;\n            }\n          }\n\n          &:focus {\n            @include -link-focus;\n\n            &>a {\n              border: none;\n              box-shadow: none;\n            }\n          }\n\n          &:focus:not(:focus-visible) {\n            @include -focus-visible-mouse-ua;\n          }\n\n          &:focus-visible {\n            @include -focus-visible-keyboard-ua;\n          }\n        }\n      }\n\n      .navbar-nav {\n        li {\n          width: 100%;\n        }\n      }\n\n      .dropdown-menu {\n        position: relative;\n        width: 100%;\n      }\n\n      .empty-dropdown {\n        margin-top: $sp-space--lg;\n      }\n\n    }\n\n    .mobile-view-on-desktop.search-visible {\n      top: 113px;\n      position: absolute;\n      right: 0;\n      width: 100%;\n      /* To prevent Mega menu panel in hamburger view from growing beyond footer */\n      max-height: 100vh;\n      overflow-y: auto;\n      z-index: 1001; // keep it bigger than 1000 - DEF0360746\n      padding: 10px 0px;\n      margin-bottom: 10px;\n    }\n\n    .navbar-brand {\n      margin: 0;\n      margin-right: auto;\n      height: 60px;\n      padding: $sp-logo-margin-y 0px 10px $sp-logo-margin-x;\n\n      img,\n      span {\n        margin: 0;\n        display: block;\n        max-height: $sp-logo-max-height;\n        max-width: $sp-logo-max-width;\n        position: relative;\n        top: 50%;\n        -webkit-transform: translateY(-50%);\n        -ms-transform: translateY(-50%);\n        transform: translateY(-50%);\n      }\n    }\n\n    .navbar-right .dropdown-menu>li>a {\n      &:hover {\n        @include -link-hover;\n        @include -link-decoration;\n      }\n\n      &:focus {\n        @include -link-focus;\n        @include -link-decoration;\n      }\n\n      &:focus:not(:focus-visible) {\n        @include -focus-visible-mouse-ua;\n      }\n\n      &:focus-visible {\n        @include -focus-visible-keyboard-ua;\n      }\n    }\n  }\n\n  .dropdown-menu>li>a {\n    color: $navbar-inverse-link-color;\n  }\n\n  .dropdown-toggle:focus {\n    outline: thin dotted;\n    outline: 5px auto -webkit-focus-ring-color;\n  }\n\n  .sub-navbar {\n    background-color: $sp-navbar-divider-color;\n    border: none;\n    width: 100%;\n\n    #cart-dropdown,\n    #wishlist-menu {\n      display: none;\n\n      ~* {\n        display: none !important;\n      }\n    }\n\n    .navbar-nav>li>a[href=\"?id=sc_cart\"],\n    .navbar-nav>li>a[href=\"?id=sc_wishlist\"] {\n      display: none !important;\n    }\n\n    .gtd-dropdown-container {\n      display: none;\n    }\n\n    .open>a,\n    .open>a:focus {\n      background-color: darken($sp-navbar-divider-color, 8%);\n    }\n\n    #cart-dropdown {\n      display: none;\n\n      :after {\n        content: \"\\f0d7\";\n        vertical-align: baseline;\n        width: auto;\n        height: auto;\n        border: none;\n        margin-left: 5px !important;\n        display: inline-block;\n        font: normal normal normal 14px/1 FontAwesome;\n        font-size: inherit;\n        text-rendering: auto;\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n      }\n    }\n\n    .dropdown-menu {\n      background-color: $sp-navbar-divider-color;\n\n      >li>a:hover,\n      >li>a:focus {\n        background-color: darken($sp-navbar-divider-color, 8%);\n      }\n    }\n  }\n\n  .dropdown-menu {\n    background-color: rgba($navbar-inverse-bg, 0.97);\n    border: none;\n\n    &.case-menu {\n      right: 0;\n      left: auto;\n      padding: 0;\n      width: 450px;\n      background: $color-lightest;\n      overflow-y: hidden;\n    }\n  }\n\n  >.open>a:hover,\n  >.open>a:focus {\n    background-color: darken($navbar-invese-bg, 8%);\n  }\n\n  .fa-caret-down {\n    vertical-align: middle;\n    margin-top: 2px;\n  }\n\n  .caret:before {\n    content: \"\\f0d7\";\n  }\n\n  .caret {\n    vertical-align: baseline;\n    width: auto;\n    height: auto;\n    border: none;\n    margin-left: 5px !important;\n    display: inline-block;\n    font: normal normal normal 14px/1 FontAwesome;\n    font-size: inherit;\n    text-rendering: auto;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n\n  .label-as-badge {\n    font-size: 1.2rem;\n    position: relative;\n    top: -$sp-space--sm;\n    left: -$sp-space--xxs;\n    padding: 1px 5px;\n    margin-left: 0;\n    background-color: $btn-danger-bg;\n    color: $text-white;\n  }\n\n  .navbar {\n    transition: 250ms opacity ease-in-out;\n    -webkit-transition: 250ms opacity ease-in-out;\n    border: 0;\n  }\n\n  .navbar-fade {\n    opacity: 0.4;\n  }\n\n  .navbar-collapse {\n    padding-right: 0px;\n  }\n\n  .case-menu {\n    div#widget-tabs-2 {\n      border: none;\n\n      >.panel-heading {\n        border: none;\n        border-bottom: 1px solid $border;\n      }\n    }\n  }\n\n  ul.nav.navbar-nav {\n\n    // Hiding the loading indicator from Header Menu base system widget\n    div.header-loader {\n      display: none;\n    }\n  }\n\n  #more-items-dropdown {\n    overflow: visible;\n  }\n\n  .cart-dropdown,\n  .wishlist-menu,\n  .gtd-dropdown-container .empty-dropdown {\n    width: 350px;\n    padding: 0;\n    z-index: 1000;\n    border-top-left-radius: 4px !important;\n    border-top-right-radius: 4px !important;\n\n    ul {\n      max-height: 300px;\n      overflow: auto;\n    }\n\n    .subtotal {\n      display: block;\n    }\n\n    .item-image {\n      padding: 0;\n      margin: 0;\n      text-align: center;\n      max-width: 100%;\n      height: auto;\n    }\n\n    label,\n    p {\n      padding: 0;\n      margin: 0;\n    }\n\n    .media {\n      padding: 0;\n      margin: 0;\n    }\n\n    .media-left>a {\n      display: block;\n      width: 48px;\n      max-width: 48px;\n    }\n\n    .media-body {\n      label {\n        font-weight: bold;\n      }\n    }\n\n    li.media {\n      border-top: 1px solid #cccccc;\n      padding: 1rem;\n    }\n\n    .panel {\n      margin: 0;\n    }\n\n    .panel .panel-body {\n      padding: 0;\n    }\n\n    .btn-clear {\n      color: #333;\n      background-color: #fff;\n    }\n\n    p.quantity-price {\n      padding-top: 0.5rem;\n\n      span {\n        color: $text-muted;\n        padding-right: 0.5rem;\n      }\n    }\n\n    .align-right {\n      text-align: right;\n    }\n  }\n\n\n  .item-added-tooltip,\n  wishlist-item-added-tooltip {\n    width: 184px;\n    font-size: 14px;\n  }\n\n  .gtd-dropdown-container {\n    .empty-tour-content {\n      text-align: center;\n      margin: 40px 20px;\n    }\n\n    .dropdown-menu li {\n      a {\n        cursor: pointer;\n      }\n\n      min-width: 20em;\n    }\n\n    .label-as-badge {\n      width: 12px;\n      height: 12px;\n      display: inline-block;\n      padding: 0px;\n      padding-top: 2px;\n    }\n\n    .badge-container {\n      display: inline-block;\n      width: 12px;\n    }\n  }\n\n}\n\n.header-group {\n  display: flex;\n  flex-direction: row;\n}\n\n.nav-mobile {\n  border-bottom: 1px solid darken($sp-navbar-divider-color, 15%);\n}\n\n@media screen and (min-width: 768px) {\n  .navbar-inverse {\n    .navbar-right>.navbar-nav>div {\n      float: left;\n    }\n\n    .navbar-right {\n      display: flex;\n      flex-direction: row-reverse;\n      margin-right: 10px;\n\n      >ul {\n        display: -webkit-box;\n        display: -moz-box;\n        display: box;\n\n        -moz-box-orient: horizontal;\n        box-orient: horizontal;\n        -webkit-box-orient: horizontal;\n      }\n\n      .navbar-nav>li>a {\n        padding-right: 10px;\n        padding-left: 10px;\n      }\n    }\n\n    .navbar-avatar {\n      margin-top: -7px;\n    }\n\n    a#todos_popup {\n      padding-left: 0px;\n    }\n\n    .navbar-nav .open .dropdown-menu>li>a {\n      margin: 0 $sp-space--sm 0 $sp-space--sm;\n      padding: 10px 20px;\n    }\n\n    .navbar-header {\n      position: relative;\n\n      .dropdown-toggle {\n        height: 60px;\n      }\n    }\n\n    .temp-mobile {\n      display: inline-block;\n    }\n\n    .sub-navbar {\n      display: flex;\n      padding-left: 0;\n    }\n\n    .sub-navbar--mobile-view {\n      .navigation--xs {\n        display: none;\n      }\n    }\n  }\n}\n\n.header-search-mobile {\n  margin: 1.3rem 1rem;\n  width: 100%;\n}\n\n.sp-loading-indicator {\n  padding-top: $sp-space--sm * 3;\n  margin-top: $sp-space--xxs;\n}\n\n// Search bar styles in the header (Should always be in the center)\n.header-search {\n  margin: 1.3rem 1rem;\n  width: 100%;\n  max-width: 600px;\n  min-width: 250px;\n\n  @media (max-width: 1920px) and (min-width: 1441px) {\n    max-width: 600px;\n  }\n\n  @media (max-width: 1440px) and (min-width: 1025px) {\n    max-width: 450px;\n  }\n\n  @media (max-width: 1024px) and (min-width: 768px) {\n    max-width: 350px;\n  }\n}\n\n@media all and (-ms-high-contrast: none),\n  (-ms-high-contrast: active) {\n    .navbar-inverse {\n      .mobile-top-navigation {\n        .mobile-view-on-desktop {\n          .main-header-items {\n            padding-left: .4rem;\n          }\n        }\n      }\n    }\n}\n\n@media (min-width : 320px) and (max-width : 767px) {\n  .navbar-inverse {\n    .dropdown-menu.case-menu {\n      width: 100%;\n    }\n\n    .navbar-toggle {\n      border-color: rgba(255, 255, 255, .25);\n    }\n\n    .navbar-toggle:focus {\n      -webkit-box-shadow: 0rem 0rem 0.5rem #1f8476\n    }\n\n    .navbar-nav {\n      display: block;\n      margin: 0;\n\n      .open .dropdown-menu>li>a {\n        padding: 5px 30px;\n      }\n    }\n\n    .sub-navbar {\n      padding: 0px 0px;\n    }\n\n    .upper-collapse {\n      width: 100%;\n      padding-bottom: 0px;\n    }\n\n    .navbar-collapse {\n      padding-top: 0px;\n      padding-left: 0px;\n      overflow: hidden;\n\n      ul {\n        margin: 0;\n      }\n    }\n\n    .navbar-header.nav-container {\n      .mobile-view-on-desktop {\n        min-width: 100%;\n        // max-width: 100%; is needed for 400% zoom-level in WCAG resolution\n        max-width: 100%;\n\n        .impersonate-and-logout {\n          div>ul>li:first-child {\n            & > a{\n              display: block;\n            }\n          }\n        }\n      }\n\n      >ul {\n        display: inline-block;\n        padding: 10px 10px 0 0;\n        float: right;\n        margin: 0;\n      }\n\n      >li {\n        display: inline-block;\n      }\n    }\n\n    .height-adjust {\n      padding: 10px 0px;\n      margin-bottom: 10px;\n    }\n\n    .popup-edit {\n      background: $color-lightest;\n      position: fixed;\n      top: 0;\n      height: 100%;\n      margin-top: 0;\n      max-height: 100%;\n      width: 100%\n    }\n\n    .navbar-collapse-label {\n      float: right;\n      margin-right: -5px;\n      margin-top: -7px;\n    }\n\n    button>span.label {\n      padding: .2em .5em .2em;\n    }\n  }\n}","internal":"false","roles":"","link":"function escHeaderLink(scope, element, attrs, controller) {\n    $(element).on('click', 'a.navbar-brand', function (e) {\n        scope.expanded = false;\n    });\n    //defaults for calulating width of components\n    var DEFAULT_RIGHT_NAVIGATION_SIZE = 400;\n    var DEFAULT_LOGO_SIZE  = 300;\n\n    //added these to scope so that these can be potentially used in controller\n    scope.navbarRightSize = 0;\n    scope.navbarRightFinalSize = 0\n    scope.navbarRightTop = 0;\n    scope.navbarSearchSize = 0;\n    scope.navbarSearchFinalSize = 0\n    scope.navbarSearchTop = 0;\n    scope.navLogoFinalSize = 0;\n\n    $(element).on('click.nav', '.navbar-collapse.in', function (e) {\n        var target = $(e.target);\n        if (target.is('a') && !target.hasClass(\"dropdown-toggle\") && target.siblings('.dropdown-menu').length == 0) {\n            // collapse mobile nav if clicked an anchor that isn't a dropdown toggle\n            scope.expanded = false;\n            return;\n        }\n\n        // if neither target nor parent is an anchor or the parent anchor is a dropdown-toggle, do nothing\n        if (!target.parent().is('a') || target.parent().hasClass(\"dropdown-toggle\") || target.parent().siblings('.dropdown-menu').length > 0)\n            return;\n\n        // collapse mobile nav if target is part of a submenu\n        if (target.parents(\"ul.dropdown-menu\").length > 0) {\n            scope.expanded = false;\n            return;\n        }\n\n        // collapse mobile nav is target is part of the dropdown\n        if (target.parents(\"div.navbar-collapse\").length > 0)\n            scope.expanded = false;\n    });\n    $(element).on('keydown', '.dropdown-menu > .header-menu-item', function (e) {\n        var target = e.target;\n        if (target.localName === 'a') {\n            if (e.keyCode === 37 || e.keyCode === 39) {\n                e.preventDefault();\n                $(target).parents('li').removeClass('open');\n                $(target).parents('li').find('a').focus();\n            } else if (e.keyCode === 9) {\n                $(target).parents('li').removeClass('open');\n            }\n        }\n    });\n\n  $('body').click(function (event) {\n      if ($(event.target).text().trim() != controller.toursTranslation && scope.isMobileViewOnDesktopExpanded)\n        scope.toggleMobileMenuVisibility();\n   });\n\n  // Closing mobile navigation menu after hitting Tab key on Logout option to focus on next DOM element on the page.\n  $(document).on('keydown', '.impersonate-and-logout > div > ul > li > a[href*=\"logout\"]', function (keyDownEvent) {\n     var TAB_KEY_VALUE = 'Tab';\n\n     if (keyDownEvent.key === TAB_KEY_VALUE  && !keyDownEvent.shiftKey && scope.mobileDevice) {\n        scope.$applyAsync(function () {\n         scope.toggleMobileMenuVisibility();\n        });\n     }\n  });\n\n  // this is for the fact that the impersonate and logout widget has hardcoded mobile size, and for screen width\n  // greater than 767 pixel, the impersonate and dropdown li has tabindex -1, hence handling that case to close menu.\n  $(document).on('keydown', '.impersonate-and-logout > div > ul > li', function (keyDownEvent) {\n    var TAB_KEY_VALUE = 'Tab';\n    var dropdownItems = $('.impersonate-and-logout > div > ul > li > a + ul > li > a');\n    if (dropdownItems.length > 0) {\n    //Close mega menu only if focus is at the last element of the menu and tab key is entered\n        if (document.activeElement === dropdownItems[dropdownItems.length - 1]) {\n            if (keyDownEvent.key === TAB_KEY_VALUE  && !keyDownEvent.shiftKey && (scope.mobileDevice || scope.showMobileMenuOnDesktop)) {\n                scope.$applyAsync(function() {\n                    scope.toggleMobileMenuVisibility();\n               });\n            }\n        }\n    }\n  });\n\n  // Helper function to handle the arrow key navigation in the header\n\tfunction handleKeyPressEvents(e) {\n\t\tvar target = e.target;\n\t\tvar querySelector;\n\t\tif($(this).hasClass('gt-menu-item'))\n\t\t\tquerySelector = 'li.gt-menu-item';\n\n\t\t// Only Side arrow keys should work for gt-menu-item and only vertical arrow keys should work for header-nav-item\n\t\tif(querySelector === 'li.gt-menu-item' && !(e.keyCode === 37 || e.keyCode === 39 || e.keyCode === 9))\n\t\t\t\treturn;\n\t\telse if($(this).parents('.header-nav-item').length !== 0 && !(e.keyCode === 38 || e.keyCode === 40))\n\t\t\t\treturn;\n\n\t\t//desktop view prework\n\t\tvar currentMenuItem = $(target).parents('li');\n\t\tvar parentUL = currentMenuItem.parents('ul');\n\t\tvar allMenuItems = parentUL.children(querySelector);\n\t\tvar firstMenuItem = allMenuItems.first();\n\t\tvar lastMenuItem = allMenuItems.last();\n\t\tvar menuItemToFocus;\n\n\t\tif(querySelector === 'li.gt-menu-item') {\n\t\t\tif(e.keyCode === 9) {\n\t\t\t\t$(target).parents('li').removeClass('open');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\te.preventDefault();\n\t\t\t\tcurrentMenuItem.removeClass('open');\n\t\t\t}\n\t\t}\n\n\t\t//mobile view navigation prework\n\t\tvar items = [];\n\t\tvar selectors = [];\n\t\tselectors.push('li.main-header-item>a'); //main header items -> Employee Center Header widget\n\t\tif(scope.exFeedbackActive)\n\t\t\tselectors.push('li.main-header-item>div>a.experience-feedback-header-item'); //Experience Feedback Header widget mobile menu item\n\t\tselectors.push('li.header-menu-item>a#tour-dropdown'); // Tour drop down -> EC Menu widget\n\t\tselectors.push('li.user-name>a'); // User Name -> Employee Center Header widget\n\t\tselectors.push('.impersonate-and-logout > div > ul > li > a + ul > li > a'); // Logout/Impersonate -> Profile with Drop Down widget\n\t\tselectors.push('.impersonate-and-logout li.visible-xs-block>a');\n\t\tfor (var i = 0; i < selectors.length; i++) {\n\t\t    //Dont include hidden profile button\n\t\t\tif(selectors[i] === '.impersonate-and-logout > div > ul > li > a + ul > li > a'){\n\t\t\t\titems.push($(selectors[i]).slice(1).get());\n\t\t\t}\n\t\t\telse{\n\t\t\t\titems.push($(selectors[i]).get());\n\t\t\t}\n\t\t}\n\t\titems = [].concat.apply([], items);\n\n\t\t//mobile view navigation starts\n\t\tif ($(target).parents('.header-nav-item').length) {\n\t\t\tvar index = items.indexOf($(':focus').get(0));\n\t\t\tif (e.keyCode === 40) {\n\t\t\t\te.preventDefault();\n\t\t\t\tindex = index + 1;\n\t\t\t}\n\t\t\telse if(e.keyCode === 38) {\n\t\t\t\te.preventDefault();\n\t\t\t\tif (index === 0) {\n\t\t\t\t\t$('.mega-menu-item').filter(':visible').last().focus();\n\t\t\t\t}\n\t\t\t\tindex = index - 1;\n\t\t\t}\n\t\t\tif (index < items.length && index >= 0)\n\t\t\t\titems[index].focus();\n\t\t} //else if desktop view\n\t\telse if (target.localName === 'a') {\n\t\t\tif(e.keyCode === 37) {\n\t\t\t\tvar previousMenuItem = currentMenuItem.prevAll(querySelector);\n\t\t\t\tcurrentMenuItem.prevAll(querySelector).first();\n\t\t\t\t//enable circular navigation\n\t\t\t\tmenuItemToFocus = previousMenuItem.length ? previousMenuItem : lastMenuItem;\n\t\t\t\tmenuItemToFocus.find('a').focus();\n\t\t\t} else if(e.keyCode === 39) {\n\t\t\t\tvar nextMenuItem = currentMenuItem.nextAll(querySelector).first();\n\t\t\t\t//enable circular navigation\n\t\t\t\tmenuItemToFocus = nextMenuItem.length ? nextMenuItem : firstMenuItem;\n\t\t\t\tmenuItemToFocus.find('a').focus();\n\t\t\t}\n\t\t}\n\t}\n\n\t// Handler to focus the first element of More Items dropdown on pressing Space/Enter/Down Arrow key.\n\t$(element).on('keydown', '#more-items-button', function(e) {\n\t\tif(e.keyCode === 32 || e.keyCode === 13 || e.keyCode === 40) {\n\t\t\te.preventDefault();\n\t\t\tvar target = e.target;\n\t\t\tvar moreItemsDropdown = '#more-items-dropdown';\n\t\t\t$(target).click();\n\t\t\t$(moreItemsDropdown).find('li.header-menu-item a:first').focus();\n\t\t}\n\t});\n\n\t// Capturing the arrow key navigation in mega menu for both desktop and mobile view\n\t$(element).on('keydown','.gt-menu-item, .header-nav-item', handleKeyPressEvents);\n\n  /*\n   * this is the method, which calculates the navbar component total width,\n   * the main logic is that when the navbar wraps for text zoom or for normal case,\n   * the top increases from 0, and then the mobile view is triggered.\n   * It also takes care of edge cases, with and without the searchbar\n  */\n  scope.calulatedNavbarWidth = function(inDigest) {\n    //if the text zoom level is less than 100% then falling back to normal mobileDevice calculation\n    \n    var WINDOW_WIDTH = window.innerWidth;\n    var DEFAULT_SEARCH_SIZE;\n    if (WINDOW_WIDTH > 1440) {\n      DEFAULT_SEARCH_SIZE = 600;\n    } else if (WINDOW_WIDTH > 1024 && WINDOW_WIDTH < 1441) {\n      DEFAULT_SEARCH_SIZE = 450;\n    } else if (WINDOW_WIDTH > 768 && WINDOW_WIDTH < 1025) {\n      DEFAULT_SEARCH_SIZE = 350;\n    } else {\n      DEFAULT_SEARCH_SIZE = 250;\n    }\n\n    var currentFontSize  = parseInt($('body').css('font-size'));\n    var constantOffset = 50;\n    var flexOffsetWidth = constantOffset * (currentFontSize / 16);\n    if(currentFontSize < 16) {\n      scope.$apply(function() {\n        scope.mobileDevice = controller.data.isMobile || (window.innerWidth <= controller.MOBILE_DEVICE_SCREEN_WIDTH);\n      });\n      return;\n    }\n    var headerSearch = angular.element(\".header-search\");\n    var navbarBrand = angular.element(\".navbar-brand-logo > img\");\n    var navbarRight = angular.element(\".navbar-right > div\");\n    var totalNavbarSize = 0;\n    if(headerSearch && headerSearch.length >= 1 && scope.navbarSearchTop == 0) {\n      var tempSearchSize = scope.navbarSearchSize;\n      scope.navbarSearchSize = headerSearch[headerSearch.length - 1].offsetWidth\n      scope.navbarSearchTop = headerSearch[headerSearch.length - 1].clientTop;\n      if(headerSearch[headerSearch.length - 1].clientTop > 0) {\n        scope.navbarSearchFinalSize = tempSearchSize !== 0 ? tempSearchSize : DEFAULT_SEARCH_SIZE;\n      }\n      else {\n        scope.navbarSearchFinalSize = scope.navbarSearchSize;\n      }\n    }\n    if(navbarBrand && navbarBrand.length >= 1)\n      scope.navLogoFinalSize = navbarBrand[navbarBrand.length - 1].offsetWidth;\n    if(navbarRight && navbarRight.length >= 1 && scope.navbarRightTop == 0) {\n      var tempSize = scope.navbarRightSize;\n      scope.navbarRightSize = navbarRight[navbarRight.length - 1].offsetWidth\n      scope.navbarRightTop = navbarRight[navbarRight.length - 1].clientTop;\n      if(navbarRight[navbarRight.length - 1].clientTop > 0) {\n        scope.navbarRightFinalSize = tempSize !== 0 ? tempSize : DEFAULT_RIGHT_NAVIGATION_SIZE;\n      }\n      else {\n        scope.navbarRightFinalSize = scope.navbarRightSize;\n      }\n    }\n    totalNavbarSize += scope.navLogoFinalSize !== 0 ? scope.navLogoFinalSize : DEFAULT_LOGO_SIZE;\n    totalNavbarSize += scope.navbarSearchFinalSize !== 0 ? scope.navbarSearchFinalSize : DEFAULT_SEARCH_SIZE;\n    totalNavbarSize += scope.navbarRightFinalSize !== 0 ? scope.navbarRightFinalSize : DEFAULT_RIGHT_NAVIGATION_SIZE;\n    //if it has gone to two lines, simply go for mobileView\n    var navBarFitsInViewport = (totalNavbarSize > (window.innerWidth - flexOffsetWidth));\n    if(inDigest) {\n      scope.mobileDevice = navBarFitsInViewport || controller.data.isMobile || (window.innerWidth <= controller.MOBILE_DEVICE_SCREEN_WIDTH);\n    }\n    else {\n      scope.$apply(function () {\n        // update current scope based on the new innerWidth and let angular update the view.\n        scope.mobileDevice = navBarFitsInViewport || controller.data.isMobile || (window.innerWidth <= controller.MOBILE_DEVICE_SCREEN_WIDTH);\n      });\n    }\n  }\n\n\n   $(window).resize(function(e) {\n    if(e.type == 'resize') {\n      scope.calulatedNavbarWidth();\n    }\n  });\n\n   // This helper returns a function, that, as long as it continues to be invoked, will not\n   // be triggered. The function will be called after it stops being called for\n   // N milliseconds. If `immediate` is passed, trigger the function on the\n   // leading edge, instead of the trailing.\n   function debounce(func, wait, immediate) {\n      var timeout;\n      return function () {\n         var context = this,\n            args = arguments;\n         var later = function () {\n            timeout = null;\n            if (!immediate) func.apply(context, args);\n         };\n         var callNow = immediate && !timeout;\n         clearTimeout(timeout);\n         timeout = setTimeout(later, wait);\n         if (callNow) func.apply(context, args);\n      };\n   }\n}","description":"","sys_updated_on":"2024-10-03 06:31:24","sys_class_name":"sp_header_footer","sys_id":"d0009941eb103010ed7966d6475228c1","sys_updated_by":"admin","docs":"","public":"false","client_script":"function escHeaderController($rootScope, $scope, $window, spUtil, $location, $uibModal, cabrillo, $timeout, i18n, spContextManager, snAnalytics) {\n    var c = this;\n\n    // Events fired from/to $rootScope for responsive mobile view.\n    c.SHOW_MOBILE_MEGA_MENU = 'showMobileMegaMenu';\n    c.SHOW_MOBILE_MENU_ON_DESKTOP = 'showMobileMenuOnDesktop';\n    c.TOGGLE_MOBILE_MENU_VISIBILITY = 'toggleMobileMenuVisibility';\n    c.INITIAL_TIMEOUT = 500;\n    $rootScope.isHeaderInMobileView = false;\n\n    $('body').on('click', function(e) {\n        $('[data-toggle=tooltip]').each(function() {\n            if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.tooltip').has(e.target).length === 0) {\n                $(this).tooltip('hide');\n            }\n        });\n    });\n\n    c.evaluateSearchWidgetVisibility = function() {\n        if (c.data.hideSearchOnHomepage) {\n            var currentUrl = $location.url();\n            var params = $location.search();\n\n            // hide on home page\n            if ((params && params.id && params.id === c.data.dashboardSuffix) || (params && !params.id && currentUrl.includes(c.data.portalSuffix)) || hideSearchWidgetForNASS(params)) {\n                $scope.showSearchBar = false;\n                $scope.showViewAsHeader = false;\n            } else\n                $scope.showSearchBar = true;\n            // show ViewAs header on viewAsPages  \n            if ((params && params.id && currentUrl.includes(\"ec_view_as\")))\n                $scope.showViewAsHeader = true;\n        }\n    };\n\n    function hideSearchWidgetForNASS(params) {\n        var pageIds = ['esc_search', 'search'];\n        var nassFullPageId = 'nowassistselfservice';\n        return c.data.showSparkle && params && params.id && (params.id == nassFullPageId || (pageIds.includes(params.id) && params.searchFromChat && params.searchFromChat == 'true'));\n    }\n\n    c.evaluateExperienceFeedbackDrawerVisibility = function() {\n        $scope.exFeedbackActive = c.data.exFeedbackActive;\n        if (c.data.drawerV2Available && c.data.shouldRefreshDefnOnNavigation) {\n            $scope.exFeedbackActive = true;\n            c.data.exFeedbackActive = true;\n        } else {\n            var pageID = $location.search().id;\n            var currentPage = pageID ? pageID : c.data.homepageDisplayValue;\n            if (c.data.isDrawerConfigured) {\n                var showOnAllPages = c.data.widgetData.showOnAllPages === '1';\n                var currentPageIncluded = c.data.widgetData.includedPages.length && c.data.widgetData.includedPages.includes(currentPage);\n                var currentPageExcluded = c.data.widgetData.excludedPages.length && c.data.widgetData.excludedPages.includes(currentPage);\n                if ((showOnAllPages && currentPageExcluded) || (!showOnAllPages && !currentPageIncluded)) {\n                    $scope.exFeedbackActive = false;\n                    c.data.exFeedbackActive = false;\n                } else {\n                    $scope.exFeedbackActive = true;\n                    c.data.exFeedbackActive = true;\n                }\n            }\n        }\n    };\n\n    function addDeferScript(src, callback) {\n        var s = document.createElement('script');\n        s.setAttribute('src', src);\n        s.setAttribute('defer', true);\n        s.onload = callback;\n        document.body.appendChild(s);\n    }\n\n    if (c.data.isPersonalizedAnswer) {\n        addDeferScript(\"/scripts/app-ex-integrated-answers-components/app-ex-integrated-answers-components.min.js\");\n    }\n\n    $scope.$on('sp_loading_indicator', function(e, value) {\n        $scope.loadingIndicator = value;\n        // Evaluate search bar visibility once the page has completed loading.\n        if (!value) {\n            c.evaluateSearchWidgetVisibility();\n            c.evaluateExperienceFeedbackDrawerVisibility();\n        }\n    });\n\n    /*\n    Finds the header seismic component sn-search-combobox\n    as it has a shadow dom, hence direct access to the input button is not available\n    So accessing the nested desktop search box component, and then setting the value\n    of the input control based on query passed\n    */\n    function setSearchBoxValue(query) {\n        var headerSearchBox = document.querySelector(\"sn-search-combobox\");\n        if (headerSearchBox) {\n            var desktopSearchBox = headerSearchBox.shadowRoot.querySelector(\"sn-search-combobox-desktop\");\n            if (desktopSearchBox) {\n                if (desktopSearchBox.shadowRoot.querySelector(\"input\").value != query)\n                    desktopSearchBox.shadowRoot.querySelector(\"input\").value = query;\n            }\n        }\n    }\n\n    /*\n    Checks if showSearchBar is visible and sets the correct value from query\n    $timeout is only used so that current digest cycle completes, there is no hardcoded delay added\n    */\n    $scope.$watch('showSearchBar', function() {\n        $timeout(function() {\n            try {\n                if ($scope.showSearchBar && $scope.query && $scope.query != '' && $scope.newUrlId !== $scope.oldUrlId) {\n                    setSearchBoxValue($scope.query);\n                }\n            } catch (e) {}\n        });\n    })\n\n    $scope.showSearchBar = true;\n    $scope.userID = $scope.user.sys_id;\n    $scope.todosPopupId = c.data.isMobile ? '#popup_todos_mobile' : '';\n    $scope.casesPopupId = c.data.isMobile ? '#popup_cases_mobile' : '';\n    $scope.popupType = c.data.isMobile ? 'collapse' : 'dropdown';\n    $scope.expanded = false;\n    $scope.isMobileViewOnDesktopExpanded = false;\n    $scope.loadingIndicator = $rootScope.loadingIndicator;\n    $scope.cartItemCount = 0;\n\n    /* Below 2 scope variables (showMobileMenuOnDesktop, showMobileMegaMenu) have counterparts in EC Navigation widget also.\n     So whenever we set these variables, make sure to emit an event on rootScope to update them in the former widget as well. */\n\n    // Determines whether to show mobile view on desktop due to oveflow of items in sub navigation bar of header.\n    $scope.showMobileMenuOnDesktop = false;\n    // Used to hide global navigation tools on mobile while showing mega menu topics in right panel.\n    $scope.showMobileMegaMenu = false;\n\n    c.todoCountTranslation = i18n.format(c.data.todoCountLabel, String(c.data.todoCount));\n    c.attestaionCountTranslation = i18n.format(c.data.attestaionCountLabel, String(c.data.assetAttestaionCount));\n    c.toursTranslation = \"${Tours}\";\n\n    c.MOBILE_DEVICE_SCREEN_WIDTH = 767;\n    $scope.mobileDevice = $scope.mobileDevice || c.data.isMobile || ($window.innerWidth <= c.MOBILE_DEVICE_SCREEN_WIDTH);\n\n    if (cabrillo.isNative())\n        $scope.isViewNative = true;\n\n    $scope.navEvent = function(event, hrefParam) {\n        var JOURNEYS_HREF = \"?id=jny_journeys\";\n        if (hrefParam === JOURNEYS_HREF) {\n            var payload = {};\n            payload.name = \"Navigate to Journey's home\";\n            payload.data = {};\n            payload.data[\"Entry point\"] = \"Header\";\n            snAnalytics.addEvent(payload);\n        }\n    };\n\n    // initially for first load, if the calculated width is in mobile view then update\n    // isHeaderInMobileView so that Employee Center Navigation widget also goes into mobile mode\n    $scope.$watch(\"mobileDevice\", function() {\n        $rootScope.isHeaderInMobileView = $scope.mobileDevice;\n        $rootScope.$broadcast('isHeaderInMobileView', $scope.mobileDevice);\n        if (!$scope.mobileDevice) {\n            updateClassesOnWishlistElement('remove');\n        }\n    });\n\n    $scope.$watch('isMobileViewOnDesktopExpanded', function(oldVal, newVal) {\n        if (oldVal && !newVal) {\n            $timeout(c.registerClickEventHanlderOnCart, c.INITIAL_TIMEOUT);\n        }\n    });\n\n    c.registerClickEventHanlderOnCart = function() {\n        $('a#cart-dropdown').on('click', function(event) {\n            if ($window.innerWidth > c.MOBILE_DEVICE_SCREEN_WIDTH && $scope.isMobileViewOnDesktopExpanded) {\n                $location.search({\n                    id: 'sc_cart'\n                });\n                $scope.toggleMobileMenuVisibility();\n            }\n        });\n    }\n\n    $scope.$on(\"$sp.service_catalog.cart.count\", function($evt, count) {\n        $scope.cartItemCount = count;\n    });\n\n    $scope.$on(\"$locationChangeSuccess\", function(event, data) {\n        if (c.data.isMobile) {\n            if ($('div#popup_todos_mobile').is(\":visible\"))\n                $('li > a#todos_popup').click();\n            else if ($('div#popup_cases_mobile').is(\":visible\"))\n                $('li > a#cases_popup').click();\n        } else {\n            $('li.open > a#cases_popup').click();\n            $('li.open > a#todos_popup').click();\n        }\n\n        // when location changes and have a query parameter in url, refresh the search bar so that changes will reflect\n        //DEF0353060 : regression due to reload of typeahead widget, now setting search box value\n        try {\n            scope.query = new URL(newUrl).searchParams.get(\"q\");\n            $scope.oldUrlId = new URL(oldUrl).searchParams.get(\"id\");\n            $scope.newUrlId = new URL(newUrl).searchParams.get(\"id\");\n            if ($scope.query && $scope.query != '' && $scope.newUrlId !== $scope.oldUrlId) {\n                setSearchBoxValue($scope.query);\n            }\n        } catch (e) {}\n    });\n\n    c.processWatchers = function(watcher) {\n        setTimeout($scope.reloadHeader, 20);\n    };\n\n    /* Record Watchers */\n    if (c.data.recordWatchers && c.data.recordWatchers.length > 0) {\n        angular.forEach(c.data.recordWatchers, function(watcher) {\n            spUtil.recordWatch($scope, watcher.table, watcher.filter, c.processWatchers);\n        });\n    }\n\n    $scope.reloadHeader = function(actionName) {\n        c.data.action = actionName || c.data.ACTION_TODO_COUNT;\n        if (c.data.action == c.data.ACTION_TODO_COUNT)\n            c.server.get({\n                action: c.data.action\n            }).then(function(resp) {\n                c.data.todoCount = resp.data.todoCount;\n                c.todoCountTranslation = i18n.format(c.data.todoCountLabel, String(c.data.todoCount));\n            });\n        else\n            c.server.update();\n    };\n\n    $scope.openLogin = function() {\n        $scope.modalInstance = $uibModal.open({\n            templateUrl: 'modalLogin',\n            scope: $scope\n        });\n    };\n\n    $rootScope.$on(\"update.searchpage\", function(e, searchPage) {\n        $scope.searchPage = searchPage;\n    });\n\n    $rootScope.$on('sp.avatar_changed', function() {\n        $scope.userID = '';\n        $timeout(function() {\n            $scope.userID = $scope.user.sys_id;\n        });\n    });\n\n    $rootScope.$on(c.SHOW_MOBILE_MENU_ON_DESKTOP, function(event, showMobileMenuOnDesktop) {\n        if (!(showMobileMenuOnDesktop || $scope.mobileDevice) && $scope.showMobileMenuOnDesktop) {\n            $scope.isMobileViewOnDesktopExpanded = false;\n        }\n        $scope.showMobileMenuOnDesktop = showMobileMenuOnDesktop || $scope.mobileDevice;\n    });\n\n    $rootScope.$on(c.SHOW_MOBILE_MEGA_MENU, function(event, showMobileMegaMenu) {\n        $scope.showMobileMegaMenu = showMobileMegaMenu;\n        if ($scope.mobileDevice) {\n            updateClassesOnWishlistElement('add');\n        }\n    });\n\n    function updateClassesOnWishlistElement(action) {\n        var wishListDesktopElement = document.getElementById(\"wishlist-menu-wrapper\");\n        updateClassOnElement(wishListDesktopElement, action, 'hidden-sm');\n        updateClassOnElement(wishListDesktopElement, action, 'hidden-md');\n\n        if (wishListDesktopElement) {\n            var wishListMobileElement = wishListDesktopElement.nextElementSibling;\n            updateClassOnElement(wishListMobileElement, action, 'visible-sm');\n            updateClassOnElement(wishListMobileElement, action, 'visible-md');\n        }\n    }\n\n    function updateClassOnElement(element, action, className) {\n        if (element) {\n            if (action == 'add') {\n                element.classList.add(className);\n            } else if (action == 'remove') {\n                element.classList.remove(className);\n            }\n        }\n    }\n\n    $timeout(function() {\n        $scope.calulatedNavbarWidth();\n        resizeObserverForTopNav();\n    }, c.INITIAL_TIMEOUT);\n\n    function resizeObserverForTopNav() {\n        var headerSearch = document.querySelector(\".header-search\");\n        var navbarBrand = document.querySelector(\".navbar-brand-logo > img\");\n        var navbarRight = document.querySelector(\".navbar-right > div\");\n        //fix for firefox/chrome on cmd + text zoom increase\n        if (window.ResizeObserver) {\n            var resizeObserver = new ResizeObserver(function(entries) {\n                if (entries) {\n                    $scope.calulatedNavbarWidth();\n                }\n            });\n\n            if (headerSearch)\n                resizeObserver.observe(headerSearch);\n\n            if (navbarBrand)\n                resizeObserver.observe(navbarBrand);\n\n            if (navbarRight)\n                resizeObserver.observe(navbarRight);\n        }\n    }\n\n    $scope.toggleMobileMenuVisibility = function(event) {\n        if (event) {\n            event.stopPropagation();\n        }\n        $('.sub-navbar-overflow-entry-button').tooltip('hide');\n        $scope.isMobileViewOnDesktopExpanded = !$scope.isMobileViewOnDesktopExpanded;\n        $scope.expanded = false;\n        $scope.showMobileMegaMenu = false;\n        $rootScope.$emit(c.SHOW_MOBILE_MEGA_MENU, false);\n    };\n\n    $rootScope.$on(c.TOGGLE_MOBILE_MENU_VISIBILITY, function() {\n        $scope.toggleMobileMenuVisibility();\n    });\n\n    $scope.handleMobileViewClick = function(event) {\n        // only stop propagation for navigation menu items\n        if ($(event.target).hasClass('mobile-navigation-menu-item') || $(event.target).parents('.mobile-navigation-menu-item').length || $(event.target).hasClass('back-container'))\n            event.stopPropagation();\n        else if ($(event.target).text().trim() != c.toursTranslation) {\n            // Stop propagation for menu items eg. My Requests etc\n            if (!($(event.target).parents('.main-header-item').length))\n                event.stopPropagation();\n        }\n    };\n\n    $scope.isHomepage = function() {\n        if (!$scope.page.id)\n            return true;\n\n        if ($scope.page.id == $scope.portal.homepage_dv)\n            return true;\n\n        return false;\n    };\n\n    c.evaluateSearchWidgetVisibility();\n\n    //remove nested ul to fix screen reader issue\n    $timeout(function() {\n        var cartToursWrapper = $('.navbar-header .v' + scope.data.top.menu.sys_id);\n\n        if (!cartToursWrapper.length)\n            return;\n\n        var menu = cartToursWrapper.parent().parent();\n        var menuItems = cartToursWrapper.children();\n        menu.append(menuItems);\n        cartToursWrapper.parent().remove();\n    }, 1000);\n\n    $scope.$on('sn_lp.giveFeedbackModalOpen', function() {\n        $scope.toggleMobileMenuVisibility();\n    });\n}","sys_created_on":"2021-05-21 18:13:05","sys_name":"Employee Center Header","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"id":"employee-center-header","field_list":"","sys_created_by":"admin","static":"true","sys_mod_count":"1364","demo_data":"","option_schema":"","sys_tags":"","script":"(function() {\n    var stats = {};\n    stats.callerId = 'd0009941eb103010ed7966d6475228c1';\n    stats.callerTable = 'sp_widget';\n    stats.refTable = stats.callerTable;\n    stats.refRecordId = stats.callerId;\n    stats.textPrefix = 'Employee Center Header';\n    stats.userId = gs.getUserID();\n    stats.startTime = new GlideDateTime();\n\n    var performanceIndicatorUtil = new sn_ex_sp.PerformanceIndicatorUtil();\n\n    function isImpersonating() {\n        if (gs.getCurrentScopeName() == \"rhino.global\")\n            return GlideImpersonate().isImpersonating();\n        return gs.getSession().isImpersonating();\n    }\n\n    /**\n     * Conditionaly looks for EXfeedbackUtil script include to support compatibility with older versions of store app\n     */\n    function getFeedbackUtil(portalId) {\n\n        var feedbackUtilGr = new GlideRecord('sys_script_include');\n        feedbackUtilGr.addQuery('sys_id', '2d6125cf777331105e82756f1b5a9965');\n        feedbackUtilGr.query();\n        if (feedbackUtilGr.hasNext())\n            return new sn_ex_sp_pro.ExFeedbackPortalUtil(portalId);\n\n        feedbackUtilGr = new GlideRecord('sys_script_include');\n        feedbackUtilGr.addQuery('sys_id', '67ad9f6aeb313110f3da2ff2a252288e');\n        feedbackUtilGr.query();\n        if (feedbackUtilGr.hasNext())\n            return new sn_ex_sp_pro.ExFeedbackUtil(portalId);\n    }\n\n    var isPerfWidgetEnabled = (isImpersonating() || gs.hasRole('admin')) && gs.getProperty(\"sn_ex_sp_perf_tools.enable_perf_widget\", 'true') == 'true';\n    if (isPerfWidgetEnabled)\n        data.perfWidget = $sp.getWidget('performance_indicator');\n\n    data.ACTION_TODO_COUNT = 'update_todo_count';\n    data.ACTION_LOAD_CASES = 'load_cases';\n    data.isMobile = gs.isMobile();\n    data.isFavoritesEnabled = $sp.getValue('enable_favorites') == 'true';\n    data.isPersonalizedAnswer = GlidePluginManager().isActive(\"com.sn_app_ex_integrated_answers\");\n\n    //Initialize menu objects\n    data.sub = {};\n    data.top = {};\n    var menu = $sp.getValue(\"sp_rectangle_menu\");\n    data.sub.menu = $sp.getWidgetFromInstance(menu);\n    data.escNavigation = $sp.getWidget(\"employee-center-navigation\");\n\n    //Copy sub menu to top menu, we want cart up top and menu items in the sub nav\n    data.top.menu = JSON.parse(JSON.stringify(data.sub.menu));\n\n    var configOptions = JSON.parse((data.top.menu && data.top.menu.options && data.top.menu.options.widget_parameters) || '{}');\n\n    data.moreItemsSysId = (configOptions.enable_more_items && configOptions.enable_more_items.sysId) || '';\n    data.hideSearchOnHomepage = configOptions.exclude_search_on_homepage ? configOptions.exclude_search_on_homepage.value : false;\n    data.showRequests = configOptions.enable_requests ? configOptions.enable_requests.value : true;\n    data.showTodos = configOptions.enable_tasks ? configOptions.enable_tasks.value : true;\n    data.showAssets = (configOptions.enable_assets ? configOptions.enable_assets.value : false) && (GlidePluginManager.isActive('com.sn_itam_common') && sn_itam_common.AssetWidgetUtils && sn_itam_common.AssetWidgetUtils.showMyAssetsOnWidgetType(gs.getUserID(), 'hardware'));\n    if(data.showAssets) {\n        data.assetAttestaionCount = sn_itam_common.AssetWidgetUtils.assetsWithUserAttesationNeeded(gs.getUserID());\n        data.attestaionCountLabel = gs.getMessage(\"{0} assets need attestation\");\n    } else {\n        data.assetAttestaionCount = 0;\n        data.attestaionCountLabel = '';\n    }\n\n    data.todoCount = 0;\n    data.todoCountLabel = '';\n\n    //Load To-dos count\n    if ((!input || input.action == data.ACTION_TODO_COUNT) && data.showTodos) {\n        var myTodosCountObject = new sn_hr_sp.todoPageUtils().getMyTodosCount(false, false, true);\n        data.mobileViewTodoCount = myTodosCountObject.todoCount;\n        data.todoCount = (myTodosCountObject.todoCount > 9) ? '9+' : myTodosCountObject.todoCount;\n\n        data.todoCountLabel = gs.getMessage(\"{0} to-dos remaining\");\n        data.recordWatchers = myTodosCountObject.recordWatchers;\n\n        // avoid consecutive calls \n        if (input)\n            return;\n    }\n\n    data.isHrCoreActive = GlidePluginManager().isActive(\"com.sn_hr_core\");\n    if (data.isHrCoreActive && gs.getProperty('sn_hr_core.esc.create_hrprofile.override', 'true') === \"true\") {\n        // HR Profile\n        var hrProfileGr = new GlideRecord('sn_hr_core_profile');\n        hrProfileGr.addQuery('user', gs.getUserID());\n        hrProfileGr.setLimit(1);\n        hrProfileGr.query();\n        if (!hrProfileGr.hasNext() && gs.getUserID() && new GlideRecord('sys_user').get(gs.getUserID())) {\n            hrProfileGr.setValue('user', gs.getUserID());\n            hrProfileGr.insert();\n        }\n    }\n\n    // check for listening posts voluntary feedback\n    data.voluntarySurveyIsActive = false;\n    data.isListeningPostsActive = GlidePluginManager().isActive(\"sn_lp\");\n    if (data.isListeningPostsActive) {\n        var pulseUtils = new sn_lp.PulseUserCriteriaEvaluation();\n        data.voluntarySurvey = pulseUtils.getActiveVoluntarySurvey && pulseUtils.getActiveVoluntarySurvey();\n\n        if (data.voluntarySurvey && data.voluntarySurvey.next()) {\n            data.voluntarySurveyIsActive = true;\n        }\n    }\n\n    function checkDrawerV2Availability() {\n        var ga = new GlideAggregate('sp_widget');\n        ga.addQuery(\"sys_id\", \"0ed0a9f34302c210d06729f026b8f272\");\n        ga.addAggregate('COUNT');\n        ga.query();\n        var count = 0;\n        if (ga.next()) {\n            count = ga.getAggregate('COUNT');\n        }\n        return count > 0;\n    }\n\n    // check for experience feedback\n    function experienceFeedbackCheck() {\n        data.exFeedbackActive = false;\n        data.isDrawerConfigured = false;\n        var portalId = $sp.getPortalRecord().sys_id;\n        var isECProActive = GlidePluginManager().isActive(\"sn_ex_sp_pro\");\n        var pageId = $sp.getParameter(\"id\");\n\n        if (!pageId)\n            pageId = $sp.getDisplayValue('homepage').toString();\n\n        data.drawerV2Available = checkDrawerV2Availability();\n        var feedbackUtil = getFeedbackUtil(portalId);\n\n        if (isECProActive) {\n            if (data.drawerV2Available && feedbackUtil.shouldRefreshDefnOnNavigation()) {\n                data.shouldRefreshDefnOnNavigation = true\n                data.isDrawerConfigured = true;\n                data.drawerV2Available = true;\n                data.modalWidget = $sp.getWidget('experience-feedback-wrapper');\n                data.headerFeedbackWidget = $sp.getWidget('experience-feedback-header-wrapper');\n\n            } else {\n                data.shouldRefreshDefnOnNavigation = false;\n                data.exFeedbackActive = false;\n                if (feedbackUtil) {\n                    var feedbackConfig = feedbackUtil.getFeedbackConfig(portalId);\n                    var feedbackDefinitionGr = feedbackUtil.getFeedbackDefinitionForDrawer(pageId);\n                    if (feedbackConfig && feedbackDefinitionGr) {\n                        data.isDrawerConfigured = true;\n                        data.widgetData = feedbackUtil.getDrawerWidgetData(feedbackConfig, feedbackDefinitionGr);\n                        data.modalWidget = $sp.getWidget('experience-feedback-drawer', data.widgetData);\n                        data.headerFeedbackWidget = $sp.getWidget('experience-feedback-header-item', data.widgetData);\n                    }\n                    data.homepageDisplayValue = $sp.getDisplayValue('homepage').toString();\n                }\n            }\n        }\n    }\n    experienceFeedbackCheck();\n\n    // populate the 'data' object\n    data.link = '?id=hri_user_profile&sys_id=' + gs.getUserID();\n\n    // Defines the support queue ID that will be linked to by the Live Chat link in header\n    data.login_page = $sp.getValue('login_page');\n\n    //Fetching My Items menu item sys_id\n    var subMenu = data.sub.menu;\n    var moreItems;\n    if (subMenu && subMenu.data) {\n        subMenu.data.replace = true;\n        // Hide login if menu already has link to login\n        data.hasLogin = false;\n        var subMenuDataItems = (subMenu.data.menu && subMenu.data.menu.items) || [];\n        for (var i in subMenuDataItems) {\n            var item = subMenuDataItems[i];\n            if (item.sys_id === data.moreItemsSysId)\n                moreItems = item;\n            if (item.type === 'page' && item.sp_page === data.login_page)\n                data.hasLogin = true;\n        }\n    }\n\n    if (moreItems && moreItems.items) {\n        data.moreItems = moreItems.items;\n    } else if (moreItems && moreItems.scriptedItems && moreItems.scriptedItems.items) {\n        data.moreItems = moreItems.scriptedItems.items;\n    }\n\n    if (moreItems && data.moreItems && moreItems.label) {\n        // Removing items with no label\n        data.moreItems = data.moreItems.filter(function(moreItem) {\n            return moreItem.label;\n        });\n\n        // Truncating label of items exceeding 60 character limit\n        data.moreItems.forEach(function(moreItem) {\n            moreItem.shortLabel = (moreItem.label.length > 60) ? (moreItem.label.substring(0, 60) + '...') : moreItem.label;\n        });\n    }\n\n    if (data.hideSearchOnHomepage) {\n        data.homepage = $sp.getValue('homepage');\n        var gr = new GlideRecord('sp_page');\n        gr.get(data.homepage);\n        data.dashboardSuffix = gr.getValue(\"id\");\n        data.portalSuffix = $sp.getPortalRecord().getDisplayValue(\"url_suffix\");\n    }\n\n    data.showMoreItems = (moreItems && moreItems.label && data.moreItems && configOptions.enable_more_items) ? (data.moreItems.length > 0 && configOptions.enable_more_items.value) : false;\n    if (data.showMoreItems)\n        data.moreItemsTitle = data.moreItems.length === 1 ? data.moreItems[0].shortLabel : moreItems.label;\n\n    // Analytics\n    data.analyticsSupportEnabled = new GlidePluginManager().isActive('com.sn_content_analytics') && new GlidePluginManager().isActive('com.sn_content_delivery') && !sn_cd.cd_ContentDelivery.isContentPreview($sp);\n\n    //Clean up items that don't belong\n    if (subMenu) {\n        if (subMenu.data) {\n            subMenu.data.cartWidget = {};\n            subMenu.data.showTours = false;\n        }\n        if (subMenu.options) {\n            subMenu.options.enable_cart = false;\n        }\n    }\n    if (data.top.menu && data.top.menu.data && data.top.menu.data.menu && data.top.menu.data.menu.items)\n        data.top.menu.data.menu.items = [];\n\n    var typeAheadOptions = {};\n    typeAheadOptions.refresh_page_on_search_submission = false;\n    typeAheadOptions.title = gs.getMessage(\"Search\");\n    if ($sp.isAISearchEnabled())\n        typeAheadOptions.disable_all_suggestions = ($sp.getParameter('disableAllSuggestions') == 'true');\n\n    data.typeahead = $sp.getWidget('typeahead-search', typeAheadOptions);\n    data.loginWidget = $sp.getWidgetFromInstance('login-modal');\n    data.avatarDropDown = $sp.getWidget('profile-with-drop-down', {\n        \"profile_url\": data.link,\n        \"show_xs_avatar\": false\n    });\n\n    //Portal Notifications widget\n    data.isNotificationsActive = GlidePluginManager().isActive(\"sn_ex_sp_notifs\");\n    if (data.isNotificationsActive) {\n        data.notificationsBellWidget = $sp.getWidget('ec-notifications-bell');\n    }\n\n    function safeGet(objectParam, pathParam, defaultValue) {\n        var path = Array.isArray(pathParam) ? pathParam : pathParam.split('.');\n        var index = 0;\n        var length = path.length;\n        var objectVal = objectParam;\n\n        while (objectVal != null && index < length) {\n            objectVal = objectVal[path[index]];\n            index++;\n        }\n        var value = index === length ? objectVal : undefined;\n        return !gs.nil(value) ? value : defaultValue;\n    }\n\n    try {\n        data.showSparkle = $sp.isNowAssistEnabled();\n    } catch (error) {\n        data.showSparkle = false;\n    }\n  \n    if (data.showSparkle)\n        data.sparkle = $sp.getWidget('now_assist_sparkle_icon');\n    stats.shortDesc = 'Load Data';\n    performanceIndicatorUtil.postHotspot(stats);\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/4249e63a28d54d61bb6fbf61fd86cccb","value":"4249e63a28d54d61bb6fbf61fd86cccb"},"servicenow":"false","sys_update_name":"sp_header_footer_d0009941eb103010ed7966d6475228c1","data_table":"sp_instance","name":"Employee Center Header","category":"hr","controller_as":"c","sys_policy":""},{"template":" <div class=\"sample-footer\" role=\"contentinfo\">\t\n  ${Page generated at {{::c.data.time}}}\n </div>","css":".sample-footer {\n  background-color: black; \n  color: white; \n  padding: 5px;\n}","internal":"false","roles":"","link":"","description":"","sys_updated_on":"2022-04-20 19:16:38","sys_class_name":"sp_header_footer","sys_id":"feb4f763df121200ba13a4836bf26320","sys_updated_by":"admin","docs":"","public":"false","client_script":"function() {\n  // widget controller\n  var c = this;\n}","sys_created_on":"2016-03-28 00:50:09","sys_name":"Sample Footer","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"id":"","field_list":"","sys_created_by":"admin","static":"false","sys_mod_count":"13","demo_data":"","option_schema":"","sys_tags":"","script":"(function() {\n data.time = new GlideDateTime().getDisplayValue();\n})();","has_preview":"false","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/69996b7b04f12210559073c06a02f7e2","value":"69996b7b04f12210559073c06a02f7e2"},"servicenow":"true","sys_update_name":"sp_header_footer_feb4f763df121200ba13a4836bf26320","data_table":"sp_instance","name":"Sample Footer","category":"sample","controller_as":"c","sys_policy":""}]}