{"result":[{"conditional":"true","description":"Domain Name Resolver","sys_updated_on":"2013-06-04 05:18:15","classy":"discovery_classy_proc","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"09fac5b40ab30150005055effbf8c808","sys_updated_by":"aleck.lin","sys_created_on":"2009-01-24 18:51:16","scanner":"DNS","triggers_probe":"","supplementary":"false","sys_name":"dns","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"22","active":"true","services":"e6401808c0a8020700ff8f2cff0ab87f","sys_tags":"","active_discover_cis":"true","script":"function(cidata, result, scanner, status, midServer, sensor) {\n    var resolvedHostname = scanner.hostName;\n    var sourceAddress = result.ip;\n\n    if (!JSUtil.nil(resolvedHostname))\n        cidata.getData()['dns_name'] = resolvedHostname;\n\n    handleScanCI(cidata, resolvedHostname, sourceAddress);\n\n    function handleScanCI(cidata, resolvedHostname, sourceAddress) {\n        var trusted = JSUtil.toBoolean(gs.getProperty(\"glide.discovery.hostname.dns_nbt_trusted\", \"false\"));\n        var haveNow = !JSUtil.nil(cidata.getData()['name']);\n        var haveDNS = !JSUtil.nil(resolvedHostname);\n\n        if (!haveDNS)\n            return;\n\n        if (haveNow && !trusted)\n            return;\n\n        var hn = new HostnameJS();\t\n\t\t\n\t\tvar dl = sensor.getLogger();\n\t\tdl.setSource(\"DNS Port Probe script\");\n\t\thn.setLogger(dl);\n\t\t\t\t\n        cidata.getData()['name'] = hn.format(resolvedHostname);\n        var dname = hn.getDomainName();\n        if (JSUtil.notNil(dname))\n            cidata.getData()['dns_domain'] = dname;\n    }\n}\n","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_09fac5b40ab30150005055effbf8c808","classification_priority":"","name":"dns","sys_policy":""},{"conditional":"true","description":"WINS Name Resolver","sys_updated_on":"2013-06-04 05:17:51","classy":"discovery_classy_proc","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"09fba0bb0ab301500069fa474f89e935","sys_updated_by":"aleck.lin","sys_created_on":"2009-01-24 18:52:05","scanner":"NBT","triggers_probe":"","supplementary":"false","sys_name":"wins","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"26","active":"true","services":"09e9d79f0ab3015000ac88704e680ad4","sys_tags":"","active_discover_cis":"true","script":"function(cidata, result, scanner, status, midServer, sensor) {\n    var resolvedHostname = scanner.hostName;\n    var sourceAddress = result.ip;\n    var resolvedDomain = scanner.domainName;\n\n    handleScanCI(cidata, resolvedHostname, sourceAddress, resolvedDomain);\n        \n    function handleScanCI(cidata, resolvedHostname, sourceAddress, resolvedDomain) {\n        if (!JSUtil.nil(resolvedHostname)) {\n            var hn = new HostnameJS();\n\t\t\t\n\t\t\tvar dl = sensor.getLogger();\n\t\t\tdl.setSource(\"wins Port Probe script\");\n\t\t\thn.setLogger(dl);\t\t\t\n\t\t\t\n            cidata.getData()['name'] = hn.format(resolvedHostname);\n        }\n        if (!JSUtil.nil(resolvedDomain)) {\n            cidata.getData()['os_domain'] = resolvedDomain;\n        }\n    }\n}\n","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_09fba0bb0ab301500069fa474f89e935","classification_priority":"","name":"wins","sys_policy":""},{"conditional":"false","description":"ESXi Server Appliance web user interface","sys_updated_on":"2020-09-14 08:48:00","classy":"discovery_classy_appl","sys_class_name":"discovery_port_probe","active_discover_ips":"false","sys_id":"23556127c7521010f580178603c260d2","sys_updated_by":"pooja.chugwani","sys_created_on":"2020-08-04 08:09:19","scanner":"BannerTCP","triggers_probe":{"link":"https://dev315171.service-now.com/api/now/v1/table/discovery_probes/6311c527c7121010f580178603c26059","value":"6311c527c7121010f580178603c26059"},"supplementary":"false","sys_name":"esxi","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_mod_count":"0","active":"false","services":"b185e127c7521010f580178603c26059","sys_tags":"","active_discover_cis":"true","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_23556127c7521010f580178603c260d2","classification_priority":"5","name":"esxi","sys_policy":""},{"conditional":"false","description":"Secure Shell Login","sys_updated_on":"2022-04-29 13:54:00","classy":"discovery_classy_unix","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"97ff2abd0a0a070300b7f37daa11a241","sys_updated_by":"jim.freeman","sys_created_on":"2007-07-05 20:11:57","scanner":"SSH","triggers_probe":{"link":"https://dev315171.service-now.com/api/now/v1/table/discovery_probes/10e0eebd0a0a0b4f61f46a5027df7fb6","value":"10e0eebd0a0a0b4f61f46a5027df7fb6"},"supplementary":"false","sys_name":"ssh","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"15","active":"true","services":"e433b32ec0a80164002cb4913c42fdfe","sys_tags":"","active_discover_cis":"true","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_97ff2abd0a0a070300b7f37daa11a241","classification_priority":"2","name":"ssh","sys_policy":""},{"conditional":"false","description":"Windows WMI","sys_updated_on":"2010-04-06 17:45:08","classy":"discovery_classy_windows","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"9802b18f0a0a0703009d322d5b5540e5","sys_updated_by":"tom.dilatush","sys_created_on":"2007-07-05 20:12:12","scanner":"GenericTCP","triggers_probe":{"link":"https://dev315171.service-now.com/api/now/v1/table/discovery_probes/b11360600a0a0ba500c41bcbae55c5c4","value":"b11360600a0a0ba500c41bcbae55c5c4"},"supplementary":"false","sys_name":"wmi","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"13","active":"true","services":"e44d59f7c0a801640088884e03a72724","sys_tags":"","active_discover_cis":"true","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_9802b18f0a0a0703009d322d5b5540e5","classification_priority":"1","name":"wmi","sys_policy":""},{"conditional":"false","description":"Web Servers","sys_updated_on":"2018-04-25 20:32:46","classy":"discovery_classy_http","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"980365530a0a070300b473edf16f8ce0","sys_updated_by":"steve.bandow","sys_created_on":"2007-07-05 20:12:59","scanner":"HTTP","triggers_probe":{"link":"https://dev315171.service-now.com/api/now/v1/table/discovery_probes/0cc9e5779f060300a114d0aec32e7072","value":"0cc9e5779f060300a114d0aec32e7072"},"supplementary":"false","sys_name":"http","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"39","active":"true","services":"e433d6bdc0a8016400081f03a8dd1536,e4399630c0a801640174a61524c3288f","sys_tags":"","active_discover_cis":"true","script":"function(cidata, result, scanner, status, midServer, sensor) {\n\n    if (scanner.service != \"http\")\n        return;\n\n    // our default values...\n    var httpdType = \"\";\n    var httpdVersion = \"\";\n    \n    // if we got a Server option back, process it...\n    if (scanner.contents.Server) {\n        // get only the stuff before the first space (if there is one), and make that our type...\n        var spaceParts = /^([^ ]+)( .*)?$/.exec(scanner.contents.Server);\n        if (spaceParts)\n            httpdType = spaceParts[1];\n        \n        // now see if we have a version, after a slash...\n        var versionParts = /^([^\\/ ]+)(\\/(.*))$/.exec(httpdType);\n        if (versionParts) {\n            httpdType = versionParts[1];\n            httpdVersion = versionParts[3];\n        }\n    }\n    \n    // now update or insert our IP service record...\n    var name = httpdType + ' ' + httpdVersion;\n    var svcSysID = g_disco_functions.getService(scanner.port).sys_id;\n    \n    updateCIData(cidata, name, svcSysID);\n    \n    function updateCIData(cidata, name, svcSysID) {\n\t// see if other port probe might've added this already\n\t\tvar rl = cidata.getRelatedListInstance('cmdb_ip_service_ci', 'ci');\t\t\n\t\tif (rl == null) {\n\t        rl = new CIRelatedList('cmdb_ip_service_ci', 'ci');\n\t        cidata.addRelatedList(rl);\n\t\t}\n\n        var rec = {};\n        rec[ 'description' ] = name;\n        rec[ 'service'     ] = svcSysID;\n        rl.addRec(rec);\n    }\n}","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_980365530a0a070300b473edf16f8ce0","classification_priority":"5","name":"http","sys_policy":""},{"conditional":"false","description":"Simple Network Management Protocol","sys_updated_on":"2020-07-21 17:44:49","classy":"discovery_classy_snmp","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"9803b0150a0a07030014493c58138458","sys_updated_by":"udaykiran.immanni","sys_created_on":"2007-07-05 20:13:12","scanner":"SNMP","triggers_probe":{"link":"https://dev315171.service-now.com/api/now/v1/table/discovery_probes/930a60500a0a0b61006f83edd300f689","value":"930a60500a0a0b61006f83edd300f689"},"supplementary":"false","sys_name":"snmp","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"15","active":"true","services":"e43c4f2bc0a8016401d0a692b7e91069","sys_tags":"","active_discover_cis":"true","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_9803b0150a0a07030014493c58138458","classification_priority":"3","name":"snmp","sys_policy":""},{"conditional":"false","description":"Finds network printers","sys_updated_on":"2010-04-07 13:03:05","classy":"discovery_classy_scan_app","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"db8730390ab30155008b397e89991e18","sys_updated_by":"tom.dilatush","sys_created_on":"2009-06-13 21:30:55","scanner":"GenericTCP","triggers_probe":"","supplementary":"false","sys_name":"printer","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"7","active":"true","services":"db869bdd0ab3015500b054fc079f4c71,db8636b90ab3015500b029144c7dff06","sys_tags":"","active_discover_cis":"false","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_db8730390ab30155008b397e89991e18","classification_priority":"","name":"printer","sys_policy":""},{"conditional":"false","description":"OS/X computers","sys_updated_on":"2010-04-07 13:02:53","classy":"discovery_classy_scan_app","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"db98c3450ab3015500665f9fd3f8016c","sys_updated_by":"tom.dilatush","sys_created_on":"2009-06-13 21:49:47","scanner":"GenericTCP","triggers_probe":"","supplementary":"false","sys_name":"osx","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"3","active":"true","services":"db9840e10ab3015500f5e3fe8f78da42","sys_tags":"","active_discover_cis":"false","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_db98c3450ab3015500665f9fd3f8016c","classification_priority":"","name":"osx","sys_policy":""},{"conditional":"false","description":"IP Phones","sys_updated_on":"2010-04-07 13:02:53","classy":"discovery_classy_snmp","sys_class_name":"discovery_port_probe","active_discover_ips":"true","sys_id":"dc0cf75f0ab301550060d9ee5ddad04d","sys_updated_by":"tom.dilatush","sys_created_on":"2009-06-13 23:57:01","scanner":"GenericTCP","triggers_probe":"","supplementary":"false","sys_name":"ip_phone","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","sys_mod_count":"2","active":"true","services":"dc0c50d60ab30155006ffaf81c6ce2fe","sys_tags":"","active_discover_cis":"false","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"sys_update_name":"discovery_port_probe_dc0cf75f0ab301550060d9ee5ddad04d","classification_priority":"","name":"ip_phone","sys_policy":""}]}