{"result":[{"trigger_condition":"always","request_processor_script":"function process(context) {\n\tvar answer = new sn_ais.GeniusResultAnswer();\n\n\tanswer.setTable('sc_cat_item');\n\tanswer.setSearchPhrase(context.getOriginalSearchPhrase());\n\tanswer.setEncodedQuery(\"sys_class_name!=std_change_record_producer\");\n\tanswer.setSearchLimit(3);\n\tanswer.searchTitleOnly(true);\n\tanswer.addSearchAttribute(\"geniusResultSearchMode\", [\"custom\"]);\n\n\treturn answer;\n}","sys_mod_count":"11","active":"true","sys_updated_on":"2023-04-27 22:48:52","sys_tags":"","response_processor_script":"","sys_class_name":"ais_genius_result_configuration","sys_id":"4e4c046408e71010f877b349f72d9d3f","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/76946b3f04312210559073c06a02f73b","value":"76946b3f04312210559073c06a02f73b"},"sys_update_name":"ais_genius_result_configuration_4e4c046408e71010f877b349f72d9d3f","sys_updated_by":"admin","sys_created_on":"2020-09-25 21:00:58","name":"Catalog Item","return_fields":"taxonomy_topic,category,picture,name,description,price,recurring_price,recurring_frequency,short_description,kb_article.sys_id,kb_article.short_description,url,content_type","sys_name":"Catalog Item","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"term":"","category":"catalog","sys_created_by":"admin","sys_policy":"read"},{"trigger_condition":"intent","request_processor_script":"function process(context) {\n\tvar answer = new sn_ais.GeniusResultAnswer();\n\n\tanswer.setTable('sys_user');\n\tanswer.setSearchLimit(2);\n\tanswer.spellCheck(false);\n\tvar queries = [];\n\tvar searchPhrases = [];\n\tvar title;\n\tvar matchingSegments;\n\tvar predictionResult = context.getPredictionResult();\n\tif (predictionResult && predictionResult.length == 1) {\n\t\tvar detail = predictionResult[0];\n\t\tif (detail['result'] && detail['result']['entities']) {\n\t\t\tvar entities = detail['result']['entities'];\n\t\t\tfor (var i = 0; i < entities.length; i++) {\n\t\t\t\tmatchingSegments = entities[i]['matchingSegments'];\n\t\t\t\tif (entities[i]['name'].endsWith('personName')) {\n\t\t\t\t\tfor (var j = 0; j < matchingSegments.length; j++)\n\t\t\t\t\t\tsearchPhrases.push(matchingSegments[j]['value']);\n\t\t\t\t} else if (entities[i]['name'].endsWith('cityLocation')) {\n\t\t\t\t\tif (matchingSegments && matchingSegments.length > 0)\n\t\t\t\t\t\tqueries.push('location.nameLIKE' + matchingSegments[0]['value']);\n\t\t\t\t} else if (entities[i]['name'].endsWith('departmentName')) {\n\t\t\t\t\tif (matchingSegments && matchingSegments.length > 0)\n\t\t\t\t\t\tqueries.push('department.nameLIKE' + matchingSegments[0]['value']);\n\t\t\t\t} else if (entities[i]['name'].endsWith('jobTitle')) {\n\t\t\t\t\tif (matchingSegments && matchingSegments.length > 0) {\n\t\t\t\t\t\ttitle = matchingSegments[0]['value'];\n\t\t\t\t\t\tqueries.push('titleLIKE' + title);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (searchPhrases.length > 0)\n\t\tanswer.addSearchPhrases(searchPhrases);\n\telse if (title)\n\t\tanswer.setSearchPhrase(title);\n\n\tif (queries.length > 0)\n\t\tanswer.setEncodedQuery(queries.join('^'));\n\n\treturn answer;\n}","sys_mod_count":"9","active":"false","sys_updated_on":"2023-04-27 22:48:53","sys_tags":"","response_processor_script":"","sys_class_name":"ais_genius_result_configuration","sys_id":"b48b0c2408e71010f877b349f72d9d3f","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/76946b3f04312210559073c06a02f73b","value":"76946b3f04312210559073c06a02f73b"},"sys_update_name":"ais_genius_result_configuration_b48b0c2408e71010f877b349f72d9d3f","sys_updated_by":"admin","sys_created_on":"2020-09-25 20:58:49","name":"People","return_fields":"name,email,manager,department,title,location,avatar,mobile_phone,city,state","sys_name":"People","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"term":"","category":"people","sys_created_by":"admin","sys_policy":"read"},{"trigger_condition":"always","request_processor_script":"","sys_mod_count":"31","active":"true","sys_updated_on":"2024-06-04 16:57:16","sys_tags":"","response_processor_script":"function process(context) {\n    var OE_CAPABILITY_ID = 'c061cecf7056f110f8779b1be17c7af7';\n\n    var user = gs.getUser();\n    // NLQ only supports english as of washington release\n    if (user.getLanguage() != 'en') {\n        return null;\n    }\n    var wsAccess = user.hasRole('sn_cmdb_user');\n    if (!wsAccess) gs.debug('NLQ GR - User: ' + user.getFullName() + ' not authorized for CMDB workspace');\n\n    var answer = new sn_ais.GeniusResultAnswer();\n    var query = context.getOriginalSearchPhrase();\n    var timeout = parseInt(this._getProperty(\"sn_ais_assist.u_llm_api_timeout\", 120)); // Same as what's used for Q&A\n\n    // Fields needed for the Genius Result that aren't based on the NLQ response\n    var dataMap = {\n        'label': 'NLQ',\n        'searchProfile': context.getSearchContext()['fProfile'],\n        'utterance': query\n    };\n    var meta = context.getSearchQueryRequestDetails();\n    meta.initialDataMap = dataMap;\n\n    var mode = 'SYNC';\n    if (!gs.nil(context.getAsyncMode()) && context.getAsyncMode() != 'OFF')\n        mode = 'ASYNC';\n\n    var nlqRequest = {\n        timeout: timeout,\n        mode: mode,\n        callbackHandler: \"AISearchNLQUtils\",\n        executionRequests: [{\n            payload: {\n                query: query,\n                wsAccess: wsAccess,\n                meta: meta\n            },\n            capabilityId: OE_CAPABILITY_ID,\n            returnRequest: true\n        }]\n    };\n\n    var result = {};\n    try {\n        result = new sn_one_extend.OneExtendUtil.execute(nlqRequest);\n    } catch (e) {\n        gs.error(\"An error occurred when submitting an NLQ request to OneExtend: \", e);\n    }\n\n    if (result.capabilities && result.capabilities[OE_CAPABILITY_ID]) {\n        var response = result.capabilities[OE_CAPABILITY_ID].output.response;\n        if (response && response.length > 2) {\n            dataMap.response = response;\n            dataMap.multiTable = result.capabilities[OE_CAPABILITY_ID].output.multiTable;\n            dataMap.navConfig = result.capabilities[OE_CAPABILITY_ID].output.navConfig;\n            answer.addDataMap(dataMap);\n            return answer;\n        } else {\n            return;\n        }\n    } else if (result.status == \"success\") {\n        answer.setAwaitingResults(true); // Submitted in Async mode, full answer will be generated later in callback handler\n        return answer;\n    } else {\n        gs.error(\"An error occurred while executing the job for NLQ Genius Results: \" + result.status);\n    }\n}","sys_class_name":"ais_genius_result_configuration","sys_id":"f1e1b719432031101ed7489a1cb8f251","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/76946b3f04312210559073c06a02f73b","value":"76946b3f04312210559073c06a02f73b"},"sys_update_name":"ais_genius_result_configuration_f1e1b719432031101ed7489a1cb8f251","sys_updated_by":"admin","sys_created_on":"2023-08-08 19:37:13","name":"NLQ","return_fields":"label, response, searchProfile, utterance, multiTable, navConfig","sys_name":"NLQ","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"term":"","category":"nlq","sys_created_by":"admin","sys_policy":""},{"trigger_condition":"always","request_processor_script":"function process(context) {\n\tvar answer = new sn_ais.GeniusResultAnswer();\n\n\tvar searchPhrase = context.getOriginalSearchPhrase();\n\tanswer.setSearchPhrase(searchPhrase);\n\tanswer.snippetSearch(true);\n\n\treturn answer;\n}","sys_mod_count":"3","active":"true","sys_updated_on":"2023-04-27 21:32:10","sys_tags":"","response_processor_script":"","sys_class_name":"ais_genius_result_configuration","sys_id":"f8bc086408e71010f877b349f72d9dfe","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/76946b3f04312210559073c06a02f73b","value":"76946b3f04312210559073c06a02f73b"},"sys_update_name":"ais_genius_result_configuration_f8bc086408e71010f877b349f72d9dfe","sys_updated_by":"admin","sys_created_on":"2020-09-25 21:02:23","name":"Q&A","return_fields":"","sys_name":"Q&A","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"term":"","category":"qna","sys_created_by":"admin","sys_policy":"read"}]}