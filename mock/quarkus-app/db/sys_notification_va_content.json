{"result":[{"advanced":"true","send_link":"true","customize_header":"false","message_heading":"A notification has arrived. You can continue the conversation after viewing the notification.","sys_updated_on":"2023-05-16 22:40:09","type":"simple","sys_class_name":"sys_notification_va_content","image_source":"upload_image","notification":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_notification/47cafbd277420110e6330ea24b5a99d5","value":"47cafbd277420110e6330ea24b5a99d5"},"sys_id":"f93c7f1677420110e6330ea24b5a9905","sys_updated_by":"admin","consumer_account_contexts":"","sys_created_on":"2022-03-08 00:12:24","sys_name":"Collab Chat VA Notification Content","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/53b1b0e79761011018b2fa98c253afcc","value":"53b1b0e79761011018b2fa98c253afcc"},"sys_created_by":"admin","notification_image":"","image_url":"","sys_mod_count":"29","active":"true","is_default":"false","message":"","sys_tags":"","image_alt_text":"","script":"(function getNotificationHeadingAndMessage(\n    /*GlideRecord of record changed to cause notification*/ target,\n    /*GlideRecord of event triggered to cause notification*/ event,\n    /*Recipient Table Name*/ recipientTable,\n    /*Recipient Sys Id*/ recipientSysId) {\n\t\n\tif (gs.getProperty(\"com.glide.cs.collab.teams.notifcard\") == \"false\") {\n\t  gs.error(\"Could not send Notification for user: \" + recipientSysId + \".  Property com.glide.cs.collab.teams.notifcard is currently set to false.  Please contact a ServiceNow Administrator to turn on.\");\n\t  return;\n\t}\n\tvar userGR = new GlideRecord('sys_user');\n\tuserGR.get(recipientSysId);\n\t\n\tvar collabChatID = target.getValue('collab_chat');\n\t// get originator\n\tvar collabMemberGR = new GlideRecord('sys_cs_collab_member');\n\tcollabMemberGR.addQuery('collab_chat', collabChatID);\n\tcollabMemberGR.addQuery('member_type', 'creator');\n    collabMemberGR.query();\n\tvar requestorName = gs.getMessage(\"Someone\");\n\tif (collabMemberGR.next()) {\n\t\trequestorName = requestorName = collabMemberGR.getElement('member.display_name');\n\t}\n\t// get collab record (i.e. incident)\n\tvar collabRecordGR = new GlideRecord('sys_cs_collab_record');\n\tcollabRecordGR.addQuery('collab_chat', collabChatID);\n\tcollabRecordGR.query();\n\tif(collabRecordGR.next()) {\n\t\tvar tableName = collabRecordGR.getValue('table');\n\t\tvar documentGR = new GlideRecord(tableName);\n\t\tif(documentGR.get(collabRecordGR.getValue('document'))) {\n\t\t\tvar number = documentGR.getValue('number');\n\t\t\tvar recordID = documentGR.getValue('sys_id');\n\t\t\tvar documentID = documentGR.getUniqueValue();\n\t\t\tvar member = documentGR.getValue('member');\n\t\t\tvar formattedMessageHeading = gs.getMessage('Hi ') + userGR.getValue(\"first_name\") + ', ' + requestorName + gs.getMessage(' requests help in a Collaboration Chat, click on the record link and open a chat');\n\n\t\t\tvar recordLink =  gs.getProperty('glide.servlet.uri') + '/now/nav/ui/classic/params/target/' + tableName + '.do%3Fopen-collab-chat%3Dtrue%26sys_id%3D' + recordID + '%26collab_chat_id%3D' + collabChatID;\n\t\n\t\t\tvar formattedMessageContent = '[' + number + ']' +  '(' + recordLink + ')\\n'\n\t\t\t+ '\\n\\n**' + documentGR.getValue('short_description') + '**  \\n\\n'\n\t\t\t+ '**' + gs.getMessage(\"State\") + '**:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + \n\t\t\t\tdocumentGR.getDisplayValue('state') + '  \\n'\n\t\t\t+ '**' + gs.getMessage(\"Assigned To\") + '**:&nbsp;&nbsp;' +\n\t\t\t\tdocumentGR.getDisplayValue('assigned_to') + '  \\n';\n\t\t\tvar priority = documentGR.getDisplayValue('priority');\n\t\t\tif (priority) {\n\t\t\t\tformattedMessageContent +=  ('**' + gs.getMessage(\"Priority\") + '**:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' +\n\t\t\t\tdocumentGR.getDisplayValue('priority'));\n            }\n\t\treturn {messageHeading: formattedMessageHeading, messageContent: formattedMessageContent};\n\t\t}\n\t}else {\n\t\tgs.error(\"Could not send Notification for user: \" + recipientSysId +\n\t\t\t\t \"\\nAs Collaboration Chat could not be found: \" + collabChatID);\n\t}\n})(target, event, recipientTable, recipientSysId);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/53b1b0e79761011018b2fa98c253afcc","value":"53b1b0e79761011018b2fa98c253afcc"},"sys_update_name":"sys_notification_va_content_f93c7f1677420110e6330ea24b5a9905","name":"Collab Chat VA Notification Content","delivery_channels":"004a8122eb832010ad88ca5d235228bb,37263ba673b210104049dec2c4f6a77d,805a8122eb832010ad88ca5d235228e1,8ca0544053d110102f40ddeeff7b12be,d257e4e9c3d310106c9a5230d840ddd2,ea0cb816732110104a905ee515f6a7b5","fields":"","header_customization_script":"","sys_policy":""}]}