{"result":[{"sys_mod_count":"29","active":"true","sys_updated_on":"2023-01-03 19:26:47","sys_tags":"","type":"search_result","script":"function process(record) {\n\tvar transformableTables = ['sys_cs_collab_chat', 'sys_cs_collab_message', 'sys_cs_collab_attachment'];\n\tvar table = record.getTable();\n\tvar collabChat;\n\t\n    if (transformableTables.indexOf(table) === -1)\n\t\treturn;\n\t\n\tif (table == 'sys_cs_collab_chat') {\n\t\tcollabChat = sn_collab.CollabChatScriptObject.getCollabChatSearchResultView(\n\t\t\trecord.getSysId()\n\t\t);\n\t\n\t\tfor (var key in collabChat) {\n\t\t\trecord.addField(key, key, collabChat[key], collabChat[key]);\n\t\t}\n\t\t\n\t\treturn;\n\t}\n\t\n\tif (table == 'sys_cs_collab_message') {\n\t\tvar collabChatField = record.getField('collab_chat');\n\t\tvar messageId = record.getSysId();\n\t\tif (!collabChatField) {\n\t\t\tvar gr = new GlideRecord('sys_cs_collab_message');\n\t\t\t// if the record does not exist, some internal errors happen. Just return.\n\t\t\tif (!gr.get(messageId))\n\t\t\t\treturn;\n\n\t\t\tcollabChat = getCollabChatSearchResult(messageId, gr.getValue('collab_chat'));\n\t\t\trecord.addField('collab_chat', 'collab_chat', gr.getDisplayValue('collab_chat'), gr.getDisplayValue('collab_chat'));\n\t\t} else {\n\t\t\tcollabChat = getCollabChatSearchResult(messageId, collabChatField.getValue());\n\t\t}\n\t\n\t\tfor (var key in collabChat) {\n\t\t\trecord.addField(key, key, collabChat[key], collabChat[key]);\n\t\t}\n\t\t\n\t\treturn;\n\t}\n\t\n\tif (table == 'sys_cs_collab_attachment') {\n\n\t\tvar document = record.getField('document');\n\t\tvar documentValue = '';\n\t\tif (!document) {\n\t\t\tvar collabAttachmentId = record.getSysId();\n\t\t\tvar gr = new GlideRecord('sys_cs_collab_attachment');\n\t\t\tgr.get(collabAttachmentId);\n\t\t\tdocumentValue = gr.getValue('document');\n\t\t\trecord.addField('attachment_sys_id', 'attachment_sys_id', gr.getValue('attachment_sys_id'), gr.getValue('attachment_sys_id'));\n\t\t} else {\n\t\t\tdocumentValue = document.getValue();\n\t\t}\n\n\t\tcollabChat = sn_collab.CollabChatScriptObject.getCollabChatSearchResultView(\n\t\t\tdocumentValue\n\t\t);\n\t\n\t\tfor (var key in collabChat) {\n\t\t\trecord.addField(key, key, collabChat[key], collabChat[key]);\n\t\t}\n\t\t\n\t\treturn;\n\t}\n\t\n\treturn;\n}\n\nfunction getCollabChatSearchResult(messageId, collabChatId) {\n\tif (sn_collab.CollabChatScriptObject.getCollabChatSearchResultViewBySearchRecord) {\n\t\treturn sn_collab.CollabChatScriptObject.getCollabChatSearchResultViewBySearchRecord(messageId, 'MESSAGE');\n\t}\n\t//fallback to Tokyo version which retrieves the last message from chat\n\treturn sn_collab.CollabChatScriptObject.getCollabChatSearchResultView(collabChatId);\n}","sys_class_name":"sys_search_scripted_processor","sys_id":"6402ac8bc3a230100f24c87af040dd57","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/53b1b0e79761011018b2fa98c253afcc","value":"53b1b0e79761011018b2fa98c253afcc"},"sys_update_name":"sys_search_scripted_processor_6402ac8bc3a230100f24c87af040dd57","sys_updated_by":"admin","sys_created_on":"2021-09-16 16:21:03","name":"Transform Collab Chat Search Results","sys_name":"Transform Collab Chat Search Results","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/53b1b0e79761011018b2fa98c253afcc","value":"53b1b0e79761011018b2fa98c253afcc"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"2","active":"true","sys_updated_on":"2024-07-02 21:52:09","sys_tags":"","type":"search_result","script":"function process(record) {\n    // Add your code here\n    if (record.getTable() === \"par_visualization\") {\n        record.setUrl(\"/now/platform-analytics-workspace/visualization-designer/\" + record.getSysId() + \"?\");\n    } else if (record.getTable() === \"par_dashboard\") {\n        record.setUrl(\"/now/platform-analytics-workspace/dashboards/params/edit/false/sys-id/\" + record.getSysId() + \"?\");\n    } else if (record.getTable() === \"pa_indicators\") {\n        record.setUrl(\"/now/platform-analytics-workspace/ac_kpi_details/\" + record.getSysId() + \"?\");\n    }\n\n    return;\n}","sys_class_name":"sys_search_scripted_processor","sys_id":"693ad0b543e331102d2bda5e5bb8f229","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3c467b5f0bf130109e0fa4e6e9c4c946","value":"3c467b5f0bf130109e0fa4e6e9c4c946"},"sys_update_name":"sys_search_scripted_processor_693ad0b543e331102d2bda5e5bb8f229","sys_updated_by":"admin","sys_created_on":"2024-01-05 20:20:46","name":"Update PAR URLs","sys_name":"Update PAR URLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3c467b5f0bf130109e0fa4e6e9c4c946","value":"3c467b5f0bf130109e0fa4e6e9c4c946"},"sys_created_by":"admin","sys_policy":""},{"sys_mod_count":"2","active":"true","sys_updated_on":"2022-03-01 19:37:05","sys_tags":"","type":"search_result","script":"function process(record) {\n      if (record.getUrl()) return;\n      if (record.getTable() === \"kb_knowledge\") {\n        record.setUrl(\"kb_view.do?sys_kb_id=\"+record.getSysId()+\"&preview_article=true\");\n      } else if (record.getTable() === \"sc_cat_item\") {\n        record.setUrl(\"com.glideapp.servicecatalog_cat_item_view.do?v=1&sysparm_id=\"+record.getSysId());\n      }\n\n      return;\n    }\n    ","sys_class_name":"sys_search_scripted_processor","sys_id":"896eff5425c64110f877ee387c913869","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3c467b5f0bf130109e0fa4e6e9c4c946","value":"3c467b5f0bf130109e0fa4e6e9c4c946"},"sys_update_name":"sys_search_scripted_processor_896eff5425c64110f877ee387c913869","sys_updated_by":"maint","sys_created_on":"2022-03-01 19:03:03","name":"Add Missing URL","sys_name":"Add Missing URL","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/3c467b5f0bf130109e0fa4e6e9c4c946","value":"3c467b5f0bf130109e0fa4e6e9c4c946"},"sys_created_by":"maint","sys_policy":""},{"sys_mod_count":"49","active":"true","sys_updated_on":"2022-08-26 11:11:22","sys_tags":"","type":"genius_result","script":"function process(record) {\n    var table = record.getField('table');\n    if (!table || table.getValue() != 'sys_user') {\n        return;\n    }\n\n    var formattedLocation = '';\n\n    var locationField = record.getField('location');\n    if (!locationField) {\n        return;\n    }\n\n    var locationRef = locationField.getValue();\n    locationField.setDisplayValue(formattedLocation);\n    if (!locationRef) {\n        return;\n    }\n\n    var locationGr = new GlideRecord('cmn_location');\n    locationGr.get(locationRef);\n    var locationArr = [];\n    locationArr[0] = locationGr.getDisplayValue('city');\n    locationArr[1] = locationGr.getDisplayValue('state');\n    locationArr[2] = locationGr.getDisplayValue('country');\n\n    locationArr.forEach(function(elm) {\n        elm = elm ? elm.trim() : elm;\n        if (elm) {\n            formattedLocation = formattedLocation ? (formattedLocation + ', ' + elm) : (formattedLocation + elm);\n        }\n    });\n\n    locationField.setDisplayValue(formattedLocation);\n\n    return record;\n}","sys_class_name":"sys_search_scripted_processor","sys_id":"b42748b40d61d110f87727e81acb8fef","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/b3f3303477232300454792718a1061df","value":"b3f3303477232300454792718a1061df"},"sys_update_name":"sys_search_scripted_processor_b42748b40d61d110f87727e81acb8fef","sys_updated_by":"admin","sys_created_on":"2022-08-23 13:55:14","name":"Format User Location","sys_name":"Format User Location","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/b3f3303477232300454792718a1061df","value":"b3f3303477232300454792718a1061df"},"sys_created_by":"maint","sys_policy":""},{"sys_mod_count":"2","active":"true","sys_updated_on":"2020-10-18 03:18:43","sys_tags":"","type":"search_result","script":"function process(record) {\n\t/**\n\t * This OOTB scripted processor is read-only. If you need to customize the behavior of this\n\t * processor, you need to create your own scripted processor by copying this script and\n\t * making yuor changes there. Then you can link your own script to your search application\n\t * configuration.\n\t */ \n\t\n    var transformableTables = ['kb_knowledge'];\n    var transformableDateFields = ['sys_updated_on'];\n\t\n\tvar table = record.getTable();\n\t\n\t// It is a good practice to early terminate if possible, to avoid unnecessary overhead.\n    if (transformableTables.indexOf(table) === -1)\n\t\treturn;\n\n    function transformToHumanFriendlyDate(rawDate) {\n        // Time gaps in ms\n        var MINUTE_GAP = 60000;\n        var HOUR_GAP = 3600000;\n        var DAY_GAP = 86400000;\n        var WEEK_GAP = 604800000;\n        var MONTH_GAP = 2592000000;\n        var YEAR_GAP = 31536000000;\n\n        var gap = new Date().getTime() - rawDate;\n        if (gap < MINUTE_GAP) {\n            return gs.getMessage('Just Now');\n        } else if (gap > MINUTE_GAP && gap < 2 * MINUTE_GAP) {\n            return gs.getMessage('1 minute ago');\n        } else if (gap < HOUR_GAP) {\n            return gs.getMessage('{0} minutes ago', '' + Math.floor(gap / MINUTE_GAP));\n        } else if (gap > HOUR_GAP && gap < 2 * HOUR_GAP) {\n            return gs.getMessage('1 hour ago');\n        } else if (gap < DAY_GAP) {\n            return gs.getMessage('{0} hours ago', '' + Math.floor(gap / HOUR_GAP));\n        } else if (gap > DAY_GAP && gap < 2 * DAY_GAP) {\n            return gs.getMessage('1 day ago');\n        } else if (gap < WEEK_GAP) {\n            return gs.getMessage('{0} days ago', '' + Math.floor(gap / DAY_GAP));\n        } else if (gap > WEEK_GAP && gap < 2 * WEEK_GAP) {\n            return gs.getMessage('1 week ago');\n        } else if (gap < MONTH_GAP) {\n            return gs.getMessage('{0} weeks ago', '' + Math.floor(gap / WEEK_GAP));\n        } else if (gap > MONTH_GAP && gap < 2 * MONTH_GAP) {\n            return gs.getMessage('1 month ago');\n        } else if (gap < YEAR_GAP) {\n            return gs.getMessage('{0} months ago', '' + Math.floor(gap / MONTH_GAP));\n        } else if (gap > YEAR_GAP && gap < 2 * YEAR_GAP) {\n            return gs.getMessage('1 year ago');\n        } else {\n            return gs.getMessage('{0} years ago', '' + Math.floor(gap / YEAR_GAP));\n        }\n    }\n\n\tfor (var i = 0; i < transformableDateFields.length; i++) {\n\t\tvar fieldName = transformableDateFields[i];\n\t\tvar updatedDateField = record.getField(fieldName);\n\t\tif (updatedDateField !== null) {\n\t\t\tvar updatedDateRaw = updatedDateField.getValue();\n\t\t\tif (updatedDateRaw != null) {\n\t\t\t\tvar humanFriendlyDate = transformToHumanFriendlyDate(updatedDateRaw);\n\t\t\t\tupdatedDateField.setDisplayValue(humanFriendlyDate);\n\t\t\t}\n\t\t}\n\t}\n}","sys_class_name":"sys_search_scripted_processor","sys_id":"ee8d73425b331010d9a5ce1a8581c7f2","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/0a99ab7b04f12210559073c06a02f746","value":"0a99ab7b04f12210559073c06a02f746"},"sys_update_name":"sys_search_scripted_processor_ee8d73425b331010d9a5ce1a8581c7f2","sys_updated_by":"admin","sys_created_on":"2020-10-13 16:41:55","name":"Transform Date to User Friendly Format","sys_name":"Transform Date to User Friendly Format","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","sys_policy":""}]}