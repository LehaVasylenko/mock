{"result":[{"short_description":"Require Authentication by Default for Client-Callable Script Includes","description":"This property makes sure that Client-Callable Script Includes, also known as Ajax Script Includes, are not automatically made available to non-authenticated users. If \"glide.script.ccsi.ispublic\" is not set to the recommended value of \"False\", then it will allow Script Includes to be run as public scripts and allow unauthenticated users access to instance data.","sys_updated_on":"2023-10-06 17:27:47","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"046598c8d5001110fa9bdbc0c4c2ab75","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:37","sys_name":"Require Authentication by Default for Client-Callable Script Includes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.script.ccsi.ispublic\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:privacy-on-client-callable-script-includes","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.script.ccsi.ispublic';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_046598c8d5001110fa9bdbc0c4c2ab75","name":"Require Authentication by Default for Client-Callable Script Includes","category":"security","sys_policy":"read"},{"short_description":"Restrict Impersonation to Admin","description":"When the Glide Property 'glide.sys.permissive.impersonate' is set to a value of  'false', only users with the 'admin' role may impersonate. When this value is set to 'true', users may be able to make use of application components that expose impersonation APIs to impersonate a higher privileged user. This may result in unauthorized resource access if these application components are misconfigured.","sys_updated_on":"2024-08-30 00:11:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"05cfa14694905210f87753480ed46d9a","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-30 00:11:54","sys_name":"Restrict Impersonation to Admin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.sys.permissive.impersonate' is set to a value of 'false'. If this property does not exist, the default value is 'false'. Note : This is a safe db override property and cannot be altered once set to recommended value.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-impersonation-to-admin","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sys.permissive.impersonate';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_05cfa14694905210f87753480ed46d9a","name":"Restrict Impersonation to Admin","category":"security","sys_policy":"read"},{"short_description":"Enforce OAuth State Parameter Validation","description":"The \"glide.oauth.state.paramater.required system\" property enables the \"State\" parameter to be required in an OAuth request for authorization code flow. Beginning in the Madrid release, the system property \"glide.oauth.state.parameter.required\" adds a \"State\" parameter for an OAuth request. For zbooted instances, the property is true. For upgraded instances, the property is not present, so the \"State\" parameter is not enabled. The \"State\" parameter is a string value, and should not contain special characters. The State parameter cannot be empty or \" \". Not enabling the \"State\" parameter to \"true\" ensures that an attacker cannot perform CSRF attacks during authentication can allow an attacker to perform operations as the victim.","sys_updated_on":"2023-10-06 17:27:48","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"07aff094779821108bd73a91fa5a99d1","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enforce OAuth State Parameter Validation","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure that the property \"glide.oauth.state.parameter.required\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-oauth-state-param-validation","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.oauth.state.parameter.required';\n    var expectedValue = 'true';\n\n    // If not found in Glide Property table, it will default to \"false\" in source code.\n    var propertyValue = gs.getProperty(targetProperty, 'false');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_07aff094779821108bd73a91fa5a99d1","name":"Enforce OAuth State Parameter Validation","category":"security","sys_policy":"read"},{"short_description":"Enforce Field Level ACLs in GlideRecordSandbox","description":"Enforces field level ACLs in GlideRecordSandbox. The context in which this comes into the picture is in places where user can provide script, like in sysparm_query, filters etc. Using these vectors, if \"glide.sandbox.fields.check_acl\" is not set to the recommended value of \"true\", then ACL restrictions can be bypassed and allow sensitive data to be read such as sys_user.user_password from an external, public, or internal low privileged user.","sys_updated_on":"2023-10-06 17:27:48","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"07aff094779821108bd73a91fa5a99d2","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enforce Field Level ACLs in GlideRecordSandbox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.sandbox.fields.check_acl\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-field-level-acls-grsandbox","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sandbox.fields.check_acl';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_07aff094779821108bd73a91fa5a99d2","name":"Enforce Field Level ACLs in GlideRecordSandbox","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for PDF Requests","description":"If \"glide.basicauth.required.pdf\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for PDF format export processor. This also happens when combined with a wrong role within the guest_user related property (For example a high privileged user such as Admin). This will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"096598c8d5001110fa9bdbc0c4c2abdc","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:40","sys_name":"Require Authorization for PDF Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.pdf\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:pdf-request-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.pdf';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_096598c8d5001110fa9bdbc0c4c2abdc","name":"Require Authorization for PDF Requests","category":"security","sys_policy":"read"},{"short_description":"Enable Work Order Management Query Rules for Service Organizations","description":"When set to 'true', rules/filters from sn_query_rule table will be used to determine read access to Field Service Management-related tables (Work Order and Work Order Task) to the logged in user through query business rules and read ACLs. When 'false', the records won't be filtered based on query rules. Query business rules add additional security validations. Specifically, this property will filter records for agents, qualifiers, and dispatchers based on their assigned territory or territory membership. It is best practice to follow the principle of least privilege when reading records. When this property is not set to 'true', there may be increased risk of data exposure from Field Service Management tables.","sys_updated_on":"2024-01-03 15:38:26","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"0a5485855323311053a6ddeeff7b1237","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-01-03 15:38:26","sys_name":"Enable Work Order Management Query Rules for Service Organizations","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'sn_fsm.use_query_rules' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-work-order-management","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var enabledPlugin = new GlidePluginManager().isActive('com.snc.work_management');\n    var targetProperty = 'sn_fsm.use_query_rules';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (enabledPlugin) {\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_0a5485855323311053a6ddeeff7b1237","name":"Enable Work Order Management Query Rules for Service Organizations","category":"security","sys_policy":"read"},{"short_description":"Limit Integrations' Active Session Life Span","description":"This configuration will enforce max lifespan on active guest HTTP sessions irrespective of inactive timeout. The configured value is in minutes and the value of zero will disable timing out the active sessions. A larger maximum lifespan could allow an attacker to persist in a stolen session for longer, increasing the scope of a security incident. This particular property is limited to integrations that have low-privilege access to an instance.","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"0b321930774031101b803a91fa5a9946","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:15","sys_name":"Limit Integrations' Active Session Life Span","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Set the Glide Property 'glide.integrations.active.session.life_span' to a value greater than 0 and less than or equal to 720.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-integrations-active-session","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.integrations.active.session.life_span';\n    var expectedValue = 720;\n    var defaultValue = 0;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    // Value should be greater than or equal to 0 and less than 720\n    // 0 = disabled, greater than 720 is too long a timeout\n    if (isNaN(propertyValue) || (parseInt(propertyValue, 10) <= 0) || (parseInt(propertyValue, 10) > expectedValue)) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_0b321930774031101b803a91fa5a9946","name":"Limit Integrations' Active Session Life Span","category":"security","sys_policy":"read"},{"short_description":"Block Expired Anti-CSRF Tokens","description":"This property allows usage of an expired secure token to identify and validate incoming requests. This token is used to prevent cross-site request forgery attacks.","sys_updated_on":"2023-12-26 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"0baff094779821108bd73a91fa5a99d0","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Block Expired Anti-CSRF Tokens","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.security.csrf_previous.allow\" is set to \"false\"","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:block-expired-csrf-tokens","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.csrf_previous.allow';\n    var expectedValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, 'true');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_0baff094779821108bd73a91fa5a99d0","name":"Block Expired Anti-CSRF Tokens","category":"security","sys_policy":"read"},{"short_description":"Limit Attachment Size in Training and Prediction Flows","description":"This property \"glide.platform_ml_di.max_attachment_size\" dependent on plugin 'Platform Document Intelligence' controls the maximum allowed size limit for returning attachments in training or prediction flows. If \"glide.platform_ml_di.max_attachment_size\" is not set to the recommended value of 4000000 or less, then returning large files could cause a denial of service.","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"0f321930774031101b803a91fa5a9951","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Limit Attachment Size in Training and Prediction Flows","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('u')","resolution_details":"Ensure the property \"glide.platform_ml_di.max_attachment_size\" is set to \"4000000\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-attachment-size-in-training","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n\n    var targetProperty = 'com.glide.attachment.max_get_size';\n    var expectedValue = 4000000;\n    var defaultValue = 4000000;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    var enabledPluginAppStore = GlidePluginManager.isActive('com.glide.platform_ml_di');\n    // Need to validate if property value is a integer in the chance that\n    // for some reason the value was improperly set by a user to a string value.\n    if (enabledPluginAppStore) {\n        defaultValue = 30000000;\n        expectedValue = 30000000;\n    }\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        finding.increment();\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_0f321930774031101b803a91fa5a9951","name":"Limit Attachment Size in Training and Prediction Flows","category":"security","sys_policy":"read"},{"short_description":"Enforce Production Instance Behavior","description":"If \"glide.installation.production\" is not set to the recommended value of \"true\", then the instance is not treated as a production instance, permitting zboot and other potentially dangerous scripts. Allowing a production instance to be evaluated as non-production can lead to information disclosure or denial of service.","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"0faff094779821108bd73a91fa5a99d1","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enforce Production Instance Behavior","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.installation.production\" is set to \"true\" on a production instance.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:prod-instance-behavior","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.installation.production';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_0faff094779821108bd73a91fa5a99d1","name":"Enforce Production Instance Behavior","category":"security","sys_policy":"read"},{"short_description":"Enforce Credential Alias Usage","description":"The MID Server Property 'alias_filtering_behavior' defines the behavior of Discovery aliases. When the behavior is not 'strict', then all credentials are used regardless of their aliases for Discovery schedules. This behavior might not be desirable in some circumstances, particularly for credentials with elevated privileges. Credential aliases provide more control over which credentials a Discovery schedule is allowed to use and prevents the unnecessary exposure of credentials with elevated privileges.","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"1232d530774031101b803a91fa5a99bf","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:12","sys_name":"Enforce Credential Alias Usage","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the MID Server Property 'alias_filtering_behavior' to the value 'strict'.\n\nSee https://docs.servicenow.com/bundle/tokyo-servicenow-platform/page/product/mid-server/reference/r_MIDServerProperties.html for instructions on creating/setting MID Server Properties.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-credential-alias","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n\n    // Query to see if any MID Servers are configured\n    var gr1 = new GlideRecord('ecc_agent');\n    gr1.query();\n\n    // Query for MID Server Property alias_filtering_behavior\n    var gr2 = new GlideRecord('ecc_agent_property');\n    var propQuery = 'name=alias_filtering_behavior^value=strict';\n    gr2.addEncodedQuery(propQuery);\n    gr2.query();\n\n    // Check to make sure MID Server functionality is utilized before returning a finding\n    // If the property table record does not exit, then default is loose, which is a finding\n    if (gr1.next()) {\n        if (!gr2.next()) {\n            var gr = new GlideRecord('ecc_agent_property');\n            gr.addEncodedQuery(propQuery);\n            gr.query();\n            gr.next();\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_1232d530774031101b803a91fa5a99bf","name":"Enforce Credential Alias Usage","category":"security","sys_policy":"read"},{"short_description":"Anti-CSRF Token Validation Time","description":"Time in seconds for a secure token to expire. When the user session expires, the secure token expires with it, unless the \"allowing reuse of expired tokens are allowed\" property is enabled, and its within the time frame described by this property. This token is used to prevent cross site request forgery attacks. (default is 86400 seconds or 1 day).","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"13321930774031101b803a91fa5a996f","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Anti-CSRF Token Validation Time","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure glide.security.csrf_previous.time_limit is set to 86400 secs (1 day).","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:anti-csrf-token-validation-time","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.csrf_previous.time_limit';\n    var expectedValue = 86400;\n    var defaultValue = 86400;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_13321930774031101b803a91fa5a996f","name":"Anti-CSRF Token Validation Time","category":"security","sys_policy":"read"},{"short_description":"Escape XML Markup","description":"This property escapes XML values at the parser level for the user interface. It prevents reflected and stored cross-site scripting attacks. If \"glide.ui.escape_text\" is not set to the recommended value of \"true\", then XML values will not be escaped at the parser level for the user interface; this will leave jelly templates susceptible to reflected and stored cross site scripting attacks. This property is not applicable in Service Portal.","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"146598c8d5001110fa9bdbc0c4c2ab82","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:37","sys_name":"Escape XML Markup","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.escape_text\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:escape-xml","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.escape_text';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_146598c8d5001110fa9bdbc0c4c2ab82","name":"Escape XML Markup","category":"security","sys_policy":"read"},{"short_description":"Disable Legacy AngularJS Behavior","description":"If \"glide.angular.legacy\" is not set to the recommended value of \"false\", then older prepatched angularJS versions are used. This could potentially lead to security risks arising from attacks on vulnerabilities discovered in outdated AngularJS library versions. This property was introduced for Quebec to patch angularJS security issues in versions 1.4 and 1.5.11. The system property is a failsafe in case any organizations depend on the non-patched versions of angularJS to run their custom implementations.","sys_updated_on":"2023-10-06 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"196598c8d5001110fa9bdbc0c4c2abfe","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:41","sys_name":"Disable Legacy AngularJS Behavior","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.angular.legacy\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:legacy-angularjs-behavior","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.angular.legacy';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_196598c8d5001110fa9bdbc0c4c2abfe","name":"Disable Legacy AngularJS Behavior","category":"security","sys_policy":"read"},{"short_description":"Disable Entity Expansion within the XMLDocument2 Streaming Parser","description":"If \"glide.stax.allow_entity_resolution\" is not set to the recommended value of \"False\", then this property allow XML entities to be expanded during parsing by the streaming parser (XMLDocument2). XML entity expansion can lead to attacks such as ability to read system files, and Denial of Service.","sys_updated_on":"2023-12-26 17:27:49","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"1965d8c8d5001110fa9bdbc0c4c2ab45","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:41","sys_name":"Disable Entity Expansion within the XMLDocument2 Streaming Parser","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.stax.allow_entity_resolution\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-entity-expansion","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.stax.allow_entity_resolution';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_1965d8c8d5001110fa9bdbc0c4c2ab45","name":"Disable Entity Expansion within the XMLDocument2 Streaming Parser","category":"security","sys_policy":"read"},{"short_description":"Verify Certificate Chain and Hostname","description":"When the Glide Property \"com.glide.communications.httpclient.verify_hostname\" is not set to the secure value of \"true\", the hostname and certificate chain presented by remote hosts during a TLS connection initiated from the ServiceNow instance are not validated. This could compromise the security of the TLS connection and allow person-in-the-middle attacks, where communications between two parties are intercepted. This may lead to sensitive data disclosure.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"1e32d530774031101b803a91fa5a99eb","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:13","sys_name":"Verify Certificate Chain and Hostname","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure com.glide.communications.httpclient.verify_hostname is set to the secure value of 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:verify-certificate-chain-and-hostname","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.communications.httpclient.verify_hostname';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_1e32d530774031101b803a91fa5a99eb","name":"Verify Certificate Chain and Hostname","category":"security","sys_policy":"read"},{"short_description":"Password2 Fields with short KMF format","description":" This check will identify password2 records whose encrypted text exceeds field length and uses short KMF Format.","sys_updated_on":"2023-08-04 07:05:18","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"215c668b4fd071103bcb2894c8c7144c","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-08-01 14:48:08","sys_name":"Password2 Fields with short KMF format","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","run_condition":"gs.getProperty('glide.password2.legacycode.disabled', 'false') == 'true' && gs.getProperty('glide.password2.honor.attributes', 'true') == 'false'","resolution_details":"Reduce the length of the password or increase the length of the password2 field and re-enter the values to mitigate the incompatibility issue.","sys_mod_count":"0","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1443041","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(engine) {\n    var ENCRYPTION_START_TAG_STRING = \"\\uFDE3\";\n    var dictionaryGr = new GlideRecord('sys_dictionary');\n    dictionaryGr.addQuery('internal_type', 'password2');\n    dictionaryGr.addQuery('attributes','CONTAINS', 'is_fallback_module_encrypted=true');\n    dictionaryGr.query();\n\n    var tableMap = {};\n    while (dictionaryGr.next()) {\n        var tableName = dictionaryGr.getValue('name');\n        var columnName = dictionaryGr.getValue('element');\n        addToMap(tableMap, tableName, columnName);\n    }\n\n    for (table in tableMap) {\n        var fieldNames = tableMap[table];\n        var tableGr = new GlideRecord(table);\n        if (!tableGr.isValid()) {\n            continue;\n        }\n        tableGr.query();\n        while (tableGr.next()) {\n            for (var i = 0; i < fieldNames.length; i++) {\n                var columnValue = tableGr.getValue(fieldNames[i]);\n                if (JSUtil.nil(columnValue)) {\n                    continue;\n                }\n                if (columnValue.startsWith(ENCRYPTION_START_TAG_STRING)) {\n                    finding.setCurrentSource(tableGr);\n                    finding.increment();\n                }\n            }\n        }\n    }\n\n    function addToMap(object, key, value) {\n        if (!object[key])\n            object[key] = [value];\n        else\n            object[key].push(value);\n    }\n})(engine);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_script_only_check_215c668b4fd071103bcb2894c8c7144c","name":"Password2 Fields with short KMF format","category":"security","sys_policy":"read"},{"short_description":"Require Captcha for Guest Walk-up Experience in Customer Service Application","description":"The captcha for the Guest Walk-up experience prevents unauthenticated guest users to create bookings by requiring users to complete a captcha verification. If captcha is not enabled, this could lead to automated creation of spam appointments to overwhelm the system or fill up all available booking spots creating a Denial of Service attack.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"23321930774031101b803a91fa5a99a4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:18","sys_name":"Require Captcha for Guest Walk-up Experience in Customer Service Application","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"If Guest Walk-up Experience for Customer Service application is active, ensure sn_guest_walkup_cs.captcha.enabled to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:require-captcha-for-guest-walk-up-experience","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n\n    var pluginManager = new GlidePluginManager();\n\n    //If the relevant store app is active\n    if (pluginManager.isActive('sn_guest_walkup_cs')) {\n\n        var targetProperty = 'sn_guest_walkup_cs.captcha.enabled';\n        var expectedValue = 'true';\n        var defaultValue = 'true';\n\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_23321930774031101b803a91fa5a99a4","name":"Require Captcha for Guest Walk-up Experience in Customer Service Application","category":"security","sys_policy":"read"},{"short_description":"Enable Policy Based Session Access for Mobile","description":"The Zero Trust - Policy Based Session Access plugin allows security admins to reduce user access in a session based on IP, Location, Identity provider attributes and user attributes using adaptive authentication policies. When this property is enabled (set to 'true'), then users logging in via mobile device will have their roles restricted as configured by the plugin policies. Instance admins may wish to restrict high privileged access when users login via mobile device, possible indicating an unsafe environment for sensitive operations.","sys_updated_on":"2024-01-03 15:50:19","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"23888d895323311053a6ddeeff7b126d","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-01-03 15:50:19","sys_name":"Enable Policy Based Session Access for Mobile","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'glide.authenticate.session_access.mobile.enabled' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-policy-based-session","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var enabledPlugin = new GlidePluginManager().isActive('com.snc.zero_trust_session_access');\n    var targetProperty = 'glide.authenticate.session_access.mobile.enabled';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (enabledPlugin) {\n        enabledProperty = gs.getProperty('glide.authenticate.session_access.enabled', 'false');\n        if (enabledProperty.toLowerCase() == 'true') {\n            if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n                var gr = new GlideRecord('sys_properties');\n                gr.get('name', targetProperty);\n                finding.setCurrentSource(gr);\n                finding.increment();\n            }\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_23888d895323311053a6ddeeff7b126d","name":"Enable Policy Based Session Access for Mobile","category":"security","sys_policy":"read"},{"short_description":"Enforce Secure Referrer Policy","description":"When the glide property  'com.glide.security.referrerpolicy' is set to 'default', this property ensures managing the Referrer-Policy HTTP header with the level of information sent that is appropriate for the specific Now Platform page request. This prevents leaks of unauthorized data that may be accessible from other parts of the full URL such as the path and query string.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"26321930774031101b803a91fa5a9906","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:13","sys_name":"Enforce Secure Referrer Policy","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure Glide Property 'com.glide.security.referrerpolicy' is set to 'default'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-secure-referrer","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.security.referrerpolicy';\n    var expectedValue = 'default';\n    var defaultValue = 'default';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_26321930774031101b803a91fa5a9906","name":"Enforce Secure Referrer Policy","category":"security","sys_policy":"read"},{"short_description":"Enable HTTP Only Cookie Flag","description":"If \"glide.cookies.http_only\" is not set to the recommended value of \"true\", then the instance does not require the HTTPOnly attribute for sensitive cookies. The HTTPOnly attribute is used to prevent attacks, such as cross-site scripting, because it doesn't allow access to the cookie using a client-side script, such as JavaScript.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"2c6598c8d5001110fa9bdbc0c4c2ab97","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:38","sys_name":"Enable HTTP Only Cookie Flag","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.cookies.http_only\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:cookies-http-only","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.cookies.http_only';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_2c6598c8d5001110fa9bdbc0c4c2ab97","name":"Enable HTTP Only Cookie Flag","category":"security","sys_policy":"read"},{"short_description":"Enforce Device Encryption and Passcode Requirements","description":"When the Glide Property 'glide.sg.device_encryption_enabled' is set to true, the ServiceNow mobile app will check that device encryption is enabled and that device passcode is enabled. If encryption or passcode is not enabled, the user will not be allowed to log into the instance on mobile. This property enforces FIPS 140-2 Encryption. Mobile device encryption and passcode are important security features for ensuring an unauthorized user cannot access the content of the device even if the device is physically obtained.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"2f321930774031101b803a91fa5a9998","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:17","sys_name":"Enforce Device Encryption and Passcode Requirements","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'glide.sg.device_encryption_enabled' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-device-encryption-and-passcode","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sg.device_encryption_enabled';\n    var expectedValue = 'true';\n\n    // Default value is different based off of regulated instance property (GCC, etc.)\n    var defaultValue = gs.getProperty('glide.regulated_instance', 'false');\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_2f321930774031101b803a91fa5a9998","name":"Enforce Device Encryption and Passcode Requirements","category":"security","sys_policy":"read"},{"short_description":"Restrict Global App Development by Role","description":"The property \"sn_g_app_creator.allow_global\" controls which users can create applications in the global scope using the Guided Application Creator. If \"sn_g_app_creator.allow_global\" is set to the recommended value of \"false\", users need the role \"sn_g_app_creator.global\" to create an application in the global scope using Guided Application Creator. If \"sn_g_app_creator.allow_global\" is set to the insecure value of \"true\" then all users with only the base role \"sn_g_app_creator.app_creator\" can create an application in the global scope using Guided Application Creator. Applications in the global scope do not contain scope protections allowing a developer to access greater features and functions beyond a specific scope. Limiting global application development to users with the additional role follows the principle of least privilege.","sys_updated_on":"2024-08-29 23:56:35","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"2f3ce50294905210f87753480ed46dba","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-29 23:56:35","sys_name":"Restrict Global App Development by Role","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"sn_g_app_creator.allow_global\" is set to \"false\" or does not appear in the sys_properties table. If the property is not present in the sys_properties table the secure default will be used. ","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-global-app-dev-by-role","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'sn_g_app_creator.allow_global';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_2f3ce50294905210f87753480ed46dba","name":"Restrict Global App Development by Role","category":"security","sys_policy":"read"},{"short_description":"Enforce Scope Security for Public Sector Digital Services","description":"When the Glide Property 'glide.enforce_security_scope.sn_gsm' is not set to 'true', access to application data from the Public Sector Digital Services application residing in global tables may be accessible based on the ACLs of those global tables. When this property is set to 'true', access to data residing in global tables is only evaluated based off of the ACLs shipped directly in the Public Sector Digital Services application. An unsafe value of this property may lead to information disclosure from overpermissive access controls.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"36321930774031101b803a91fa5a993b","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:15","sys_name":"Enforce Scope Security for Public Sector Digital Services","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Set the Glide Property 'glide.enforce_security_scope.sn_gsm' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-scope-security-for-public","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    if (GlidePluginManager.isActive('com.sn_public_sector_digital_services_core')) {\n        var targetProperty = 'glide.enforce_security_scope.sn_gsm';\n        var expectedValue = 'true';\n\n        // For customers having the PSDS core application installed prior to Utah release - This property is NOT inserted in sys_properties table. \n        // Hence, platform takes the default value false.\n        var defaultValue = 'false';\n\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_36321930774031101b803a91fa5a993b","name":"Enforce Scope Security for Public Sector Digital Services","category":"security","sys_policy":"read"},{"short_description":"GlideEncrypter API is deprecated","description":"The GlideEncrypter API will be deprecated for the ServiceNow platform. The API will no longer be supported and will soon be removed in future releases of the platform.\r\n\t\t\t\r\nDue to evolving security standards and for the safety of our customers, the decision has been made to deprecate this API.","sys_updated_on":"2024-09-23 11:20:11","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"457e9a8bffd802107497fffffffffff5","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-02-16 09:58:45","sys_name":"Deprecated API: GlideEncrypter usages in selective String fields","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Customers should migrate their GlideEncrypter usages to alternative encryption methods. The ServiceNow platform offers a variety of encryption options. For more information, see KB https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1320986\r\n\t\t\t\r\nContinued use of the GlideEncrypter API poses a security risk to your data and will result in compatibility issues with future releases of the ServiceNow platform.","sys_mod_count":"19","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1320986","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function (engine) {\n\n    var tableColumnsMap = {\"sys_trigger\" : [\"script\", \"job_context\"],\n\t\t\t\t\t\t\"kb_navons\" : [\"script\"],\n\t\t\t\t\t\t\"sys_ui_style\" : [\"value\"],\n\t\t\t\t\t\t\"sysevent_in_email_action\" : [\"condition_script\"],\n\t\t\t\t\t\t\"par_coreui_migration_script\" : [\"script\"],\n\t\t\t\t\t\t\"gs_entitlement_plugin_mapping\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sys_jelly_file\" : [\"script\"],\n\t\t\t\t\t\t\"sysrule_assignment\" : [\"script\"],\n\t\t\t\t\t\t\"sys_filter_option_dynamic\" : [\"script\"],\n\t\t\t\t\t\t\"ecc_agent_script_file\" : [\"script\"],\n\t\t\t\t\t\t\"expert_panel_redirect\" : [\"script\"],\n\t\t\t\t\t\t\"sys_transform_entry\" : [\"source_script\"],\n\t\t\t\t\t\t\"discovery_probe_parameter\" : [\"value_script\"],\n\t\t\t\t\t\t\"cmn_notif_service_provider\" : [\"construction_script\", \"script\"],\n\t\t\t\t\t\t\"sc_cat_item_delivery_plan\" : [\"script\"],\n\t\t\t\t\t\t\"ecc_queue_config\" : [\"notify_script\"],\n\t\t\t\t\t\t\"sys_wizard_answer\" : [\"script\"],\n\t\t\t\t\t\t\"sysevent_script_action\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sys_impex_map\" : [\"condition_script\"],\n\t\t\t\t\t\t\"ecc_event_handler\" : [\"script\"],\n\t\t\t\t\t\t\"sysrule_approvals\" : [\"script\"],\n\t\t\t\t\t\t\"sys_declarative_action_assignment\" : [\"script_condition\", \"scripted_client_condition\", \"dynamic_script_condition\"],\n\t\t\t\t\t\t\"sys_sg_button\" : [\"condition_script\", \"offline_condition_script\"],\n\t\t\t\t\t\t\"sys_app_payload_unloader_rule\" : [\"script_condition\"],\n\t\t\t\t\t\t\"sysevent_email_template\" : [\"message\"],\n\t\t\t\t\t\t\"sn_cloud_discovery_retry_configuration\" : [\"script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_rule\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_action_type\" : [\"action_script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_condition_type\" : [\"condition_script\", \"condition_invocation_script\"],\n\t\t\t\t\t\t\"discovery_classifier_probe\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_condition\" : [\"script\"],\n\t\t\t\t\t\t\"sn_cmp_rb_resourcescript\" : [\"script\"],\n\t\t\t\t\t\t\"sn_cmp_cloud_event_handler\" : [\"run_handler_script\"],\n\t\t\t\t\t\t\"sn_capi_response_processor\" : [\"script\"],\n\t\t\t\t\t\t\"web_service_launcher_lookup\" : [\"launch_script\"],\n\t\t\t\t\t\t\"task_rel_type\" : [\"child_script\", \"parent_script\"],\n\t\t\t\t\t\t\"task_rel_allowed\" : [\"child_script\"],\n\t\t\t\t\t\t\"sys_hub_input_scripts\": [\"script\"]\n\t\t\t\t\t\t};\n\n\tvar search_regex = /new\\s*GlideEncrypter\\s*\\(/;\n\tvar code_comments_regex = /\\/\\*[\\s\\S]*?\\*\\/|([^:]|^)\\/\\/.*$/gm;\n\tvar ISNOTEMPTY_LITERAL = \"ISNOTEMPTY\";\n\tvar OR_QUERY_LITERAL = \"^OR\";\n\n\tfor(var table in tableColumnsMap) {\n\t\tvar columns = tableColumnsMap[table];\n\t\tvar gr = new GlideRecord(table);\n\t\tif(!gr.isValid())\n\t\t\tcontinue;\n\n\t\tvar query = \"\";\n\t\tfor(var column in columns) {\n\t\t\tif(!gr.isValidField(columns[column]))\n\t\t\t\tcontinue;\n\t\t\tquery += columns[column] + ISNOTEMPTY_LITERAL;\n\t\t\tif(column < columns.length - 1)\n\t\t\t\tquery += OR_QUERY_LITERAL;\n\t\t}\n\t\tgr.addEncodedQuery(query);\n\t\tgr.query();\n\n\t\twhile(gr.next()) {\n\t\t\tfor(var i in columns) {\n\t\t\t\tvar columnValue = gr.getValue(columns[i]);\n\t\t\t\tif (!search_regex.test(columnValue))\n\t\t\t\t\tcontinue;\n\n\t\t\t\t//remove code comments\n\t\t\t\tvar commentsRemovedValue = columnValue.replace(code_comments_regex, '');\n\n\t\t\t\t//raise finding if no comments found or usage found in commentsRemovedValue\n\t\t\t\tif (commentsRemovedValue.length == columnValue.length || search_regex.test(commentsRemovedValue)) {\n\t\t\t\t\tengine.finding.setCurrentSource(gr);\n\t\t\t\t\tengine.finding.increment();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n})(engine);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_script_only_check_457e9a8bffd802107497fffffffffff5","name":"Deprecated API: GlideEncrypter usages in selective String fields","category":"security","sys_policy":"read"},{"short_description":"Enable Jelly JS Interpolation Protection","description":"This property allows a customer to turn on or off interpolation protection. Interpolation protection ensures that when Jelly expressions are used in JavaScript, they must be deemed safe by either falling under certain categories OR being marked as SAFE in the expression itself. Without this mitigation enabled, a malicious actor can send a crafted GET parameter to a Jelly page and cause the contents of that parameter to be evaluated as server-side JavaScript with admin privileges. If \"glide.ui.jelly.js_interpolation.protect\" is not set to the recommended value of \"true\", then dangerous jelly expressions interpolated in JavaScript are allowed and user can execute code using jelly template.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"45d05f3d773011108bd73a91fa5a9981","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Enable Jelly JS Interpolation Protection","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.jelly.js_interpolation.protect\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:jelly-js-interpolation","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.jelly.js_interpolation.protect';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_45d05f3d773011108bd73a91fa5a9981","name":"Enable Jelly JS Interpolation Protection","category":"security","sys_policy":"read"},{"short_description":"Rotate HTTP Session Identifiers","description":"If \"glide.ui.rotate_sessions\" is not set to the recommended value of \"true\", then identifying information on a session is kept and not rotated between applications which could higher the risk of session hijack attacks.","sys_updated_on":"2023-10-06 17:27:50","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"45d05f3d773011108bd73a91fa5a9983","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Rotate HTTP Session Identifiers","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.rotate_sessions\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:rotate-http-session-identifiers","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.rotate_sessions';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_45d05f3d773011108bd73a91fa5a9983","name":"Rotate HTTP Session Identifiers","category":"security","sys_policy":"read"},{"short_description":"Enforce Strict Security of Session Cookies","description":"If \"glide.ui.secure_cookies\" is not set to the recommended value of \"true\", then additional cookie security and strict cookie validation is not performed. This could allow an attacker to bypass cookie validation leading to unauthorized resource access.","sys_updated_on":"2023-10-06 17:27:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"45d05f3d773011108bd73a91fa5a9985","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Enforce Strict Security of Session Cookies","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.secure_cookies\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:secure-session-cookies","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.secure_cookies';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_45d05f3d773011108bd73a91fa5a9985","name":"Enforce Strict Security of Session Cookies","category":"security","sys_policy":"read"},{"short_description":"Minimize Session Activity Timeout Duration","description":"This property determines the user session timeout. This determines how long a user session stays active.  If \"glide.ui.session_timeout\" is not set to the recommended value of \"60\" or less, then the session may stay valid for long even without activity. This could open a big time window for session hijacking attack.","sys_updated_on":"2023-10-06 17:27:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"45d05f3d773011108bd73a91fa5a9987","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Minimize Session Activity Timeout Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.session_timeout\" is set to \"60\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:session-activity-timeout","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.session_timeout';\n    var expectedValue = 60;\n    var defaultValue = 30;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_45d05f3d773011108bd73a91fa5a9987","name":"Minimize Session Activity Timeout Duration","category":"security","sys_policy":"read"},{"short_description":"Minimize Session Window Timeout Duration","description":"This property affects the expiry of the cookie. After each successful authentication, the cookie will expire after the number of days specified as the property value. If \"glide.ui.user_cookie.life_span_in_days\" is not set to the recommended value of 15 or less, then there is a higher risk that the cookie, if stolen, can be used for longer.","sys_updated_on":"2023-10-06 17:27:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"45d05f3d773011108bd73a91fa5a9989","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Minimize Session Window Timeout Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.user_cookie.life_span_in_days\" is set to \"15\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:session-window-timeout","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.user_cookie.life_span_in_days';\n    var expectedValue = 15;\n    var defaultValue = 15;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_45d05f3d773011108bd73a91fa5a9989","name":"Minimize Session Window Timeout Duration","category":"security","sys_policy":"read"},{"short_description":"Minimize Absolute Session Timeout Duration","description":"If \"glide.ui.user_cookie.max_life_span_in_days\" is not set to the recommended value of \"30\" or other appropriate value, then a very long life session could be more vulnerable to session hijack attacks.","sys_updated_on":"2023-10-06 17:27:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"45d05f3d773011108bd73a91fa5a998b","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Minimize Absolute Session Timeout Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.user_cookie.max_life_span_in_days\" is set to \"30\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:absolute-session-timeout","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.user_cookie.max_life_span_in_days';\n    var expectedValue = 30;\n    var defaultValue = 30;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_45d05f3d773011108bd73a91fa5a998b","name":"Minimize Absolute Session Timeout Duration","category":"security","sys_policy":"read"},{"short_description":"Restrict XML External Entities","description":"If \"glide.xml.entity.whitelist\" is not set to the recommended value of \"http://java.sun.com/j2ee/dtds/\" and \"glide.xml.entity.whitelist.enabled\" is not set to \"true\", then a malicious external entity can be allowed which could cause an XXE attack. An attacker can use the DTD to include arbitrary HTTP requests that the server may execute. This could lead to additional attacks using the server's trust relationship with other entities.","sys_updated_on":"2024-07-20 01:37:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"45d05f3d773011108bd73a91fa5a998d","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Restrict XML External Entities","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property \"glide.xml.entity.whitelist\" exists and is set to \"http://java.sun.com/j2ee/dtds/\" and the Glide Property \"glide.xml.entity.whitelist.enabled\" exists and is set to the value \"true\". If the properties do not appear in the sys_properties table, add new records.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:allow-entity-validation-with-whitelisting-xmldoc2","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty1 = 'glide.xml.entity.whitelist';\n    var expectedValue1 = 'http://java.sun.com/j2ee/dtds/';\n    var defaultValue1 = 'http://java.sun.com/j2ee/dtds/';\n    var propertyValue1 = gs.getProperty(targetProperty1, defaultValue1);\n\n    var targetProperty2 = 'glide.xml.entity.whitelist.enabled';\n    var expectedValue2 = 'true';\n    var defaultValue2 = 'true';\n    var propertyValue2 = gs.getProperty(targetProperty2, defaultValue2);\n\n    if ((propertyValue1.toLowerCase() != expectedValue1.toLowerCase()) || (propertyValue2.toLowerCase() != expectedValue2.toLowerCase())) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty1);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_45d05f3d773011108bd73a91fa5a998d","name":"Restrict XML External Entities","category":"security","sys_policy":"read"},{"short_description":"Restrict Knowledge Bases Access","description":"This property is being used in the functionality of knowledge record user criteria security. If \"glide.knowman.block_access_with_no_user_criteria\" is not set to the recommended value of \"true\", then knowledge bases without can read or can contribute user criteria become readable and writeable by all users.","sys_updated_on":"2023-10-06 17:27:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"47321930774031101b803a91fa5a9949","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:15","sys_name":"Restrict Knowledge Bases Access","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.knowman.block_access_with_no_user_criteria\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-knowledge-bases-access","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.knowman.block_access_with_no_user_criteria';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_47321930774031101b803a91fa5a9949","name":"Restrict Knowledge Bases Access","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for SOAP Requests","description":"The glide property 'glide.basicauth.required.soap' controls whether basic authentication is required to make a SOAP request to an instance. If 'glide.basicauth.required.soap' is not set to the recommended value of 'true', then unauthenticated users performing SOAP operations will be mapped to the soap.guest user. This may enable an unauthenticated user to perform operations on the instance as if a logged in user to the instance. There may be additional impact if the user define within 'com.glide.soap.guest_user' is assigned additional roles.","sys_updated_on":"2024-07-20 01:13:38","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"486594c8d5001110fa9bdbc0c4c2ab99","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-06-07 17:27:36","sys_name":"Require Authorization for SOAP Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.basicauth.required.soap' exists and is set to the value 'true'.  Alternatively, configure the instance for WS Security by setting the property 'glide.soap.require_ws_security' to 'true' and following the product documentation to configure WS Security Profiles. If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:basic-auth-soap-requests","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty1 = 'glide.basicauth.required.soap';\n    var expectedValue1 = 'true';\n    var defaultValue1 = 'false';\n\n    var targetProperty2 = 'glide.soap.require_ws_security';\n    var expectedValue2 = 'true';\n    var defaultValue2 = 'false';\n\n    var propertyValue1 = gs.getProperty(targetProperty1, defaultValue1);\n    var propertyValue2 = gs.getProperty(targetProperty2, defaultValue2);\n\n    // Check that basic auth is required first    \n    if (propertyValue1.toLowerCase() != expectedValue1.toLowerCase()) {\n\n        // If WS Security is also not required, then we have a finding.\n        if (propertyValue2.toLowerCase() != expectedValue2.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty1);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_486594c8d5001110fa9bdbc0c4c2ab99","name":"Require Authorization for SOAP Requests","category":"security","sys_policy":"read"},{"short_description":"Enable HTML Sanitizer","description":"This property controls sanitization behavior of HTML fields on a global level from a backend Java context. If \"glide.html.sanitize_all_fields\" is not set to the recommended value of \"true\", then, the platform is open to XSS in HTML fields. The ability to have XSS can lead to easily attained privilege escalation to higher roles such as admin where more lateral movement can be taken.","sys_updated_on":"2023-10-06 17:27:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"486598c8d5001110fa9bdbc0c4c2ab6c","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:36","sys_name":"Enable HTML Sanitizer","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.html.sanitize_all_fields\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:html-sanitizer","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.html.sanitize_all_fields';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_486598c8d5001110fa9bdbc0c4c2ab6c","name":"Enable HTML Sanitizer","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for RSS Requests","description":"This property controls basic authorization for inbound RSS requests. If \"glide.basicauth.required.rss\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for RSS format export processor. This also could be combined with a wrong role within the guest_user related property, this will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:27:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"4d6598c8d5001110fa9bdbc0c4c2abe0","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:40","sys_name":"Require Authorization for RSS Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.rss\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:rss-request-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.rss';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_4d6598c8d5001110fa9bdbc0c4c2abe0","name":"Require Authorization for RSS Requests","category":"security","sys_policy":"read"},{"short_description":"Restrict Downloadable Files Types in Static Content","description":"This property controls the ability to restrict the types of files that can be downloaded. If \"glide.ui.strict_customer_uploaded_static_content\" is not set to the recommended value of \"true\", then it is possible to download any file extension that have been uploaded using the Upload File functionality from static content. This could lead to information disclosure.","sys_updated_on":"2023-10-06 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"4eb7eeab777411108bd73a91fa5a9904","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-26 07:54:31","sys_name":"Restrict Downloadable Files Types in Static Content","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.strict_customer_uploaded_static_content\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-file-download-restrictions","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.strict_customer_uploaded_static_content';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_4eb7eeab777411108bd73a91fa5a9904","name":"Restrict Downloadable Files Types in Static Content","category":"security","sys_policy":"read"},{"short_description":"Escape HTML in List Views","description":"This property helps sanitize list view displaying of HTML fields. If \"glide.ui.escape_html_list_field\" is not set to the recommended value of \"true\", then a malicious user can inject HTML code within the form field to execute unwanted scripts on different client/user sessions. This could potentially be leveraged by attackers to steal session information and sensitive data.","sys_updated_on":"2023-12-26 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"5165d8c8d5001110fa9bdbc0c4c2ab41","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:41","sys_name":"Escape HTML in List Views","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.escape_html_list_field\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:escape-html","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.escape_html_list_field';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_5165d8c8d5001110fa9bdbc0c4c2ab41","name":"Escape HTML in List Views","category":"security","sys_policy":"read"},{"short_description":"Enforce ACL on HR Virtual Agent Data","description":"This property limits the ACLs of several HR tables to only consider the \"sn_hr_va\" scope. If \"glide.enforce_security_scope.sn_hr_va\" is not set to the recommended value of \"true\", then \"Human Resources: Virtual Agent Conversations\" scoped application data will be exposed to ACLs from all other scopes.  For example, this could lead to IT Administrator gaining access to HR data.","sys_updated_on":"2024-08-05 23:58:20","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"53860e92433b4210a0d25dc36ab8f2fd","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-08-05 23:58:20","sys_name":"Enforce ACL on HR Virtual Agent Data","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.enforce_security_scope.sn_hr_va\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-acl-on-hr-virtual-agent-data","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function (finding) {\n    var pluginManager = new GlidePluginManager();\n    var enabledPlugin = pluginManager.isActive('com.sn_hr_virtual_agent');\n\n    var targetProperty = 'glide.enforce_security_scope.sn_hr_va';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (enabledPlugin) {\n      if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n          finding.setCurrentSource(gr);\n        }\n        finding.increment();\n      }\n    } \n})(finding);\n","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_53860e92433b4210a0d25dc36ab8f2fd","name":"Enforce ACL on HR Virtual Agent Data","category":"security","sys_policy":"read"},{"short_description":"Enable the Hardened Java Security Manager","description":"This property contains Java classname of current Java security manager. ServiceNow has standardized on the Contextual Security Manager. If \"glide.security.manager\" is not set to the recommended value of \"com.glide.sys.security.ContextualSecurityManager\", then the instance may be using an obsolete Java security manager which is missing expected hardening policies. Without this hardening, it may be possible for a malicious actor with script execution access to achieve remote code execution on the instance.","sys_updated_on":"2023-10-06 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"57321930774031101b803a91fa5a9990","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:17","sys_name":"Enable the Hardened Java Security Manager","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.manager\" is set to \"com.glide.sys.security.ContextualSecurityManager\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-the-hardened-java-security-manager","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.manager';\n    var expectedValue = 'com.glide.sys.security.ContextualSecurityManager';\n    var defaultValue = 'com.glide.sys.security.ContextualSecurityManager';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_57321930774031101b803a91fa5a9990","name":"Enable the Hardened Java Security Manager","category":"security","sys_policy":"read"},{"short_description":"Double Check Inbound Transactions","description":"Property provides an extra layer of security on form submission / field updates by ensuring only users with the proper permissions are allowed to update a form. If \"glide.security.strict.updates\" is not set to the recommended value of \"true\", then updates are not strict meaning they are able to modify fields visible to them regardless of whether they have the appropriate permissions.","sys_updated_on":"2023-10-06 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"586598c8d5001110fa9bdbc0c4c2ab79","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:37","sys_name":"Double Check Inbound Transactions","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.strict.updates\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:double-check-inbound-transactions","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.strict.updates';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_586598c8d5001110fa9bdbc0c4c2ab79","name":"Double Check Inbound Transactions","category":"security","sys_policy":"read"},{"short_description":"Verify Certificate Revocation","description":"If \"com.glide.communications.httpclient.verify_revoked_certificate\" is not set to the recommended value of \"true\", then certificate revocation will not be checked during TLS handshake, bypassing an important security check. This is dangerous and risky because an attacker with a revoked certificate can simply neglect to provide a valid certificate and hence break the notion of PKI/digital certificate trust that is foundational to the web.","sys_updated_on":"2023-10-06 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"5a32d530774031101b803a91fa5a99ee","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:13","sys_name":"Verify Certificate Revocation","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"com.glide.communications.httpclient.verify_revoked_certificate\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:verify-certificate","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.communications.httpclient.verify_revoked_certificate';\n    var expectedValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, 'true');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_5a32d530774031101b803a91fa5a99ee","name":"Verify Certificate Revocation","category":"security","sys_policy":"read"},{"short_description":"Restrict Email Domains for External User Registration","description":"The \"sn_ext_usr_reg.allowed_email_domains\" property defines which email addresses are allowed to self-register to a ServiceNow instance. The format should be a comma separated list of acceptable email domains such as \"domain1.com,domain2.com\" where emails such as example@domain2.com will be accepted. If \"sn_ext_usr_reg.allowed_email_domains\" is not set with a list of acceptable domains, then users with any email address are allowed to register accounts on the instances. If not defined, malicious actors could perform registration using emails addresses from unwanted domains to gain authenticated access to the instance.","sys_updated_on":"2023-12-26 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"5b61e6a7777411108bd73a91fa5a999f","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-26 07:29:59","sys_name":"Restrict Email Domains for External User Registration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"sn_ext_usr_reg.allowed_email_domains\" is not set to an empty value.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:external-user-registration-email-domain-allowlist","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    if (new GlidePluginManager().isActive('com.snc.external_user_self_registration')) {\n        var targetProperty = 'sn_ext_usr_reg.allowed_email_domains';\n        var insecureValue1 = '';\n        var insecureValue2 = '\"\"';\n        var defaultValue = '\"\"';\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() === insecureValue1.toLowerCase() || propertyValue.toLowerCase() === insecureValue2.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_5b61e6a7777411108bd73a91fa5a999f","name":"Restrict Email Domains for External User Registration","category":"security","sys_policy":"read"},{"short_description":"Disable JavaScript Tags in Embedded HTML","description":"If \"glide.ui.security.codetag.allow_script\" is not set to the recommended value of \"false\", then this property allows rendered HTML in journal fields and forms which opens room for XSS attacks. Malicious HTML needs to be put between code tags for example [code][/code].","sys_updated_on":"2023-10-06 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"5d65d8c8d5001110fa9bdbc0c4c2ab49","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:42","sys_name":"Disable JavaScript Tags in Embedded HTML","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.security.codetag.allow_script\" exists in the sys_properties table and is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:allow-javascript-tags-in-embedded-html","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.security.codetag.allow_script';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_5d65d8c8d5001110fa9bdbc0c4c2ab49","name":"Disable JavaScript Tags in Embedded HTML","category":"security","sys_policy":"read"},{"short_description":"ServiceNow authored security controls to be activated","description":"We flag a security control (like an ACL, or Security Data Filter record) as a finding to bring to your attention. This is because ServiceNow will at times release new security controls that will improve the instances security posture, but we don't want to automatically turn these security controls on, to prevent impact to the instance. This allows you to review the security control that was released and test it out before you activate it.","sys_updated_on":"2024-10-02 20:54:55","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"5d7853c37ff012100e0450546c866593","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-09-27 07:15:08","sys_name":"Deactivated Security Controls","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Inspect the security control to understand which table it is protecting. Make a decision to activate it, or mute that finding. It is recommended to test in a sub production environment first.","sys_mod_count":"25","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1703437","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function (finding) {\n\tvar tableNames = [\"sys_security_acl\", \"sys_security_data_filter\"];\n\tvar securityControl = \"[SNOW_API_REDACTED_SECURITY_CONTROL]\";\n\tfor (var i = 0; i < tableNames.length; i++) {\n\t\tvar tableName = tableNames[i];\n\t\tvar gr = new GlideRecord(tableName);\n\t\tif (!gr.isValid()) {\n\t\t\tcontinue;\n\t\t}\n\t\tgr.addQuery(\"active\", false);\n\t\tgr.addQuery(\"description\", \"CONTAINS\", securityControl);\n\t\tgr.query();\n\t\twhile (gr.next()) {\n\t\t\tvar updateGr = new GlideRecord(\"sys_update_xml\");\n\t\t\tupdateGr.addQuery(\"name\", tableName + \"_\" + gr.sys_id);\n\t\t\tupdateGr.setLimit(1);\n\t\t\tupdateGr.query();\n\t\t\tif (!updateGr.next()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (updateGr.payload.includes(\"<active>false</active>\") && \n\t\t\t\t\tupdateGr.payload.includes(securityControl) && \n\t\t\t\t\tupdateGr.payload.includes(gr.sys_id) && \n\t\t\t\t\tupdateGr.action == \"INSERT_OR_UPDATE\") {\n\t\t\t\tfinding.setCurrentSource(gr);\n\t\t\t\tfinding.increment();\n\t\t\t}\n\t\t}\n\t}\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_5d7853c37ff012100e0450546c866593","name":"Deactivated Security Controls","category":"security","sys_policy":"read"},{"short_description":"Implement the X-Frame-Options: SAMEORIGIN Security Header","description":"The following property controls the implementation of the security header X-Frame-Options: SAMEORIGIN. If \"glide.set_x_frame_options\" is not set to the recommended value of \"true\", then an instance will be allowed to be framed in an iframe of another page. This can lead to a clickjacking attack.","sys_updated_on":"2023-10-06 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"606598c8d5001110fa9bdbc0c4c2ab9c","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:38","sys_name":"Implement the X-Frame-Options: SAMEORIGIN Security Header","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.set_x_frame_options\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:x-frame-options-sameorigin","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.set_x_frame_options';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_606598c8d5001110fa9bdbc0c4c2ab9c","name":"Implement the X-Frame-Options: SAMEORIGIN Security Header","category":"security","sys_policy":"read"},{"short_description":"Define Active Session Timeout Exception Roles","description":"Active session timeouts are a feature to ensure that a hijacked session cannot be used indefinitely without providing authentication information. This property controls the roles that are exempted from an active session timeout limit. It is best practice to only consider an active session timeout limit exception for internal integration account roles. If a role is given an exception to the session timeout, and that role is given to a user who is the victim of a session hijacking attack, an attacker can continue to authenticate to that session indefinitely. This may increase the affected scope of a security incident by allowing an attacker more time to make use of a hijacked account.","sys_updated_on":"2023-10-06 17:27:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"62321930774031101b803a91fa5a9909","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:14","sys_name":"Define Active Session Timeout Exception Roles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Ensure Glide Property 'glide.active.session.timeout.exception.roles' is set to value 'edge_encryption,mid_server'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:define-active-session","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.active.session.timeout.exception.roles';\n    var expectedValue = 'edge_encryption,mid_server';\n    var defaultValue = 'edge_encryption,mid_server';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_62321930774031101b803a91fa5a9909","name":"Define Active Session Timeout Exception Roles","category":"security","sys_policy":"read"},{"short_description":"Enforce Security Scope for Agent Workspace for HR Case Management","description":"When the Glide Property 'glide.enforce_security_scope.sn_hr_agent_ws' is set to the value 'true', only the ACLs within the Agent Workspace for HR Case Management plugin are used to determine access to a resource. When this value is not true, Agent Workspace for HR Case Management data in scope master tables are exposed by considering the ACLs from all the scopes for granting access. \r\n\r\nExample: IT Administrator can access Agent Workspace for HR Case Management data when it's set to false.","sys_updated_on":"2024-07-22 23:38:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"67cbc58d5323311053a6ddeeff7b1264","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-01-03 16:03:35","sys_name":"Enforce Security Scope for Agent Workspace for HR Case Management","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.enforce_security_scope.sn_hr_agent_ws' is set to a value of 'true'.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-security-scope-agent-workspace","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    var enabledPlugin = pluginManager.isActive('com.sn_hr_agent_ws');\n\t\n    var targetProperty = 'glide.enforce_security_scope.sn_hr_agent_ws';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (enabledPlugin) {\n      if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n          var gr = new GlideRecord('sys_properties');\n          if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n          }\n          finding.increment();\n      }\n\t  }\n    })(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_67cbc58d5323311053a6ddeeff7b1264","name":"Enforce Security Scope for Agent Workspace for HR Case Management","category":"security","sys_policy":"read"},{"short_description":"Validate File MIME Type in AttachmentCreator SOAP Web Service","description":"If \"glide.attachment.enforce_security_validation\" is not set to the recommended value of \"true\", then there will be no validation for attachment mime-type and dangerous files could be uploaded on the system using wrong file extensions. When this property is set to 'true', files are uploaded with the correct file type extension. \n\nIt is a security best practice to validate file uploads at least with MIME type validation.","sys_updated_on":"2023-12-26 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"6a321930774031101b803a91fa5a9927","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:14","sys_name":"Validate File MIME Type in AttachmentCreator SOAP Web Service","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.attachment.enforce_security_validation\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:validate-fle-mime-type","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.attachment.enforce_security_validation';\n    var expectedValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, 'true');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_6a321930774031101b803a91fa5a9927","name":"Validate File MIME Type in AttachmentCreator SOAP Web Service","category":"security","sys_policy":"read"},{"short_description":"Limit UI Active Session Life Span","description":"This configuration will enforce max lifespan on active guest HTTP sessions irrespective of inactive timeout. The configured value is in minutes and the value of zero will disable timing out the active sessions. A larger maximum lifespan could allow an attacker to persist a stolen session for longer, increasing the scope of a security incident. This particular property is limited to UI session timeout.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"6b321930774031101b803a91fa5a999b","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:17","sys_name":"Limit UI Active Session Life Span","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v');","resolution_details":"Set the Glide Property 'glide.ui.active.session.life_span' to a value greater than 0 and less than or equal to 720.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-ui-active-session-life-span","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.active.session.life_span';\n    var expectedValue = 720;\n    var defaultValue = 0;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    // Value should be greater than or equal to 0 and less than 720\n    // 0 = disabled, greater than 720 is too long a timeout\n    if (isNaN(propertyValue) || (parseInt(propertyValue, 10) <= 0) || (parseInt(propertyValue, 10) > expectedValue)) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_6b321930774031101b803a91fa5a999b","name":"Limit UI Active Session Life Span","category":"security","sys_policy":"read"},{"short_description":"Disable Password-Less Authentication","description":"This property ensures strong authentication as sometimes the usernames are easy to guess within an organization. If \"glide.login.no_blank_password\" is not set to the recommended value of \"true\", then users will be allowed to log in to the Now Platform with blank passwords, or by leaving the Password field empty.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"6c6598c8d5001110fa9bdbc0c4c2abac","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:38","sys_name":"Disable Password-Less Authentication","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.login.no_blank_password\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-password-less-authentication","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.login.no_blank_password';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_6c6598c8d5001110fa9bdbc0c4c2abac","name":"Disable Password-Less Authentication","category":"security","sys_policy":"read"},{"short_description":"Check Impersonation on ACL Evaluation in HR App","description":"A secure setting prevents an admin from seeing another user's HR information while using impersonation. An insecure setting for this property allows an admin to impersonate a user and access HR data such as survey results or audit records with the impersonated user's access. Due to the nature of this type of data, such as information which should available only to the user themselves like an email, this is not recommended. Setting  sn_hr_core.impersonateCheck to \"true\" only allows access to HR information when the user is not impersonating any others.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"6f321930774031101b803a91fa5a99a6","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:18","sys_name":"Check Impersonation on ACL Evaluation in HR App","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set sn_hr_core.impersonateCheck to \"true\" to prevent HR information access while impersonating.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:check-impersonation-on-acl-evaluation","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    if (pluginManager.isActive('com.sn_hr_core')) {\n        var targetProperty = 'sn_hr_core.impersonateCheck';\n        var expectedValue = 'true';\n        var defaultValue = 'false';\n\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_6f321930774031101b803a91fa5a99a6","name":"Check Impersonation on ACL Evaluation in HR App","category":"security","sys_policy":"read"},{"short_description":"Set Automatic Token Cleanup for Token Credentials","description":"If the property 'com.snc.platform.security.token.auth.cleanup' is set to the insecure value of 'false', expired API keys and HMAC secrets will not be deleted. This creates a potential for token reuse. If the token was expired due to leakage or compromise, reuse exposes the instance to anyone possessing the leaked token. Expired tokens are kept for the number of days defined by 'com.snc.platform.security.token.auth.days.expired.hmac_secret.is.kept' and 'com.snc.platform.security.token.auth.days.expired.api_key.is.kept'. Integers value of 0 and greater are valid values. A value of 0 would cause the expired tokens to be deleted in the same day. A high number of days increases the exposure period. The default of 7 days, or fewer, is recommended.","sys_updated_on":"2024-08-30 19:58:11","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"711df15e81181210f87724ace3e18346","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-30 19:58:11","sys_name":"Set Automatic Token Cleanup for Token Credentials","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property 'com.snc.platform.security.token.auth.cleanup' does not exist in the sys_properties table or is set to 'true'.  Ensure the properties 'com.snc.platform.security.token.auth.days.expired.api_key.is.kept' and 'com.snc.platform.security.token.auth.days.expired.hmac_secret.is.kept' do not exist in the sys_properties table or are set to 7 or less, where 7 corresponds to the number of days. ","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:set-automatic-token-cleanup-for-token-cred","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    if (GlidePluginManager.isActive('com.glide.tokenbased_auth')) {\n        var gr = new GlideRecord('sys_properties');\n        // Check for deletion of expired properties\n        var targetProperty_authCleanup = 'com.snc.platform.security.token.auth.cleanup';\n        var expectedValue_authCleanup = 'true';\n        var defaultValue_authCleanup = 'true';\n        var propertyValue_authCleanup = gs.getProperty(targetProperty_authCleanup, defaultValue_authCleanup);\n\n        if (propertyValue_authCleanup.toLowerCase() != expectedValue_authCleanup.toLowerCase()) {\n            if (gr.get('name', targetProperty_authCleanup)) {\n                finding.setCurrentSource(gr);\n            }\n            finding.increment();\n        }\n\n        // Check for default number of days or fewer API Key \n        var targetProperty_apiKey = 'com.snc.platform.security.token.auth.days.expired.api_key.is.kept';\n        var defaultValue_apiKey = 7;\n        var propertyValue_apiKey = gs.getProperty(targetProperty_apiKey, defaultValue_apiKey);\n\n        if (parseInt(propertyValue_apiKey, 10) > defaultValue_apiKey) {\n            if (gr.get('name', targetProperty_apiKey)) {\n                finding.setCurrentSource(gr);\n            }\n            finding.increment();\n        }\n\n        // Check for default number of days or fewer HMAC Secret\n        var targetProperty_hmacSecret = 'com.snc.platform.security.token.auth.days.expired.hmac_secret.is.kept';\n        var defaultValue_hmacSecret = 7;\n        var propertyValue_hmacSecret = gs.getProperty(targetProperty_hmacSecret, defaultValue_hmacSecret);\n\n        if (parseInt(propertyValue_hmacSecret, 10) > defaultValue_hmacSecret) {\n            if (gr.get('name', targetProperty_hmacSecret)) {\n                finding.setCurrentSource(gr);\n            }\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_711df15e81181210f87724ace3e18346","name":"Set Automatic Token Cleanup for Token Credentials","category":"security","sys_policy":"read"},{"short_description":"Enforce Scoped ACL Access for Information Request Playbooks","description":"If glide.enforce_security_scope.sn_gsm_info_req is not set to \"true\" then unexpected access could be granted to playbook data for the Information Request playbooks feature. If set to the insecure value, ACLs from all scopes are considered when granting access to playbook data in the scope master table. This would expose information request playbooks data. Set the property to the secure value of \"true\" to only consider ACLs from the sn_gsm_info_req scope when granting access.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"72321930774031101b803a91fa5a993e","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:15","sys_name":"Enforce Scoped ACL Access for Information Request Playbooks","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Ensure \"glide.enforce_security_scope.sn_gsm_info_req\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforced-scoped-acl-access","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    if (pluginManager.isActive('com.sn_gsm_info_req')) {\n        var targetProperty = 'glide.enforce_security_scope.sn_gsm_info_req';\n        var expectedValue = 'true';\n        var defaultValue = 'false';\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_72321930774031101b803a91fa5a993e","name":"Enforce Scoped ACL Access for Information Request Playbooks","category":"security","sys_policy":"read"},{"short_description":"Disable Legacy JQuery Behavior","description":"If \"glide.jquery.legacy\" is not set to the recommended value of \"false\", then older prepatched JQuery versions are used which will introduce unpatched vulnerabilities in the library. This could potentially lead to security risks arising from attacks on vulnerabilities discovered in outdated JQuery library versions. When false, integrates the JQuery 1.12.3 and 2.2.3 security patches. The system property is a failsafe in case any organizations depend on the non-patched versions of angularJS to run their custom implementations.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a995f","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Disable Legacy JQuery Behavior","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.jquery.legacy\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:legacy-jquery-behavior","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.jquery.legacy';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a995f","name":"Disable Legacy JQuery Behavior","category":"security","sys_policy":"read"},{"short_description":"Deny Unauthorized Access to Request Items","description":"This property defines a default behavior for the \"retrieveAddress\" API. When there are no roles given in property \"glide.sc.req_for.roles\",  the Client Callable Script Include 'ScriptServiceCatalogGetLocation' can be called by any unprivileged logged-in user and can retrieve the address of any other users in the system. If \"glide.sc.req_for.roles.default\" is not set to the recommended value of \"deny\" (allow) and the value of glide.sc.req_for.roles is empty, then any user can request items for other users allowing unauthorized resource access.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a9963","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Deny Unauthorized Access to Request Items","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.sc.req_for.roles.default\" is set to \"deny\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:deny-unauthorized-access-request-items","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sc.req_for.roles.default';\n    var expectedValue = 'deny';\n    var defaultValue = 'deny';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a9963","name":"Deny Unauthorized Access to Request Items","category":"security","sys_policy":"read"},{"short_description":"Honor Admin Override ACLs","description":"ACLs are evaluated cumulatively. If there are a number of ACLs on any given field and the Admin Overrides option is false (not selected) on one of them, then the effective admin overrides for all the ACLs are considered to be false. This causes admins to be unable to pass even the ACL where the override should be in effect. If \"glide.security.admin.override.accessterm\"  is not set to the recommended value of \"true\" then, even if one of the ACL terms under the ACL rule is \"Admin overrides\" false, the entire rule evaluates to false.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a9965","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Honor Admin Override ACLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.admin.override.accessterm\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:honor-admin-override-acls","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.admin.override.accessterm';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a9965","name":"Honor Admin Override ACLs","category":"security","sys_policy":"read"},{"short_description":"Disable Locked Form Elements Debugging","description":"If \"glide.security.explain.write.locks\" is not set to the recommended value of \"False\", then additional debug information is displayed on locked form elements. This could lead to information disclosure.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a9967","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Disable Locked Form Elements Debugging","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.explain.write.locks\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-locked-form-elements-debugging","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.explain.write.locks';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a9967","name":"Disable Locked Form Elements Debugging","category":"security","sys_policy":"read"},{"short_description":"Check UI Action Conditions Before Execution","description":"If \"glide.security.strict.actions\" is not set to the recommended value of \"true\", then there will be no validation on the table UI before execution. Setting this property to secure value will add an extra layer of security validation.","sys_updated_on":"2023-10-06 17:27:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a996d","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Check UI Action Conditions Before Execution","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.strict.actions\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:check-ui-action-conditions-before-execution","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.strict.actions';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a996d","name":"Check UI Action Conditions Before Execution","category":"security","sys_policy":"read"},{"short_description":"Enforce URL Allowlist Check","description":"If \"glide.security.url.whitelist.strict_check\" is not set to the recommended value of \"true\" then all external URLs are allowed for redirection when \"glide.security.url.whitelist\" is empty. If \"glide.security.url.whitelist\" is not empty,  then only external URLs in the whitelist are allowed. Thus either setting \"glide.security.url.whitelist.strict_check\" to true OR ensuring \"glide.security.url.whitelist\" is set to a non-empty value with the allowed external URLs leaves the instance in a secure state.  If all external URLs are allowed for redirection, this could allow an attacker to redirect a user to a malicious website.","sys_updated_on":"2023-12-26 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a996f","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Enforce URL Allowlist Check","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.url.whitelist.strict_check\" is set to \"true\" or the property \"glide.security.url.whitelist\" is set to a value.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:url-whitelist-for-logout-redirects","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty1 = 'glide.security.url.whitelist.strict_check';\n    var expectedValue1 = 'true';\n    var defaultValue1 = 'true';\n    var propertyValue1 = gs.getProperty(targetProperty1, defaultValue1);\n\n    var targetProperty2 = 'glide.security.url.whitelist';\n    var defaultValue2 = '';\n    var propertyValue2 = gs.getProperty(targetProperty2, defaultValue2);\n\n    if ((propertyValue1.toLowerCase() != expectedValue1.toLowerCase()) && (propertyValue2.toLowerCase() == defaultValue2.toLowerCase())) {\n    //if strict check is NOT true AND whitelist IS empty\n        var gr1 = new GlideRecord('sys_properties');\n        gr1.get('name', targetProperty1);\n        finding.setCurrentSource(gr1);\n        finding.increment();\n\n        var gr2 = new GlideRecord('sys_properties');\n        gr2.get('name', targetProperty2);\n        finding.setCurrentSource(gr2);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a996f","name":"Enforce URL Allowlist Check","category":"security","sys_policy":"read"},{"short_description":"Validate SOAP Content Type","description":"If \"glide.soap.require_content_type_xml\" is not set to the recommended value of \"true\", then there is no validation for the SOAP request and could lead to cross-site request forgery (CSRF) attacks.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a9973","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Validate SOAP Content Type","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.soap.require_content_type_xml\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:soap-content-type-checking","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.soap.require_content_type_xml';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a9973","name":"Validate SOAP Content Type","category":"security","sys_policy":"read"},{"short_description":"Enforce SOAP Request Strict Security","description":"If \"glide.soap.strict_security\" is not set to the recommended value of \"true\", then users do not need a SOAP role to make requests of non-public pages when the high security or web service plugin is installed. An unauthorized user can get access to sensitive content/data on the target instance.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a9975","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Enforce SOAP Request Strict Security","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.soap.strict_security\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:soap-request-strict-security","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.soap.strict_security';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a9975","name":"Enforce SOAP Request Strict Security","category":"security","sys_policy":"read"},{"short_description":"Require XMLdoc2 entity validation with allowlistDisable Entity Expansion","description":"If \"glide.stax.whitelist_enabled\" is not set to the recommended value of \"true\", then all external entities are allowed. This could lead to External Entities Expansion (XXE) attacks.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a9977","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Require XMLdoc2 entity validation with allowlistDisable Entity Expansion","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.stax.whitelist_enabled\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-entity-expansion","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.stax.whitelist_enabled';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a9977","name":"Require XMLdoc2 entity validation with allowlistDisable Entity Expansion","category":"security","sys_policy":"read"},{"short_description":"Define Restricted Downloadable MIME Types","description":"This check is only relevant if \"glide.ui.attachment.force_download_all_mime_types\" property is \"false\". If \"glide.ui.attachment.download_mime_types\" does include dangerous items such as \"text/html,image/svg,image/svg+xml,application/xml\", then dangerous files could be rendered inline in the browser which could lead to Cross Site Scripting attacks (XSS). This property is the list of comma separated attachment mime types which will not render inline in the browser. For example, including text/html will force html files to be downloaded to the client as attachments rather than viewed inline in the browser. Maintaining this list properly will prevent cross site scripting attacks.","sys_updated_on":"2024-08-19 22:19:15","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a9979","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Define Restricted Downloadable MIME Types","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.attachment.download_mime_types\" includes the dangerous items \"text/html,image/svg,image/svg+xml,application/xml\".","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:downloadable-mimetype-denylist","finding_type":"scan_finding","priority":"3","sys_tags":"","script":" \n      (function(finding) {\n        var forceDownloadConfigured = gs.getProperty('glide.ui.attachment.force_download_all_mime_types', 'false');\n\n        // Only bother with the check if force download is not configured.\n        if (forceDownloadConfigured.toLowerCase() == \"false\") {\n            var value_dict = {\n                'text/html': '',\n                'image/svg': '',\n                'image/svg+xml': '',\n                'application/xml': ''\n            };\n            var targetProperty = 'glide.ui.attachment.download_mime_types';\n            var requiredValueList = JSON.parse(JSON.stringify(value_dict));\n            var defaultValue = 'text/html,image/svg,image/svg+xml,application/xml';\n\n            var rawValue = gs.getProperty(targetProperty, defaultValue);\n\n            var valueArray = rawValue.split(',');\n            for (var i = 0; i < valueArray.length; i++) {\n                var current = valueArray[i];\n                if (requiredValueList.hasOwnProperty(current))\n                    delete requiredValueList[current];\n            }\n\n            if (Object.keys(requiredValueList).length != 0) {\n                var gr = new GlideRecord('sys_properties');\n                gr.get('name', targetProperty);\n                finding.setCurrentSource(gr);\n                finding.increment();\n            }\n        }\n      })(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a9979","name":"Define Restricted Downloadable MIME Types","category":"security","sys_policy":"read"},{"short_description":"Enable URL Allowlist for Cross-Origin iframe Communication","description":"This property assists in performing proper origin validation. If \"glide.ui.concourse.onmessage_enforce_same_origin\" is not set to the recommended value of \"true\" then all URLs included in glide.ui.concourse.onmessage_enforce_same_origin_whitelist can propagate messages in the UI.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"74d05f3d773011108bd73a91fa5a997b","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Enable URL Allowlist for Cross-Origin iframe Communication","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.concourse.onmessage_enforce_same_origin\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-url-whitelist-for-cross-origin-iframe-communication","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.concourse.onmessage_enforce_same_origin';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_74d05f3d773011108bd73a91fa5a997b","name":"Enable URL Allowlist for Cross-Origin iframe Communication","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for CSV Requests","description":"If \"glide.basicauth.required.csv\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for CSV format export processor. This also happens when combined with a wrong role within the guest_user related property (Ex: high privileged role). This will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"786598c8d5001110fa9bdbc0c4c2abcf","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:39","sys_name":"Require Authorization for CSV Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.csv\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:csv-request-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.csv';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_786598c8d5001110fa9bdbc0c4c2abcf","name":"Require Authorization for CSV Requests","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for API Requests","description":"If \"glide.basicauth.required.api\" is not set to the recommended value of \"true\", then this will disable Basic Authentication on API request and will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"7c6598c8d5001110fa9bdbc0c4c2abbe","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:39","sys_name":"Require Authorization for API Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.api\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:api-request-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.api';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_7c6598c8d5001110fa9bdbc0c4c2abbe","name":"Require Authorization for API Requests","category":"security","sys_policy":"read"},{"short_description":"Prevent Empty ACL Creation","description":"The glide.security.empty_acl.popup_window.enabled property controls whether users making form-based edits to ACL records (sys_security_acl) can create, update, or save an invalid ACL that has an invalid data condition, script, security attribute, or roles list, or otherwise does not have any configured (an \"empty ACL\"). As of the Xanadu release, an empty ACL will completely deny access. On versions prior to Xanadu, empty an ACL will allow unconditional access.\n\nWhen the glide.security.empty_acl.popup_window.enabled property is set to a secure value of \"true\", attempts to create, update, or save an invalid or empty ACL will be blocked, and a client-side model will be provided to configure a role or security attribute for the ACL. If the property is insecurely set to any other value, then such attempts will be allowed and no client-side model will be displayed.\n\nNote: This property is case sensitive. A value of \"True\" (capital \"T\") will be equivalent to \"false\". Additionally, this property will only function when the High Security (com.glide.high_security) plugin is installed and active.","sys_updated_on":"2024-08-29 23:29:31","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"7daa890e94dc1210f87753480ed46d47","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-29 22:37:16","sys_name":"Prevent Empty ACL Creation","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the glide.security.empty_acl.popup_window.enabled property is set to \"true\" and ensure that the High Security (com.glide.high_security) plugin is active.","sys_mod_count":"2","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:prevent-empty-acl-creation","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    var targetProperty = 'glide.security.empty_acl.popup_window.enabled';\n    var secureValue = 'true';\n    var fallbackBehavior = '';\n\n    if (pluginManager.isActive('com.glide.high_security')) {\n        var propertyValue = gs.getProperty(targetProperty, fallbackBehavior);\n        if (propertyValue != secureValue) {\n            /* case-sensitive */\n            var gr = new GlideRecord('sys_properties');\n            if (gr.get('name', targetProperty)) {\n                finding.setCurrentSource(gr);\n            }\n            finding.increment();\n        }\n    } else {\n        finding.increment();\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_7daa890e94dc1210f87753480ed46d47","name":"Prevent Empty ACL Creation","category":"security","sys_policy":"read"},{"short_description":"Enforce Security Rules to Sharing Dashboards","description":"When the Glide Property 'glide.cms.dashboards.sharing_with_secure_search' is not set to 'true', a user can share a dashboard to groups and roles that they do not personally have access to. This property enforces ACLs on searching the sys_user, sys_user_role, and sys_user_group tables when sharing a dashboard. Oversharing a dashboard may result in minor confidentiality impacts in cases where a user shares a dashboard with a user, group, or role that should not access to the dashboard.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"7e321930774031101b803a91fa5a9932","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:14","sys_name":"Enforce Security Rules to Sharing Dashboards","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'glide.cms.dashboards.sharing_with_secure_search' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:require-authentication-on-event-management","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.cms.dashboards.sharing_with_secure_search';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_7e321930774031101b803a91fa5a9932","name":"Enforce Security Rules to Sharing Dashboards","category":"security","sys_policy":"read"},{"short_description":"Empty ACL's should not exist","description":"We flag an ACL record as a finding if ACL has no script, no condition, no security attribute, no role or role is public.","sys_updated_on":"2024-03-01 19:44:40","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"7f1953d3431eb110adf71f062bb8f2d9","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-11-09 22:47:07","sys_name":"Empty ACLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure ACL has roles, condition or script","sys_mod_count":"2","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1553688","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var fullScanEnabled = global.JSUtil.toBoolean(gs.getProperty('glide.security.empty_acl_check.full_scan', 'false'));\n    var gr = new GlideRecord('sys_security_acl');\n    gr.addActiveQuery();\n    gr.addNullQuery('condition');\n    if (gr.isValidField('security_attribute'))\n        gr.addNullQuery('security_attribute');\n    gr.query();\n    while (gr.next()) {\n        //skip OOB records when fullscan not enabled\n        if (!fullScanEnabled && !isCustomRecord(gr))\n            continue;\n\n        var script = '' + gr.script;\n        var aclScript = script.trim();\n        var grRole = new GlideRecord('sys_security_acl_role');\n        grRole.addEncodedQuery(\"sys_security_acl=\" + gr.sys_id);\n        grRole.query();\n        if (grRole.hasNext()) {\n            while (grRole.next()) {\n                var roleId = grRole.sys_user_role.sys_id;\n                //check if role is public\n                if (roleId == \"b0593b350a0a0aa7001d689e4542dc28\") {\n                    if (global.JSUtil.notNil(aclScript))\n                        continue;\n                    finding.setCurrentSource(gr);\n                    finding.increment();\n                    break;\n                }\n            }\n        } else {\n            // Continue if acl has a script\n            if (global.JSUtil.notNil(aclScript))\n                continue;\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);\n\nfunction isCustomRecord(record) {\n    var gr = new GlideRecord('sys_update_xml');\n    gr.addQuery('name', record.sys_class_name + \"_\" + record.sys_id);\n    gr.setLimit(1);\n    gr.setWorkflow(false);\n    gr.query();\n    return gr.next();\n}\n","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_7f1953d3431eb110adf71f062bb8f2d9","name":"Empty ACLs","category":"security","sys_policy":"read"},{"short_description":"Encrypter API is deprecated","description":"The Encrypter API will be deprecated for the ServiceNow platform. The API will no longer be supported and will soon be removed in future releases of the platform.\r\n\t\t\t\r\nDue to evolving security standards and for the safety of our customers, the decision has been made to deprecate this API.","sys_updated_on":"2024-02-23 10:26:27","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"8025bd84ffa046107497ffffffffffe7","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-02-19 09:30:49","sys_name":"Deprecated API: Encrypter usages in selective String fields","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Customers should migrate their Encrypter usages to alternative encryption methods. The ServiceNow platform offers a variety of encryption options. For more information, see KB https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1633559\r\n\t\t\t\r\nContinued use of the Encrypter API poses a security risk to your data and will result in compatibility issues with future releases of the ServiceNow platform.","sys_mod_count":"7","active":"true","documentation_url":"https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1633559","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function (engine) {\n\n    var tableColumnsMap = {\"sys_trigger\" : [\"script\", \"job_context\"],\n\t\t\t\t\t\t\"kb_navons\" : [\"script\"],\n\t\t\t\t\t\t\"sys_ui_style\" : [\"value\"],\n\t\t\t\t\t\t\"sysevent_in_email_action\" : [\"condition_script\"],\n\t\t\t\t\t\t\"par_coreui_migration_script\" : [\"script\"],\n\t\t\t\t\t\t\"gs_entitlement_plugin_mapping\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sys_jelly_file\" : [\"script\"],\n\t\t\t\t\t\t\"sysrule_assignment\" : [\"script\"],\n\t\t\t\t\t\t\"sys_filter_option_dynamic\" : [\"script\"],\n\t\t\t\t\t\t\"ecc_agent_script_file\" : [\"script\"],\n\t\t\t\t\t\t\"expert_panel_redirect\" : [\"script\"],\n\t\t\t\t\t\t\"sys_transform_entry\" : [\"source_script\"],\n\t\t\t\t\t\t\"discovery_probe_parameter\" : [\"value_script\"],\n\t\t\t\t\t\t\"cmn_notif_service_provider\" : [\"construction_script\", \"script\"],\n\t\t\t\t\t\t\"sc_cat_item_delivery_plan\" : [\"script\"],\n\t\t\t\t\t\t\"ecc_queue_config\" : [\"notify_script\"],\n\t\t\t\t\t\t\"sys_wizard_answer\" : [\"script\"],\n\t\t\t\t\t\t\"sysevent_script_action\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sys_impex_map\" : [\"condition_script\"],\n\t\t\t\t\t\t\"ecc_event_handler\" : [\"script\"],\n\t\t\t\t\t\t\"sysrule_approvals\" : [\"script\"],\n\t\t\t\t\t\t\"sys_declarative_action_assignment\" : [\"script_condition\", \"scripted_client_condition\", \"dynamic_script_condition\"],\n\t\t\t\t\t\t\"sys_sg_button\" : [\"condition_script\", \"offline_condition_script\"],\n\t\t\t\t\t\t\"sys_app_payload_unloader_rule\" : [\"script_condition\"],\n\t\t\t\t\t\t\"sysevent_email_template\" : [\"message\"],\n\t\t\t\t\t\t\"sn_cloud_discovery_retry_configuration\" : [\"script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_rule\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_action_type\" : [\"action_script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_condition_type\" : [\"condition_script\", \"condition_invocation_script\"],\n\t\t\t\t\t\t\"discovery_classifier_probe\" : [\"condition_script\"],\n\t\t\t\t\t\t\"sn_cmp_pol_condition\" : [\"script\"],\n\t\t\t\t\t\t\"sn_cmp_rb_resourcescript\" : [\"script\"],\n\t\t\t\t\t\t\"sn_cmp_cloud_event_handler\" : [\"run_handler_script\"],\n\t\t\t\t\t\t\"sn_capi_response_processor\" : [\"script\"],\n\t\t\t\t\t\t\"web_service_launcher_lookup\" : [\"launch_script\"],\n\t\t\t\t\t\t\"task_rel_type\" : [\"child_script\", \"parent_script\"],\n\t\t\t\t\t\t\"task_rel_allowed\" : [\"child_script\"]\n\t\t\t\t\t\t};\n\n\tvar search_regex = /new\\s*Encrypter\\s*\\(/;\n\tvar code_comments_regex = /\\/\\*[\\s\\S]*?\\*\\/|([^:]|^)\\/\\/.*$/gm;\n\tvar ISNOTEMPTY_LITERAL = \"ISNOTEMPTY\";\n\tvar OR_QUERY_LITERAL = \"^OR\";\n\n\tfor(var table in tableColumnsMap) {\n\t\tvar columns = tableColumnsMap[table];\n\t\tvar gr = new GlideRecord(table);\n\t\tif(!gr.isValid())\n\t\t\tcontinue;\n\n\t\tvar query = \"\";\n\t\tfor(var column in columns) {\n\t\t\tif(!gr.isValidField(columns[column]))\n\t\t\t\tcontinue;\n\t\t\tquery += columns[column] + ISNOTEMPTY_LITERAL;\n\t\t\tif(column < columns.length - 1)\n\t\t\t\tquery += OR_QUERY_LITERAL;\n\t\t}\n\t\tgr.addEncodedQuery(query);\n\t\tgr.query();\n\n\t\twhile(gr.next()) {\n\t\t\tfor(var i in columns) {\n\t\t\t\tvar columnValue = gr.getValue(columns[i]);\n\t\t\t\tif (!search_regex.test(columnValue))\n\t\t\t\t\tcontinue;\n\n\t\t\t\t//remove code comments\n\t\t\t\tvar commentsRemovedValue = columnValue.replace(code_comments_regex, '');\n\n\t\t\t\t//raise finding if no comments found or usage found in commentsRemovedValue\n\t\t\t\tif (commentsRemovedValue.length == columnValue.length || search_regex.test(commentsRemovedValue)) {\n\t\t\t\t\tengine.finding.setCurrentSource(gr);\n\t\t\t\t\tengine.finding.increment();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n})(engine);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_script_only_check_8025bd84ffa046107497ffffffffffe7","name":"Deprecated API: Encrypter usages in selective String fields","category":"security","sys_policy":"read"},{"short_description":"Escape JavaScript","description":"The glide property \"glide.html.escape_script\" helps sanitize HTML fields. If \"glide.html.escape_script\" is not set to the recommended value of \"true\", then inputs will not be sanitized for HTML fields (output encoding) from a backend Java context by removing embedded JavaScript. Javascript in HTML fields can lead to stored and reflected XSS. The ability to have XSS can lead to easily attained privilege escalation to higher roles such as admin where more lateral movement can be taken.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"806594c8d5001110fa9bdbc0c4c2ab9e","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:36","sys_name":"Escape JavaScript","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.html.escape_script\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:escape-javascript","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.html.escape_script';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_806594c8d5001110fa9bdbc0c4c2ab9e","name":"Escape JavaScript","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for Script Requests","description":"This property determines if basic auth is required to invoke a scripted processor. Any records accessed by the scripted processor will still use other access controls, ie ACLs, before returning any data.  If \"glide.basicauth.required.scriptedprocessor\" is not set to the recommended value of \"true\", then an attacker could access sensitive information such as an unauthenticated (guest) user attempting to access an email through the EmailDisplay sys_processor.","sys_updated_on":"2023-10-06 17:27:54","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"816598c8d5001110fa9bdbc0c4c2abe5","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:41","sys_name":"Require Authorization for Script Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.scriptedprocessor\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:script-request-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.scriptedprocessor';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_816598c8d5001110fa9bdbc0c4c2abe5","name":"Require Authorization for Script Requests","category":"security","sys_policy":"read"},{"short_description":"Publicly Exposed Virtual Agent Embedded Web Client sn_va_web_client_app_embed","description":"The UI page sn_va_web_client_app_embed , which is a embedded web client for Virtual Agent, contains the ACL marked 'true' in the sys_public table Out of Box. It has been confirmed that there are use cases where public accessibility is needed however this is not a security best practice to set it to default publicly accessible.","sys_updated_on":"2024-08-30 21:21:53","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"82511e1281981210f87724ace3e18353","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-30 21:21:53","sys_name":"Publicly Exposed Virtual Agent Embedded Web Client sn_va_web_client_app_embed","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Deactivate ui page sn_va_web_client_app_embed from the sys_public table if embedded web client is not needed for unauthenticated users ","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:publicly-exposed-virtual-agent-embedded-web-client","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var gr_pub = new GlideRecord('sys_public');\n    var sn_va_web_client_app_embed_sys_id = \"04b1905473222300e985658b4cf6a7ef\";\n    if (gr_pub.get(sn_va_web_client_app_embed_sys_id)) {\n        if (gr_pub.active == true) {\n            finding.setCurrentSource(gr_pub);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_82511e1281981210f87724ace3e18353","name":"Publicly Exposed Virtual Agent Embedded Web Client sn_va_web_client_app_embed","category":"security","sys_policy":"read"},{"short_description":"Hide User Comments on Articles","description":"When the Glide Property 'glide.knowman.show_user_feedback' is not set to 'never', feedback comments will be visible on knowledge articles to users with the roles defined in the Glide Property 'glide.knowman.show_user_feedback.roles'. Due to the potentially sensitive information in a feedback comment, an instance admin may not want the feedback to be visible. If this property is not set to 'never', there could be confidentiality impacts if sensitive information is disclosed in feedback.","sys_updated_on":"2023-10-06 17:27:55","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"83321930774031101b803a91fa5a994c","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Hide User Comments on Articles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'glide.knowman.show_user_feedback' to 'never'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:hide-users-comments","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.knowman.show_user_feedback';\n    var expectedValue = 'never';\n    var defaultValue = 'onload';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_83321930774031101b803a91fa5a994c","name":"Hide User Comments on Articles","category":"security","sys_policy":"read"},{"short_description":"Limit Concurrent Interactive Sessions","description":"This property is meant to be used with the Limit Concurrent Sessions (com.glide.limit.concurrent.sessions) plugin. When the plugin is active and the property is set to \"false\", a user can have any number of concurrent interactive sessions on an instance. A greater number of open sessions means there is a great possibility for session hijacking to occur.","sys_updated_on":"2023-10-06 17:27:55","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"83aff094779821108bd73a91fa5a99f3","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Limit Concurrent Interactive Sessions","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.authenticate.limit.concurrent.interactive.sessions\" is set to \"true\" when the \"com.glide.limit.concurrent.sessions\" plugin is active.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:glide-auth-limit-concurrent-interactive-sessions","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var isConcurrentSessionPluginActive = GlidePluginManager.isActive('com.glide.limit.concurrent.sessions');\n    if (isConcurrentSessionPluginActive) {\n        var targetProperty = 'glide.authenticate.limit.concurrent.interactive.sessions';\n        var expectedValue = 'true';\n\n        // Property is set to \"false\" by default in source code\n        var propertyValue = gs.getProperty(targetProperty, 'false');\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_83aff094779821108bd73a91fa5a99f3","name":"Limit Concurrent Interactive Sessions","category":"security","sys_policy":"read"},{"short_description":"Minimize Concurrent Interactive Session Quantity","description":"The property \"glide.authenticate.max.concurrent.interactive.sessions\" controls the number of active sessions that can be open for a user when the Limit Concurrent Sessions (com.glide.limit.concurrent.sessions) plugin is enabled. It is recommended that this value be the default of \"1\" to reduce the number of sessions that can be left open for a user. A greater number of open sessions means there are more sessions that can potentially be hijacked.","sys_updated_on":"2023-10-06 17:27:55","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"83aff094779821108bd73a91fa5a99f4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Minimize Concurrent Interactive Session Quantity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure that property \"glide.authenticate.max.concurrent.interactive.sessions\" is set to \"1\" when the \"com.glide.limit.concurrent.sessions\" plugin is active.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:glide-auth-max-concurrent-interactive-sessions","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var isConcurrentSessionPluginActive = GlidePluginManager.isActive('com.glide.limit.concurrent.sessions');\n    if (isConcurrentSessionPluginActive) {\n        var targetProperty = 'glide.authenticate.max.concurrent.interactive.sessions';\n        var expectedValue = 1;\n        var defaultValue = 1;\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_83aff094779821108bd73a91fa5a99f4","name":"Minimize Concurrent Interactive Session Quantity","category":"security","sys_policy":"read"},{"short_description":"Enforce Password Reset on API Requests","description":"When a user is marked for \"Password needs reset\" they must provide a new password at the next authentication attempt. This property controls whether the password reset is mandatory before making API calls. If \"glide.authenticate.api.user.reset_password.mandatory\" is not set to the recommended value of \"true\", then user accounts marked as \"Password needs reset\" can still perform most common operations by querying the table API through basic authentication. This could allow information disclosure in the event that stale accounts are compromised.","sys_updated_on":"2023-12-26 17:27:55","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"83aff094779821108bd73a91fa5a99f5","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Enforce Password Reset on API Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.authenticate.api.user.reset_password.mandatory\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-pw-reset-api-requests","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.authenticate.api.user.reset_password.mandatory';\n    var expectedValue = 'true';\n\n    // Goofy try/catch here because of glide.*password property in a scoped app rules\n    try {\n      var propertyValue = gs.getProperty(targetProperty, 'false');\n      if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n      }\n    } catch(ex) {\n      finding.increment();\n    }  \n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_83aff094779821108bd73a91fa5a99f5","name":"Enforce Password Reset on API Requests","category":"security","sys_policy":"read"},{"short_description":"Disable External Content URL","description":"If \"glide.ui.url.external.content\" is not set to the recommended value of \"false\", then Connect chat will retrieve external link metadata in order to render richer content in messages with links to Youtube, news articles, images, etc. This could lead to Server Side Request Forgery (SSRF) attacks.","sys_updated_on":"2024-07-22 23:48:32","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"83aff094779821108bd73a91fa5a99f7","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Disable External Content URL","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the Glide Property \"glide.ui.url.external.content\" exists and is set to the value \"false\". If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"2","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-ext-content-url","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function (finding) {\n  var targetProperty = 'glide.ui.url.external.content';\n  var expectedValue = 'false'; \n  var defaultValue = 'false';\n\n  var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    \n  if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n    var gr = new GlideRecord('sys_properties');\n    if (gr.get('name', targetProperty)) {\n      finding.setCurrentSource(gr);\n    }\n    finding.increment();\n  } \n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_83aff094779821108bd73a91fa5a99f7","name":"Disable External Content URL","category":"security","sys_policy":"read"},{"short_description":"Escape Scripts in Scratchpad","description":"The scratchpad is an easy way to set information on the server that can be accessed in the browser. An admin can script anything to be on it, including arbitrary data from arbitrary records. If \"glide.ui.escape_scratchpad\" is not set to the recommended value of \"true\", then it is possible to execute malicious script like a cross-site scripting vulnerability.","sys_updated_on":"2023-10-06 17:27:55","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"83aff094779821108bd73a91fa5a99f8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Escape Scripts in Scratchpad","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.ui.escape_scratchpad\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:escape-scratchpad","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.escape_scratchpad';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_83aff094779821108bd73a91fa5a99f8","name":"Escape Scripts in Scratchpad","category":"security","sys_policy":"read"},{"short_description":"Enable Jelly JS Interpolation Protection for Nested Expressions","description":"This property allows a customer to turn on or off interpolation protection specifically for nested Jelly expressions. Interpolation protection ensures that when Jelly expressions are used in JavaScript, they must be deemed safe by either falling under certain categories OR being marked as SAFE in the expression itself. This property was added to protect against possibly dangerous Jelly expressions which are nested in another Jelly expression.If \"glide.ui.jelly.js_interpolation.protect_nested_expressions\" is not set to the recommended value of \"true\", then Interpolated jelly experession may result in a malicious actor sending a crafted GET parameter to a Jelly page and cause the contents of that parameter to be evaluated as server-side JavaScript with admin privileges.","sys_updated_on":"2024-07-20 01:44:26","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"83aff094779821108bd73a91fa5a99f9","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Enable Jelly JS Interpolation Protection for Nested Expressions","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.ui.jelly.js_interpolation.protect_nested_expressions' exists and is set to the value 'true'. If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-jelly-js-interpolation-protection-nested-expressions","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.jelly.js_interpolation.protect_nested_expressions';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_83aff094779821108bd73a91fa5a99f9","name":"Enable Jelly JS Interpolation Protection for Nested Expressions","category":"security","sys_policy":"read"},{"short_description":"Ensure Dashboards Creation/Deletion Requires Access Check","description":"The property 'glide.processors.check_access_before_process' enables ACL enforcement for creating or deleting dashboards so long as a user is logged in. Disabling this property (i.e., setting it to false) effectively allows for an ACL bypass on dashboards which allows all authenticated low privileged users to arbitrarily delete and add dashboards. This property should always be set to true.","sys_updated_on":"2024-07-20 01:50:22","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"87321930774031101b803a91fa5a9957","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Ensure Dashboards Creation/Deletion Requires Access Check","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.processors.check_access_before_process' exists and is set to the value 'true'. If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:ensure-dashboards-creation-and-deletion-requires-access-check","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.processors.check_access_before_process';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_87321930774031101b803a91fa5a9957","name":"Ensure Dashboards Creation/Deletion Requires Access Check","category":"security","sys_policy":"read"},{"short_description":"Block Rooted or Jailbroken Mobile Devices","description":"If \"glide.sg.allow_rooted_jailbroken_device\" is not set to the recommended value of \"false\", then the mobile app will allow users to use the app from jailbroken or rooted mobile devices. Jailbroken or rooted mobile devices run untrusted code at the system level that can bypass the platform's security model which our mobile apps rely on. Setting \"allow_rooted_jailbroken_device\" to \"false\" enables a limited client-side check to display an error message to the user if attempting to use the app from one of these devices. \n\nThis configuration maps to MASVS v1.4.2 requirement 8.1 at R-level.","sys_updated_on":"2023-10-06 17:27:55","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"8baff094779821108bd73a91fa5a99f2","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Block Rooted or Jailbroken Mobile Devices","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.sg.allow_rooted_jailbroken_device\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:block-rooted-jailbroken-mobile-devices","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sg.allow_rooted_jailbroken_device';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_8baff094779821108bd73a91fa5a99f2","name":"Block Rooted or Jailbroken Mobile Devices","category":"security","sys_policy":"read"},{"short_description":"Enable UserCookie Version 3.1","description":"UserCookie v3 is generated only when property glide.ui.secure.cookies.use_kmf is disabled. UserCookie v3 is not secure due to storing secret key for HMAC in source code and identical for all customers. That can support malicious actors to use this one secret key for attempts to hijacking user sessions. By setting the property \"glide.ui.secure.cookies.use_kmf\" to \"true\", UserCookie v3.1 will be used and secret key will be stored in security storage such as KMF.","sys_updated_on":"2024-07-20 01:47:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"8baff094779821108bd73a91fa5a99f3","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Enable UserCookie Version 3.1","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.ui.secure.cookies.use_kmf\" exists and is set to \"true\". If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-usercookie-v3-1","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.secure.cookies.use_kmf';\n    var expectedValue = 'true';\n\n    // Property is set to \"false\" by default in source code\n    var propertyValue = gs.getProperty(targetProperty, 'false');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_8baff094779821108bd73a91fa5a99f3","name":"Enable UserCookie Version 3.1","category":"security","sys_policy":"read"},{"short_description":"Limit Concurrent Sessions Plugin","description":"The Limit Concurrent Sessions plugin  (com.glide.limit.concurrent.sessions)  allows an administrator to limit the number of active sessions per user/role. It is recommended this plugin be enabled and configured to reduce the likelihood of session hijacking. If this plugin is enabled and configured, there will be a limit to the number of open sessions that can be hijacked.","sys_updated_on":"2023-10-06 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"8baff094779821108bd73a91fa5a99f4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Limit Concurrent Sessions Plugin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the \"com.glide.limit.concurrent.sessions\" plugin is activated.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-concurrent-sessions-plugin","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var pluginId = 'com.glide.limit.concurrent.sessions';\n    if (!GlidePluginManager.isActive(pluginId)) {\n        var gr = new GlideRecord('v_plugin');\n        gr.get('id', pluginId);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_8baff094779821108bd73a91fa5a99f4","name":"Limit Concurrent Sessions Plugin","category":"security","sys_policy":"read"},{"short_description":"Limit Concurrent Sessions Across All Nodes","description":"This property is meant to be used with the \"Limit Concurrent Sessions\" plugin. When this plugin is installed and configured, the number of open sessions can be limited per user. When this property is set, the number of sessions will be tracked across all nodes instead of a single application nodes. If this property is not set to true, multiple sessions can be open across multiple nodes, increasing the likelihood of a successful session hijacking.","sys_updated_on":"2023-10-06 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"8baff094779821108bd73a91fa5a99f5","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Limit Concurrent Sessions Across All Nodes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure \"glide.authenticate.limit.concurrent.sessions.across.all.nodes\" is set to \"true\" when the \"com.glide.limit.concurrent.sessions\" plugin is active.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:glide-auth-limit-concurrent-sessions-all-nodes","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var isConcurrentSessionPluginActive = GlidePluginManager.isActive('com.glide.limit.concurrent.sessions');\n    if (isConcurrentSessionPluginActive) {\n        var targetProperty = 'glide.authenticate.limit.concurrent.sessions.across.all.nodes';\n        var expectedValue = 'true';\n        var defaultValue = 'true';\n\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_8baff094779821108bd73a91fa5a99f5","name":"Limit Concurrent Sessions Across All Nodes","category":"security","sys_policy":"read"},{"short_description":"Escape XML Response","description":"If \"glide.soaprequest.unescape_xml_response\" is not set to the recommended value of \"False\", then XML responses will not be escaped. This can lead to XML injection attack. The injection of unintended XML content into an XML message can alter the intended logic of an application, and XML Injection can cause the insertion of malicious content into resulting documents.","sys_updated_on":"2023-10-06 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"8baff094779821108bd73a91fa5a99f8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:45","sys_name":"Escape XML Response","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.soaprequest.unescape_xml_response\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:excape-xml-response","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.soaprequest.unescape_xml_response';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_8baff094779821108bd73a91fa5a99f8","name":"Escape XML Response","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for Unload Requests","description":"This property performs authentication while retrieving data from tables/pages in the form of unload data on the instance. If \"glide.basicauth.required.unl\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for the UNL format export processor. This also could be combined with a wrong role within the guest_user related property, this will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"8d6598c8d5001110fa9bdbc0c4c2abf5","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:41","sys_name":"Require Authorization for Unload Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.unl\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:access-control-instance-security-hardening","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.unl';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_8d6598c8d5001110fa9bdbc0c4c2abf5","name":"Require Authorization for Unload Requests","category":"security","sys_policy":"read"},{"short_description":"Deny by Default with Empty ACLs","description":"If \"glide.sm.default_mode\" is not set to the recommended value of \"deny\", then the instance's legacy security manager allows access to a resource when there are no ACLs defined for that resource; or only wildcards table-level ACLs. By setting this to \"allow\" anything that does not have explicit ACLs set is susceptible to manipulation.","sys_updated_on":"2023-10-06 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"9165d8c8d5001110fa9bdbc0c4c2ab4e","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:42","sys_name":"Deny by Default with Empty ACLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.sm.default_mode\" is set to \"deny\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:default-deny","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sm.default_mode';\n    var expectedValue = 'deny';\n    var defaultValue = 'deny';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_9165d8c8d5001110fa9bdbc0c4c2ab4e","name":"Deny by Default with Empty ACLs","category":"security","sys_policy":"read"},{"short_description":"Enforce Security Scope License and Permit Playbook","description":"When the Glide Property 'glide.enforce_security_scope.sn_gsm_lic_prmt' is set to the value 'true', only the ACLs within the License and Permit plugin are used to determine access to a resource. When this value is not true, License and Permit Playbooks data in scope master tables are exposed by considering the ACLs from all the scopes for granting access. \r\n\r\nExample: IT Administrator can access License and Permit Playbooks data when it's set to false.","sys_updated_on":"2024-07-24 22:00:44","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"91acc98d5323311053a6ddeeff7b1277","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-01-03 16:07:03","sys_name":"Enforce Security Scope License and Permit Playbook","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.enforce_security_scope.sn_gsm_lic_prmt' is set to the value 'true'.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-security-scope-license-and-playbook","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var enabledPlugin = new GlidePluginManager().isActive('com.sn_gsm_lic_prmt');\n    var targetProperty = 'glide.enforce_security_scope.sn_gsm_lic_prmt';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (enabledPlugin) {\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n          var gr = new GlideRecord('sys_properties');\n          if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n          }\n          finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_91acc98d5323311053a6ddeeff7b1277","name":"Enforce Security Scope License and Permit Playbook","category":"security","sys_policy":"read"},{"short_description":"Enforce Strict Elevate Privilege","description":"When this property is set to 'true', roles marked as \"privileged\" must always be manually elevated by an admin user upon new session creation in order for the user to be granted the role's capabilities. When 'false', roles marked as \"privileged\" are automatically elevated upon an admin user new session, and do not need to be manually elevated (with exception of \"security_admin\"). Setting this property to secure value will add an extra layer of security validation to role elevation by privileged user.","sys_updated_on":"2023-10-06 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"93321930774031101b803a91fa5a9993","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:17","sys_name":"Enforce Strict Elevate Privilege","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure glide.security.strict_elevate_privilege is set to true as it allows a user with admin to manually elevate to a role they want to.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-strict-elevate-privilege","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.strict_elevate_privilege';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_93321930774031101b803a91fa5a9993","name":"Enforce Strict Elevate Privilege","category":"security","sys_policy":"read"},{"short_description":"Enforce Security Scope for Service Application Information","description":"When the property \"glide.enforce_security_scope.sn_svc_appl_info\" is set to the value of \"true\", only the ACLs within the Service Application Information plugin (sn_svc_appl_info) are used to determine access to a resource in this scope. If set to the insecure value, ACLs from all scopes are considered when granting access to data in scope master tables such as sys_attachment. This could lead to unauthorized access to sensitive information by users who are not granted access to the Service Application Information data. ","sys_updated_on":"2024-08-29 01:59:08","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"96adb071dd985210f877477f3179cea1","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-29 01:59:08","sys_name":"Enforce Security Scope for Service Application Information","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure \"glide.enforce_security_scope.sn_svc_appl_info\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-security-scope-for-service-application-info","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(engine) {\n    if (GlidePluginManager.isActive('com.sn_svc_appl_info')) {\n        var targetProperty = 'glide.enforce_security_scope.sn_svc_appl_info';\n        var expectedValue = 'true';\n        var defaultValue = 'false';\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            if (gr.get('name', targetProperty)) {\n                finding.setCurrentSource(gr);\n            }\n            finding.increment();\n        }\n    }\n})(engine);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_96adb071dd985210f877477f3179cea1","name":"Enforce Security Scope for Service Application Information","category":"security","sys_policy":"read"},{"short_description":"Enable Scoped Admin Application ACLs","description":"Determines whether an application administration apps can inherit global access control list (ACL) rules. Useful when there are no scoped admin application ACLs defined for the record scope.\n\nIf \"glide.security.scoped_administration.honor_global_acl\" is not set to the recommended value of \"true\",  then a low privilege user with permissions to the application could potentially access sensitive records.","sys_updated_on":"2023-10-06 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"99d09f3d773011108bd73a91fa5a990b","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable Scoped Admin Application ACLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.scoped_administration.honor_global_acl\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:administer-scoped-admin-app-acls","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.scoped_administration.honor_global_acl';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_99d09f3d773011108bd73a91fa5a990b","name":"Enable Scoped Admin Application ACLs","category":"security","sys_policy":"read"},{"short_description":"Disable SQL Error Messages","description":"If \"glide.db.loguser\" is not set to the recommended value of \"false\", then sensitive server-side error messages could be displayed to end-users.  Error messages can include stack traces and information about the structure of the database that could provide an attacker the knowledge needed to perform successful SQL Injection should the preconditions exist. As defense in depth, these error messages should not be displayed to the end user.","sys_updated_on":"2023-12-26 17:27:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"99d09f3d773011108bd73a91fa5a990d","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Disable SQL Error Messages","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.db.loguser\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disabling-sql-error-messages","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.db.loguser';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_99d09f3d773011108bd73a91fa5a990d","name":"Disable SQL Error Messages","category":"security","sys_policy":"read"},{"short_description":"Enforce Relative Links","description":"The \"glide.cms.catalog_uri_relative\" property enforces relative links from the URI parameter on /ess/catalog.do. If \"glide.cms.catalog_uri_relative\" is not set to the recommended value of \"true\", then the URL will not be sanitized with the enforceRelativeURL(url)  function. Absolute URLs can pose a security risk when used as a part of parameter or a field value, thus redirecting the source page to an adversary-controlled website.\n\nThis property impacts the legacy Content Management System (CMS) which has been replaced with Service Portal.","sys_updated_on":"2023-12-26 17:27:57","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"99d09f3d773011108bd73a91fa5a9911","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enforce Relative Links","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.cms.catalog_uri_relative\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-relative-links","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.cms.catalog_uri_relative';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_99d09f3d773011108bd73a91fa5a9911","name":"Enforce Relative Links","category":"security","sys_policy":"read"},{"short_description":"Limit Policy Based Session Access Mobile Refresh Token Interval","description":"The property 'glide.authenticate.session_access.mobile.refresh_token_interval' governs the length of time after which a mobile device user will be forced to re-authenticate. This only applies if the admin has configured the Identity Provider attributes (which can vary for each login) in the session access policy and the user authenticates via Single Sign On . The property value is an integer in seconds. The recommended value is 1800 (30 minutes). A large value may grant a larger timeframe for session access to be hijacked by an attacker.","sys_updated_on":"2024-01-03 15:46:21","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"9a97cd495323311053a6ddeeff7b12cb","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-01-03 15:46:21","sys_name":"Limit Policy Based Session Access Mobile Refresh Token Interval","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.authenticate.session_access.mobile.refresh_token_interval' is set to a value of '1800' or below.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-policy-based-session-access","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var enabledPlugin = new GlidePluginManager().isActive('com.snc.zero_trust_session_access');\n    var targetProperty = 'glide.authenticate.session_access.mobile.refresh_token_interval';\n    var expectedValue = 1800;\n    var defaultValue = 1800;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    // Only check if Zero Access is enabled\n    if (enabledPlugin) {\n        enabledProperty = gs.getProperty('glide.authenticate.session_access.enabled', 'false');\n        if (enabledProperty.toLowerCase() == 'true') {\n            if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n                var gr = new GlideRecord('sys_properties');\n                gr.get('name', targetProperty);\n                finding.setCurrentSource(gr);\n                finding.increment();\n            }\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_9a97cd495323311053a6ddeeff7b12cb","name":"Limit Policy Based Session Access Mobile Refresh Token Interval","category":"security","sys_policy":"read"},{"short_description":"Sanitize All Translated HTML Fields","description":"When the Glide Property 'glide.translated_html.sanitize_all_fields' is set to the value 'true', all translated_html elements will be sanitized using an HTML sanitizer. When the property is set to 'false', an element will only be sanitized if a dictionary attribute, html_sanitize, is set to true.\r\n\r\nSanitizing HTML elements is best practice to ensure an attacker cannot embed malicious content that may lead to Cross Site Scripting (XSS) attacks.","sys_updated_on":"2024-08-02 21:11:24","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"9ae28edd43ff0210a0d25dc36ab8f210","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-08-02 21:11:24","sys_name":"Sanitize All Translated HTML Fields","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.translated_html.sanitize_all_fields' is set to the value 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:sanitize-all-translated-html-fields","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.translated_html.sanitize_all_fields';\n    var expectedValue = 'true';\n    var defaultValue  = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n      var gr = new GlideRecord('sys_properties');\n      if (gr.get('name', targetProperty)) {\n        finding.setCurrentSource(gr);\n      }\n      finding.increment();\n    }\n    })(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_9ae28edd43ff0210a0d25dc36ab8f210","name":"Sanitize All Translated HTML Fields","category":"security","sys_policy":"read"},{"short_description":"Disable GlideRecord Scope Fencing Legacy Behavior","description":"GlideRecord provided cross scope create/update access to tables that were not configured with that level of access. In order to prevent customers from having applications broken when this scoped access behavior was patched, the property glide.record.legacy_cross_scope_access_policy_in_script was created. When 'true', cross scope access falls back onto legacy behavior (insecure). This property disables scope fencing, allowing scoped apps to access global script interfaces.\n\nIt is best security practice to have scope fencing restrictions in place. Scoping ensures applications can only access resources with explicit access or within their scope, following the principle of least privilege. Disabiling this feature could lead to confidentiality, availability, and integrity impacts.","sys_updated_on":"2024-07-20 01:43:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"9b321930774031101b803a91fa5a9966","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Disable GlideRecord Scope Fencing Legacy Behavior","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'glide.record.legacy_cross_scope_access_policy_in_script' to 'false'.  When not present in the sys_properties table, the default value is \"true\".","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-gliderecord-scope-fencing-legacy-behavior","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.record.legacy_cross_scope_access_policy_in_script';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n          finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_9b321930774031101b803a91fa5a9966","name":"Disable GlideRecord Scope Fencing Legacy Behavior","category":"security","sys_policy":"read"},{"short_description":"Restrict Access to GlideSystemUserSession Scriptable API","description":"\"gs.addErrorMessageNoSanitizationMessaging()\" and \"gs.addInfoMessageNoSanitization()\" are used within the scripting environment for logging and notifications. Both of these are available in the sandbox if this property is not set to the recommended value of \"false\". The sandbox is a low privileged scripting environment available to unauthenticated and no role users. Both of these methods can be used to display unsanitized input to a user. Displaying unsanitized input to the user is dangerous, as unsanitized input may contain dangerous code that runs in the user's browser. This can be utilized for traditional reflected XSS attacks. Reflected XSS attacks can be used in multiple scenarios, including session hijacking.","sys_updated_on":"2023-10-06 17:27:57","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a06598c8d5001110fa9bdbc0c4c2abb1","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:39","sys_name":"Restrict Access to GlideSystemUserSession Scriptable API","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.sandbox.usersession.allow_unsanitized_messages\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:allow-glide-system-user-session-scriptable","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sandbox.usersession.allow_unsanitized_messages';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a06598c8d5001110fa9bdbc0c4c2abb1","name":"Restrict Access to GlideSystemUserSession Scriptable API","category":"security","sys_policy":"read"},{"short_description":"Certificate Based Authentication Not Enforced","description":"This property enables certificate based authentication, a type of mutual authentication, for inbound connections to REST and SOAP APIs in the Now platform. Mutual authentication establishes trust between server and client by exchanging Secure Sockets Layer (SSL) certificates and validating the certificate with a trusted Certificate Authority (CA). This allows verification that a trusted source is connecting to the Now platform. Without this setting the instance is at risk person-in-the-middle, replay or spoofing attacks.","sys_updated_on":"2023-10-06 17:27:57","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a6321930774031101b803a91fa5a992a","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:14","sys_name":"Certificate Based Authentication Not Enforced","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Enable mutual authentication for inbound web services. For first time set-up install the Certificate-based authentication plugin (com.glide.auth.mutual) for the Now platform and follow set up instructions. Ensure the property \"glide.authenticate.mutual.enabled\" is set to \"true\" to activate the plugin functionality. \n\nDocumentation and set-up instructions can be found here: https://docs.servicenow.com/csh?topicname=set-up-mutual-auth.html&version=latest.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:certificate-based-authentication","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    // This property is installed as part of the Certificate-based authentication (com.glide.auth.mutual) plugin. \n    // If the property does not exist (default 'false' here), this is a finding. If the property does exist and is false, this is a finding.\n    var targetProperty = 'glide.authenticate.mutual.enabled';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a6321930774031101b803a91fa5a992a","name":"Certificate Based Authentication Not Enforced","category":"security","sys_policy":"read"},{"short_description":"Set Safe Content Security Policy for SVG Files","description":"This property adds \"script-src none\" to the Content-Security-Policy header when SVGs are accessed via the \".iix\" file extension, which prevents the exploitation of stored XSS from crafted file attachments stored within the instance. Without this policy, a malicious actor could trick a user into running arbitrary JavaScript code in their web browser leading to consequences such as data exfiltration or session takeover.","sys_updated_on":"2023-10-06 17:27:57","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a632d530774031101b803a91fa5a99f1","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:13","sys_name":"Set Safe Content Security Policy for SVG Files","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure that the property \"com.glide.csp.self_script_src_svg\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:set-safe-content","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.csp.self_script_src_svg';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a632d530774031101b803a91fa5a99f1","name":"Set Safe Content Security Policy for SVG Files","category":"security","sys_policy":"read"},{"short_description":"Enable MID Audit Log","description":"The MID Server command audit log records details such as the command name, command hash, name of credential used and execution status. Once enabled, audit logs can be viewed users with the role agent_security_admin in the ecc_agent_command_audit_log table or by navigating to MID Server > Command Audit Logs.\n\nIn the event of a security investigation, this table can be by incident response teams to audit the commands run on the MID server. Without this log there might not be sufficient details to respond to situations such as unauthorized account use.","sys_updated_on":"2024-04-04 21:46:12","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a7321930774031101b803a91fa5a999e","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:17","sys_name":"Enable MID Audit Log","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set mid.log.command_audit.enable to \"true\" in the ecc_agent_property table to turn on auditing for commands run by the MID server. \n\nSee the following documentation for editing this mid server property: https://docs.servicenow.com/csh?topicname=mid-audit-log.html&version=latest","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-mid-audit-log","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    // Query for MID Server Property mid.log.command_audit.enable\n    if (pluginManager.isActive('com.glideapp.agent')) {\n        var gr = new GlideRecord('ecc_agent_property');\n        var propQuery = 'name=mid.log.command_audit.enable^value=true';\n        gr.addEncodedQuery(propQuery);\n        gr.query();\n\n        // If the property table record does not exit, then default is false\n        if (!gr.next()) {\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a7321930774031101b803a91fa5a999e","name":"Enable MID Audit Log","category":"security","sys_policy":"read"},{"short_description":"Enable Security Jump Start Plugin (ACL Rules)","description":"Creates several important ACLs that validate the Access Controls on some of the key system tables within the Now Platform. These rules provide a jump-start on securing many system tables, making it easier for an organization to get an instance into production. The Security Jump Start (ACL Rules) plugin is installed automatically on all new instances.","sys_updated_on":"2023-10-06 17:27:57","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9915","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable Security Jump Start Plugin (ACL Rules)","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the plugin \"com.snc.system_security\" is activated.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:security-jump-start-acl-rules","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var pluginId = 'com.snc.system_security';\n    if (!GlidePluginManager.isActive(pluginId)) {\n        var gr = new GlideRecord('v_plugin');\n        gr.get('id', pluginId);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9915","name":"Enable Security Jump Start Plugin (ACL Rules)","category":"security","sys_policy":"read"},{"short_description":"Activate Role Based Multi-Factor Authentication","description":"This property enforces multi-factor authentication based on the roles assigned to the user. If this property is set to true, then it will enforce role-based multi-factor authentication for all users described in the multi_factor_criteria table. This table enforces multi-factor authentication based on the roles assigned to the user. If a user has been assigned \"admin\", \"security_admin\" or \"user_admin\" roles in the multi-factor roles list, MFA will be enforced.","sys_updated_on":"2023-10-06 17:27:57","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9917","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Activate Role Based Multi-Factor Authentication","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.authenticate.multifactor\" is set to \"true\" and the \"multi_factor_criteria\" table has a \"Role base multi-factor authentication\" record with the \"Active\" field set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:role-based-multi-factor-authentication","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.authenticate.multifactor';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    var targetTabularQuery = new GlideRecord('multi_factor_criteria');\n    targetTabularQuery.addQuery('sys_id', 'd427668b73003300fdbd04fbc4f6a7b6');\n    targetTabularQuery.addQuery('active', 'true');\n    targetTabularQuery.query();\n\n    if ((propertyValue.toLowerCase() != expectedValue.toLowerCase()) && !targetTabularQuery.hasNext()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9917","name":"Activate Role Based Multi-Factor Authentication","category":"security","sys_policy":"read"},{"short_description":"Disable Creating Users from Incoming Emails","description":"An administrator can set an email property to automatically create users from incoming emails. If set this property to the insecure value, the instance will automatically create users from incoming email. Each user created will have the same hardcoded default password which makes bypassing authentication through brute force easier.","sys_updated_on":"2023-10-06 17:27:57","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9919","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Disable Creating Users from Incoming Emails","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.pop3readerjob.create_caller\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-emails-by-domain","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.pop3readerjob.create_caller';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9919","name":"Disable Creating Users from Incoming Emails","category":"security","sys_policy":"read"},{"short_description":"Enable Contextual Security Plugin","description":"The \"Contextual Security: Role Management\" plugin helps manage user groups and roles to protect information through role-based access controls. The plugin efficiently consolidates duplicate entries for inherited roles, and secures a record/information using create, read, write, and delete functionality. After it is installed and activated, the dictionary roles (created by simple security manager) are no longer tested. Instead, the Now Platform looks for ACL rules on fields and tables. It secures the data with the help of ACL rules instead of traditional, role-based dictionary rules implemented by simple security manager. Even if you configure the dictionary form and add roles to a dictionary entry, no change in rights occurs.","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a991b","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable Contextual Security Plugin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the plugin \"com.glide.role_management\" is activated.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:contextual-security","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var pluginId = 'com.glide.role_management';\n    if (!GlidePluginManager.isActive(pluginId)) {\n        var gr = new GlideRecord('v_plugin');\n        gr.get('id', pluginId);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a991b","name":"Enable Contextual Security Plugin","category":"security","sys_policy":"read"},{"short_description":"Enable SNC Access Control Plugin","description":"The SNC Access Control (com.snc.snc_access_control) plugin prevents Customer Service and Support personnel from accessing the instances without your express permission. However, other authorized ServiceNow Operations personnel, in their capacity to support and manage the product, are required to perform administrative actions on the underlying infrastructure. This infrastructure includes servers and databases, among other infrastructure components that make up the SaaS solution. This access method is fully auditable and tracked.\nThis plugin enables you to restrict access to your instance without your express permission, so it may affect support service levels and the Availability SLA. Availability SLA is then measured from the time that Support staff personnel are granted access to your instance.","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a991f","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Enable SNC Access Control Plugin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the plugin \"com.snc.snc_access_control\" is activated.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:snc-access-control-plugin","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var pluginId = 'com.snc.snc_access_control';\n    if (!GlidePluginManager.isActive(pluginId)) {\n        var gr = new GlideRecord('v_plugin');\n        gr.get('id', pluginId);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a991f","name":"Enable SNC Access Control Plugin","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for XSD Requests","description":"The glide property \"glide.basicauth.required.xsd\" controls whether authentication is required in order to make a XSD request to an instance.  If \"glide.basicauth.required.xsd\" is not set to the recommended value of \"true\", then authentication is disabled for XSD requests on the instance. It allows unauthenticated access to XSD processor leaking sensitive information.","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9923","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Require Authorization for XSD Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.xsd\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:xsd-request-authorization","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.xsd';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9923","name":"Require Authorization for XSD Requests","category":"security","sys_policy":"read"},{"short_description":"Block Access For Delegated Developers","description":"This property determines whether a delegated developer can give assign roles to users through scripts. If \"com.glide.sys.security.delegateddev.block_grant_roles\" is not set to the recommended value of \"true\",  then a delegated developer could assign roles to any user. This could lead to unapproved privilege escalation.","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9925","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Block Access For Delegated Developers","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"com.glide.sys.security.delegateddev.block_grant_roles\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:block-access-delegated-developers","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.sys.security.delegateddev.block_grant_roles';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9925","name":"Block Access For Delegated Developers","category":"security","sys_policy":"read"},{"short_description":"Minimize Entity Expansion Threshold for GlideXMLUtil Scriptable","description":"This property controls the maximum amount of entity expansion within an XML Parser. If \"glide.xmlutil.max_entity_expansion\" is not set to the recommended value of 3000 or less, then the GlideXMLUtil parsing scriptable may be vulnerable to denial of service attacks.","sys_updated_on":"2024-07-20 01:39:44","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9927","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Minimize Entity Expansion Threshold for GlideXMLUtil Scriptable","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.xmlutil.max_entity_expansion\" is set to \"3000\" or less.\r\nIf the instance is on Washington or later, the default implied value is 3000 if the sys_properties record does not exist. If the instance is not on Washington or later, the recommendaton is for the instance admin to create a sys_properties record with name \"glide.xmlutil.max_entity_expansion\" and the value \"3000\".","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:setting-entity-expansion-threshold","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.xmlutil.max_entity_expansion';\n    var expectedValue = 3000;\n    var defaultValue = 3000;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n          finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9927","name":"Minimize Entity Expansion Threshold for GlideXMLUtil Scriptable","category":"security","sys_policy":"read"},{"short_description":"Require AJAXGlideRecord ACL Checking","description":"This property toggles ACL validation for GlideAjax API calls. If \"glide.script.secure.ajaxgliderecord\" is not set to the recommended value of \"true\",  then ACL validation will not be completed for GlideAjax requests. This could lead to server-side resources being accessed by users without proper authorization.","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9929","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Require AJAXGlideRecord ACL Checking","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.script.secure.ajaxgliderecord\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enabling-ajaxgliderecord-acl-checking","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.script.secure.ajaxgliderecord';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9929","name":"Require AJAXGlideRecord ACL Checking","category":"security","sys_policy":"read"},{"short_description":"Maximize Failed Login Unlock Timeout Duration","description":"If \"glide.user.unlock_timeout_in_mins\" is not set to the recommended value of \"15\", then it may be easier to brute force accounts in a faster timeframe. This property unlocks the user account after the time period that is specified for the glide.user.unlock_timeout_in_mins property. If no value is specified, then the system unlocks the user account after the default period of 15 minutes.","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a992b","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Maximize Failed Login Unlock Timeout Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.user.unlock_timeout_in_mins\" is set to \"15\" or more.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:managing-failed-login-attempts","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.user.unlock_timeout_in_mins';\n    var expectedValue = 15;\n    var defaultValue = 15;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) < expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a992b","name":"Maximize Failed Login Unlock Timeout Duration","category":"security","sys_policy":"read"},{"short_description":"Restrict Access to Specific IP Ranges Plugin","description":"This plugin when set to true restricts access to specific IP ranges. Unless public access is intended for the instance, administrators should limit access to their assigned IP net blocks. \r\nAn exclusion list (Deny) or an inclusion list (Allow) of IP addresses can be created through IP Address Access Control (ip_access_list.do). ","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a992d","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Restrict Access to Specific IP Ranges Plugin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the plugin \"com.snc.ipauthenticator\" is activated and there is at least one active IP access policy in the table \"ip_access\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-access-to-specific-ip-ranges","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var active_plugin = GlidePluginManager.isActive('com.snc.ipauthenticator');\n    //If the plugin is active, confirm there is at least 1 active IP based rule\n    if (active_plugin) {\n        var ip_access = new GlideRecord('ip_access');\n        ip_access.addActiveQuery();\n        ip_access.query();\n        //If there are no active IP access entries this is a finding\n        if (!ip_access.next()) {\n            finding.setCurrentSource(ip_access);\n            finding.increment();\n        }\n    } else {\n        //The plugin is not active, this is a finding\n        var gr1 = new GlideRecord('v_plugin');\n        gr1.get('id', 'com.snc.ipauthenticator');\n        finding.setCurrentSource(gr1);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a992d","name":"Restrict Access to Specific IP Ranges Plugin","category":"security","sys_policy":"read"},{"short_description":"Disable Outbound SSLv2/SSLv3 Connections","description":"This property controls the desired transport encryption protocol. If \"glide.glide.outbound.sslv3.disabled\" is not set to the recommended value of \"true\", then outbound MID server connections such as REST and SOAP requests will use SSL as the transport protocol. SSL was proven to be insecure in 2014.","sys_updated_on":"2024-07-20 01:40:09","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a992f","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Disable Outbound SSLv2/SSLv3 Connections","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.outbound.sslv3.disabled' exists and is set to the value 'true'. If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disabling-sslv2-sslv3","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.outbound.sslv3.disabled';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a992f","name":"Disable Outbound SSLv2/SSLv3 Connections","category":"security","sys_policy":"read"},{"short_description":"Limit Allowed Number of Failed Login Attempts Before Lockout","description":"The \"SNC User Lockout Check\" or \"SNC User Lockout Check with Auto Unlock\" script actions enable the administrator to manage the number of failed login attempts for a user. Two script actions are available that enable a site administrator to manage the number of times a user can provide correct password before getting locked out from the Now Platform. \r\n\r\nAdditionally, the \"glide.user.max_unlock_attempts\" property controls the number of allowed failed login attempts. If the value of \"glide.user.max_unlock_attempts\" is increased above the recommended value of \"5\", it will increase the number of login attempts an attacker could make against a given user. ","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9931","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Limit Allowed Number of Failed Login Attempts Before Lockout","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure at least one of the script actions: \"SNC User Lockout Check\" or \"SNC User Lockout Check with Auto Unlock\" are enabled to manage failed login attempts. Additionally, ensure the property \"glide.user.max_unlock_attempts\" is set to \"5\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:managing-failed-login-attempts","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetTabularQuery1 = new GlideRecord('sysevent_script_action');\n    targetTabularQuery1.addQuery('sys_id', '5e44f9bf0a0a0a0a019a6440b2137767');\n    targetTabularQuery1.addQuery('active', '1');\n    targetTabularQuery1.query();\n\n    var targetTabularQuery2 = new GlideRecord('sysevent_script_action');\n    targetTabularQuery2.addQuery('sys_id', 'd92636b2975301008e00958e3b297567');\n    targetTabularQuery2.addQuery('active', '1');\n    targetTabularQuery2.query();\n\n    var targetProperty = 'glide.user.max_unlock_attempts';\n    var expectedValue = 5;\n    var defaultValue = 5;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if ((!targetTabularQuery1.hasNext() && !targetTabularQuery2.hasNext()) || isNaN(propertyValue) || (parseInt(propertyValue, 10) > expectedValue)) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9931","name":"Limit Allowed Number of Failed Login Attempts Before Lockout","category":"security","sys_policy":"read"},{"short_description":"Remove Remember Me","description":"This property controls the Remember Me check box from the login page to prevent login information from being cached when set to true. If the value is set to false, caching of authentication information is allowed and the \"Remember Me\" checkbox is displayed.","sys_updated_on":"2023-10-06 17:27:58","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9933","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Remove Remember Me","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.forgetme\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:remove-remember-me","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.forgetme';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9933","name":"Remove Remember Me","category":"security","sys_policy":"read"},{"short_description":"Restrict Access to Emails with Empty Target Table","description":"If \"glide.email.email_with_no_target_visible_to_all\" is not set to the recommended value of false, then low level users will have access to emails which are not their own.","sys_updated_on":"2023-10-06 17:27:59","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9937","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Restrict Access to Emails with Empty Target Table","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.email.email_with_no_target_visible_to_all\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-access-to-emails-with-empty-target-table","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.email.email_with_no_target_visible_to_all';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9937","name":"Restrict Access to Emails with Empty Target Table","category":"security","sys_policy":"read"},{"short_description":"Restrict Downloadable MIME Types","description":"If the property \"glide.ui.attachment.force_download_all_mime_types\" is set to true, then the \"glide.ui.attachment.download_mime_types\" property will be overridden so that all MIME types will be downloaded rather than rendered by the browser. For example, downloading text/html forces an HTML file to be downloaded to the client as a file rather than viewed inline in the browser, preventing a XSS attack. XSS can lead to easily attained privilege escalation to higher roles such as admin where more lateral movement can be taken.","sys_updated_on":"2024-08-19 21:55:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9939","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Restrict Downloadable MIME Types","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.attachment.force_download_all_mime_types\" is set to \"true\". If the property does not exist in the \"sys_properties\" table, the default value is \"false\".","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:download-mime-types","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.attachment.force_download_all_mime_types';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9939","name":"Restrict Downloadable MIME Types","category":"security","sys_policy":"read"},{"short_description":"Disable Public Access to Favorites","description":"If \"glide.ui.magellan.favorites.allow_public\" is not set to the recommended value of \"false\", then all unauthenticated users can access Favorites of the same \"Guest\" user in the navigator.","sys_updated_on":"2023-10-06 17:27:59","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a993f","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Disable Public Access to Favorites","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.magellan.favorites.allow_public\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:public-access-favorites","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.magellan.favorites.allow_public';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a993f","name":"Disable Public Access to Favorites","category":"security","sys_policy":"read"},{"short_description":"Restrict Uploaded MIME Types","description":"This property is used to activate MIME type checking for uploads. If \"glide.security.file.mime_type.validation\" is not set to the recommended value of true, then MIME type validation for file attachments will not take place which could allow malicious file types to be uploaded.","sys_updated_on":"2024-07-20 01:44:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"a9d09f3d773011108bd73a91fa5a9941","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-07-21 00:23:06","sys_name":"Restrict Uploaded MIME Types","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.file.mime_type.validation\" exists and is set to \"true\". If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:upload-mime-type-restriction","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.file.mime_type.validation';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_a9d09f3d773011108bd73a91fa5a9941","name":"Restrict Uploaded MIME Types","category":"security","sys_policy":"read"},{"short_description":"Restrict HR Case Updates from Personal Emails","description":"When the Glide Property 'sn_hr_core.restrict_guest_email' is not set to 'true', a user can send an email from a personal account referencing the HR case to be included in the worknotes. This could result in minor confidentiality or integrity issues if the personal email is compromised or communicating insecurely. An admin may want to restrict the ability of users to respond to HR cases via their personal email, since they cannot be confident of the user accessing the personal email account.","sys_updated_on":"2023-10-06 17:27:59","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"ab321930774031101b803a91fa5a99a9","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:18","sys_name":"Restrict HR Case Updates from Personal Emails","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'sn_hr_core.restrict_guest_email' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-hr-caze-updates-from-persoal-emails","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'sn_hr_core.restrict_guest_email';\n    var expectedValue = 'true';\n    var defaultValue = 'true'; //Default shipped is false, but getter defaults to true, so this value is true\n    if (new GlidePluginManager().isActive('com.sn_hr_core')) {\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_ab321930774031101b803a91fa5a99a9","name":"Restrict HR Case Updates from Personal Emails","category":"security","sys_policy":"read"},{"short_description":"Enforce Client Generated Scripts Sandbox","description":"This property enables the \"script sandbox\" validation feature which limits query conditions and calculated values in client-generated scripts. If \"glide.script.use.sandbox\" is not set to the recommended value of \"true\", then our \"javascript sandbox\" feature will be disabled which controls what can be done in script. Without appropriate authorization and validation, there is a potential for an attacker to perform unauthorized operations against the platform.","sys_updated_on":"2023-10-06 17:27:59","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"ac6598c8d5001110fa9bdbc0c4c2abb9","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:39","sys_name":"Enforce Client Generated Scripts Sandbox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.script.use.sandbox\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:client-generated-scripts-sandbox","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.script.use.sandbox';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_ac6598c8d5001110fa9bdbc0c4c2abb9","name":"Enforce Client Generated Scripts Sandbox","category":"security","sys_policy":"read"},{"short_description":"Prevent Users From Accepting Warning To Bypass CSRF Validation","description":"This property prevents users from being able to accept a warning which allows a potentially malicious request to be sent to the instance. This warning appears when a POST request fails due to having a mis-matched anti-CSRF token belonging to one of the victim's other active sessions. If \"glide.security.csrf.strict.validation.mode\" is not set to the recommended value of \"true\", then an attacker can formulate a CSRF attack utilizing a leaked anti-CSRF token from a different active session belonging to the victim.\n\nA POST request to an instance contains an anti-CSRF token within \"sysparm_ck\" or \"X-UserToken\" which matches the user's current session. If the anti-CSRF token is instead tied to one of the user's other active sessions, the POST request will return a 302 redirection to security_interceptor.do with a \"Continue\" button available to the user when this property is set to \"false\". Clicking this button will re-submit the request to the instance, except it will now having a valid anti-CSRF token. When this property is set to \"true\", the 302 redirection to the security_interceptor.do page will not display a \"Continue\" button and the user will not be allowed to resubmit the request.\n\nA successful CSRF attack will allow an attacker to effectively perform any operation that the victim is able to perform.","sys_updated_on":"2023-12-26 17:27:59","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"acd05f3d773011108bd73a91fa5a991e","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:02","sys_name":"Prevent Users From Accepting Warning To Bypass CSRF Validation","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.csrf.strict.validation.mode\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:csrf-strict-validation","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.csrf.strict.validation.mode';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_acd05f3d773011108bd73a91fa5a991e","name":"Prevent Users From Accepting Warning To Bypass CSRF Validation","category":"security","sys_policy":"read"},{"short_description":"Deny Internal Access to Explicit External Roles","description":"This property prevents external users from being assigned the snc_internal role. When \"glide.security.explicit_roles.enable_internal_user_blacklist\" is set to the recommended value of \"true\", then it enforces the parameters of the maint-protected \"glide.security.explicit_roles.internal_user_blacklist\" property which assigns the 'snc_external' role to a list of untrusted user classes. If the value is set to false, the \"glide.security.explicit_roles.internal_user_blacklist\" property is ignored. Misconfiguration of this propery increases the risk that an external user account gains access to internal information.","sys_updated_on":"2023-10-06 17:27:59","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"acd05f3d773011108bd73a91fa5a9932","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:02","sys_name":"Deny Internal Access to Explicit External Roles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.explicit_roles.enable_internal_user_blacklist\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-explicit-roles-internal-denylist","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.explicit_roles.enable_internal_user_blacklist';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_acd05f3d773011108bd73a91fa5a9932","name":"Deny Internal Access to Explicit External Roles","category":"security","sys_policy":"read"},{"short_description":"Prevent Inactive Users from Logging In","description":"When the Glide Property 'glide.authenticate.only.allow.active.user.login' is not set to 'true', users in the sys_user table marked inactive can still login to the instance. Users may be marked inactive if they no longer have permission to login (such as during termination from a company). If the property is not set to 'true', then these users may still access the instance and any data they could previously access. ","sys_updated_on":"2024-01-03 15:53:41","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"ad698dc95323311053a6ddeeff7b12c3","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-01-03 15:53:41","sys_name":"Prevent Inactive Users from Logging In","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.authenticate.only.allow.active.user.login' is set to 'true'. ","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:prevent-inactive-users","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.authenticate.only.allow.active.user.login';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_ad698dc95323311053a6ddeeff7b12c3","name":"Prevent Inactive Users from Logging In","category":"security","sys_policy":"read"},{"short_description":"Proactively Invalidate Inactive Sessions","description":"The Glide Property 'glide.active.session.timeout.invalidate.session' controls if a timed out session is proactively invalidated before the Tomcat container invalidates the session. When this property is not set to 'true', there can be a small interval of time where a timed out session is not invalidated (60+ seconds, depending on queue size). If a session is hijacked, an attacker may be able to utilize a session during this small period of time.","sys_updated_on":"2024-07-20 01:50:43","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"ae321930774031101b803a91fa5a990b","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-07-12 22:11:14","sys_name":"Proactively Invalidate Inactive Sessions","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Ensure the Glide Property 'glide.active.session.timeout.invalidate.session' exists and is set to the value 'true'. If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:proactively-invaidate-inactive-sessions","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.active.session.timeout.invalidate.session';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_ae321930774031101b803a91fa5a990b","name":"Proactively Invalidate Inactive Sessions","category":"security","sys_policy":"read"},{"short_description":"Enable ACLs for Encoded Query in Simple List Widget","description":"When the Glide Property \"glide.service_portal.enable_acls_for_encoded_query_in_list\" is not set to \"true\", a user may be able to bypass ACLs evaluation on a query condition in Simple List Widget. It is best practice to evaluate ACLs within queries to ensure a user has access to the fields being queried to prevent uanuthorized data leakage.","sys_updated_on":"2024-08-29 00:00:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"b43324bdddd45210f877477f3179cee2","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-29 00:00:05","sys_name":"Enable ACLs for Encoded Query in Simple List Widget","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property \"glide.service_portal.enable_acls_for_encoded_query_in_list\" is set to \"true\". If the property does not exist in the \"sys_properties\" table, the default value is \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-acls-for-encoded-query-in-simple-list-widget","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.service_portal.enable_acls_for_encoded_query_in_list';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_b43324bdddd45210f877477f3179cee2","name":"Enable ACLs for Encoded Query in Simple List Widget","category":"security","sys_policy":"read"},{"short_description":"Deprecated 3DES Usage in Password2 Fields","description":"The Password2 fields may use triple-DES encryption, which is not recommended for encryption after December 31, 2023, according to NIST 800-131A Rev 2. This check will help you to identify the Password2 fields which may use 3DES during encryption operation.","sys_updated_on":"2023-08-03 10:47:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"b98b39ba43103110d85b334eeab8f21b","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-07-31 16:36:41","sys_name":"Triple DES Usages in Password2 Fields","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Assess usage of these fields in instance to instance data transfer and enable Crypto Module Key Exchange for Complete Password2 3DES Usage deprecation","sys_mod_count":"0","active":"true","documentation_url":"https://docs.servicenow.com/?context=request_3des_deprecation","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(engine) {\n    var PARENT_MODULE_ID = '7d7ee9e3b7030010ebf7082e7e11a979';\n\n    //Function to get the KMF Submodules for password2\n\tfunction getPassword2ModuleScopeList() {\n\t\tvar password2ModuleScopeList = [];\n\t\tvar gr = new GlideRecord('sys_kmf_crypto_module');\n\t\tgr.addQuery('parent_crypto_module', PARENT_MODULE_ID);\n\t\tgr.query();\n\t\twhile (gr.next()) {\n\t\t\tpassword2ModuleScopeList.push(gr.getValue('sys_package'));\n\t\t}\n\t\treturn password2ModuleScopeList;\n\t}\n\tvar password2CryptoScopeList = getPassword2ModuleScopeList();\n\tvar query1 = 'attributesLIKEis_legacy_password2=true^attributesNOT LIKEuse_instance_level_glideencrypter=true^NQ';\n\tvar query2 = 'attributesLIKEuse_legacy_glideencrypter=true^attributesNOT LIKEis_legacy_password2=true';\n\tvar query = query1 + query2;\n\tvar sysDictionaryGr = new GlideRecord('sys_dictionary');\n\tsysDictionaryGr.addQuery('internal_type', 'password2');\n\tsysDictionaryGr.addEncodedQuery(query);\n\tsysDictionaryGr.addQuery('name', 'DOES NOT CONTAIN', 'var__m_');\n\tsysDictionaryGr.query();\n\twhile (sysDictionaryGr.next()) {\n\t\tvar scope = sysDictionaryGr.getValue('sys_package');\n\t\tif(password2CryptoScopeList.indexOf(scope) > -1){\n\t\t\tcontinue;\n\t\t}\n\t\tvar tableName = sysDictionaryGr.getValue('name');\n\t\tengine.finding.setCurrentSource(sysDictionaryGr);\n\t\tengine.finding.setValue('finding_details', \"Table Name:\" + tableName);\n\t\tengine.finding.increment();\n\t}\n})(engine);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/3d53e77304312210559073c06a02f70d","value":"3d53e77304312210559073c06a02f70d"},"sys_update_name":"scan_script_only_check_b98b39ba43103110d85b334eeab8f21b","name":"Triple DES Usages in Password2 Fields","category":"security","sys_policy":"read"},{"short_description":"Disallow Target Cloning","description":"If \"glide.db.clone.allow_clone_target\" is not set to the recommended value of \"false\", then the Instance can be used as a clone target. This risks the instance database being overwritten by cloning process, leading to integrity and availability loss.","sys_updated_on":"2023-10-06 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"ba321930774031101b803a91fa5a9935","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:14","sys_name":"Disallow Target Cloning","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.db.clone.allow_clone_target\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disallow-target-cloning","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.db.clone.allow_clone_target';\n    var expectedValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, 'true');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_ba321930774031101b803a91fa5a9935","name":"Disallow Target Cloning","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for Excel Requests","description":"If \"glide.basicauth.required.excel\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for EXCEL format export processor. This also happens when combined with a wrong role within the guest_user related property (For example a high privileged user such as Admin). This will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"bc6598c8d5001110fa9bdbc0c4c2abd3","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:40","sys_name":"Require Authorization for Excel Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.excel\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:excel-request-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.excel';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_bc6598c8d5001110fa9bdbc0c4c2abd3","name":"Require Authorization for Excel Requests","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for Import Requests","description":"This property performs this authentication while importing data sources into the instance tables/pages.\r\nIt restricts any guest users who are currently accessing this data. If \"glide.basicauth.required.importprocessor\" is not set to the recommended value of \"true\", then unauthenticated users could access import processor. Additional access controls, ie ACLs, are still enforced, but this value allows a guest user import request to be processed and not summarily denied.","sys_updated_on":"2023-10-06 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"bcd05f3d773011108bd73a91fa5a993c","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:02","sys_name":"Require Authorization for Import Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.importprocessor\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:import-request-auth","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.importprocessor';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_bcd05f3d773011108bd73a91fa5a993c","name":"Require Authorization for Import Requests","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for SCHEMA Requests","description":"If \"glide.basicauth.required.schema\" is not set to the recommended value of \"true\", then basic authorization is not required for all Inbound Table Schema Processor requests. The Inbound Table Schema Processor handles incoming schema requests for the platform. Omitting authentication from this processor will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"bcd05f3d773011108bd73a91fa5a9944","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:02","sys_name":"Require Authorization for SCHEMA Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.schema\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:schema-request-authorization","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.schema';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_bcd05f3d773011108bd73a91fa5a9944","name":"Require Authorization for SCHEMA Requests","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for WSDL Request","description":"If \"glide.basicauth.required.wsdl\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for WSDL requests. WSDL is a protocol that is used to describe web services such as instance table schemas, and is not a mechanism for sharing the data within tables. Setting this property to \"true\" allows for disclosure of table schemas to unauthenticated users.","sys_updated_on":"2023-12-26 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"bcd05f3d773011108bd73a91fa5a994a","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Require Authorization for WSDL Request","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.wsdl\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:wsdl-request-authorization","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.wsdl';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_bcd05f3d773011108bd73a91fa5a994a","name":"Require Authorization for WSDL Request","category":"security","sys_policy":"read"},{"short_description":"Restrict Delegated Developers Read Access","description":"If \"com.glide.dd_allow_global_access_tables\"  does not contain the recommended value of \"wf_activity, wf_activity_definition, wf_workflow, wf_workflow_version, sp_portal, sp_widget, sp_page\" then those tables could be read by delegated developer. This will provide the delegated developer read access to sensitive information.","sys_updated_on":"2023-10-06 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"bcd05f3d773011108bd73a91fa5a994e","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:03","sys_name":"Restrict Delegated Developers Read Access","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"com.glide.dd_allow_global_access_tables\" is set to \"wf_activity, wf_activity_definition, wf_workflow, wf_workflow_version, sp_portal, sp_widget, sp_page\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:delegated-dev-read-access","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.dd_allow_global_access_tables';\n    var expectedValue = 'wf_activity, wf_activity_definition, wf_workflow, wf_workflow_version, sp_portal, sp_widget, sp_page';\n    var defaultValue = 'wf_activity, wf_activity_definition, wf_workflow, wf_workflow_version, sp_portal, sp_widget, sp_page';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n\t\tvar gr = new GlideRecord('sys_properties');\n\t\tgr.get('name', targetProperty);\n\t\tfinding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_bcd05f3d773011108bd73a91fa5a994e","name":"Restrict Delegated Developers Read Access","category":"security","sys_policy":"read"},{"short_description":"Limit Guest's Active Session Life Span","description":"This configuration will enforce max lifespan on active guest HTTP sessions irrespective of inactive timeout. The configured value is in minutes and the value of zero will disable timing out the active sessions. A larger maximum lifespan could allow an attacker to persist a stolen session for longer, increasing the scope of a security incident. This particular property is limited to Guest users, which have low privilege access to an instance.","sys_updated_on":"2023-10-06 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"be321930774031101b803a91fa5a9940","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:15","sys_name":"Limit Guest's Active Session Life Span","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Set the Glide Property 'glide.guest.active.session.life_span' to a value greater than 0 and less than or equal to 720.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-guests-active-session","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.guest.active.session.life_span';\n    var expectedValue = 720;\n    var defaultValue = 0;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    // Value should be greater than or equal to 0 and less than 720\n    // 0 = disabled, greater than 720 is too long a timeout\n    if (isNaN(propertyValue) || (parseInt(propertyValue, 10) <= 0) || (parseInt(propertyValue, 10) > expectedValue)) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_be321930774031101b803a91fa5a9940","name":"Limit Guest's Active Session Life Span","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for XML Requests","description":"If \"glide.basicauth.required.xml\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for XML format export processor. This also happens when combined with a wrong role within the guest_user related property (For example a high privileged user such as Admin). This will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:28:00","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c16598c8d5001110fa9bdbc0c4c2abfa","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:41","sys_name":"Require Authorization for XML Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.xml\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:xml-request-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.xml';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c16598c8d5001110fa9bdbc0c4c2abfa","name":"Require Authorization for XML Requests","category":"security","sys_policy":"read"},{"short_description":"Enable Captcha in Password Reset","description":"If \"password_reset.captcha.ignore\" is not set to the recommended value of \"false\", then a CAPTCHA challenge-response will not be used during the password reset process. CAPTCHAs help prevent automation attacks by prompting the user for a challenge-response that is not easily answered by automated systems. The CAPTCHA is disabled, an attacker may be more successful during  automated attacks against the password reset feature.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99a8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Enable Captcha in Password Reset","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"password_reset.captcha.ignore\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-captcha-pw-reset","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.captcha.ignore';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99a8","name":"Enable Captcha in Password Reset","category":"security","sys_policy":"read"},{"short_description":"Minimize Reset Password Request Expiration Duration","description":"If \"password_reset.request.expiry\" is not set to the recommended value of \"10\" or less, then it increases the opportunity for someone else to guess and use the request and attempt to reset the password.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99aa","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Minimize Reset Password Request Expiration Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"password_reset.request.expiry\" is set to \"10\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-request-expiration","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.request.expiry';\n    var expectedValue = 10;\n    var defaultValue = 10;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99aa","name":"Minimize Reset Password Request Expiration Duration","category":"security","sys_policy":"read"},{"short_description":"Limit Invalid Password Reset Attempts","description":"If \"password_reset.request.max_attempt\" is not set to the recommended value of \"3\" or other reasonable small value, then it could be possible to perform brute force attack against password reset process.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99ac","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Limit Invalid Password Reset Attempts","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"password_reset.request.max_attempt\" is set to \"3\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-request-max-attempts","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.request.max_attempt';\n    var expectedValue = 3;\n    var defaultValue = 3;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99ac","name":"Limit Invalid Password Reset Attempts","category":"security","sys_policy":"read"},{"short_description":"Control Lockout Time for Invalid Password Reset Attempts","description":"The `password_reset.request.max_attempt_window` property defines the number of minutes a user must wait to reset or change their password after exceeding the maximum number of unsuccessful attempts that is set with the password_reset.request.max_attempt property. A small number of minutes for the  `password_reset.request.max_attempt_window` property increases the risk of successfully brute forcing a password as a greater number of password reset attempts can be made. The default of 1440 minutes is recommended.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99ae","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Control Lockout Time for Invalid Password Reset Attempts","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property `password_reset.request.max_attempt_window` is set to \"1440\" or greater.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-req-max-attempts-window","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.request.max_attempt_window';\n    var expectedValue = 1440;\n    var defaultValue = 1440;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) < expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99ae","name":"Control Lockout Time for Invalid Password Reset Attempts","category":"security","sys_policy":"read"},{"short_description":"Maximize Reset Password Request Retry Window Duration","description":"This property specifies the length of time before the count for password reset attempts refreshes. If \"password_reset.request.retry_window\" is not set to the recommended value of \"1440\" or more, then it will make brute forcing against password reset process attacks much faster.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99b0","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Maximize Reset Password Request Retry Window Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"password_reset.request.retry_window\" is set to \"1440\" or more.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-requests-retry-window","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.request.retry_window';\n    var expectedValue = 1440;\n    var defaultValue = 1440;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) < expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99b0","name":"Maximize Reset Password Request Retry Window Duration","category":"security","sys_policy":"read"},{"short_description":"Minimize Reset Password Request Success Window Duration","description":"If \"password_reset.request.success_window\" is not set to the recommended value of \"1440\" or less, then it increases the opportunity of someone else abusing the password reset functionality to gain unauthorised access to a user account.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99b2","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Minimize Reset Password Request Success Window Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"password_reset.request.success_window\" is set to \"1440\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-request-success-window","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.request.success_window';\n    var expectedValue = 1440;\n    var defaultValue = 1440;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99b2","name":"Minimize Reset Password Request Success Window Duration","category":"security","sys_policy":"read"},{"short_description":"Maximize Reset Password Request Unlock Window Duration","description":"This property controls the number of minutes a user must wait to start a reset request after the last successful unlock account. If \"password_reset.request.unlock_window\" is not set to the recommended value of \"1440\" or more, it increases the opportunity for a malicious actor from brute forcing the user's password using automated tools.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99b4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Maximize Reset Password Request Unlock Window Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"password_reset.request.unlock_window\" is set to a value of \"1440\" or greater.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid-reset-pw-request-unlock-window","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.request.unlock_window';\n    var expectedValue = 1440;\n    var defaultValue = 1440;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) < expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99b4","name":"Maximize Reset Password Request Unlock Window Duration","category":"security","sys_policy":"read"},{"short_description":"Maximize Reset Password SMS Complexity","description":"If \"password_reset.sms.default_complexity\" is not set to the recommended value of \"6\" or greater, then a weak SMS validation token is used. This increases the possibility of token guessing which could lead to account takeover.","sys_updated_on":"2023-10-06 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99b6","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Maximize Reset Password SMS Complexity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"password_reset.sms.default_complexity\" is set to \"6\" or more.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-sms-complexity","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.sms.default_complexity';\n    var expectedValue = 6;\n    var defaultValue = 4;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) < expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99b6","name":"Maximize Reset Password SMS Complexity","category":"security","sys_policy":"read"},{"short_description":"Enable Captcha for External User Registration","description":"If \"sn_ext_usr_reg.captchaEnabled\" is not set to the recommended value of \"true\", then Captcha will not be validated for external user registration and could lead to automatic account creation attacks.","sys_updated_on":"2023-12-26 17:28:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99be","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Enable Captcha for External User Registration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"sn_ext_usr_reg.captchaEnabled\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-captcha-ext-user-registration","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    if (new GlidePluginManager().isActive('com.snc.external_user_self_registration')) {\n        var targetProperty = 'sn_ext_usr_reg.captchaEnabled';\n        var expectedValue = 'true';\n        var defaultValue = 'true';\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99be","name":"Enable Captcha for External User Registration","category":"security","sys_policy":"read"},{"short_description":"Restrict Allowed Java Packages","description":"If the \"sys_whitelist_member\" and \"sys_whitelist_package\" table are not empty value, then dangerous APIs may be exposed to the scripting engine. Entries correspond to Java namespace that have not be approved by ServiceNow's security teams. These supported APIs will likely will introduce instability and insecurity within the instance.","sys_updated_on":"2023-10-06 20:09:12","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99c0","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Restrict Allowed Java Packages","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the \"sys_whitelist_member\" and \"sys_whitelist_package\" tables are empty. If the tables are not empty, activate the Packages Call removal tool plugin (com.glide.script.packages_call_removal).","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:java-packages-allowlist","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetTabularQuery1 = new GlideRecord('sys_whitelist_member');\n    targetTabularQuery1.query();\n\n    var targetTabularQuery2 = new GlideRecord('sys_whitelist_package');\n    targetTabularQuery2.query();\n\n    if (targetTabularQuery1.hasNext() && targetTabularQuery2.hasNext()) {\n\t\tif (targetTabularQuery1.hasNext()){\n\t\t\tfinding.setCurrentSource(targetTabularQuery1);\n\t\t}\n\t\tif (targetTabularQuery2.hasNext()){\n\t\t\tfinding.setCurrentSource(targetTabularQuery2);\n\t\t}\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99c0","name":"Restrict Allowed Java Packages","category":"security","sys_policy":"read"},{"short_description":"Enable Antivirus Scan","description":"If \"com.glide.snap.enable_scan\" is not set to the recommended value of \"true\", then antivirus scanning is disabled and users may download malicious files leading to desktop and session compromise.","sys_updated_on":"2023-10-06 17:28:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c1d05f3d773011108bd73a91fa5a99c2","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Enable Antivirus Scan","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"com.glide.snap.enable_scan\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-antivirus-scan","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.snap.enable_scan';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c1d05f3d773011108bd73a91fa5a99c2","name":"Enable Antivirus Scan","category":"security","sys_policy":"read"},{"short_description":"Enforce ACL on HR Lifecycle Events Data","description":"This property limits the ACLs of several HR tables to only consider the \"sn_hr_le\" scope. If \"glide.enforce_security_scope.sn_hr_le\" is not set to the recommended value of \"true\", then \"Human Resources: Lifecycle Events\" scoped application data will be exposed to ACLs from all other scopes.  For example, this could lead to IT Administrator gaining access to HR data.","sys_updated_on":"2024-08-01 23:23:25","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c666514143bb0210a0d25dc36ab8f240","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-08-01 23:23:25","sys_name":"Enforce ACL on HR Lifecycle Events Data","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.enforce_security_scope.sn_hr_le\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-acl-on-hr-lifecycle-events-data","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    var enabledPlugin = pluginManager.isActive('com.sn_hr_lifecycle_events');\n\n    var targetProperty = 'glide.enforce_security_scope.sn_hr_le';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n\t  if (enabledPlugin) {\n      if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n          finding.setCurrentSource(gr);\n        }\n        finding.increment();\n      }\n\t  }\n    })(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c666514143bb0210a0d25dc36ab8f240","name":"Enforce ACL on HR Lifecycle Events Data","category":"security","sys_policy":"read"},{"short_description":"Restrict Access to Background Script","description":"This property holds the required role to access Script Background module. If \"glide.script_processor.admin\" is not set to the recommended and default value of \"admin\", then users having a lower privileged role will be able to run background scripts on the instance. This will lead to a complete bypass of the ACL system allowing full access to tables.","sys_updated_on":"2023-10-06 17:28:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99d7","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Restrict Access to Background Script","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.script_processor.admin\" is set to the \"admin\". This is the default value on instances.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-access-background-script","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.script_processor.admin';\n    var expectedValue1 = 'admin';\n    var expectedValue2 = 'security_admin';\n    var expectedValue3 = 'maint';\n    var defaultValue = 'admin';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue1.toLowerCase()) {\n        if (propertyValue.toLowerCase() != expectedValue2.toLowerCase()) {\n            if (propertyValue.toLowerCase() != expectedValue3.toLowerCase()) {\n\t\t\t\tvar gr = new GlideRecord('sys_properties');\n\t\t\t\tgr.get('name', targetProperty);\n\t\t\t\tfinding.setCurrentSource(gr);\n                finding.increment();\n            }\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99d7","name":"Restrict Access to Background Script","category":"security","sys_policy":"read"},{"short_description":"Set Guest User for SOAP Requests","description":"The glide property \"com.glide.soap.guest_user\" controls the level of access of unauthenticated SOAP requests. If \"com.glide.soap.guest_user\" is not set to the recommended value of \"soap.guest\" or is set to a user with limited privileges, then SOAP requests will execute on behalf of this user. If the property is blank, it allows unauthenticated access to administrator or maint level operations; thereby negating all security controls within the instance.","sys_updated_on":"2023-10-06 17:28:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99d8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Set Guest User for SOAP Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"com.glide.soap.guest_user\" is set to \"soap.guest\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:guest-user-soap-requests","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function (finding) {\n  var targetProperty = 'com.glide.soap.guest_user';\n  var expectedValue = 'soap.guest'; \n  var defaultValue = 'soap.guest';\n\n  var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    \n  if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n\tvar gr = new GlideRecord('sys_properties');\n    gr.get('name', targetProperty);\n    finding.setCurrentSource(gr); \n    finding.increment();\n  } \n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99d8","name":"Set Guest User for SOAP Requests","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for XML Output Requests","description":"If \"glide.basicauth.required.xmloutputprocessor\" is not set to the recommended value of \"true\", then basic authorization is not required for all inbound XMLOutputProcessor requests. This could lead to unauthenticated information disclosure from the instance.","sys_updated_on":"2023-10-06 17:28:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99d9","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Require Authorization for XML Output Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.xmloutputprocessor\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:xml-output-authorization","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.xmloutputprocessor';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99d9","name":"Require Authorization for XML Output Requests","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for Data Broker Rest API","description":"If \"glide.basicauth.required.databrokerrestapiprocessor\" is not set to the recommended value of \"true\", then basic authorization is not required for all inbound Data Broker Rest API requests. This could lead to unauthenticated information disclosure from the instance.","sys_updated_on":"2023-10-06 20:11:01","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99da","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Require Authorization for Data Broker Rest API","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('u')","resolution_details":"Ensure the property \"glide.basicauth.required.databrokerrestapiprocessor\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:data-broker-restapi-auth","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n\n    var targetProperty = 'glide.basicauth.required.databrokerrestapiprocessor';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        if (gr.hasNext()) {\n            finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99da","name":"Require Authorization for Data Broker Rest API","category":"security","sys_policy":"read"},{"short_description":"Require Obfuscation of Mobile App UI","description":"If \"glide.sg.blur_ui_when_backgrounded\" is not set to the recommended value of \"true\", then the mobile app's UI is visible when viewed from the app switcher once the app has been backgrounded. Setting \"glide.sg.blur_ui_when_backgrounded\" to \"true\" provides a higher level of confidentiality and privacy on the local device by blurring this view when backgrounded.","sys_updated_on":"2023-10-06 17:28:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99db","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Require Obfuscation of Mobile App UI","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.sg.blur_ui_when_backgrounded\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:mobile-app-ui-obfuscation","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sg.blur_ui_when_backgrounded';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99db","name":"Require Obfuscation of Mobile App UI","category":"security","sys_policy":"read"},{"short_description":"Minimize One-Time Out of Band Verifier Lifetime Duration","description":"An out of band verifier is an alternate delivery method for a one time code for situations such as a need to reset an multifactor token. If this method is enabled by administrators in the Service Now Multifactor plugin, this allows a one-time code to be delivered via email.  If used, one-time out of band verifiers should expire after 10 minutes to limit the validty window. A larger time window allows more time for the code to be compromised such as through phishing, social engineering or shoulder surfing attacks which could lead to bypass of multi factor authentication and unauthorized access to the account.","sys_updated_on":"2023-10-06 17:28:02","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99dd","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Minimize One-Time Out of Band Verifier Lifetime Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Set the property value to \"10\" or a shorter validity time.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:short-ot-oob-verifier-lifetime","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.multifactor.onetime.code.validity';\n    var expectedValue = 10;\n    var propertyValue = gs.getProperty(targetProperty, 10);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr)\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99dd","name":"Minimize One-Time Out of Band Verifier Lifetime Duration","category":"security","sys_policy":"read"},{"short_description":"Set OTP Lifetime for Password Reset to 12 Hours or Less","description":"This property \"glide.pwd_reset.onetime.token.validity\" allows the link in the password reset email to expire after the number of hours specified in that \"glide.pwd_reset.onetime.token.validity\" property.  Validity time of password reset token should be keeped as short as possible in according of normal user experience. Have long validity time for password reset token can help malicious actors to perform account takeover. ","sys_updated_on":"2024-07-22 23:18:35","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99df","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Set OTP Lifetime for Password Reset to 12 Hours or Less","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Set the property value to 12 hours or a shorter validity time.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:set-otp-lifetime-pw-reset-minus12","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.pwd_reset.onetime.token.validity';\n    var expectedValue = 12;\n    var propertyValue = gs.getProperty(targetProperty, 12);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n          finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99df","name":"Set OTP Lifetime for Password Reset to 12 Hours or Less","category":"security","sys_policy":"read"},{"short_description":"Enable SMS Code Notification for Enrollment and Verification","description":"This property \"password_reset.sms.use_notify\" controls usage SMS code notification for enrollment and verification. If \"password_reset.sms.use_notify\" is set to the recommended value \"true\", then user will be notifed for password reset for SMS verification method and new device enrollment.  Using SMS code notification for enrollment and verification is more secure that default email notification.","sys_updated_on":"2023-10-06 17:28:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99e0","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enable SMS Code Notification for Enrollment and Verification","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"password_reset.sms.expiry\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:sms-code-notification-enrollment-verification","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.sms.use_notify';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99e0","name":"Enable SMS Code Notification for Enrollment and Verification","category":"security","sys_policy":"read"},{"short_description":"Minimize Reset Password Max SMS Per Day","description":"If \"password_reset.sms.max_per_day\" is not set to the recommended value of \"10\" or less, then it will be easier for attackers to brute force the sms code. This denotes the maximum number of SMS codes sent for verification per day for a user.","sys_updated_on":"2023-10-06 17:28:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99e1","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Minimize Reset Password Max SMS Per Day","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"password_reset.sms.max_per_day\" is set to \"10\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-max-sms-day","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.sms.max_per_day';\n    var expectedValue = 10;\n    var defaultValue = 10;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99e1","name":"Minimize Reset Password Max SMS Per Day","category":"security","sys_policy":"read"},{"short_description":"Minimize Reset Password SMS Expiracy Duration","description":"If \"password_reset.sms.expiry\" is not set to the recommended value of \"5\" or less, then it increases the opportunity of someone else guessing and using the SMS code in order to reset the password. This denotes the number of minutes before the SMS code expires.","sys_updated_on":"2023-10-06 17:28:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99e2","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Minimize Reset Password SMS Expiracy Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"password_reset.sms.expiry\" is set to \"5\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-sms-expiracy","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.sms.expiry';\n    var expectedValue = 5;\n    var defaultValue = 5;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99e2","name":"Minimize Reset Password SMS Expiracy Duration","category":"security","sys_policy":"read"},{"short_description":"Limit Max Comments Per User Per Day","description":"If \"sn_kb_social_qa.max_comments_per_user_daily\" is not set to the recommended value of \"500\" or less, then there will be no restriction on number of QA comments per day. This could lead to resource exhaution.","sys_updated_on":"2023-10-06 17:28:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99e4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Limit Max Comments Per User Per Day","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"sn_kb_social_qa.max_comments_per_user_daily\" is set to \"500\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-max-comments-user-day","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'sn_kb_social_qa.max_comments_per_user_daily';\n    var expectedValue = 500;\n    var defaultValue = 500;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99e4","name":"Limit Max Comments Per User Per Day","category":"security","sys_policy":"read"},{"short_description":"Validate Remote Host","description":"If \"glide.update_set.remote.check_host\" is not set to the recommended value of \"true\", then  the Team Development Remote Instance test feature will allow an internal network port scan by providing positive/negative error messages. Using this method it is possible to enumerate all open ports on a given host, and in some cases pull response data leading to information leak or unauthorized data access.","sys_updated_on":"2023-10-06 17:28:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99e5","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Validate Remote Host","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.update_set.remote.check_host\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:validate-remote-host","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.update_set.remote.check_host';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99e5","name":"Validate Remote Host","category":"security","sys_policy":"read"},{"short_description":"Disable SOAP Fault Stack Trace Display","description":"If \"glide.soapfault.display_stack_trace\" is not set to the recommended value of \"False\", then a stack trace in a SOAP fault detail element is displayed. This could lead to information leak.","sys_updated_on":"2023-10-06 17:28:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99e6","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Disable SOAP Fault Stack Trace Display","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.soapfault.display_stack_trace\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-soap-fault-stack-trace-display","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.soapfault.display_stack_trace';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99e6","name":"Disable SOAP Fault Stack Trace Display","category":"security","sys_policy":"read"},{"short_description":"Enable Updated Version of Multi SSO Plugin","description":"If the Multi SSO plugin is enabled on an instance, the v2 version should be enabled. Versions prior to MultiSSOv2, including SAML 1.1 and SAML 2.0, do not follow best practice and use opensaml library versions with known CVEs. If the known CVEs were exploitable in outdated opensaml libraries, this could allow the attacker to forge messages and bypass authentication through XML Signature Wrapping attacks, impersonate entities or allow person-in-the-middle attackers to gain unauthorized access to the platform.","sys_updated_on":"2023-10-06 17:28:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99e7","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enable Updated Version of Multi SSO Plugin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Follow the steps in the KB https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB0756504 to upgrade to the latest version, resulting in the property \"glide.authenticate.multissov2_feature.enabled\" set to \"true\". This includes checking for and migrating any customization-related changes, then upgrading the version.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:updated-version-multisso-plugin-enabled","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n\n    if (pluginManager.isActive('com.snc.integration.sso.multi.installer')) {\n        // Both properties exist in Glide Properties table if com.snc.integration.sso.multi plugin is installed, \n        // but otherwise would not be included in default OOB instance\n        var dependentProperty = 'glide.authenticate.multisso.enabled';\n        var dependentValue = 'true';\n\n        var targetProperty = 'glide.authenticate.multissov2_feature.enabled';\n        var expectedValue = 'true';\n\n        var propertyValue = gs.getProperty(targetProperty, 'false');\n        var dependentPropertyValue = gs.getProperty(dependentProperty, 'false');\n\n        // Insecure configuration if MultiSSO plugin is enabled, but MultiSSOv2 isn't being used as well\n        if (dependentPropertyValue.toLowerCase() == dependentValue.toLowerCase() && (propertyValue.toLowerCase() != expectedValue.toLowerCase())) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99e7","name":"Enable Updated Version of Multi SSO Plugin","category":"security","sys_policy":"read"},{"short_description":"Log User Impersonation","description":"If \"glide.sys.log_impersonation\" is not set to the recommended value of \"true\", then user-impersonating events will no longer be logged. This could affect ServiceNow's automated security detections and security investigation capabilities.","sys_updated_on":"2024-07-20 01:49:46","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99eb","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Log User Impersonation","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.sys.log_impersonation\" exists and is set to \"true\". If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:log-user-impersonation","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sys.log_impersonation';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99eb","name":"Log User Impersonation","category":"security","sys_policy":"read"},{"short_description":"Disallow Infected File Download","description":"When the property \"com.glide.snap.infected_download_allowed\" is set to \"true\", users can still download non-scanned attachments in the case that the antivirus service is down or unreachable. This means it is possible that a user downloads a malicious file and risks infecting the user's desktop (in the case there is no other endpoint protection on the device).","sys_updated_on":"2023-12-26 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c7aff094779821108bd73a91fa5a99ec","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Disallow Infected File Download","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"com.glide.snap.infected_download_allowed\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disallow-infected-files-download","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.snap.infected_download_allowed';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c7aff094779821108bd73a91fa5a99ec","name":"Disallow Infected File Download","category":"security","sys_policy":"read"},{"short_description":"Set Allowed MIME Child Types","description":"Defines MIME file types whose file extension may not match the data within a uploaded file. This allows such files to bypass the MIME type checking. The property takes in a comma separated list of file type pairs of the form \"application/zip=application/java-archive\".  In this example, if the property is set to such a value, files with the extension zip which are technically jars are allow to pass the MIME type checking despite the inconsistency. If set improperly, this MIME type checking bypass can lead to the remote code execution of an uploaded file. As such, it should always be set to \"\" unless a valid use case arises. ","sys_updated_on":"2024-08-30 00:36:56","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c8a5f9ca94905210f87753480ed46d60","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-30 00:36:56","sys_name":"Set Allowed MIME Child Types","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.mime.type.allowed_child_types\" is set to \"\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:set-allowed-mime-child-types","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.mime.type.allowed_child_types';\n    var expectedValue = '';\n    var defaultValue = '';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c8a5f9ca94905210f87753480ed46d60","name":"Set Allowed MIME Child Types","category":"security","sys_policy":"read"},{"short_description":"Configure Service Portal Widgets Allow List","description":"The Glide Property 'glide.service_portal.widget.allow_list' determines the list of widgets that are allowed to attempt to access any table on the instance. ACLs for those tables will still be enforced. If there are misconfigured empty ACLs on tables on the instance, widgets in this list may allow access to those tables, leading to information disclosure. This property is only enforced if the widget makes use of SNCACLWidgetUtil, and the Glide Property 'glide.service_portal.widget.enforce_public_check' is set to 'true'.","sys_updated_on":"2024-08-02 23:31:47","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"c8b3e29943334210a0d25dc36ab8f224","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-02 23:31:47","sys_name":"Configure Service Portal Widgets Allow List","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.service_portal.widget.allow_list' is empty or does not exist.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:configure-service-portal-wid-allowlist","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var enforcePublicWidgetSecurity = gs.getProperty('glide.service_portal.widget.enforce_public_check', 'true');\n\n    if (enforcePublicWidgetSecurity.toLowerCase() == 'true') {\n        var targetProperty = 'glide.service_portal.widget.allow_list';\n        var expectedValue = '';\n        var defaultValue = '';\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n          var gr = new GlideRecord('sys_properties');\n          if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n          }\n          finding.increment();\n        }\n    }\n    })(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_c8b3e29943334210a0d25dc36ab8f224","name":"Configure Service Portal Widgets Allow List","category":"security","sys_policy":"read"},{"short_description":"Limit HTTP Response Body Size","description":"The properties glide.http.response.get_body.limit.enabled and glide.http.response.get_body.limit were introduced to enable new functionality that prevents Out of memory exceptions being thrown as a result of a requests response body being too big. Out of memory exceptions can cause denial of service attacks as well as other issues that may aid attackers in compromising an instance.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cb321930774031101b803a91fa5a9943","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:15","sys_name":"Limit HTTP Response Body Size","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Ensure the property 'glide.http.response.get_body.limit.enabled' is set to true and 'glide.http.response.get_body.limit' is no more than 524288000 (500 mb)","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-http-response-body","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.http.response.get_body.limit.enabled';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var targetProperty2 = 'glide.http.response.get_body.limit';\n    var expectedValue2 = 524288000;\n    var defaultValue2 = 524288000;\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    var propertyValue2 = gs.getProperty(targetProperty2, defaultValue2);\n    var isFinding1 = propertyValue.toLowerCase() != expectedValue.toLowerCase();\n    var isFinding2 = parseInt(propertyValue2, 10) > expectedValue2;\n    if (isFinding1 || isFinding2) {\n        var gr = new GlideRecord('sys_properties');\n        if (isFinding1) {\n            gr.get('name', targetProperty);\n        } else if (isFinding2) {\n            gr.get('name', targetProperty2);\n        }\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cb321930774031101b803a91fa5a9943","name":"Limit HTTP Response Body Size","category":"security","sys_policy":"read"},{"short_description":"Enforce GroupBy ACLs","description":"If \"glide.security.groupby_acl_check\" is not set to the recommended value of \"True\", then make sure that a table has \"groupby_acl_check\" attribute set in order to honor groupby ACLs. In other case there will be no ACLs check on groupby columns of a table. This could lead to information disclosure.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cbaff094779821108bd73a91fa5a99d6","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enforce GroupBy ACLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.security.groupby_acl_check\" is set to \"True\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-groupby-acls","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.groupby_acl_check';\n    var expectedValue = 'True';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cbaff094779821108bd73a91fa5a99d6","name":"Enforce GroupBy ACLs","category":"security","sys_policy":"read"},{"short_description":"Disable AJAXEvaluate","description":"The AjaxEvaluator processor executes these scripts in sandbox however there are several additional properties which can allow the scope of activities in the sandbox to expand or be turned off entirely. In a worst case scenario a user can easily execute scripts as an admin privilege. If \"glide.script.allow.ajaxevaluate\" is not set to the recommended value of \"false\", then the system API can be vulnerable to Client script execution through AJAX calls.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cc6598c8d5001110fa9bdbc0c4c2ab70","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:37","sys_name":"Disable AJAXEvaluate","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.script.allow.ajaxevaluate\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-ajaxevaluate","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.script.allow.ajaxevaluate';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cc6598c8d5001110fa9bdbc0c4c2ab70","name":"Disable AJAXEvaluate","category":"security","sys_policy":"read"},{"short_description":"Restrict Oauth Parameters to POST Body","description":"This property controls the inbound OAuth authentication's acceptance of access tokens. Access tokens are sensitive and should only be accepted when located within a POST request body. If \"glide.oauth.allow.parameters.in.post.body.only\" is not set to the recommended value of \"true\", then access tokens could be present in the GET request parameter which could linger in client and infrastructure logs and potentially lead to account takeover if those logs are leaked.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cf321930774031101b803a91fa5a994e","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Restrict Oauth Parameters to POST Body","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.oauth.allow.parameters.in.post.body.only\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-oauth-parameters-to-post-body","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.oauth.allow.parameters.in.post.body.only';\n    var expectedValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, 'false');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cf321930774031101b803a91fa5a994e","name":"Restrict Oauth Parameters to POST Body","category":"security","sys_policy":"read"},{"short_description":"Enable Report View ACLs","description":"The following property is responsible for implementing a check of report_view ACLs for published reports. If \"glide.report.report_view.check_published\" is not set to the recommended value of \"true\", then checking of report_view ACLs for published reports is disabled. This could potentially leak sensitive data to unauthenticated users.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99d7","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enable Report View ACLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.report.report_view.check_published\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-report-view-acls","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.report.report_view.check_published';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99d7","name":"Enable Report View ACLs","category":"security","sys_policy":"read"},{"short_description":"Restrict JSONP Requests to Trusted URLs","description":"This property specifies trusted URLs for the angularJS $http service to allow/reject JSONP requests. Property is necessary because this is a potentially breaking change for customers, so they need a way to add their trusted URLs. If \"angular.jsonp.inclusion_list.enabled\" is not set to the recommended value of \"true\", then JSONP requests are allowed to any URL.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99d8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Restrict JSONP Requests to Trusted URLs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"angular.jsonp.inclusion_list.enabled\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:jsonp-request-inclusion-list","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function (finding) {\n  var targetProperty = 'angular.jsonp.inclusion_list.enabled';\n  var expectedValue = 'true';\n  var defaultValue = 'true';\n\n  var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n  if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n\tvar gr = new GlideRecord('sys_properties');\n    gr.get('name', targetProperty);\n    finding.setCurrentSource(gr);\n    finding.increment();\n  } \n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99d8","name":"Restrict JSONP Requests to Trusted URLs","category":"security","sys_policy":"read"},{"short_description":"Enforce Read ACLs on Report Views","description":"The property \"glide.report.report_view.read_acl\", when set to \"enforce\", enforces the READ ACL (table level) on reporting functions when there is no Report View ACL on the table/field. If this property is not set to \"enforce\" then ACLs could be bypassed, leading to potential sensitive information disclosure.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99d9","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enforce Read ACLs on Report Views","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.report.report_view.read_acl\" is set to \"enforce\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-read-acls-report-views","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.report.report_view.read_acl';\n    var expectedValue = 'enforce';\n    var defaultValue = 'enforce';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99d9","name":"Enforce Read ACLs on Report Views","category":"security","sys_policy":"read"},{"short_description":"Enforce Field ACLs for Inbound Query Requests","description":"If the property \"glide.export.query.enforce_field_acl\" is set to \"true\", field ACLs will be checked against the incoming query, and reject the query if the user is unauthorized. If the property is false, ACLs will NOT be checked against incoming query and will continue to execute. This can result in information disclosure to unauthorized parties.","sys_updated_on":"2023-10-06 17:28:04","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99da","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enforce Field ACLs for Inbound Query Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Set the property \"glide.export.query.enforce_field_acl\" to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-field-acls-inbound-query-requests","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.export.query.enforce_field_acl';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99da","name":"Enforce Field ACLs for Inbound Query Requests","category":"security","sys_policy":"read"},{"short_description":"Enable Email OTP for Multi-Factor Authentication","description":"The property \"glide.authenticate.multifactor.email.otp.enabled\" controls if a token for the second authentication factor can be sent via email. Email is considered a weak MFA factor which an attacker is more likely to gain access into for defeating MFA. By setting this property to \"false\", the risk of an attacker successfully bypassing MFA when they have the user's password is reduced.\r\n\r\nIf the property is false:\r\n1) The user will not see email OTP option on the MFA validation screen.\r\nIf the property is true:\r\n1) The email factor is shown in cases where the email factor policy is inactive and no other 2fa registered.\r\n2) The email factor is shown if the email factor policy is active and evaluated to true.\r\n3) The email factor is not shown if the email factor policy is active and evaluated to false.","sys_updated_on":"2023-10-06 17:28:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99db","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enable Email OTP for Multi-Factor Authentication","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.authenticate.multifactor.email.otp.enabled\" is set to \"false\"","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-email-otp-mfa","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.authenticate.multifactor.email.otp.enabled';\n    var expectedValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, 'true');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99db","name":"Enable Email OTP for Multi-Factor Authentication","category":"security","sys_policy":"read"},{"short_description":"Maximize Reset Password SMS Pause Window Duration","description":"If \"password_reset.sms.pause_window\" is not set to the recommended value of \"2\" minutes or greater, then a malicious user could initiate many password reset SMS codes in a brief window of time.  This increases the attacker's likelihood of predicting the SMS reset code.","sys_updated_on":"2023-10-06 17:28:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99dc","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Maximize Reset Password SMS Pause Window Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"password_reset.sms.pause_window\" is set to \"2\" or greater.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-sms-pause-window","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function (finding) {\n  var targetProperty = 'password_reset.sms.pause_window';\n  var expectedValue = 2;\n  var defaultValue = 1;\n  var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n  if (isNaN(propertyValue) || parseInt(propertyValue, 10) < expectedValue) {\n\tvar gr = new GlideRecord('sys_properties');\n\tgr.get('name', targetProperty);\n\tfinding.setCurrentSource(gr);\n    finding.increment();\n  } \n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99dc","name":"Maximize Reset Password SMS Pause Window Duration","category":"security","sys_policy":"read"},{"short_description":"Minimize SAML \"notBefore\" or \"notOnOrAfter\" Constraint Duration","description":"Enter the number of seconds to add to the NotBefore and NotOnOrAfter constraints to account for time differences between the Identity Provider (IdP) clock and Service Provider (SP) clock. These constraints prevent against replay attacks by denying requests that are not made within the specified time frame. If the IdP clock and SP clock are significantly different, network latency may result in the SAML request being unauthorized. This property adds a grace period during which SAML requests and responses are still considered valid.","sys_updated_on":"2023-10-06 17:28:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99dd","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Minimize SAML \"notBefore\" or \"notOnOrAfter\" Constraint Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure that the number of seconds in the \"notBefore\" constraint or  \"notOnOrAfter\" constraint is below 60.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:saml-notbefore-onorafter-constraint","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    if (pluginManager.isActive('com.snc.integration.sso.multi.installer')) {\n        var targetProperty = 'glide.authenticate.sso.saml2.clockskew';\n        var expectedValue = 60;\n        var propertyValue = gs.getProperty(targetProperty, 180);\n\n        if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99dd","name":"Minimize SAML \"notBefore\" or \"notOnOrAfter\" Constraint Duration","category":"security","sys_policy":"read"},{"short_description":"Enable Denylisted Passwords Validation Check","description":"When the property is set to \"True\", the user's password is checked against a specific list of denylisted passwords. This prevents the user from using a password from a set of breached passwords. The administrator can maintain the list by inserting passwords into the Excluded Password table.","sys_updated_on":"2023-10-06 17:28:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99de","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enable Denylisted Passwords Validation Check","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.enable.blacklist_password\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-exclusion-list-pw-validation-check","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.enable.blacklist_password';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99de","name":"Enable Denylisted Passwords Validation Check","category":"security","sys_policy":"read"},{"short_description":"Minimize External User Registration Link Expiration Duration","description":"If \"sn_ext_usr_reg.Reg_link_expiration_days\" is not set to the recommended value of \"3\", then a registration link could be used by someone other than the intended user if the link is discovered later in time.","sys_updated_on":"2023-12-26 17:28:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99df","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Minimize External User Registration Link Expiration Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"sn_ext_usr_reg.Reg_link_expiration_days\" is set to \"3\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:ext-user-registration-link-expiration","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    if (new GlidePluginManager().isActive('com.snc.external_user_self_registration')) {\n        var targetProperty = 'sn_ext_usr_reg.Reg_link_expiration_days';\n        var expectedValue = 3;\n        var defaultValue = 3;\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99df","name":"Minimize External User Registration Link Expiration Duration","category":"security","sys_policy":"read"},{"short_description":"Enable SSL in LDAP Authentication","description":"This property controls the enablement of TLS encryption for LDAP authentication requests sent over the network. If \"glide.ldap.use.ssl\" is not set to the recommended value of \"true\", then LDAP authentication is susceptible to Person-in-the-Middle attacks.","sys_updated_on":"2024-07-22 22:06:37","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e0","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Enable SSL in LDAP Authentication","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.ldap.use.ssl\" is set to \"true\".","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-ssl-ldap-auth","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ldap.use.ssl';\n    var defaultValue = 'true';\n    var expectedValue = 'true';\n\t\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n          finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e0","name":"Enable SSL in LDAP Authentication","category":"security","sys_policy":"read"},{"short_description":"Maximize Reset Password Verification Delay Duration","description":"If \"password_reset.verification.delay\" is not set to the recommended value of \"1000\" or more, then it will lead the login more susceptable to brute force attacks. This number of milliseconds delay limits the ability of a malicious actor to attempt to guess users identification or verification details, by using automation tools (\"bots\").","sys_updated_on":"2023-10-06 17:28:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e3","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Maximize Reset Password Verification Delay Duration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"password_reset.verification.delay\" is set to \"1000\" or more.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:reset-pw-verification-delay","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'password_reset.verification.delay';\n    var expectedValue = 1000;\n    var defaultValue = 1000;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) < expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e3","name":"Maximize Reset Password Verification Delay Duration","category":"security","sys_policy":"read"},{"short_description":"Limit Max Subscriptions Per User Per Day","description":"If \"sn_kb_social_qa.max_subscriptions_per_user_daily\" is not set to the recommended value of \"500\" or less, then there will be no restriction on the maximum number of Social Q&A questions to which a user can subscribe to in a day. This could lead to resource exhaution.","sys_updated_on":"2023-10-06 17:28:05","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Limit Max Subscriptions Per User Per Day","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"sn_kb_social_qa.max_subscriptions_per_user_daily\" is set to \"500\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-max-subscriptions-user-day","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'sn_kb_social_qa.max_subscriptions_per_user_daily';\n    var expectedValue = 500;\n    var defaultValue = 500;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e4","name":"Limit Max Subscriptions Per User Per Day","category":"security","sys_policy":"read"},{"short_description":"Do Not Use Demo Certificates for Active SAML Configurations","description":"The demo certificates provided by ServiceNow should not be used in production SAML configurations. The certificates are common among all instances with known passphrase. If one of the SAML properties utilizing a certificate keystore is active ( require_signed_authnrequest, require_signed_logoutrequest or encrypt_assertion ) then the demo data must not be used. Since demo data is shared among all instance, there is no integrity garuntee of requests signed with shared certifcates. Any message encrypted by the IDP could be decrypted by any actor, if intercepted.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e5","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Do Not Use Demo Certificates for Active SAML Configurations","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Set up a custom keystore, following the documentation. The value of glide.authenticate.sso.saml2.keystore should be set to the sys id of a custom, active keystore.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:no-use-demo-certs-active-saml-configs","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n\n    var pluginManager = new GlidePluginManager();\n\n    if (pluginManager.isActive('com.snc.integration.sso.multi.installer')) {\n        // If Glide property is not found in table, fall back to default which is an empty string\n        var keystore_id = gs.getProperty('glide.authenticate.sso.saml2.keystore', '');\n\n        var gr_prop = new GlideRecord('sys_properties');\n        gr_prop.get('config_name', 'glide.authenticate.sso.saml2.keystore');\n\n        var flagged_values = ['require_signed_authnrequest', 'require_signed_logoutrequest', 'encrypt_assertion'];\n\n\n        if (gs.tableExists('saml2_update1_properties')) {\n            var saml_props = new GlideRecord('saml2_update1_properties');\n            saml_props.addQuery('active=true');\n            saml_props.query();\n\n            // Only process records where SAML IDP is active\n            while (saml_props.next()) {\n\n                // Only check if one of flagged values is true\n                flagged_value_true = 'false';\n                for (i in flagged_values) {\n                    if (saml_props[flagged_values[i]].toLowerCase() == 'true') {\n                        flagged_value_true = 'true';\n                    }\n                }\n\n                if (flagged_value_true.toLowerCase() == 'true') {\n\n                    // Only check if the sys_id is one of two demo data X.509 Certificates\n                    if (keystore_id == 'c60ad24b732220103a5b0dd43cf6a7db' || keystore_id == '3685fc22930212003c5537ae867ffb91') {\n                        var attachment = new GlideSysAttachment();\n                        cert_meta = attachment.getAttachments('sys_certificate', keystore_id);\n\n                        if (cert_meta.next()) {\n                            file_name = cert_meta['file_name'];\n                            file_hash = cert_meta['hash'];\n                            file_sys_id = cert_meta['sys_id'];\n                            file_size = cert_meta['size_bytes'];\n\n                            // Check for Demo value 1 with hash\n                            if (keystore_id == 'c60ad24b732220103a5b0dd43cf6a7db' && file_hash == 'b2a36b7b894e51c5293461b4cda0eaa7c6cd90b4f4ddfb9520e0339a119a92e9') {\n                                finding.setCurrentSource(gr_prop);\n                                finding.increment();\n                            }\n\n                            // Check for Demo value 2 with name, size, sys id (no hash)\n                            if (keystore_id == '3685fc22930212003c5537ae867ffb91' && file_name == 'saml2sp_key2048withsha256.jks' && file_sys_id == 'cfe67062930212003c5537ae867ffb66' && file_size == 2286) {\n                                finding.setCurrentSource(gr_prop);\n                                finding.increment();\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e5","name":"Do Not Use Demo Certificates for Active SAML Configurations","category":"security","sys_policy":"read"},{"short_description":"Disable Chat Server Debugging","description":"If \"glide.cs.debug\" is not set to the recommended value of \"false\", then chat server messages logging is enabled. This could lead to unintended sensitive information leak through system logs.\nSetting the property value to true enables logging chat server messages on system logs. As a lot of log messages are generated, it is advised to enable it only when troubleshooting chat server. After troubleshooting, the property should be disabled to avoid clogging system logs. \nSetting the property to false, which is also the default value does not log chat server messages on system logs.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e6","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Disable Chat Server Debugging","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.cs.debug\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-chat-server-debug","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.cs.debug';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e6","name":"Disable Chat Server Debugging","category":"security","sys_policy":"read"},{"short_description":"Set Xframe Options to Prevent Embedding Third-Party Websites","description":"If \"com.glide.cs.embed.xframe_options\" is not set to the recommended value of \"DENY\" or \"SAMEORIGIN\", then content of the web application could be embedded in a third-party site using an ALLOW-FROM uri. Allowing untrusted third-party sites could enable attacks such as clickjacking.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e7","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Set Xframe Options to Prevent Embedding Third-Party Websites","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"com.glide.cs.embed.xframe_options\" is set to \"DENY\" or \"SAMEORIGIN\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:xframe-options","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.cs.embed.xframe_options';\n    var expectedValue1 = 'DENY';\n    var expectedValue2 = 'SAMEORIGIN';\n    var defaultValue = '';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if ((propertyValue.toLowerCase() != expectedValue1.toLowerCase()) && (propertyValue.toLowerCase() != expectedValue2.toLowerCase())) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e7","name":"Set Xframe Options to Prevent Embedding Third-Party Websites","category":"security","sys_policy":"read"},{"short_description":"Turn Off Verbose SQL Error Messages for Import Processor","description":"If this property is false a verbose SQL error message is returned, potentially causing sensitive information disclosure.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Turn Off Verbose SQL Error Messages for Import Processor","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Set glide.import.error_message.generic to true to display a generic error message.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:turnoff-verbose-sql-error-messages-import-processor","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.import.error_message.generic';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e8","name":"Turn Off Verbose SQL Error Messages for Import Processor","category":"security","sys_policy":"read"},{"short_description":"Disable Logger for Low Privilege Users in Script Sandbox","description":"If \"glide.security.sandbox_no_logging\" is set to \"false\", then logging will be available for low priviliged users using sandboxed scripts. With this ability, a low privileged user can inject logs allowing the malicious user to potentially obfuscate an attack. This property controls Glide System's ability to log scripts being executed in the sandbox environment.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99e9","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Disable Logger for Low Privilege Users in Script Sandbox","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure \"glide.security.sandbox_no_logging\" is set to \"true\" in order to prevent low privileged users using a sandboxed script to have logging functionality.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:no-glide-sec-logger-sandbox","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.sandbox_no_logging';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99e9","name":"Disable Logger for Low Privilege Users in Script Sandbox","category":"security","sys_policy":"read"},{"short_description":"Disable Secure Cookie Debugging","description":"If \"glide.secure_cookie.debug\" is not set to the default value of \"false\", then debug messages in the SecureUserCookie and Cookie class are logged in localhost  log. this could lead to sensitive information disclosure.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99ea","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Disable Secure Cookie Debugging","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.secure_cookie.debug\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-secure-cookie-debug","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.secure_cookie.debug';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99ea","name":"Disable Secure Cookie Debugging","category":"security","sys_policy":"read"},{"short_description":"Limit Maximum Number of Attachments in Email","description":"This property \"glide.email.inbound.max_attachment_count\" controls the maximum number of email attachments. If \"glide.email.inbound.max_attachment_count\" is not set to the recommended value of 30 or less, then inbound emails can cause instance performance degradation.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99eb","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Limit Maximum Number of Attachments in Email","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"glide.email.inbound.max_attachment_count\" is set to \"30\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:limit-max-no-attachments-email","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.email.inbound.max_attachment_count';\n    var expectedValue = 30;\n    var defaultValue = 30;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    // Need to validate if property value is a integer in the chance that\n    // for some reason the value was improperly set by a user to a string value.\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99eb","name":"Limit Maximum Number of Attachments in Email","category":"security","sys_policy":"read"},{"short_description":"Minimize Allowed Attachment Size","description":"This property \"com.glide.attachment.max_size\" controls the maximum size of uploaded attachment. If \"com.glide.attachment.max_size\" is not set to the recommended value of 1024 or less, then the platform can accept large files that could fill up storage or cause a denial of service.\n\nNote: a real attachment size is calculated through multiplication 1024*1024*value of property \"com.glide.attachment.max_size\". \nIf the value of property \"com.glide.attachment.max_size\" is 1024 then the max allowed attachment size is 1Gb.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"cfaff094779821108bd73a91fa5a99ec","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-01-05 21:37:44","sys_name":"Minimize Allowed Attachment Size","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the property \"com.glide.attachment.max_size\" is set to \"1024\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:max-allowed-attachment-size","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.attachment.max_size';\n    var expectedValue = 1024;\n    var defaultValue = 1024;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    // Need to validate if property value is a integer in the chance that\n    // for some reason the value was improperly set by a user to a string value.\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_cfaff094779821108bd73a91fa5a99ec","name":"Minimize Allowed Attachment Size","category":"security","sys_policy":"read"},{"short_description":"Define Allowed ServiceNow Internal IP Addresses","description":"If \"glide.ip.authenticate.strict\" is set to \"true\", then internal ServiceNow personelle and systems can only make inbound connections to the instance from essential IP ranges. This limit's ServiceNow's visibility into the instance to essential internal infrastructure, and prevents access by broader ServiceNow personelle such as support and sales staff via corporate networks.\r\n\r\nWhen set to \"true\", the \"glide.ip.authenticate.allow\" property is used to grant internal ServiceNow inbound connections. If not set to \"true\", then a broader ServiceNow internal IP range as defined in \"glide.ip.authenticate.allow\" is used to grant internal ServiceNow inbound connections.","sys_updated_on":"2023-12-26 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99d0","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Define Allowed ServiceNow Internal IP Addresses","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ip.authenticate.allow.secured\" contains only trusted values and that the property \"glide.ip.authenticate.strict\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:strict-ip-restriction","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    //Check glide.ip.authenticate.strict value\n    var targetProperty = 'glide.ip.authenticate.strict';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n\t\tvar gr = new GlideRecord('sys_properties');\n\t\tgr.get('name', targetProperty);\n\t\tfinding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99d0","name":"Define Allowed ServiceNow Internal IP Addresses","category":"security","sys_policy":"read"},{"short_description":"Restrict Performance Monitoring Access","description":"If \"glide.security.diag_txns_acl\" is not set to the recommended value of \"true\", then All users (authenticated or not) have access to diagnostic pages such as stats.do, xmlstats.do, threads.do and replication.do pages. These endpoints are intended to be used for monitoring instance health. Information exposed by these endpoints may be useful to potential attackers.","sys_updated_on":"2023-10-06 17:28:06","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99d2","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Restrict Performance Monitoring Access","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.diag_txns_acl\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:performance-monitoring-acl","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.diag_txns_acl';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99d2","name":"Restrict Performance Monitoring Access","category":"security","sys_policy":"read"},{"short_description":"Disable Unauthenticated Published Reports","description":"If \"glide.report.published_reports.enabled\" is not set to the recommended value of \"false\", then reports stored on the instance can be made visible without authentication. Allowing unauthenticated access to sensitive data can cause inadvertent information disclosure to a malicious actor.","sys_updated_on":"2024-07-20 01:37:52","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99d4","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Disable Unauthenticated Published Reports","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.report.published_reports.enabled' exists and is set to the value 'false'. If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-security-reports","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.report.published_reports.enabled';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99d4","name":"Disable Unauthenticated Published Reports","category":"security","sys_policy":"read"},{"short_description":"Enforce HTML Sanitization","description":"This property enforces sanitization behavior of translated_html fields on a global level for field assignments. If \"com.glide.security.check_unsanitized_html\" is not set to the recommended value of \"enforce\", then an attacker could be able to execute arbitrary javascript in the victim's browser (XSS attacks).","sys_updated_on":"2023-10-06 17:28:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99d8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:04","sys_name":"Enforce HTML Sanitization","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"com.glide.security.check_unsanitized_html\" is set to \"enforce\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:check-unsanitized-html","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.security.check_unsanitized_html';\n    var expectedValue = 'enforce';\n    var defaultValue = 'log_only';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99d8","name":"Enforce HTML Sanitization","category":"security","sys_policy":"read"},{"short_description":"Restrict Unauthenticated Access to Attachments","description":"If \"glide.image_provider.security_enabled\" is not set to the recommended value of \"True\", then all images are accessible via urls that end in \".iix\". This would allow unauthenticated access to images leading to sensitive information leak.","sys_updated_on":"2023-10-06 17:28:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99de","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Restrict Unauthenticated Access to Attachments","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.image_provider.security_enabled\" is set to \"True\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-unauthenticated-access-to-attachments","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.image_provider.security_enabled';\n    var expectedValue = 'True';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99de","name":"Restrict Unauthenticated Access to Attachments","category":"security","sys_policy":"read"},{"short_description":"Apply Domain Separation on Dot Walked Fields","description":"This property controls whether join queries are given domain separated conditions or not, in order to ensure they apply domain separation functionality for dot walked fields. If \"glide.sys.domain.include_domain_condition_on_join\"  is not set to the recommended value of \"true\" on an instance using domain separation, then sensitive information could be disclosed that is not to be shared with a specific domain. There may be moderate functional impact to the instance if components are reliant on the unsafe cross domain queries. Instances should be tested in subproduction environments before enabling.","sys_updated_on":"2023-10-06 20:11:38","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99e0","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Apply Domain Separation on Dot Walked Fields","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.sys.domain.include_domain_condition_on_join\" is set to \"true\" when the Domain Separation plugin is active. ","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:apply-domain-separation","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n\n    if (pluginManager.isActive('com.glide.domain.msp_extensions.installer')) {\n        var targetProperty = 'glide.sys.domain.include_domain_condition_on_join';\n        var expectedValue = 'true';\n        var defaultValue = 'false';\n\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99e0","name":"Apply Domain Separation on Dot Walked Fields","category":"security","sys_policy":"read"},{"short_description":"Restrict Permissions for CMDB Model","description":"This property is an additional access control to the CMDB model. If \"csm_cmdb_model.customer_visible_flag\" is not set to the recommended value of \"true\", then any user with the sn_esm_user role and out of the box ACLs will have permissions to the CMDB model.  Note that this role tends to be granted to external users. External users could unwillingly be given permissions to the CMDB model.","sys_updated_on":"2023-12-26 17:28:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99e4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Restrict Permissions for CMDB Model","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"GlidePluginManager.isActive('com.sn_customerservice')","resolution_details":"Ensure the property \"csm_cmdb_model.customer_visible_flag\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-access-to-emails-with-empty-target","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'csm_cmdb_model.customer_visible_flag';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var pluginManager = new GlidePluginManager();\n    var enabledPlugin = pluginManager.isActive('com.sn_customerservice');\n    if(enabledPlugin) {\n      var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n      if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n          var gr = new GlideRecord('sys_properties');\n          gr.get('name', targetProperty);\n          finding.setCurrentSource(gr);\n          finding.increment();\n      }\n\n    }\n\n    \n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99e4","name":"Restrict Permissions for CMDB Model","category":"security","sys_policy":"read"},{"short_description":"Require Obfuscation of Classic Mobile App UI","description":"If \"glide.ui.m.blur_ui_when_backgrounded\" is not set to the recommended value of \"true\", then \"Classic\" mobile app's UI is visible when viewed from the app switcher once the app has been backgrounded. Setting \"glide.ui.m.blur_ui_when_backgrounded\" to \"true\" ensures additional level of confidentiality and privacy on local device.","sys_updated_on":"2023-10-06 17:28:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99e6","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Require Obfuscation of Classic Mobile App UI","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.m.blur_ui_when_backgrounded\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:mobile-ui-obfuscation","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.m.blur_ui_when_backgrounded';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99e6","name":"Require Obfuscation of Classic Mobile App UI","category":"security","sys_policy":"read"},{"short_description":"Disable Inbound Emails for Locked Out Users","description":"This property controls inbound email actions for locked out users. If \"glide.pop3.process_locked_out\" is set to \"True\",  there may be an information disclosure as inbound emails would be received by users with locked accounts.","sys_updated_on":"2023-10-06 17:28:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99e8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Disable Inbound Emails for Locked Out Users","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.pop3.process_locked_out\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-inbound-emails-lockedout-users","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.pop3.process_locked_out';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99e8","name":"Disable Inbound Emails for Locked Out Users","category":"security","sys_policy":"read"},{"short_description":"Minimize SMTP Recipient Quantity","description":"This property specifies the maximum number of recipients the instance can list in the To: line for a single email notification. Notifications that would exceed this limit instead create duplicate email notifications addressed to a subset of the recipient list. Each email notification has the same maximum number of recipients. If this property is set to an insecure value above the default value of 100, then its possible a denial of service could happen on the instance.","sys_updated_on":"2023-10-06 17:28:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99ea","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Minimize SMTP Recipient Quantity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.email.smtp.max_recipients\" is set to \"100\" or less.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:max-smtp-recipients","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.email.smtp.max_recipients';\n    var expectedValue = 100;\n    var defaultValue = 100;\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (isNaN(propertyValue) || parseInt(propertyValue, 10) > expectedValue) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99ea","name":"Minimize SMTP Recipient Quantity","category":"security","sys_policy":"read"},{"short_description":"Remove Credentials From Welcome Page","description":"Demo data is provided for the CMS plugin which includes two default passwords included on the welcome page. If this is not fixed, an unauthorized attacker could gain access to the instance.","sys_updated_on":"2023-10-06 17:28:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99ec","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Remove Credentials From Welcome Page","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Modify the default content on the Welcome page to remove the default credentials. Content can be found by Navigating to System UI > Welcome Page Content. Then find the two records with a short description of the \"How To login\".  Change the Active state of each from true to false.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:remove-credentials-from-welcome-page","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetTabularQuery = new GlideRecord('sys_home');\n    var queryString = 'short_description=How To Login^active=true^textLIKEThe System Administrator^textLIKEPassword';\n    targetTabularQuery.addEncodedQuery(queryString);\n    targetTabularQuery.query();\n\n    if (targetTabularQuery.hasNext()) {\n        finding.setCurrentSource(targetTabularQuery);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99ec","name":"Remove Credentials From Welcome Page","category":"security","sys_policy":"read"},{"short_description":"Disable Embedded HTML Code","description":"Disables support for embedding HTML code created using the [code] tag. If \"glide.ui.security.allow_codetag\" is not set to the value of \"false\", then rendered HTML in journal fields and forms will not be displayed. Setting \"glide.ui.security.allow_codetag\" to \"true\" with display embedded HTML code with may lead to cross-site scripting (XSS) attacks.","sys_updated_on":"2023-10-06 17:28:08","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99ee","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Disable Embedded HTML Code","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.security.allow_codetag\" is set to \"false\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:allow-embedded-html-code","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.security.allow_codetag';\n    var expectedValue = 'false';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99ee","name":"Disable Embedded HTML Code","category":"security","sys_policy":"read"},{"short_description":"Enable High Security Plugin","description":"The High Security plugin, activated by default, creates more than 900 different configurations to control the level of security on your instance. These configurations mitigate many of the top OWASP attacks by enabling strict access control, input validation, and output encoding.","sys_updated_on":"2023-10-06 17:28:08","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99f0","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable High Security Plugin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the plugin \"com.glide.high_security\" is activated.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:high-security-plugin","finding_type":"scan_finding","priority":"1","sys_tags":"","script":"(function(finding) {\n    var pluginId = 'com.glide.high_security';\n    if (!GlidePluginManager.isActive(pluginId)) {\n        var gr = new GlideRecord('v_plugin');\n        gr.get('id', pluginId);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99f0","name":"Enable High Security Plugin","category":"security","sys_policy":"read"},{"short_description":"Enable Password Reset Policy Checks","description":"Use the glide.enable.password_policy property to customize password strength validation rules for the Change Password form. Customize the length and complexity values to match your organization's security policy. If \"glide.enable.password_policy\" is not set to the recommended value of \"true\", then password standards will not be enforced.","sys_updated_on":"2024-07-20 01:38:25","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99f2","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable Password Reset Policy Checks","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.enable.password_policy' exists and is set to the value 'true'. If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-strong-passwords","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.enable.password_policy';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99f2","name":"Enable Password Reset Policy Checks","category":"security","sys_policy":"read"},{"short_description":"Enable Email Spam Scoring and Filtering","description":"The Email Filter (com.glide.email_filter) plugin installs email filtering within the instance. This filtering identifies existing headers, which enables the administrator to decide what to do with the email based on the associated header. This plugin adds a header to each message. The header can be used for filtering within the instance. This feature is very helpful for filtering out spam. Note: Please make sure prerequisite properties \"glide.email.read.active\" is set to true, as this control only applies when inbound email is enabled.","sys_updated_on":"2023-10-06 17:28:09","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99f4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable Email Spam Scoring and Filtering","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the plugin \"com.glide.email_filter\" is activated when the property \"glide.email.read.active\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:email-spam-scoring-and-filtering","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var dependentProperty = 'glide.email.read.active';\n    var dependentValue = 'true';\n    var propertyValue = gs.getProperty(dependentProperty);\n\n    var targetPluginActive = GlidePluginManager.isActive('com.glide.email_filter');\n\n    if ((propertyValue.toLowerCase() == dependentValue.toLowerCase()) && !targetPluginActive) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', dependentProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99f4","name":"Enable Email Spam Scoring and Filtering","category":"security","sys_policy":"read"},{"short_description":"Enforce Strict User Image Upload","description":"If \"glide.security.strict.user_image_upload\" is not set to the recommended value of \"true\", then  ACLs are not enforced on image uploads to the Photo field. When the property is set to true, the table ACLs are enforced when uploading photos, only allowing authorized users to upload an image. This prevents an unauthorized user uploading an image to another user's profile.","sys_updated_on":"2023-10-06 17:28:09","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99f6","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enforce Strict User Image Upload","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.security.strict.user_image_upload\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-strict-user-image-upload","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.strict.user_image_upload';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99f6","name":"Enforce Strict User Image Upload","category":"security","sys_policy":"read"},{"short_description":"Escape Excel Formulas","description":"Setting the property \"glide.export.escape_formulas\" to the recommended value of \"true\" prevents potentially malicious formulas in programs such as Excel from being executed after exporting and opening the file. Cell values for CSV, Xls, and XLSX can be interpreted as formulas by spreadsheet applications unless properly escaped which can lead to malicious code execution.","sys_updated_on":"2023-10-06 17:28:09","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99f8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Escape Excel Formulas","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.export.escape_formulas\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:escape-excel-formula","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.export.escape_formulas';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99f8","name":"Escape Excel Formulas","category":"security","sys_policy":"read"},{"short_description":"Enable ACLs to Control Live Profile Details","description":"Use the glide.live_profile.details property to designate whether a user should be able to view all detail fields, such as company name and phone numbers, in a live profile under the live feed feature.\r\n\r\nIf \"glide.live_profile.details\" is set to the value of \"Hide\", then no live profile information is visible to user. If it is set to show, all information is visible. When glide.live_profile.details\" is set to the value of \"ACL\", information is visible based on the user's profile ACLs. ","sys_updated_on":"2023-10-06 17:28:09","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d1d05f3d773011108bd73a91fa5a99fd","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable ACLs to Control Live Profile Details","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.live_profile.details\" is set to \"ACL\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-acls-to-control-live-profile-details","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.live_profile.details';\n    var expectedValue = 'ACL';\n    var defaultValue = 'ACL';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    \n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n\t\tvar gr = new GlideRecord('sys_properties');\n\t\tgr.addQuery('name', 'glide.live_profile.details');\n\t\tgr.query();\n\t\tif (gr.next()){\n\t\t\tfinding.setCurrentSource(gr);\n\t\t}\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d1d05f3d773011108bd73a91fa5a99fd","name":"Enable ACLs to Control Live Profile Details","category":"security","sys_policy":"read"},{"short_description":"Configure Service Portal Widgets Table Allow List","description":"The Glide Property 'glide.service_portal.widget.table_allow_list' contains the list of tables allowed to be accessed by unauthenticated users through Service Portal widgets that make use of the additional security checks provided in the SNCACLWidgetUtil script include. This property is only enforced if the Glide Property 'glide.service_portal.widget.enforce_public_check' is 'true'. There may be unauthenticated information disclosure if uncessesary tables are listed in this property. Table ACLs will still be evaluated as previously occurred. ","sys_updated_on":"2024-08-06 00:52:31","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d20f429a433b4210a0d25dc36ab8f2b1","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2024-08-06 00:52:31","sys_name":"Configure Service Portal Widgets Table Allow List","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"admin","run_condition":"","resolution_details":"Ensure the Glide Property 'glide.service_portal.widget.table_allow_list' is empty, or the list is restricted to the smallest number of tables with use cases for unauthenticated access.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:configure-service-portal-widgets-table-allowlist","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var enforcePublicWidgetSecurity = gs.getProperty('glide.service_portal.widget.enforce_public_check', 'true');\n\n    if (enforcePublicWidgetSecurity.toLowerCase() == 'true') {\n        var targetProperty = 'glide.service_portal.widget.table_allow_list';\n        var expectedValue = '';\n        var defaultValue = '';\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            if (gr.get('name', targetProperty)) {\n              finding.setCurrentSource(gr);\n            }\n            finding.increment();\n        }\n    }\n    })(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d20f429a433b4210a0d25dc36ab8f2b1","name":"Configure Service Portal Widgets Table Allow List","category":"security","sys_policy":"read"},{"short_description":"Require Write Access to Access Service Catalog Add Item Page","description":"When the Glide Property 'glide.sc.request.add_item_write_access' is not set to 'true', any logged in user can access the Add Catalog Item UI page. This could result in unauthorized operations performed on catalog items.","sys_updated_on":"2023-10-06 17:28:09","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d3321930774031101b803a91fa5a996c","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Require Write Access to Access Service Catalog Add Item Page","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v');","resolution_details":"Set the Glide Property 'glide.sc.request.add_item_write_access' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:require-write-accessto-access-service-catalog","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sc.request.add_item_write_access';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d3321930774031101b803a91fa5a996c","name":"Require Write Access to Access Service Catalog Add Item Page","category":"security","sys_policy":"read"},{"short_description":"Enable Account Recovery","description":"This property controls the account recovery feature which binds the ability to bypass single sign-on to specifically designated administrators. If \"glide.sso.acr.enabled\" is not set to the recommended value of \"true\", then the local interactive log-ins (username or password based) will be remain enabled when single sign-on is enabled on the instance. Eliminating local interactive log-ins reduces the potential for unauthorized access to the instance.","sys_updated_on":"2023-10-06 17:28:09","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"d5d05f3d773011108bd73a91fa5a99fa","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-21 00:23:05","sys_name":"Enable Account Recovery","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.sso.acr.enabled\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:account-recovery","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    if (pluginManager.isActive('com.snc.integration.sso.multi.installer')) {\n        var targetProperty = 'glide.sso.acr.enabled';\n        var expectedValue = 'true';\n        var defaultValue = 'false';\n\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_d5d05f3d773011108bd73a91fa5a99fa","name":"Enable Account Recovery","category":"security","sys_policy":"read"},{"short_description":"Ensure Archive Table ACLs are Checked","description":"The 'glide.security.enable_archive_table_acls' controls if ACLs added to archive tables are evaluated (true) or if only the ACLs of the original table (i.e. the table the archive table was created from) are evaluated (false). There is no reason for this property to not be true since the original table ACLs will be evaluated regardless of its value and since a customer can simply avoid additional ACLs for an archive table by not adding them. However, if the property is set to false, ACLs added to archived tables will be ignored, an action which is counterintuitive and may lead to authorization bypass.","sys_updated_on":"2023-12-26 17:28:10","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"db321930774031101b803a91fa5a998a","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:16","sys_name":"Ensure Archive Table ACLs are Checked","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the value of 'glide.security.enable_archive_table_acls' is always true.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:ensure-archive-table-acls-are-checked","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.security.enable_archive_table_acls';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_db321930774031101b803a91fa5a998a","name":"Ensure Archive Table ACLs are Checked","category":"security","sys_policy":"read"},{"short_description":"Escape Jelly Script","description":"This property escapes all the JS and HTML strings included in <j:jelly> ... </j:jelly> before they are written to the output stream, preventing several XSS issues from occurring. If \"glide.ui.escape_all_script\" is not set to the recommended value of \"true\", then escaping of scripts injected into Jelly is disabled. Without this mitigation, the platform becomes widely open to a variety of script injection attacks. An attacker could execute arbitrary Rhino scripts on the instance.","sys_updated_on":"2023-10-06 17:28:10","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"dc6598c8d5001110fa9bdbc0c4c2ab7d","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:37","sys_name":"Escape Jelly Script","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.ui.escape_all_script\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:escape-jelly","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.ui.escape_all_script';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_dc6598c8d5001110fa9bdbc0c4c2ab7d","name":"Escape Jelly Script","category":"security","sys_policy":"read"},{"short_description":"Enforce OCSP Check on Network Error","description":"If \"com.glide.communications.httpclient.ocsp_allow_network_error\" is not set to the recommended value of \"false\", and the OCSP check is encountering a network error (e.g. a timeout or problem fetching the revocation information, etc.) it will bypass the OSCP security check and consider it successful. This is dangerous and risky because an attacker with a revoked certificate can simply neglect to provide an OCSP response when a browser connects to it and the browser will mistakenly accept their revoked certificate,  breaking the notion of PKI/digital certificate trust that is foundational to the web. Use of revoked certificates is often an indicator of malicious activity unless servers are out of sync.","sys_updated_on":"2024-07-20 01:14:19","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"de32d530774031101b803a91fa5a99e8","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-07-12 22:11:13","sys_name":"Enforce OCSP Check on Network Error","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"com.glide.communications.httpclient.ocsp_allow_network_error\" exists and is set to \"false\". If the property does not appear in the sys_properties table, add a new record.","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-ocsp-check","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.communications.httpclient.ocsp_allow_network_error';\n    var expectedValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, 'true');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_de32d530774031101b803a91fa5a99e8","name":"Enforce OCSP Check on Network Error","category":"security","sys_policy":"read"},{"short_description":"Restrict Flow Context Read Access","description":"When the Glide Property 'com.snc.process_flow.reporting.require_flow_access' is set to a value of true, there is an additional access check for a user trying to read a flow context. A user must have access to the parent flow to be able to read the flow context. There may be minor information disclosure if this property is not set securely. ","sys_updated_on":"2024-01-03 15:42:17","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"dee6cd095323311053a6ddeeff7b1286","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-01-03 15:42:17","sys_name":"Restrict Flow Context Read Access","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property 'com.snc.process_flow.reporting.require_flow_access' is set to a value of 'true'. ","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:restrict-flow-context-read","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.snc.process_flow.reporting.require_flow_access';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_dee6cd095323311053a6ddeeff7b1286","name":"Restrict Flow Context Read Access","category":"security","sys_policy":"read"},{"short_description":"Require Clearing Pasteboard when Backgrounding Mobile Application","description":"The \"glide.sg.clear_pasteboard_when_backgrounded\" property controls if text copied from ServiceNow mobile app is kept in the clipboard and pasteboard after the app is in background mode. If it is not set to the recommended value of \"true\", then sensitive information may be disclosed to the Android or iOS clipboard where it can be exposed to other applications on the device.","sys_updated_on":"2023-12-26 17:28:11","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"df321930774031101b803a91fa5a9995","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:17","sys_name":"Require Clearing Pasteboard when Backgrounding Mobile Application","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure that \"glide.sg.clear_pasteboard_when_backgrounded\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:require-clearing-pasteboard-when-backgrounding","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.sg.clear_pasteboard_when_backgrounded';\n    var expectedValue = 'true';\n    var propertyValue = gs.getProperty(targetProperty, 'true');\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_df321930774031101b803a91fa5a9995","name":"Require Clearing Pasteboard when Backgrounding Mobile Application","category":"security","sys_policy":"read"},{"short_description":"Use of Secure Insert Multiple Operation within Import Set API","description":"This property controls whether GlideRecordSecure or GlideRecord is used for the Insert Multiple operation within Import Set API.\n\nIf this property is set to \"false\", then GlideRecordSecure will be used to insert records and Table level ACLs will be evaluated.\nIf this property is set to \"true\", then GlideRecord will be used to insert records and Table level ACLs will not be evaluated.\n\nIf this property is not set to the recommended value of \"false\", then a low privilege user may be able to insert data into tables outside the scope of their privileged roles.","sys_updated_on":"2023-10-06 17:28:11","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"e232d530774031101b803a91fa5a99f4","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:13","sys_name":"Use of Secure Insert Multiple Operation within Import Set API","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('u')","resolution_details":"Ensure that the property \"com.glide.import_set_api.insert_multiple_optimize\" is set to \"false\".\n\nIf this property must be set to \"true\", then you must ensure that the \"Import Set API Insert Multiple\" REST Endpoint ACL (sys_id: 3101b770ff2211105cf343d0653bf182) is active and also audit user's who have the role \"import_transformer\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:use-of-secure-insert-multiple-oper","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.import_set_api.insert_multiple_optimize';\n    var expectedValue = 'false';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    if (propertyValue.toLowerCase() !== expectedValue.toLowerCase()) {\n        finding.increment();\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_e232d530774031101b803a91fa5a99f4","name":"Use of Secure Insert Multiple Operation within Import Set API","category":"security","sys_policy":"read"},{"short_description":"Required JMS Connection Factories","description":"This property controls the Java Messaging Service (JMS) connection factories that the MID Server can use. It is intended for a few select factories needed by plugins for JMS activity or action. Including additional factories could be a step in a chain of attack for vulnerabilities such as JNDI insertion that rely on capabilities an attacker can leverage in allowed factories. To prevent the possibility of any leveraged vulnerability, do not include factories beyond the necessary defaults.","sys_updated_on":"2024-07-22 23:22:03","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"e3321930774031101b803a91fa5a99a1","sys_updated_by":"admin","score_scale":"1","sys_created_on":"2023-07-12 22:11:18","sys_name":"Required JMS Connection Factories","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Review the list of names provided to the mid property \"mid.property.jms.command.allowed_factory_names\". Ensure any additional factory names beyond the default of \"connectionFactory, queueConnectionFactory, topicConnectionFactory\" are necessary. \n\nSee the following documentation for updating this and other mid server properties: https://docs.servicenow.com/csh?topicname=r_MIDServerProperties.html&version=latest","sys_mod_count":"1","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:required-jms-connection-factories","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    var enabledPlugin = pluginManager.isActive('com.snc.runbook_automation.runtime');\n\n    if (enabledPlugin) {\n        // Query for MID Server Property mid.property.jms.command.allowed_factory_names\n        var gr = new GlideRecord('ecc_agent_property');\n        var propQuery = 'name=mid.property.jms.command.allowed_factory_names';\n        var defaultValue = 'connectionFactory, queueConnectionFactory, topicConnectionFactory';\n\n        gr.addEncodedQuery(propQuery);\n        gr.query();\n\n        // If the property table does exist, check for values outside the default list\n        if (gr.next()) {\n            var propertyValue = gr.getValue('value');\n            var propertyValue2 = propertyValue.split(\",\");\n\n            for (i = 0; i < propertyValue2.length; i++) {\n\n                if (!defaultValue.includes(propertyValue2[i])) {\n                    var grSource = new GlideRecord('ecc_agent_property');\n                    grSource.addEncodedQuery(propQuery);\n                    grSource.query();\n                    if (grSource.next()) {\n                      finding.setCurrentSource(grSource);\n                    }\n                    finding.increment();\n                }\n            }\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_e3321930774031101b803a91fa5a99a1","name":"Required JMS Connection Factories","category":"security","sys_policy":"read"},{"short_description":"Invalidate Session After OAuth Token Expiration","description":"When the Glide Property `glide.authenticate.oauth.post.token.expiration.cookie_auth.disabled` is not set to a value of `true`, a user may continue to utilize a session via cookies after the OAuth token used to create that session expires. This may increase the potential that the cookies are leaked and the session hijacked by a malicious user to access unauthorized resources.","sys_updated_on":"2024-08-29 02:57:35","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"e39b41b1ddd85210f877477f3179cedc","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-29 02:57:35","sys_name":"Invalidate Session After OAuth Token Expiration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the Glide Property `glide.authenticate.oauth.post.token.expiration.cookie_auth.disabled` is set to a value of `true`. When the record does not exist in the `sys_properties` table, the default is `false`. A record is created for newly provisioned instances.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:invalidate-session-after-oauth-token-expiration","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.authenticate.oauth.post.token.expiration.cookie_auth.disabled';\n    var expectedValue = 'true';\n    var defaultValue = 'false'; \n\n    // sys_properties record `true` should exist on zbooted instance\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n        }\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_e39b41b1ddd85210f877477f3179cedc","name":"Invalidate Session After OAuth Token Expiration","category":"security","sys_policy":"read"},{"short_description":"Enable HTML Sanitizer within Virtual Agent","description":"This property controls the whether the HtmlSanitizerService is enabled. If \"com.glide.cs.html.sanitizer.enabled\" is not set to \"true\", then a Stored Cross-Site Scripting (XSS) attack is possible in the VA web client.","sys_updated_on":"2023-12-26 17:28:12","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"e46598c8d5001110fa9bdbc0c4c2abb5","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:39","sys_name":"Enable HTML Sanitizer within Virtual Agent","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"com.glide.cs.html.sanitizer.enabled\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-html-sanitizer","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.cs.html.sanitizer.enabled';\n    var expectedValue = 'true';\n    var defaultValue = 'true';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_e46598c8d5001110fa9bdbc0c4c2abb5","name":"Enable HTML Sanitizer within Virtual Agent","category":"security","sys_policy":"read"},{"short_description":"Enable Protected Tables Plugin","description":"When the Glide Property 'com.glide.security.protected_table.enabled' is set to 'true', The Protected Tables plugin will be utilized to prevent higher privilege users on an instance from tampering with log tables. The following logging tables will have special protections when this property is set to 'true':\n\nsyslog (config not modifiable)\nsyslog_transaction\nsys_outbound_http_log\nsysevent\nsys_audit\nsys_push_notification\nprotected_table_configuration (config not modifiable)\n\nThe integrity of logs is important for determining malicious activity on an instance by a customer admin.","sys_updated_on":"2023-10-06 17:28:12","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"e6321930774031101b803a91fa5a9903","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:13","sys_name":"Enable Protected Tables Plugin","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'com.glide.security.protected_table.enabled' to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enable-protected-tables","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'com.glide.security.protected_table.enabled';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_e6321930774031101b803a91fa5a9903","name":"Enable Protected Tables Plugin","category":"security","sys_policy":"read"},{"short_description":"Configure Event Management Assignment Group Admin Roles","description":"The Glide Property 'evt_mgmt.connector_assignment_group_admin_roles' contains  comma separated string signifying the role names that have admin access over the assignment group field in connector instances. Changing the default roles in this list may open up unauthorized users to altering event integrations on the instance. ","sys_updated_on":"2024-01-03 15:59:51","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"ed7a0d0d5323311053a6ddeeff7b1248","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-01-03 15:59:00","sys_name":"Configure Event Management Assignment Group Admin Roles","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Set the Glide Property 'evt_mgmt.connector_assignment_group_admin_roles' to the value 'admin,evt_mgmt_admin,sn_sow_srm.srm_admin'. \r\n\r\nReview any additional role values in this property to ensure that role warrants this access as described in the description.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:configure-event-management-assignment","finding_type":"scan_finding","priority":"4","sys_tags":"","script":"(function(finding) {\n    var enabledPlugin = new GlidePluginManager().isActive('com.sn_em_connector');\n\n    var targetProperty = 'evt_mgmt.connector_assignment_group_admin_roles';\n    var expectedValue = 'admin,evt_mgmt_admin,sn_sow_srm.srm_admin';\n    var defaultValue = 'admin,evt_mgmt_admin,sn_sow_srm.srm_admin';\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n    var expectedValueList = expectedValue.split(',');\n    var propertyValueList = propertyValue.split(',');\n\n    if (enabledPlugin) {\n        // We want to match the default list entries, more might mean an extra uncessary role has been added\n        for (i = 0; i < propertyValueList.length; i++) {\n            if (expectedValueList.indexOf(propertyValueList[i]) == -1) {\n                var gr = new GlideRecord('sys_properties');\n                gr.get('name', targetProperty);\n                finding.setCurrentSource(gr);\n                finding.increment();\n            }\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_ed7a0d0d5323311053a6ddeeff7b1248","name":"Configure Event Management Assignment Group Admin Roles","category":"security","sys_policy":"read"},{"short_description":"Disable MultiSSO Debugging","description":"This property controls debug logging for multisso. If \"glide.authenticate.multisso.debug\" is not set to the recommended value of \"False\", then MultiSSO debug is enabled which could lead to unintended sensitive information leak.","sys_updated_on":"2023-10-06 17:28:13","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"ef056e2b777411108bd73a91fa5a99c8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-07-26 07:43:08","sys_name":"Disable MultiSSO Debugging","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.authenticate.multisso.debug\" is set to \"False\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:disable-multisso-debugging","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    if (pluginManager.isActive('com.snc.integration.sso.multi.installer')) {\n        var targetProperty = 'glide.authenticate.multisso.debug';\n        var expectedValue = 'False';\n        var defaultValue = 'false';\n\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_ef056e2b777411108bd73a91fa5a99c8","name":"Disable MultiSSO Debugging","category":"security","sys_policy":"read"},{"short_description":"Enforce ACL on HR Core Data","description":"This property limits the ACLs of several HR tables to only consider the \"sn_hr_core\" scope. If \"glide.enforce_security_scope.sn_hr_core\" is not set to the recommended value of \"true\", then \"Human Resources: Core\" scoped application data will be exposed to ACLs from all other scopes.  For example, this could lead to IT Administrator gaining access to HR data.","sys_updated_on":"2024-08-05 23:17:07","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"f00df51a43f74210a0d25dc36ab8f2fa","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2024-08-05 23:17:07","sys_name":"Enforce ACL on HR Core Data","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.enforce_security_scope.sn_hr_core\" is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:enforce-acl-on-hr-core-data","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n    var pluginManager = new GlidePluginManager();\n    var enabledPlugin = pluginManager.isActive('com.sn_hr_core');\n    var targetProperty = 'glide.enforce_security_scope.sn_hr_core';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (enabledPlugin) {\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n          var gr = new GlideRecord('sys_properties');\n          if (gr.get('name', targetProperty)) {\n            finding.setCurrentSource(gr);\n          }\n          finding.increment();\n        }\n    }\n\t\n    })(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_f00df51a43f74210a0d25dc36ab8f2fa","name":"Enforce ACL on HR Core Data","category":"security","sys_policy":"read"},{"short_description":"Require Authorization for JSONv2 Requests","description":"If \"glide.basicauth.required.jsonv2\" is not set to the recommended value of \"true\", then this will disable Basic Authentication for JSONv2 format export processor. This also happens when combined with a wrong role within the guest_user related property (For example a high privileged user such as Admin). This will lead to unauthenticated access to instance data.","sys_updated_on":"2023-10-06 17:28:13","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"f06598c8d5001110fa9bdbc0c4c2abd8","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2022-06-07 17:27:40","sys_name":"Require Authorization for JSONv2 Requests","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"","resolution_details":"Ensure the property \"glide.basicauth.required.jsonv2\" exists in the sys_properties table and is set to \"true\".","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:basic-auth-jsonv2-requests","finding_type":"scan_finding","priority":"2","sys_tags":"","script":"(function(finding) {\n    var targetProperty = 'glide.basicauth.required.jsonv2';\n    var expectedValue = 'true';\n    var defaultValue = 'false';\n\n    var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n    if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n        var gr = new GlideRecord('sys_properties');\n        gr.get('name', targetProperty);\n        finding.setCurrentSource(gr);\n        finding.increment();\n    }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_f06598c8d5001110fa9bdbc0c4c2abd8","name":"Require Authorization for JSONv2 Requests","category":"security","sys_policy":"read"},{"short_description":"Log Session Audit Events","description":"When the Glide Property 'glide.authenticate.session_access.log_audit_event' is set to 'true', session audit events will be created in the sys_session_access_audit table. It is best practice to log information about who accessed a session to assist in malicious actor investigations. Information logged will include user, session ID (non-sensitive), IP address, roles, and policies.","sys_updated_on":"2023-12-26 17:28:14","sys_class_name":"scan_script_only_check","score_min":"0","sys_id":"f2321930774031101b803a91fa5a992d","sys_updated_by":"maint","score_scale":"1","sys_created_on":"2023-07-12 22:11:14","sys_name":"Log Session Audit Events","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"score_max":"100","sys_created_by":"maint","run_condition":"new sn_vsc.VSCComplianceUtil().checkIfConfigNeedValidation('v')","resolution_details":"Ensure the Glide Property 'glide.authenticate.session_access.log_audit_event' is set to 'true'.","sys_mod_count":"0","active":"true","documentation_url":"/api/now/v1/context_doc_url/sc-rid:log-session-audit","finding_type":"scan_finding","priority":"3","sys_tags":"","script":"(function(finding) {\n        var targetProperty = 'glide.authenticate.session_access.log_audit_event';\n        var expectedValue = 'true';\n        var defaultValue = 'true';\n        var propertyValue = gs.getProperty(targetProperty, defaultValue);\n\n        if (propertyValue.toLowerCase() != expectedValue.toLowerCase()) {\n            var gr = new GlideRecord('sys_properties');\n            gr.get('name', targetProperty);\n            finding.setCurrentSource(gr);\n            finding.increment();\n        }\n})(finding);","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/a51d46e3f2014110366b10017c5ba675","value":"a51d46e3f2014110366b10017c5ba675"},"sys_update_name":"scan_script_only_check_f2321930774031101b803a91fa5a992d","name":"Log Session Audit Events","category":"security","sys_policy":"read"}]}