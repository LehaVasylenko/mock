{"result":[{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Get the details of a specific Oracle listener","host_classification":"false","sys_updated_on":"2015-06-12 18:09:26","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"00555f3237130000dadacffbcfbe5d25","sys_updated_by":"josh.gerbasi","sys_created_on":"2011-06-20 18:01:34","used_by_discovery":"true","sys_name":"Oracle - Listener Details","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"ben.yukich","ecc_queue_topic":"SSHCommand","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_00555f3237130000dadacffbcfbe5d25","ecc_queue_name":"sh ${file:oracle_listener.sh} ${oracle_home} ${listener}","name":"Oracle - Listener Details","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve Solaris installed software","host_classification":"false","sys_updated_on":"2015-03-24 01:49:51","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"0e68088d0a0a0b9e000e1b6c12a2edf1","sys_updated_by":"shankar.meenkeri","sys_created_on":"2009-06-23 18:36:54","used_by_discovery":"true","sys_name":"Solaris - Installed Software","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"17","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\t/**\n     * Runs the probe instance\n     */\n\tprocess : function() {\n\t\tvar packages = [];\n\t\tvar softwareMatch = {};\n\t\tvar softwareArray = [];\n\t\tvar token;\n\t\t\n\t\tvar line = output.split('\\n');\n\t\tfor (var i = 0; i < line.length; i++) {\n\t\t\tif (line[i].indexOf(':') != -1) {\n\t\t\t\ttoken = line[i].split(':');\n\t\t\t\tfor (var k = 0; k < token.length; k++)\n\t\t\t\t\ttoken[k] = token[k].replace(/^\\s*/, \"\");\n\t\t\t\t\n\t\t\t\tsoftwareMatch[token[0]] = token[1];\n\t\t\t}\n\t\t\t\n\t\t\tif (line[i] == '' || line.length - i == 1) {\n\t\t\t\tsoftwareArray.push(softwareMatch);\n\t\t\t\tsoftwareMatch = {};\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (var j = 0; j < softwareArray.length; j++) {\n\t\t\tsoftwareMatch = softwareArray[j];\n\t\t\t\n\t\t\tvar pkg_name = softwareMatch.PKGINST;\n\t\t\tvar name     = softwareMatch.NAME;\n\t\t\tvar cat      = softwareMatch.CATEGORY;\n\t\t\tvar version  = softwareMatch.VERSION;\n\t\t\tvar vendor   = softwareMatch.VENDOR;\n\t\t\tvar desc     = softwareMatch.DESC;\n\t\t\t\n\t\t\tvar software = {};\n\t\t\tif (!name)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tsoftware.name = name;\n\t\t\tif (cat)\n\t\t\t\tsoftware.category = cat;\n\t\t\t\n\t\t\tif (version)\n\t\t\t\tsoftware.version = version;\n\t\t\t\n\t\t\tif (vendor)\n\t\t\t\tsoftware.vendor = vendor;\n\t\t\t\n\t\t\tif (desc)\n\t\t\t\tsoftware.short_description = desc + (pkg_name ? (\" ; Pkginst: \" + pkg_name + \".\") : \"\");\n\t\t\t\n\t\t\tpackages.push(software);\n\t\t}\n\t\t\n\t\trelated_data.packages= packages;\n\t\t\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_0e68088d0a0a0b9e000e1b6c12a2edf1","ecc_queue_name":"pkginfo -l | egrep  'PKGINST|NAME|CATEGORY|VERSION|VENDOR|DESC|^$'","name":"Solaris - Installed Software","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather Mongodb configuration","host_classification":"false","sys_updated_on":"2020-03-17 17:52:04","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"0e6ce562ef1221007f04b25495c0fbf3","sys_updated_by":"benjamin.phan","sys_created_on":"2014-08-05 23:46:39","used_by_discovery":"true","sys_name":"Windows - MongoDB Configuration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"jing.yang","ecc_queue_topic":"WindowsCommand","sys_mod_count":"28","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t/**\n     * Runs the probe instance\n     */\n\tprocess : function() {\t\t\n\t\tcurrent.mongodb_conf = output.trim();\n\t\t\n\t\tvar filename = g_probe.getParameter(\"powershell_param_confFilePath\") + '';\n\t\tif (filename.indexOf(\"\\\\\") > -1) {\n\t\t\tcurrent.config_file = filename;\n\t\t\tcurrent.config_directory = filename.substring(0, filename.lastIndexOf(\"\\\\\"));\n\t\t}\n\n\t\tvar param_port_set = (g_probe.getParameter(\"port_set\") == \"true\");\n\t\tif (param_port_set)\n\t\t\treturn;\n\t\tvar lines = output.split(\"\\n\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar line = lines[i];\n\t\t\t\n\t\t\tif (line == '' || line.startsWith('#'))\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tvar parts = line.indexOf(\"=\") > 0 ? line.split(\"=\") : line.split(\":\");\n\t\t\tvar name = parts[0].trim();\n\t\t\tvar value = parts[1].trim();\n\t\t\t\n\t\t\tif (name=='port') {\n\t\t\t\tcurrent.tcp_port = value;\n\t\t\t\tbreak;\t\t// no longer need to search the file\n\t\t\t}\n\t\t}\n\t\tif (!current.tcp_port)\n\t\t\tcurrent.tcp_port=\"27017\";\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_0e6ce562ef1221007f04b25495c0fbf3","ecc_queue_name":"WindowsCommand: Get MongoDB Configuration","name":"Windows - MongoDB Configuration","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information about running Weblogic servers and applications.","host_classification":"false","sys_updated_on":"2017-05-15 08:08:23","type":"Java","sys_class_name":"discovery_probes","minor_version":"3","ecc_queue_source":"","sys_id":"0f89dc44c3122100d8d4bea192d3aea2","sys_updated_by":"marjan.marzban","sys_created_on":"2014-07-28 23:20:52","used_by_discovery":"true","sys_name":"Windows - Weblogic - Find config.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"josh.gerbasi","ecc_queue_topic":"Powershell","sys_mod_count":"21","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_0f89dc44c3122100d8d4bea192d3aea2","ecc_queue_name":"Windows - Weblogic - Find config.xml","name":"Windows - Weblogic - Find config.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information to classify the type of UNIX-based CI","host_classification":"true","sys_updated_on":"2017-08-22 23:09:44","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"2","ecc_queue_source":"","sys_id":"10e0eebd0a0a0b4f61f46a5027df7fb6","sys_updated_by":"amit.dhuleshia","sys_created_on":"2010-01-09 02:19:21","used_by_discovery":"true","sys_name":"UNIX - Classify","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"MultiProbe","sys_mod_count":"10","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_multi_10e0eebd0a0a0b4f61f46a5027df7fb6","ecc_queue_name":"UNIX - Classify","name":"UNIX - Classify","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve Window cluster information","host_classification":"false","sys_updated_on":"2012-11-07 07:19:42","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"3","ecc_queue_source":"","sys_id":"123a9e6d4a36231d004cc8aa8252c209","sys_updated_by":"aleck.lin","sys_created_on":"2008-12-07 16:14:38","used_by_discovery":"true","sys_name":"Windows - Cluster","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_wmi_123a9e6d4a36231d004cc8aa8252c209","ecc_queue_name":"WMI: Cluster","name":"Windows - Cluster","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve Apache Version","host_classification":"false","sys_updated_on":"2014-10-31 17:42:06","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"16f2fd350a0a032700f2534f3b6ea391","sys_updated_by":"marjan.marzban","sys_created_on":"2007-11-06 21:52:11","used_by_discovery":"true","sys_name":"Apache - Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"8","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_16f2fd350a0a032700f2534f3b6ea391","ecc_queue_name":"${httpd_command} -V","name":"Apache - Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Determine the Solaris Zone Information. The related sensor will also trigger the 'Solaris - ADM' probe for each zone that it finds.","host_classification":"false","sys_updated_on":"2020-01-10 22:30:07","type":"Java","sys_class_name":"discovery_probes","minor_version":"5","ecc_queue_source":"","sys_id":"17c3b4ce0a0a032700d51f4b08a8bd1e","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-11-07 01:40:10","used_by_discovery":"true","sys_name":"Solaris - Zones & ADM Launcher","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_17c3b4ce0a0a032700d51f4b08a8bd1e","ecc_queue_name":"sh ${file:get-zones.sh}","name":"Solaris - Zones & ADM Launcher","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve active connections infomation","host_classification":"false","sys_updated_on":"2020-03-16 18:56:40","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"1a9c233dc0a8000b005c58d007c94a03","sys_updated_by":"benjamin.phan","sys_created_on":"2007-09-18 21:53:01","used_by_discovery":"true","sys_name":"Windows - Active Connections","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"17","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_1a9c233dc0a8000b005c58d007c94a03","ecc_queue_name":"WMI: Active Connections","name":"Windows - Active Connections","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Probe to get information about a vCenter's datacenters.  The sensor will fire a probe for each type of vCenter object in each datacenter:\r\n   VMs, explored by the \"VMWare - vCenter VMs\" probe,\r\n   clusters, explored by the \"VMWare - vCenter Clusters\" probe,\r\n   datastores, explored by the \"VMWare - vCenter Datastores\" probe, and \r\n   networks, explored by the \"VMWare - vCenter Networks\" probe.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterDatacentersProbe.\r\n\r\nAs of the Istanbul release this probe replaces the \"VMWare - vCenter\" probe for Discovery.\r\n","host_classification":"true","sys_updated_on":"2016-09-02 21:28:06","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"1e4b29618f071200c2fe0b5437bdee19","sys_updated_by":"steve.francis","sys_created_on":"2016-04-27 16:28:22","used_by_discovery":"true","sys_name":"VMWare - vCenter Datacenters","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"4","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_1e4b29618f071200c2fe0b5437bdee19","ecc_queue_name":"VMWarevCenterDatacentersProbe","name":"VMWare - vCenter Datacenters","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve the Tomcat server.xml contents","host_classification":"false","sys_updated_on":"2017-04-10 23:57:05","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"1f700ec4ac10020301d36d234582404f","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-01-14 07:09:02","used_by_discovery":"true","sys_name":"Tomcat - Get server.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"18","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_1f700ec4ac10020301d36d234582404f","ecc_queue_name":"cat ${filename}","name":"Tomcat - Get server.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve Solaris patches","host_classification":"false","sys_updated_on":"2014-10-07 22:07:48","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"204231610a0a030e00cc2619a85c85c7","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-09-20 00:12:29","used_by_discovery":"true","sys_name":"Solaris - OS Patches","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"21","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\t/**\n     * Runs the probe instance\n     */\n\tprocess : function() {\n\t\tvar patches = [];\n\t\t\n        var lines = output.split(/\\n/);\n        for (var i = 0; i < lines.length; i++) {\n            var parts = lines[i].split(\" \");\n            if (parts[0] && parts[0] == \"Patch:\" && parts[1]) {\n                \tvar patchName = parts[1];\n                \tvar patch = {};\n                \tpatch.name = patchName;\n                \tpatches.push(patch);\n            }\n        }\n\t\t\n\t\trelated_data.patches = patches;\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_204231610a0a030e00cc2619a85c85c7","ecc_queue_name":"showrev -p","name":"Solaris - OS Patches","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve OS patch info","host_classification":"false","sys_updated_on":"2012-11-07 06:58:36","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"20491c4c0a0a030e00b8bf8e17d26a33","sys_updated_by":"aleck.lin","sys_created_on":"2007-09-20 00:20:03","used_by_discovery":"true","sys_name":"AIX - OS Patches","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_20491c4c0a0a030e00b8bf8e17d26a33","ecc_queue_name":"instfix -i | grep AIX_ML","name":"AIX - OS Patches","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve HP-UX patch info","host_classification":"false","sys_updated_on":"2010-11-28 20:51:48","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"204c4e480a0a030e006fd37c571ace17","sys_updated_by":"jimmy.yuan","sys_created_on":"2007-09-20 00:23:32","used_by_discovery":"true","sys_name":"HP-UX - OS Patches","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"4","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_204c4e480a0a030e006fd37c571ace17","ecc_queue_name":"swlist -l product | grep 'PH.._'","name":"HP-UX - OS Patches","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve memory information","host_classification":"false","sys_updated_on":"2017-05-09 22:48:57","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"21297f810a0a0a8b0030701a2e4b01a5","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-06-12 18:19:34","used_by_discovery":"true","sys_name":"Linux - Memory","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"12","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {\n\t\tvar lines = output.split(\"\\n\");\n\t\t\n\t\tvar ram = 0;\n\t\t\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar columns = lines[i].split(/\\s+/);\n\t\t\t\n            if (columns[0] == \"MemTotal:\")\n                ram += parseInt(columns[1]) / 1024;\n\t\t}\n\t\t\n\t\tif (ram > 0)\n\t\t\tcurrent.ram = ram;\t\t\n\t},\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_21297f810a0a0a8b0030701a2e4b01a5","ecc_queue_name":"grep --color=never MemTotal /proc/meminfo","name":"Linux - Memory","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Run a local command on the MID server","host_classification":"false","sys_updated_on":"2010-11-28 20:52:16","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"223caebe0a00798700a60783ebbb9f84","sys_updated_by":"jimmy.yuan","sys_created_on":"2010-06-10 14:22:01","used_by_discovery":"true","sys_name":"Command","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"Command","sys_mod_count":"4","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_223caebe0a00798700a60783ebbb9f84","ecc_queue_name":"","name":"Command","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve serial number","host_classification":"false","sys_updated_on":"2019-04-12 01:26:50","type":"Java","sys_class_name":"discovery_probes","minor_version":"4","ecc_queue_source":"","sys_id":"28172c0f0a0a0bec59886bb9db7d2784","sys_updated_by":"brandon.chiem","sys_created_on":"2010-06-11 17:38:14","used_by_discovery":"true","sys_name":"Solaris - Serial Number","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"aleck.lin","ecc_queue_topic":"SSHCommand","sys_mod_count":"9","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\t/**\n     * Runs the probe instance\n     */\n\tprocess : function() {\n\t\t\n        var serials = [];\n        var lines = output.split('\\n');\n        for (var i=0; i<lines.length; i++) {\n            var line = lines[i];\n            var m = line.match(/^\"(.+?)\".*\"(.+?)\"$/);\n            if (!m)\n                continue;\n               \n            var serial = {};\n\n            serial.type = m[1];\n            serial.value = m[2];\n            \n            serials.push(serial);\n        }\n\n\t\trelated_data.serials = serials;\n\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_28172c0f0a0a0bec59886bb9db7d2784","ecc_queue_name":"sneep -T","name":"Solaris - Serial Number","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve HP-UX CPU speed","host_classification":"false","sys_updated_on":"2010-11-28 20:51:47","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"287ee5530a0a0b481798012461c01dbc","sys_updated_by":"jimmy.yuan","sys_created_on":"2009-11-24 23:20:22","used_by_discovery":"true","sys_name":"HP-UX - CPU Speed","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"6","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_287ee5530a0a0b481798012461c01dbc","ecc_queue_name":"echo itick_per_usec/D | adb -k /stand/vmunix /dev/kmem | tail -1","name":"HP-UX - CPU Speed","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve HP-UX total memory","host_classification":"false","sys_updated_on":"2012-11-07 07:07:42","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"28e1854e0a0a0b48650bebd7e38556c1","sys_updated_by":"aleck.lin","sys_created_on":"2009-11-25 01:08:06","used_by_discovery":"true","sys_name":"HP-UX - Total Memory","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"4","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_28e1854e0a0a0b48650bebd7e38556c1","ecc_queue_name":"echo 'memory_installed_in_machine/D' | adb -k /stand/vmunix /dev/mem | tail -1","name":"HP-UX - Total Memory","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve Linux installed software","host_classification":"false","sys_updated_on":"2015-03-24 01:49:41","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"2c93a59c0a0a0a8b00d5f029ccaf5573","sys_updated_by":"shankar.meenkeri","sys_created_on":"2007-06-14 23:31:20","used_by_discovery":"true","sys_name":"Linux - Installed Software","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"27","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\tpackages: [],\n\t\n\t/**\n     * Runs the probe instance\n     */    \n    process : function() {    \n\t\trelated_data.packages = this.packages; \n\t\t\n\t\tvar lines = output.trim().split('\\n');\n\t\tfor (var i = 0; i < lines.length; i++) {\n            var line = lines[i];\n\n\t\t    if (JSUtil.nil(line))\n                continue;\n\t\t   \n\t\t    var res = line.split(\":\");\n\t\t    var prefix = res[0].trim();\n\t\t    var value = line.substring(res[0].length+1).trim();\n\t\t   \n            var eventHandler = 'on_' + prefix;\n            if (this[eventHandler])\n                this[eventHandler](value);\n            else\n                this.log('Error: Invalid prefix in install software output: ' + prefix);\n        }\n\t\t\n\t\tthis.pushPkg(); // Push the last package... \t\t\n    },\n\t\n\ton_Package: function(value) {\n\t    this.pushPkg(); \n \t   this.name = value;\t   \n    },    \n   \n    on_Status: function(value) {\n \t   this.status = true;\n        var installed = /^.*ok.*installed.*$/.exec(value);\n\t    if (!installed)\n\t\t    this.status = false;\t   \n    },\n\n    on_Maintainer: function(value) {\n\t    if (!this.status)\n\t\t    return;\n\t   \n\t    this.maintainer = value;\n        var maintMat = /^(?:.*?)<.+?@(?:(?:.+?)\\\\.)*(.+?)\\\\.(?:(?:org)|(?:com)|(?:net))>$/.exec(value);\n        if (maintMat)\n            this.maintainer = maintMat[1];\n    },\n   \n    on_Version: function(value) {\n\t    if (!this.status)\n\t\t    return;\n\t   \n\t    this.version = value;\n    },\n   \n    on_Release: function(value) {   \n\t    if (!this.status)\n\t\t    return;\n\t   \n        // version is now RPM %{Version}-%{Release}\n        this.version += JSUtil.nil(value) ? '' : '-' + value;\n    },\n   \n    pushPkg: function() {\n \t   // If there's no package name... then we have nothing to push\n\t    if (JSUtil.nil(this.name))\n\t\t    return;\n\t   \n\t    // The status of pkg is not installed.. reset and return\n\t    if (!this.status) {  \n\t\t    this.resetPkg();\n\t\t    return;\n\t    }\n\t   \n        var software = {};\n        software.name = this.name;\n        software.version = this.version;\n        software.vendor = this.maintainer;\n\t   \n        this.packages.push(software);\n\t   \n\t    this.resetPkg();\n    },\n   \n    resetPkg: function() {\n\t    this.name = null;\n\t    this.version = null;\n\t    this.maintainer = null;\n\t    this.status = null\n    },\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_2c93a59c0a0a0a8b00d5f029ccaf5573","ecc_queue_name":"bash ${file:pkg_munger}","name":"Linux - Installed Software","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Probes a Dell Remote Access Controller","host_classification":"false","sys_updated_on":"2019-10-24 20:40:52","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"1","ecc_queue_source":"","sys_id":"3c0cc4729f2221001e021a1cf67fcf70","sys_updated_by":"chris.orr","sys_created_on":"2014-08-18 21:40:56","used_by_discovery":"true","sys_name":"SNMP - DRAC","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"SNMP","sys_mod_count":"3","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_snmp_3c0cc4729f2221001e021a1cf67fcf70","ecc_queue_name":"SNMP - DRAC","name":"SNMP - DRAC","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"true","description":"Gather Oracle instance version information","host_classification":"false","sys_updated_on":"2014-10-29 00:17:51","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"3c48298adf3221001e02a3cf6bf2639a","sys_updated_by":"josh.gerbasi","sys_created_on":"2014-08-29 06:46:25","used_by_discovery":"true","sys_name":"Oracle - Instance Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"swapnesh.patel","ecc_queue_topic":"Powershell","sys_mod_count":"25","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t/**\n \t* Runs the probe instance\n \t*/\n\tprocess : function() {\n\t\tif (JSUtil.notNil(output))\n\t\t\tthis.parseOutput(output);\n\t},\n\t\n\tparseOutput: function(output) {\n\t\tvar lines = output.split(/\\n/);\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar line = lines[i];\n\t\t\t\n\t\t\tvar homeIndex = line.indexOf(\"snc_ora_home=\");\n\t\t\tif(homeIndex >= 0){\n\t\t\t\tcurrent.oracle_home = line.replace(\"snc_ora_home=\",\"\").trim();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tvar versionIndex = line.indexOf(\"snc_ora_version=\");\n\t\t\tif(versionIndex >= 0){\n\t\t\t\tcurrent.version = line.replace(\"snc_ora_version=\",\"\").trim();\n\t\t\t\tcontinue;\n\t\t\t}\t\t\t\n\t\t}\n\t},\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_3c48298adf3221001e02a3cf6bf2639a","ecc_queue_name":"Windows - Oracle Version","name":"Oracle - Instance Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Get Microsoft IIS Information","host_classification":"false","sys_updated_on":"2015-08-31 17:41:09","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"1","ecc_queue_source":"","sys_id":"3d6871530a0a0b9e00ae6679e94b1182","sys_updated_by":"josh.gerbasi","sys_created_on":"2009-07-02 21:41:46","used_by_discovery":"true","sys_name":"Windows - Get IIS Information","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_wmi_3d6871530a0a0b9e00ae6679e94b1182","ecc_queue_name":"WMI: Get IIS Information","name":"Windows - Get IIS Information","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieves the web.xml file for given application filepath","host_classification":"false","sys_updated_on":"2017-04-10 23:57:05","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"3ee49d39c3e62100d8d4bea192d3ae0c","sys_updated_by":"josh.gerbasi","sys_created_on":"2014-08-16 00:26:12","used_by_discovery":"true","sys_name":"Windows - Weblogic - Get web.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"josh.gerbasi","ecc_queue_topic":"Powershell","sys_mod_count":"8","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_3ee49d39c3e62100d8d4bea192d3ae0c","ecc_queue_name":"Windows - Weblogic - Get web.xml","name":"Windows - Weblogic - Get web.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Get the details of a specific Oracle instance","host_classification":"false","sys_updated_on":"2011-06-28 21:23:23","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"3f82e14d37530000dadacffbcfbe5dbb","sys_updated_by":"ben.yukich","sys_created_on":"2011-06-14 23:09:36","used_by_discovery":"true","sys_name":"Oracle - Instance Details","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"ben.yukich","ecc_queue_topic":"SSHCommand","sys_mod_count":"1","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_3f82e14d37530000dadacffbcfbe5dbb","ecc_queue_name":"sh ${file:oracle_instance.sh} ${sid}","name":"Oracle - Instance Details","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Explore NICs installed in virtual machines.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterVMNICsProbe.","host_classification":"false","sys_updated_on":"2016-06-28 23:46:39","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"41a220d48f1c2200c2fe0b5437bdeed3","sys_updated_by":"steve.francis","sys_created_on":"2016-06-24 17:17:04","used_by_discovery":"true","sys_name":"VMWare - vCenter VM NICs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"1","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_41a220d48f1c2200c2fe0b5437bdeed3","ecc_queue_name":"VMWarevCenterVMNICsProbe","name":"VMWare - vCenter VM NICs","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Explore clusters and resource pools.  Relate each cluster to its resource pools, ESX hosts and its containing folder or datacenter.  The sensor will trigger the \"ESX Hosts\" probe to explore ESX hosts.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterClustersProbe.","host_classification":"false","sys_updated_on":"2016-06-28 23:47:53","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"442e3caf93c31200c2fe705bb47ffb94","sys_updated_by":"steve.francis","sys_created_on":"2016-05-03 18:18:55","used_by_discovery":"true","sys_name":"VMWare - vCenter Clusters","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"2","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_442e3caf93c31200c2fe705bb47ffb94","ecc_queue_name":"VMWarevCenterClustersProbe","name":"VMWare - vCenter Clusters","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Explore virtual networks.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterNetworksProbe.","host_classification":"false","sys_updated_on":"2016-06-30 00:27:26","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"477e30ef93c31200c2fe705bb47ffb46","sys_updated_by":"steve.francis","sys_created_on":"2016-05-03 18:20:29","used_by_discovery":"true","sys_name":"VMWare - vCenter Networks","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"3","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_477e30ef93c31200c2fe705bb47ffb46","ecc_queue_name":"VMWarevCenterNetworksProbe","name":"VMWare - vCenter Networks","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Explore VMs.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterVMsProbe.","host_classification":"false","sys_updated_on":"2016-06-28 23:47:06","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"478ebcaf93c31200c2fe705bb47ffb0c","sys_updated_by":"steve.francis","sys_created_on":"2016-05-03 18:20:46","used_by_discovery":"true","sys_name":"VMWare - vCenter VMs","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"1","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_478ebcaf93c31200c2fe705bb47ffb0c","ecc_queue_name":"VMWarevCenterVMsProbe","name":"VMWare - vCenter VMs","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Secure copy from one machine to another.  The copy is performed using the MID Server as a tunnel.","host_classification":"false","sys_updated_on":"2011-02-21 17:21:24","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"493d68b80ab3015901091d4729c87756","sys_updated_by":"tom.dilatush","sys_created_on":"2011-02-21 17:21:24","used_by_discovery":"false","sys_name":"SCPRelay","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"SCPRelay","sys_mod_count":"0","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_493d68b80ab3015901091d4729c87756","ecc_queue_name":"","name":"SCPRelay","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Generic SNMP Probe","host_classification":"false","sys_updated_on":"2010-11-28 20:54:11","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"","ecc_queue_source":"","sys_id":"4a97de880a0a0baa0076a17c6b01540c","sys_updated_by":"jimmy.yuan","sys_created_on":"2010-03-11 00:20:19","used_by_discovery":"false","sys_name":"SNMPProbe","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.bow","ecc_queue_topic":"SNMP","sys_mod_count":"5","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_snmp_4a97de880a0a0baa0076a17c6b01540c","ecc_queue_name":"SNMP Query","name":"SNMPProbe","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve HP-UX computer model","host_classification":"false","sys_updated_on":"2010-11-28 20:51:47","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"4cfe13470a0a0b20008b4b6f4d18d683","sys_updated_by":"jimmy.yuan","sys_created_on":"2007-08-09 23:38:13","used_by_discovery":"true","sys_name":"HP-UX - Hardware Model","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"5","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_4cfe13470a0a0b20008b4b6f4d18d683","ecc_queue_name":"model","name":"HP-UX - Hardware Model","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve HP-UX serial number","host_classification":"false","sys_updated_on":"2010-11-28 20:51:47","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"4d0593950a0a0b2000ca8269ed583d9f","sys_updated_by":"jimmy.yuan","sys_created_on":"2007-08-09 23:46:24","used_by_discovery":"true","sys_name":"HP-UX - Hardware Serial Number","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"5","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_4d0593950a0a0b2000ca8269ed583d9f","ecc_queue_name":"uname -i","name":"HP-UX - Hardware Serial Number","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Used to get the main Class of the running HBase process, as ps cannot return the full HBase command line.","host_classification":"false","sys_updated_on":"2014-09-04 18:29:38","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"4d790c449f9221001e021a1cf67fcff4","sys_updated_by":"amit.dhuleshia","sys_created_on":"2014-07-28 22:11:58","used_by_discovery":"true","sys_name":"HBase - Main Class","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"amit.dhuleshia","ecc_queue_topic":"SSHCommand","sys_mod_count":"16","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {\n\t\tvar lines = output.split(\"\\n\");\n\t\t\n\t\t// no results\n\t\tif (lines.length == 0)\n\t\t\treturn;\n\t\t\n\t\tvar regexp = new RegExp(\"^\\\\d+\\\\s+([^\\\\s]+)\", 'im');\n\t\tvar match = regexp.exec(output);\n\t\tif (match) {\n\t\t\tvar mainClass = match[1].trim();\n\t\t\tvar shortName = mainClass.substring( mainClass.lastIndexOf('.') + 1);\n\t\t\tcurrent.name = shortName + '@' + this.getParameter('computerName');\n\t\t}\n\t},\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_4d790c449f9221001e021a1cf67fcff4","ecc_queue_name":"${jps} -lv | grep ^${processID}","name":"HBase - Main Class","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve WebSphere cell.xml for Cell information","host_classification":"false","sys_updated_on":"2012-11-12 00:19:05","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"50ddd1110a0a0a6f01fba3988ac6e2d7","sys_updated_by":"aleck.lin","sys_created_on":"2007-01-23 21:30:18","used_by_discovery":"true","sys_name":"WebSphere - Get cell.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"8","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_50ddd1110a0a0a6f01fba3988ac6e2d7","ecc_queue_name":"cat ${filename}","name":"WebSphere - Get cell.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve HP-UX networking information","host_classification":"false","sys_updated_on":"2010-11-28 20:51:48","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"51174bf50a0a0b200086e777759084a9","sys_updated_by":"jimmy.yuan","sys_created_on":"2007-08-10 18:44:14","used_by_discovery":"true","sys_name":"HP-UX - Network","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"5","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_51174bf50a0a0b200086e777759084a9","ecc_queue_name":"sh ${file:hifconfig.sh}","name":"HP-UX - Network","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve WebSphere server.xml for Cell information","host_classification":"false","sys_updated_on":"2012-11-12 00:18:50","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"5171c4dc0a0a0a6f01a72df67e7d38f5","sys_updated_by":"aleck.lin","sys_created_on":"2007-01-24 00:11:54","used_by_discovery":"true","sys_name":"WebSphere - Get server.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"6","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_5171c4dc0a0a0a6f01a72df67e7d38f5","ecc_queue_name":"cat ${filename}","name":"WebSphere - Get server.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"true","description":"Obtain the PFile for Oracle instance","host_classification":"false","sys_updated_on":"2014-10-29 00:17:23","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"51c1cde3df3221001e02a3cf6bf2630f","sys_updated_by":"josh.gerbasi","sys_created_on":"2014-09-02 19:52:13","used_by_discovery":"true","sys_name":"Oracle - Instance PFile","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"swapnesh.patel","ecc_queue_topic":"Powershell","sys_mod_count":"12","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t/**\n \t* Runs the probe instance\n \t*/\n\tprocess : function() {\n\t\tif (JSUtil.notNil(output))\n\t\t\tcurrent.pfile = output.trim();\n\t},\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_51c1cde3df3221001e02a3cf6bf2630f","ecc_queue_name":"Windows - Oracle PFile","name":"Oracle - Instance PFile","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve HP-UX CPU information","host_classification":"false","sys_updated_on":"2010-11-28 20:51:48","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"5246daf50a0a0b2000741895af5905b5","sys_updated_by":"jimmy.yuan","sys_created_on":"2007-08-11 00:15:48","used_by_discovery":"true","sys_name":"HP-UX - CPU Info","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"8","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_5246daf50a0a0b2000741895af5905b5","ecc_queue_name":"sh ${file:cpuinfo.sh}","name":"HP-UX - CPU Info","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve active connections infomation","host_classification":"false","sys_updated_on":"2023-07-03 06:46:08","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"53d141350b02101088b90bdb35673a20","sys_updated_by":"now.discovery.content","sys_created_on":"2020-07-17 08:33:48","used_by_discovery":"true","sys_name":"AIX – Active Connections","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"moiz.alibhayani","ecc_queue_topic":"SSHCommand","sys_mod_count":"1","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n\tprocess : function() {    \n\t\t// parse the results from our lsof output, leaving the result in result.current.connections...\n\t\tif (JSUtil.nil(output))\n\t\t\treturn;\n\t\tvar sliceIndex = output.indexOf('\\n');\n\t\tif (sliceIndex === -1) {\n\t\t\tg_probe.setError('Unexpected output: ' + output);\n\t\t\treturn;\n\t\t}\n\t\tvar commandOutput = output.slice(sliceIndex + 1);\n\t\tif (output.startsWith('lsof output'))\n\t\t\tthis.processOutput(LSOFParser,commandOutput);\n\t\telse if (output.startsWith('netstat output')) {\n\t\t\tcommandOutput = this.normalizeNetstat(commandOutput);\n\t\t\tthis.processOutput(DiscoveryNetstatParser,commandOutput);\n\t\t}\n\t\telse\n\t\t\tg_probe.setError('Both netstat and lsof commands failed to get connection information');\t\n    },\n\t\n\t//netstat output gives IPs in the form of ip.port converting it to ip:port\n\t//eg: 10.196.33.215.22  ->  10.196.33.215:22 \n\tnormalizeNetstat : function(output) {\n\t\tvar outputArray = output.split(\"\\n\");\n\t\tfor(var i=0; i<outputArray.length; i++) {\n\t\t\tvar outputParts = outputArray[i].split(/\\s+/);\n\t\t\toutputParts[3] = outputParts[3].replace(/(.*)\\.(.*)/, '$1:$2');\n\t\t\toutputParts[4] = outputParts[4].replace(/(.*)\\.(.*)/, '$1:$2');\n\t\t\toutputArray[i] = outputParts.join(\" \");\n\t\t}\n\t\treturn outputArray.join(\"\\n\");\n\t},\n\t\n\tprocessOutput : function(parser, output) {\n\t\tvar np = new parser();\n\t\tnp.parse(output);\n\t\trelated_data.connections = np.tcp;\n\t\trelated_data.isValid = np.isValid;\n\t\trelated_data.error_string = np.errorString;\n\t},\n   \n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_53d141350b02101088b90bdb35673a20","ecc_queue_name":"sh ${file:aix_connection.sh}","name":"AIX – Active Connections","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather MongoDB configuration information","host_classification":"false","sys_updated_on":"2016-04-01 17:41:33","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"54cc23b4ef1221007f04b25495c0fbac","sys_updated_by":"greg.grisco","sys_created_on":"2014-07-31 22:38:03","used_by_discovery":"true","sys_name":"Unix - MongoDB Configuration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"jing.yang","ecc_queue_topic":"SSHCommand","sys_mod_count":"41","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t/**\n     * Runs the probe instance\n     */\n\tprocess : function() {\n\n\t\tcurrent.mongodb_conf = output.trim();\n\t\t\n\t\tvar filename = g_probe.getParameter(\"filename\") + '';\n\t\t// Remove unnecessary quotes due to space in filename\n\t\tfilename = filename.replace(/['\"]+/g, '');\n\t\tif (filename.indexOf(\"/\") > -1) {\n\t\t\tcurrent.config_file = filename;\n\t\t\tcurrent.config_directory = filename.substring(0, filename.lastIndexOf(\"/\"));\n\t\t}\n\n\t\t// port will be set by classify if specified on command line\n\t\tvar param_port_set = (g_probe.getParameter(\"port_set\") == \"true\");\n\t\tif (param_port_set)\n\t\t\treturn;\n\n\t\tvar lines = output.split(\"\\n\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar line = lines[i];\n\t\t\t\n\t\t\tif (line == '' || line.startsWith('#'))\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tvar parts = line.indexOf(\"=\") > 0 ? line.split(\"=\") : line.split(\":\");\n\t\t\tvar name = parts[0].trim();\n\t\t\tvar value = parts[1].trim();\n\t\t\t\n\t\t\tif (name=='port') {\n\t\t\t\tcurrent.tcp_port = value;\n\t\t\t\tbreak;\t\t// no longer need to search the file\n\t\t\t}\n\t\t}\n\t\tif (!current.tcp_port)\n\t\t\tcurrent.tcp_port = \"27017\";\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});\t\n\n","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_54cc23b4ef1221007f04b25495c0fbac","ecc_queue_name":"cat ${filename}","name":"Unix - MongoDB Configuration","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve WebSphere server.xml for Cell information","host_classification":"false","sys_updated_on":"2016-01-04 00:18:54","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"555485950a0a0a6f010216c0d236a69d","sys_updated_by":"aleck.lin","sys_created_on":"2007-01-24 18:18:27","used_by_discovery":"true","sys_name":"WebSphere - Get serverindex.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_555485950a0a0a6f010216c0d236a69d","ecc_queue_name":"cat ${filename}","name":"WebSphere - Get serverindex.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Probe to close all SMB sessions between MID server host and target IP","host_classification":"false","sys_updated_on":"2021-05-25 21:56:54","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"5639e2d6ff10301036a2c787d53bf12c","sys_updated_by":"nisan.barzion","sys_created_on":"2021-05-25 21:54:51","used_by_discovery":"true","sys_name":"Windows - Cleanup SMB Sessions","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"nisan.barzion","ecc_queue_topic":"Powershell","sys_mod_count":"2","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_5639e2d6ff10301036a2c787d53bf12c","ecc_queue_name":"Windows - Cleanup SMB Sessions","name":"Windows - Cleanup SMB Sessions","execute_script_remotely":"true","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve active connections infomation","host_classification":"false","sys_updated_on":"2023-08-06 15:18:37","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"56d52b5fc3101200d8d4bea192d3ae55","sys_updated_by":"now.discovery.content","sys_created_on":"2015-12-18 19:00:34","used_by_discovery":"true","sys_name":"Solaris - Active Connections","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"josh.gerbasi","ecc_queue_topic":"SSHCommand","sys_mod_count":"2","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n    process: function() {\n        //Check if output is from lsof or pfiles and parse accordingly\n        if (JSUtil.nil(output))\n            return;\n        var sliceIndex = output.indexOf('\\n');\n        if (sliceIndex === -1) {\n            g_probe.setError('Unexpected output: ' + output);\n            return;\n        }\n        var commandOutput = output.slice(sliceIndex + 1);\n        if (output.startsWith('lsof output')) {\n            // parse the results from our lsof output, leaving the result in result.current.connections...\n            var lp = new LSOFParser();\n            lp.parse(commandOutput);\n            related_data.connections = lp.tcp;\n            related_data.isValid = lp.isValid;\n            related_data.error_string = lp.errorString;\n        } else if (output.startsWith('pfiles output')) {\n            // parse the results from our pfiles output, leaving the result in result.current.connections...\n            var pfilesParser = new DiscoveryPfilesParser();\n            pfilesParser.parse(commandOutput);\n            related_data.connections = pfilesParser.tcp;\n            related_data.isValid = pfilesParser.isValid;\n            related_data.error_string = pfilesParser.errorString;\n        }\n    },\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_56d52b5fc3101200d8d4bea192d3ae55","ecc_queue_name":"sh ${file:lsof.sh} ${zone}","name":"Solaris - Active Connections","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"true","cache_results":"false","description":"Get (active) running processes","host_classification":"false","sys_updated_on":"2024-10-17 00:00:00","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"57874ec40a0a0b2000e662317a4c1714","sys_updated_by":"now.discovery_infra","sys_created_on":"2007-08-12 00:44:19","used_by_discovery":"true","sys_name":"AIX - Active Processes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"20","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n    process: function() {\n        // parse the results from our ps output, leaving the result in sensor.running_processes...\n        var psop = new PsOutputParser();\n        var procs = psop.parse(output);\n        try {\n            var rpf = this.getParameter(\"running_process_filter\");\n            if (rpf) {\n\t\t\t\ttry {\n    \t            var filtering = new RunningProcessesFilter();\n\t                var filterDefs = JSON.parse(rpf);\n        \t        procs = filtering.filterResults(procs, filterDefs);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tvar evaluator = Packages.com.snc.discovery.runningprocess.api.RunningProcessFilterEvaluatorJSProvider.get();\n\t\t\t\t\tprocs = JSON.parse(evaluator.filter(rpf, procs));\n\t\t\t\t}\n            }\n        } catch (e) {\n            if (typeof ms != 'undefined')\n                ms.log(\"AIX - Active Processes: Something went wrong while trying to filter processes. Error=\" + e);\n            else\n                // If we don't have access to ms, we are not on the MID\n                // Which means we are in classic mode:\n                DiscoveryLogger.warn(\"AIX - Active Processes: Process filtering skipped. Classic mode is not supported.\");\n        }\n        related_data.running_processes = procs;\n        related_data.error_msg = psop.error_msg;\n    },\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_57874ec40a0a0b2000e662317a4c1714","ecc_queue_name":"sh ${file:ps.sh}","name":"AIX - Active Processes","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve the JBoss default server's jboss-service.xml","host_classification":"false","sys_updated_on":"2017-04-10 23:57:05","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"5adfe34b0a0a0a6f00d496be33cf4ac4","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-01-25 20:08:46","used_by_discovery":"true","sys_name":"JBoss - Get jboss-service.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_5adfe34b0a0a0a6f00d496be33cf4ac4","ecc_queue_name":"cat ${filename}","name":"JBoss - Get jboss-service.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Find a directory listing of JBoss deployed web.xml","host_classification":"false","sys_updated_on":"2016-07-08 07:17:02","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"5bb94e820a0a0a6f0150c0135e7f5e9d","sys_updated_by":"chris.nguyen","sys_created_on":"2007-01-26 00:06:15","used_by_discovery":"true","sys_name":"JBoss - Find web.xml List","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"12","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_5bb94e820a0a0a6f0150c0135e7f5e9d","ecc_queue_name":"find ${dirname} -name web.xml -print","name":"JBoss - Find web.xml List","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve the JBoss web.xml contents","host_classification":"false","sys_updated_on":"2017-04-10 23:57:05","type":"Java","sys_class_name":"discovery_probes","minor_version":"3","ecc_queue_source":"","sys_id":"5bdcb83d0a0a0a6f018f3cc545693129","sys_updated_by":"jim.freeman","sys_created_on":"2007-01-26 00:44:56","used_by_discovery":"true","sys_name":"JBoss - Get web.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_5bdcb83d0a0a0a6f018f3cc545693129","ecc_queue_name":"cat ${filename}","name":"JBoss - Get web.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Get the distribution for Linux operation system.","host_classification":"false","sys_updated_on":"2020-12-02 08:49:10","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"5d0d176d0a0a0b5a38e584a5d95682db","sys_updated_by":"varsha.srinivas","sys_created_on":"2010-08-10 17:30:19","used_by_discovery":"true","sys_name":"Linux - Distribution","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"aleck.lin","ecc_queue_topic":"SSHCommand","sys_mod_count":"42","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n    process : function() {\n\t\tvar lowercaseOutput = output.toLowerCase();\n\t\tvar versionMatch = null;\n\n        if (this._isMatch('red hat', lowercaseOutput)) {\n\t\t\tif (this._isMatch('oracle', lowercaseOutput)) {\n\t\t\t\tcurrent.os = \"Linux Oracle\";\n\t\t\t\tversionMatch = /release ([0-9\\.]+)/.exec(lowercaseOutput);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tcurrent.os = \"Linux Red Hat\";\n\t\t\t\tversionMatch = /release ([0-9\\.]+)/.exec(lowercaseOutput);\n\t\t\t}\n\t\t}\n        else if (this._isMatch('fedora', lowercaseOutput)) {\n            current.os = \"Linux Fedora\";\n\t\t\tversionMatch = /release ([0-9\\.]+)/.exec(lowercaseOutput);\n\t\t}\n        else if (this._isMatch('suse', lowercaseOutput)) {\n            current.os = \"Linux SuSE\";\n\t\t\t//Sample OS version formats that are expected to match the regex are 15-SP1, 15.1, 15\n\t\t\tversionMatch = /version ?= ?\"([0-9]+((-|.)[a-z0-9]+)*)\"/.exec(lowercaseOutput);\n\t\t}\n        else if (this._isMatch('centos', lowercaseOutput)) {\n            current.os = \"Linux CentOS\";\n\t\t\tversionMatch = /release ([0-9\\.]+)/.exec(lowercaseOutput);\n\t\t}\n\t\telse if (this._isMatch('ubuntu', lowercaseOutput)) {\n\t\t\tcurrent.os = \"Linux Ubuntu\";\n\t\t\tversionMatch = /version=\"([0-9\\.]+)/.exec(lowercaseOutput);\n\t\t}\n        else {\n            current.os = \"GNU/Linux\";\n\t\t}\n\n\t\tif(versionMatch && versionMatch[1])\n\t\t\tcurrent.os_version = versionMatch[1].toUpperCase();\n    },\n\t\n\t// Return false if name not found, or name found on line preceded by 'id_like='.\n\t// If present, id_like= is followed by a list of similar Linux distribution names.\n\t//\n\t// Added this method for PRB942869 fix so won't incorrectly classify a Linux server if the *release \n\t// files have an ID_LIKE= line followed by a list containing a different OS names\n\t// AND that line appears before the line with ID=<correct OS name>.\n\t// Many versions of Linux don't have ID_LIKE= and ID= lines (example: Centos 6.7 doesn't have\n\t// them, Centos 7.0 does).\n\t_isMatch : function (osName, text) {\n\t\tvar osIdx = text.indexOf(osName);\n\t\tif (osIdx == -1)\n\t\t\treturn false;\n\t\t\n\t\tvar lastNewlineIdx = text.lastIndexOf('\\n', osIdx - 1);\n\t\tif (lastNewlineIdx == -1)\n\t\t\tlastNewlineIdx = 0;\n\t\tvar sub = text.substring(lastNewlineIdx, osIdx);\n\t\treturn sub.indexOf('id_like=') == -1;\n\t},\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_5d0d176d0a0a0b5a38e584a5d95682db","ecc_queue_name":"cat /etc/*release","name":"Linux - Distribution","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"","host_classification":"false","sys_updated_on":"2012-01-06 23:24:29","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"5d7d1a9b07d31000dada43c0d1021e99","sys_updated_by":"jimmy.yuan","sys_created_on":"2012-01-06 23:24:29","used_by_discovery":"false","sys_name":"RESTProbe","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"jimmy.yuan","ecc_queue_topic":"RESTProbe","sys_mod_count":"0","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_5d7d1a9b07d31000dada43c0d1021e99","ecc_queue_name":"","name":"RESTProbe","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Get active (running) processes","host_classification":"false","sys_updated_on":"2024-10-17 21:18:39","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"5fe4a8230a0a0b2000cb228a067bd153","sys_updated_by":"now.discovery_infra","sys_created_on":"2007-08-13 15:43:14","used_by_discovery":"true","sys_name":"Unix - Active Processes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"56","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n    process: function() {\n        // parse the results from our ps output, leaving the result in sensor.running_processes...\n        var psop = new PsOutputParser();\n        var procs = psop.parse(output);\n\n        try {\n            var rpf = this.getParameter(\"running_process_filter\");\n            if (rpf) {\n\t\t\t\t// There's both a Java and JavaScript implementation of process filtering. The Java\n\t\t\t\t// version is significantly faster so it's preferred and is what's used OOB.\n\t\t\t\t// The JavaScript version is shipped in case there's a bug in the Java version. If\n\t\t\t\t// there is a bug in the Java version then chances are good the JavaScript version\n\t\t\t\t// has the same bug, but the difference is that the JavaScript version can be fixed\n\t\t\t\t// and tested on a customer instance, providing immediate relief.\n\t\t\t\t// Switch to the JavaScript version by simply activating the MID script include\n\t\t\t\t// record named \"RunningProcessesFilter\".\n\t\t\t\t// IMPORTANT: Any fixes in this script need to be replicated in the Java code in\n\t\t\t\t// the RunningProcessFilterEvaluatorModule.\n\t\t\t\ttry {\n\t\t\t\t\tvar filtering = new RunningProcessesFilter();\n\t\t\t\t\tvar filterDefs = JSON.parse(rpf);\n\t\t\t\t\tprocs = filtering.filterResults(procs, filterDefs);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Doing this in the catch() makes it seem like this is fallback code when it's really\n\t\t\t\t\t// the preferred code path. Unfortunately we don't have a good way to know if someone\n\t\t\t\t\t// has activated the JavaScript (the real fallback) unless we try to use it.\n\t\t\t\t\tvar evaluator = Packages.com.snc.discovery.runningprocess.api.RunningProcessFilterEvaluatorJSProvider.get();\n\t\t\t\t\tprocs = JSON.parse(evaluator.filter(rpf, procs));\n\t\t\t\t}\n            }\n        } catch (e) {\n            if (typeof ms != 'undefined')\n                ms.log(\"Unix - Active Processes: Something went wrong while trying to filter processes. Error=\" + e);\n            else\n                // If we don't have access to ms, we are not on the MID\n                // Which means we are in classic mode:\n                DiscoveryLogger.warn(\"Unix - Active Processes: Process filtering skipped. Classic mode is not supported.\");\n        }\n\n        related_data.running_processes = procs;\n        related_data.error_msg = psop.error_msg;\n\n        if (this.getParameter('filter_kernel_procs') == 'true')\n            psop.filterKernelProcs(related_data.running_processes);\n    },\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_5fe4a8230a0a0b2000cb228a067bd153","ecc_queue_name":"ps awwxo pid,ppid,command | sed -n '/<defunct>/!p'","name":"Unix - Active Processes","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather MySQL configuration information","host_classification":"false","sys_updated_on":"2014-10-08 01:16:48","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"60fe930b0a0a0a6f005e409232b3b8bd","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-01-27 00:40:01","used_by_discovery":"true","sys_name":"MySQL - Configuration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"10","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_60fe930b0a0a0a6f005e409232b3b8bd","ecc_queue_name":"cat ${filename}","name":"MySQL - Configuration","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather MySQL version information","host_classification":"false","sys_updated_on":"2014-10-08 01:20:15","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"61361aa40a0a0a6f01b1d372d015a855","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-01-27 01:40:40","used_by_discovery":"true","sys_name":"MySQL - Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_61361aa40a0a0a6f01b1d372d015a855","ecc_queue_name":"${command} -V","name":"MySQL - Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Explore ESX servers and host mounts.  The sensor will trigger the \"ESX Hosts Storage\" probe to explore ESX hardware (disks and SAN disks, NICs).\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterESXHostsProbe.\r\n","host_classification":"false","sys_updated_on":"2016-06-28 23:44:41","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"613ebcaf93c31200c2fe705bb47ffb57","sys_updated_by":"steve.francis","sys_created_on":"2016-05-03 18:19:18","used_by_discovery":"true","sys_name":"VMWare - vCenter ESX Hosts","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"3","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_613ebcaf93c31200c2fe705bb47ffb57","ecc_queue_name":"VMWarevCenterESXHostsProbe","name":"VMWare - vCenter ESX Hosts","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather Mongodb version information","host_classification":"false","sys_updated_on":"2014-09-03 19:07:24","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"6275c330ef1221007f04b25495c0fbb9","sys_updated_by":"amit.dhuleshia","sys_created_on":"2014-07-31 19:46:26","used_by_discovery":"true","sys_name":"Unix - MongoDB Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"amit.dhuleshia","ecc_queue_topic":"SSHCommand","sys_mod_count":"9","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n\t/**\n     * Runs the probe instance\n     */\n\tprocess : function() {\n        var lines = output.split(\"\\n\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n            var line = lines[i];\n\n            if (line.indexOf(\"db version \") > -1) {\n\t\t\t\tvar matches = line.match(/db version v([\\d\\w.]+)/);\n\t\t\t\tif (matches)\n\t\t\t\t\tcurrent.version = matches[1];\n            } \n\t\t}\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});\t\n\t","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_6275c330ef1221007f04b25495c0fbb9","ecc_queue_name":"${command} -version","name":"Unix - MongoDB Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather HBase version information","host_classification":"false","sys_updated_on":"2014-10-29 00:15:36","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"62c4abee9f0221001e021a1cf67fcfec","sys_updated_by":"josh.gerbasi","sys_created_on":"2014-07-24 22:22:39","used_by_discovery":"true","sys_name":"HBase - Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"amit.dhuleshia","ecc_queue_topic":"SSHCommand","sys_mod_count":"17","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {\n\t\tvar lines = output.split(\"\\n\");\n\t\t\n\t\t// no results\n\t\tif (lines.length == 0)\n\t\t\treturn;\n\t\t\n\t\tvar regexp = new RegExp(\"version\\n([^, ]+)\", 'im');\n\t\tvar match = regexp.exec(output);\n\t\tif (match)\n\t\t\tcurrent.version = match[1].trim();\t\t\t\n\t},\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_62c4abee9f0221001e021a1cf67fcfec","ecc_queue_name":"sh ${file:version.sh} ${hbase_home}","name":"HBase - Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Uses SNMP to learn about network switches (or other devices that can switch)","host_classification":"false","sys_updated_on":"2012-11-12 00:22:00","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"","ecc_queue_source":"","sys_id":"62e9bb500a0a0b02002321355fa55452","sys_updated_by":"aleck.lin","sys_created_on":"2008-11-03 15:13:24","used_by_discovery":"true","sys_name":"SNMP Switching","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SNMP","sys_mod_count":"14","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_snmp_62e9bb500a0a0b02002321355fa55452","ecc_queue_name":"SNMP - Switching","name":"SNMP - Switching","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Probe to get information about an ESXi server. The sensor will fire a probe for each type of object managed by the server:   \r\n            VMs, explored by the \"VMWare - vCenter VMs\" probe,\r\n            datastores, explored by the \"VMWare - vCenter Datastores\" probe, and \r\n            networks, explored by the \"VMWare - vCenter Networks\" probe.\r\n            esx resource pools, explored by the \"VMWare - vCenter Clusters\" probe.\r\n            \r\n            This probe's implementation is located in a MID server script include named StandaloneESXProbe.","host_classification":"false","sys_updated_on":"2020-09-15 06:10:58","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"6311c527c7121010f580178603c26059","sys_updated_by":"pooja.chugwani","sys_created_on":"2020-08-04 05:16:19","used_by_discovery":"true","sys_name":"VMWare - Standalone ESXi Server","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"0","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_6311c527c7121010f580178603c26059","ecc_queue_name":"StandaloneESXProbe","name":"VMWare - Standalone ESXi Server","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve the OS information","host_classification":"false","sys_updated_on":"2012-11-07 07:23:51","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"","ecc_queue_source":"","sys_id":"6325f3ef0a0006bc3e2e2d83e75dc02a","sys_updated_by":"aleck.lin","sys_created_on":"2011-01-08 01:03:07","used_by_discovery":"true","sys_name":"Windows - OS Information","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"aleck.lin","ecc_queue_topic":"WMIRunner","sys_mod_count":"1","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_wmi_6325f3ef0a0006bc3e2e2d83e75dc02a","ecc_queue_name":"WMI: OS Information","name":"Windows - OS Information","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve machine for network information","host_classification":"false","sys_updated_on":"2020-02-10 15:41:08","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"1","ecc_queue_source":"","sys_id":"63dad2300a0a0b3a000ad7acdc2ee4dd","sys_updated_by":"christopher.thompson","sys_created_on":"2008-11-03 19:37:02","used_by_discovery":"true","sys_name":"Windows - Network","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"51","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\t/**\n \t* Runs the probe instance\n \t*/\n\tprocess : function() {\n\t\trelated_data.adapters = [];\n\t\t// get our adapters and configurations...\n\t\tvar network_confs = g_array_util.ensureArray(output.Win32_NetworkAdapterConfiguration);\n\t\tvar network_adapters = g_array_util.ensureArray(output.Win32_NetworkAdapter);\n\t\tvar network_routes = g_array_util.ensureArray(output.Win32_IP4RouteTable);\n\t\tvar idutil = new IDSensorUtil();\n\t\t\n\t\t// filter routes down for better searching later\n\t\tvar fixedRoutes = [];\n\t\tvar seenRoutes = {};\n\t\t\n\t\tfor (var i=0; i < network_routes.length; i++) {\n\t\t\tvar route = network_routes[i];\n\t\t\t\n\t\t\tif (route.Destination.indexOf('127.') == 0 || route.Destination == '255.255.255.255' ||\n\t\t\t\t(route.Destination.indexOf('224.') == 0 && route.Mask.indexOf('240.') == 0) ) {\n\t\t\t\t// ignore broadcast, localhost, and multicast routes\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\t// Only add the route if we haven't seen it yet\n\t\t\tvar hashedRoute = this.hashRoute(route);\n\t\t\tif (!seenRoutes[hashedRoute]) {\n\t\t\t\tseenRoutes[hashedRoute] = true;\n\t\t\t\tfixedRoutes.push(route);\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar vips = {};\n\t\tthis.buildVIPHash(vips);\n\t\t\n\t\tfor(var i = 0; i < network_confs.length; i++) {\n\t\t\tvar nc = network_confs[i];\n\t\t\tvar na = network_adapters[i];\n\t\t\t\n\t\t\tif (parseInt(nc.Index) != parseInt(na.Index)) //Just in case Index doesn't match...\n\t\t\t\tna = this.findCorrectIndex(nc.Index, network_adapters);\n\t\t\t\n\t\t\tif (JSUtil.nil(nc.IPAddress) || !nc.IPEnabled)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\t// Filter out loopback adapters\n\t\t\tif (JSUtil.notNil(nc.Caption) && nc.Caption.indexOf(\"Loopback Adapter\") >= 0)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tvar ipParsed = nc.IPAddress.split(\",\");\n\t\t\tvar subnetParsed = [];\n\t\t\tif (!JSUtil.nil(nc.IPSubnet))\n\t\t\t\tsubnetParsed = nc.IPSubnet.split(\",\");\n\t\t\t\n\t\t\tvar ips = [];\n\t\t\t\n\t\t\tfor(var j = 0; j < ipParsed.length; j++) {\n\t\t\t\t// The ip shouldn't be a VIP...\n\t\t\t\tif (vips[ipParsed[j]])\n\t\t\t\t\tcontinue;\n\t\t\t\t\n\t\t\t\tvar ip_address = ipParsed[j];\n\t\t\t\tvar isIPv6 = (ip_address.indexOf(\":\") > -1);\n\t\t\t\tif (isIPv6) {\n\t\t\t\t\tip_address = SncIPAddressV6.get(ip_address);\n\t\t\t\t\tif (!ip_address)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\t// check if valid nic ip address..\n\t\t\t\t\tif (!SncIPAddressV4.get(ip_address) || ip_address == \"0.0.0.0\" ||\n\t\t\t\t\t\tip_address == \"255.255.255.255\" || ip_address == \"127.0.0.1\")\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar ip = {};\n\t\t\t\tip.ip_address = ip_address;\n\t\t\t\tip.netmask = (j < subnetParsed.length) ? subnetParsed[j] : null;\n\t\t\t\tip.ip_version = isIPv6 ? '6' : '4';\n\t\t\t\tips.push(ip);\n\t\t\t}\n\t\t\t\n\t\t\tvar adapter = {};\n\t\t\tadapter.name\t           = na.NetConnectionID;\n\t\t\tadapter.short_description  = nc.Caption;\n\t\t\tadapter.ip_address         = (ips.length > 0) ? ips[0].ip_address : null;\n\t\t\tadapter.netmask            = (ips.length > 0) ? ips[0].netmask : null;\n\t\t\tadapter.ip_default_gateway = nc.DefaultIPGateway ? nc.DefaultIPGateway.toString() : null;\n\t\t\tadapter.mac_address        = nc.MACAddress ? nc.MACAddress.toString() : null;\n\t\t\tadapter.dhcp_enabled       = (nc.DHCPEnabled.toString() == 1) ? true : false;\n\t\t\tadapter.ip_addresses       = ips;\n\t\t\tadapter.manufacturer \t  = na.Manufacturer;\n\t\t\tadapter.routes             = {ifRoutes: [], gwRoutes: []};\n\t\t\t\n\t\t\t// handle routes\n\t\t\tfor (var j=0; j < adapter.ip_addresses.length; j++) {\n\t\t\t\tvar ip = adapter.ip_addresses[j];\n\t\t\t\t\n\t\t\t\tif (ip.ip_version == '6' || ip.netmask == null)\n\t\t\t\t\tcontinue;\n\t\t\t\t\n\t\t\t\t// search for matching routes\n\t\t\t\tvar cidr = idutil.maskToCidr(ip.netmask);\n\t\t\t\tvar network = new SncIPNetworkV4(ip.ip_address + '/' + cidr);\n\t\t\t\tfor (var k=0; k < fixedRoutes.length; k++) {\n\t\t\t\t\tvar route = fixedRoutes[k];\n\t\t\t\t\t\n\t\t\t\t\tcidr = idutil.maskToCidr(route.Mask);\n\t\t\t\t\tvar destIpNetwork = route.Destination + '/' + cidr;\n\t\t\t\t\tvar newRoute = { dest_ip_network: destIpNetwork };\n\t\t\t\t\tif (route.NextHop == '0.0.0.0') {\n\t\t\t\t\t\t// possible exit interface route\n\t\t\t\t\t\tif (route.Mask == '255.255.255.255') {\n\t\t\t\t\t\t\t// host or broadcast exit interface route, will be contained by a subnet route\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (route.Destination == '' + network.address) {\n\t\t\t\t\t\t\tnewRoute.router_interface = adapter.name;\n\t\t\t\t\t\t\tadapter.routes.ifRoutes.push(newRoute);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// possible next hop route\n\t\t\t\t\t\tvar nextHop = new SncIPAddressV4(route.NextHop);\n\t\t\t\t\t\tif (network.contains(nextHop) || network.isBroadcastAddress(nextHop) ) {\n\t\t\t\t\t\t\tnewRoute.route_interface = adapter.name;\n\t\t\t\t\t\t\tnewRoute.next_hop_ip_address = String(nextHop);\n\t\t\t\t\t\t\tadapter.routes.gwRoutes.push(newRoute);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\trelated_data.adapters.push(adapter);\n\t\t\t\n\t\t\t//if this nic has a default gateway configured, set the default_gateway for the computer CI:\n\t\t\tif(JSUtil.notNil(adapter.ip_default_gateway))\n\t\t\t\trelated_data.ip_default_gateway = adapter.ip_default_gateway;\n\t\t}\n\t},\n\t\n\t/*************************************************************\n \t* Function definitions\n \t*************************************************************/\n\t\n\tbuildVIPHash: function(vips) {\n\t\t// if we have a VIPs parameter, parse it and build a hashmap of them...\n\t\tvar vipsParam = g_probe.getParameter('vips');\n\t\tif (vipsParam) {\n\t\t\tvar vipsParamParts = vipsParam.split(',');\n\t\t\tfor (var i = 0; i < vipsParamParts.length; i++)\n\t\t\t\tvips[vipsParamParts[i]] = true;\n\t\t}\n\t},\n\t\n\t/*\n \t* Win32_NetworkAdapter and Win32_NetworkAdapterConfiguration seem to always have the same\n \t* length of array data and the order matches. But just in case it doesn't, we need to\n \t* manually match them up by index.\n \t*/\n\tfindCorrectIndex: function(index, network_adapters) {\n\t\tfor(var i=0; i<network_adapters.length; i++)\n\t\t\tif (parseInt(network_adapters[i].Index) == parseInt(index))\n\t\t\treturn network_adapters[i];\n\t},\n\t\n\t// Routes are unique based on Destination, Mask, and NextHop\n\thashRoute: function(route) {\n\t\tvar routeHash = \"\";\n\t\trouteHash += \"D:\" + route.Destination;\n\t\trouteHash += \"M:\" + route.Mask;\n\t\trouteHash += \"NH:\" + route.NextHop;\n\t\t\n\t\treturn routeHash;\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_wmi_63dad2300a0a0b3a000ad7acdc2ee4dd","ecc_queue_name":"WMI: Network","name":"Windows - Network","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Get detailed information about the memory modules installed in the system.\r\n\"| cat\" is used because 1) Dmidecode tends to return junk error codes so \"|\" throws away the code, and 2) sudo command has a bug causing it to hang forever; see KB0683246 and https://bugzilla.sudo.ws/show_bug.cgi?id=826 for details.","host_classification":"false","sys_updated_on":"2020-03-26 09:12:52","type":"Java","sys_class_name":"discovery_probes","minor_version":"4","ecc_queue_source":"","sys_id":"6ac0fab40a0007171dfa9895dbc49411","sys_updated_by":"srikanth.nelapudi","sys_created_on":"2011-04-18 22:35:44","used_by_discovery":"true","sys_name":"Linux - Memory Modules","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"ben.yukich","ecc_queue_topic":"SSHCommand","sys_mod_count":"18","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\t/**\n\t * Runs the probe instance\n\t */\n\tprocess : function() { \n\t\tif (!(g_probe.haveWarning() || g_probe.haveError()) && !output.contains(\"System Information\")) {\n\t\t\tg_probe.setError(\"Unable to parse output of dmidecode: \" + output);\n\t\t\trelated_data.warn = \"Unable to parse output of dmidecode: \" + output;\n\t\t\treturn;\n\t\t}\n\t\tvar modules = [];\n\t\tvar handleRegex = /.*DMI type ([0-9]+).*/;\n\t\trelated_data.modules = modules; \n\t\t\n\t\t/**\n\t\t *  Output for dmidecode will be in this format:\n\t\t *    Handle 0x0107, DMI type 3, 6 bytes\n\t\t *    Serial Number: VMware-42 08 4b d3 41 9e eb e3-5e fd 7e 7b 42 42 c0 66;\n\t\t *    UUID: 42084BD3-419E-EBE3-5EFD-7E7B4242C066\n\t\t *\n\t\t *    Handle 0x0105, DMI type 23, 13 bytes\n\t\t *    ...\n\t\t *\n\t\t *  The following code splits the output into blocks (around \"Handle 0x\").\n\t\t *  A bit of optimization is done based on the fact that we only care about\n\t\t *  DMI type 17.\n\t\t */\n\t\tvar blocks = output.split(/Handle\\s0x/);\n\t\tfor(var i = 0; i < blocks.length; i++) {\n\t\t\tvar block = blocks[i];\n\t\t\tvar mat = handleRegex.exec(block);\n\t\t\tif (mat) {\n\t\t\t\tcurrentBlock = parseInt(mat[1]);\n\t\t\t\t// we're only interested in block 17...\n\t\t\t\tif (currentBlock != 17)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar lines = block.split(/\\n/);\n\n\t\t\tfor (var j = 0; j < lines.length; j++) {\n\t\t\t\tvar line = lines[j];\n\n\t\t\t\tif (line == \"Memory Device\") {\n\t\t\t\t\tvar module = this.parseModule(lines, j + 1);\n\n\t\t\t\t\tif (module != null)\n\t\t\t\t\t\tmodules.push(module);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t\n\tparseModule: function(lines, start) {\n        var module = {};\n        \n        for (var i = start; i < lines.length; i++) {\n            var line = lines[i];\n            \n            if (line == \"\")\n                return module;\n            \n            var parts = line.split(\":\");\n            var name = parts[0].trim();\n            var value = parts[1].trim();\n            \n            if (name == \"Total Width\")\n                module.total_width = value.split(\" \")[0];\n            else if (name == \"Data Width\")\n                module.data_width = value.split(\" \")[0];\n            else if (name == \"Size\") {\n                if (value == \"No Module Installed\")\n                    return null;\n                var sizeComponents = value.split(\" \");\n                var unit = sizeComponents[1];\n                if (unit && unit == \"GB\")\n                    module.capacity = sizeComponents[0] * 1024;\n                else\n                    module.capacity = sizeComponents[0];\n            } else if (name == \"Form Factor\")\n                module.form_factor = (value.startsWith(\"FB-\")) ? value.split(\"-\")[1] : value;\n            else if (name == \"Locator\") {\n                module.device_locator = value;\n                module.name = value;\n            } else if (name == \"Bank Locator\")\n                module.bank_label = (value == \"Not Specified\") ? null : value;\n            else if (name == \"Type\")\n                module.type = value.split(\" \")[0];\n            else if (name == \"Type Detail\")\n                module.type_detail = value;\n            else if (name == \"Speed\")\n                module.speed = (value == \"Unknown\") ? null : value.split(\" \")[0];\n            else if (name == \"Serial Number\")\n                module.serial_number = value;\n            else if (name == \"Part Number\")\n                module.part_number = value;\n            else if (name == \"Manufacturer\")\n                module.manufacturer = value;\n            else if (name ==\"Product Name\")\n                module.model_id = value;\n        }\n        \n        return module;\n    },\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_6ac0fab40a0007171dfa9895dbc49411","ecc_queue_name":"sudo dmidecode | cat","name":"Linux - Memory Modules","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve AIX installed software","host_classification":"false","sys_updated_on":"2015-03-24 01:49:02","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"6f030dde0a0a0b7e3b62dec732519697","sys_updated_by":"shankar.meenkeri","sys_created_on":"2009-10-19 22:55:21","used_by_discovery":"true","sys_name":"AIX - Installed Software","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"9","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_6f030dde0a0a0b7e3b62dec732519697","ecc_queue_name":"lslpp -Lc","name":"AIX - Installed Software","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve serial numbers from DMI (BIOS)\r\n          \"| cat\" is used because 1) Dmidecode tends to return junk error codes so \"|\" throws away the code, and 2) sudo command has a bug causing it to hang forever; see KB0683246 and https://bugzilla.sudo.ws/show_bug.cgi?id=826 for details.","host_classification":"false","sys_updated_on":"2020-02-10 16:50:47","type":"Java","sys_class_name":"discovery_probes","minor_version":"7","ecc_queue_source":"","sys_id":"6f23f36f4014b54c00d127806d1d579b","sys_updated_by":"christopher.thompson","sys_created_on":"2007-08-16 14:46:40","used_by_discovery":"true","sys_name":"Linux - Hardware Information","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"26","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n\t/**\n\t * Runs the probe instance\n\t */\n\tprocess : function() {\n\t\tif (!(g_probe.haveWarning() || g_probe.haveError()) && !output.contains(\"System Information\")) {\n\t\t\tg_probe.setError(\"Unable to parse output of dmidecode: \" + output);\n\t\t\trelated_data.warn = \"Unable to parse output of dmidecode: \" + output;\n\t\t\treturn;\n\t\t}\n\n\t\trelated_data.tDataObj = {};\n\n\t\t// key (property name) is currentBlock + ':' + field name...\n\t\tvar matchMap = {\n\t\t\t'1:Manufacturer'  : 'manufacturer',\n\t\t\t'1:Product Name'  : 'model_id',\n\t\t\t'1:Version'       : 'model_number',\n\t\t\t'1:Serial Number' : 'system_serial_number',\n\t\t\t'1:UUID'          : 'uuid_serial',\n\t\t\t'2:Serial Number' : 'baseboard_serial',\n\t\t\t'3:Serial Number' : 'chassis_serial'\n\t\t};\n\t\tvar handleRegex = /.*DMI type ([0-9]+).*/;\n\t\tvar valueRegex = /^\\s*([^:]*)\\s*:\\s*(.*?)\\s*$/;\n\t\tvar currentBlock = -1;\n\n\t\t/**\n\t\t *  Output for dmidecode will be in this format:\n\t\t *    Handle 0x0107, DMI type 3, 6 bytes\n\t\t *    Serial Number: VMware-42 08 4b d3 41 9e eb e3-5e fd 7e 7b 42 42 c0 66;\n\t\t *    UUID: 42084BD3-419E-EBE3-5EFD-7E7B4242C066\n\t\t *\n\t\t *    Handle 0x0105, DMI type 23, 13 bytes\n\t\t *    ...\n\t\t *\n\t\t *  The following code splits the output into blocks (around \"Handle 0x\").\n\t\t *  A bit of optimization is done based on the fact that we only care about\n\t\t *  DMI types between 1~3.\n\t\t *  Skip processing on blocks with types that are not in this range.\n\t\t *  If the type is between 1~3, we grab the field names that we care about and\n\t\t *  save those in tDataObj.\n\t\t */\n\t\tvar blocks = output.split(/Handle\\s0x/);\n\t\tfor(var i = 0; i < blocks.length; i++) {\n\t\t\tvar block = blocks[i];\n\t\t\tvar mat = handleRegex.exec(block);\n\t\t\tif (mat) {\n\t\t\t\tcurrentBlock = parseInt(mat[1]);\n\t\t\t\t// we're only interested in blocks 1 through 3...\n\t\t\t\tif (currentBlock < 1 || currentBlock > 3)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar values = block.split(/\\n/);\n\t\t\tfor (var j = 0; j < values.length; j++) {\n\t\t\t\tvar value = values[j].trim();\n\t\t\t\tmat = value.match(valueRegex);\n\t\t\t\tif (!mat)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tvar fieldName = mat[1];\n\t\t\t\tvar fieldValue = mat[2];\n\t\t\t\tvar curName = matchMap['' + currentBlock + ':' + fieldName];\n\t\t\t\tif (curName == null)\n\t\t\t\t\tcontinue;\n\n\t\t\t\t// don't overwrite data we already have, as sometimes there are duplicate blocks with no data...\n\t\t\t\tif (related_data.tDataObj[curName] == null)\n\t\t\t\t\trelated_data.tDataObj[curName] = fieldValue;\n\t\t\t}\n\t\t}\n\t}\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_6f23f36f4014b54c00d127806d1d579b","ecc_queue_name":"sudo dmidecode | cat","name":"Linux - Hardware Information","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve memory information","host_classification":"false","sys_updated_on":"2014-10-07 22:07:31","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"6fd293e24a35ce820171b597fd3342ac","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-08-16 17:57:25","used_by_discovery":"true","sys_name":"Solaris - Memory","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"19","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n    /**\n     * Runs the probe instance \n     */\n\tprocess : function() {\n\t\tvar lines = output.split(/\\n/);\n\t\t\n\t\tvar ram = 0;\n\t\t\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar parts = lines[i].split(\":\");\n\t\t\t\n\t\t\tif (JSUtil.notNil(parts[0]) && (parts[0] == \"Memory size\")) {\n\t\t\t\tif (JSUtil.notNil(parts[1])){\n\t\t\t\t\tvar rest = parts[1].trim().split(\" \");\n\t\t\t\t\tram = rest[0];\n\t\t\t\t\tif (ram > 0)\n\t\t\t\t\t\tcurrent.ram = ram;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_6fd293e24a35ce820171b597fd3342ac","ecc_queue_name":"prtconf | grep Memory","name":"Solaris - Memory","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Explore datastores, datastore hostmounts and datastore disks.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterDatastoresProbe.\r\n","host_classification":"false","sys_updated_on":"2016-06-28 23:40:39","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"715efcaf93c31200c2fe705bb47ffb51","sys_updated_by":"steve.francis","sys_created_on":"2016-05-03 18:19:51","used_by_discovery":"true","sys_name":"VMWare - vCenter Datastores","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"2","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_715efcaf93c31200c2fe705bb47ffb51","ecc_queue_name":"VMWarevCenterDatastoresProbe","name":"VMWare - vCenter Datastores","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Identifies Mac OS X instances in the CMDB.","host_classification":"false","sys_updated_on":"2012-11-04 14:49:45","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"","ecc_queue_source":"","sys_id":"74d878ab0ab3015100ee673f760999e4","sys_updated_by":"tom.dilatush","sys_created_on":"2009-12-09 19:10:00","used_by_discovery":"true","sys_name":"Mac OS X - Identity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"MultiProbe","sys_mod_count":"10","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_multi_74d878ab0ab3015100ee673f760999e4","ecc_queue_name":"Mac OS X - Identity","name":"Mac OS X - Identity","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Verifying if it's a Vcenter IP","host_classification":"false","sys_updated_on":"2024-03-28 10:53:43","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"7862ffae47244a10aa755222516d43e4","sys_updated_by":"now.discovery.content","sys_created_on":"2024-02-27 13:03:03","used_by_discovery":"true","sys_name":"VMWare - Classify","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"now.discovery.content","ecc_queue_topic":"VMWareProbe","sys_mod_count":"0","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_7862ffae47244a10aa755222516d43e4","ecc_queue_name":"VMWarevCenterClassyProbe","name":"VMWare - vCenter Classify","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Probes a Power Distribution Unit ","host_classification":"false","sys_updated_on":"2010-11-28 20:51:48","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"1","ecc_queue_source":"","sys_id":"7882fc690a0a0b9828dda94ffa9291ad","sys_updated_by":"jimmy.yuan","sys_created_on":"2010-03-19 22:20:23","used_by_discovery":"true","sys_name":"SNMP - PDU","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"mike.currie","ecc_queue_topic":"SNMP","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_snmp_7882fc690a0a0b9828dda94ffa9291ad","ecc_queue_name":"SNMP -PDU","name":"SNMP - PDU","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Send a new HTTP GET","host_classification":"false","sys_updated_on":"2011-05-02 16:11:29","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"78c7ac860a0a0b993e7cf8b8c29d789b","sys_updated_by":"admin","sys_created_on":"2010-03-19 23:35:04","used_by_discovery":"false","sys_name":"HTTPProbe","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"HTTPProbe","sys_mod_count":"3","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_78c7ac860a0a0b993e7cf8b8c29d789b","ecc_queue_name":"","name":"HTTPProbe","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve HP-UX Installed Software","host_classification":"false","sys_updated_on":"2015-03-24 01:49:31","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"794b0f000a0a0bc43eda4619a5bd0aab","sys_updated_by":"shankar.meenkeri","sys_created_on":"2009-10-21 22:50:12","used_by_discovery":"true","sys_name":"HP-UX - Installed Software","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"8","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_794b0f000a0a0bc43eda4619a5bd0aab","ecc_queue_name":"swlist -l product | grep -v 'PH.._'","name":"HP-UX - Installed Software","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Determine the OS processors","host_classification":"false","sys_updated_on":"2015-07-08 20:27:57","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"7b73e821ef75300098d5925495c0fb08","sys_updated_by":"sky.lin","sys_created_on":"2012-11-19 06:49:19","used_by_discovery":"true","sys_name":"Solaris - CPU","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"aleck.lin","ecc_queue_topic":"SSHCommand","sys_mod_count":"5","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {\n\t\tvar lines = output.split(\"\\n\");\n\t\t\n\t\tvar processors = 0;   // Keep track of total virtual CPUs seen by the OS\n        var physicalIds = {}; // Keep track of physical ids for an accurate count of CPUs\n        physicalIds.count = 0;\n        var coreIds = {}; // Keep track of core ids for an accurate count cores\n        coreIds.count = 0;\n\t\tvar physical_id_in_curr_block = '';\n\n        for (var i = 0; i < lines.length; i++) {\n            var line = lines[i];\n\t\t\t\n\t\t\tline = line.trim();\n\t\t\t\n            if (line == '') \n                continue;\n\t\t\t\n\t\t\tif (line.indexOf(\"module:\") > -1) {\n\t\t\t\tprocessors++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif (line.indexOf(\"name:\") > -1)\n\t\t\t\tcontinue;\n\n\t\t\tvar parts = new RegExp(\"^(.+?)\\\\s+(.*)$\").exec(line);\n\t\t\t\n\t\t\tif (parts.length < 3)\n\t\t\t\tcontinue;\n\t\t\t\n            var name = parts[1].trim();\n            var value = parts[2].trim();\n\n            if (name == \"clock_MHz\") {\n                var cpu_speed = parseInt(value);\n\t\t\t\t\n\t\t\t\tif (!isNaN(cpu_speed))\n                \tcurrent.cpu_speed = cpu_speed;\n            } else if (name == \"chip_id\") {\n\t\t\t\tphysical_id_in_curr_block = value;\n\t\t\t\tif (!physicalIds[value]) {\n                \tphysicalIds[value] = true;\n                \tphysicalIds.count++;\n                }\n            } else if (name == \"core_id\" && !coreIds[physical_id_in_curr_block + '.' + value]) {\n                coreIds[physical_id_in_curr_block + '.' + value] = true;\n                coreIds.count++;\n            } else if (name == \"brand\")\n\t\t\t\tcurrent.cpu_name = value;\n            else if (name == \"cpu_type\")\n                current.cpu_type = value;\n            else if (name == \"vendor_id\")\n\t\t\t\tcurrent.cpu_vendor = value;\t\n\t\t\t\n        }\n\t\t\n\t\t/**********************************************************\n\t\tHere are the assumptions how we're going to calculate CPU counts, core count, threads per core Hyperthreading...\n\t\t* Total number of processors represents the total CPUs available to the OS\n\t\t* Here's the formula how the various numbers fit into each other\n  \t\tProcessors = Physical CPUs * Cores per CPU * Threads per core;\n\t\t* To get the number of physical CPUs, we need the unique \"chip_id\" value\n\t\t* To get the \"total\" number of core counts, we count the number of unique \"chip_id\" + \"core_id\" combinations\n\t\t* To get \"core count PER CPU\", we just need to divide total \"core count\" by physical CPUs.\n\t\t  This is where kstat differs from cpuinfo in linux. In linux, the unique \"core id\" already represents\n\t\t  core count per CPU, but here we need to do the division to get it.\n\t\t* To get the \"threads per core\", we need to divide total CPU by total core count (processors/toal_core_count)\n\t\t*******************************************************/\n\t\t\n\t\tif (processors == 0) {\n\t\t\t// something's wrong here 'cause we didn't see a single procesor header! \n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// Calculate CPU count\n\t\tvar cpuCount = 1;\n\t\tif (physicalIds.count > 0)\n\t\t\tcpuCount = physicalIds.count;\n\t\t\n\t\tcurrent.cpu_count = cpuCount;\n\t\t\n\t\t// Calculate total CPU core count\n\t\tvar cpuCoreCount = 1;\n\t\tif (coreIds.count > 0)\n\t\t\tcpuCoreCount = coreIds.count;\t\t\t\n\n\t\t// To get core count per CPU, if core_id is not available, then just set the core count to 1.\n\t\tcurrent.cpu_core_count = cpuCoreCount == 1 ? cpuCoreCount : cpuCoreCount/cpuCount; \n\n\t\t// calculate threads per core\n\t\tvar threadsPerCore = processors/cpuCoreCount;\n\t\tcurrent.cpu_core_thread = threadsPerCore;\n    },\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_7b73e821ef75300098d5925495c0fb08","ecc_queue_name":"kstat cpu_info","name":"Solaris - CPU","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve OS uptime","host_classification":"false","sys_updated_on":"2018-04-10 14:24:51","type":"Java","sys_class_name":"discovery_probes","minor_version":"3","ecc_queue_source":"","sys_id":"7bbde08c0a0a0b2500e88aeee4bd8ed5","sys_updated_by":"vishal.rao","sys_created_on":"2008-09-19 17:52:33","used_by_discovery":"true","sys_name":"UNIX - OS Uptime","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"110","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {\n\n        // Imports from Java Standard Libraries that we will use later\n        var SimpleDateFormat = Packages.java.text.SimpleDateFormat;\n        var Locale = Packages.java.util.Locale;\n\n\t\t// Parse the input\n        var uptime = 0;\n        var lines = output.split('\\n');\n\n        var m = lines[0].match(/up (.*?),\\s*(.*?),/);\n        if (m) {\n            uptime += parseInt(this.getSecondsFromStr(m[1]));\n            uptime += parseInt(this.getSecondsFromStr(m[2]));\n        }\n\n        if (uptime > 0) {\n            var nowDate = 0;\n\n            // We need to explicitly request the \"root\" Locale by specifying the Locale.ROOT enum value\n            // This corresponds to the UNIX LC_ALL=C \"C\" Locale which is country/language/variant independent.\n            // LC_ALL=C is what we are requesting in this Probe's SSHCommand:\n            //         uptime;env LC_ALL=C date '+%a %b %e %H:%M %Z %Y'\n            // \"C\" is the POSIX locale as defined by The Single UNIX Specification.\n            //  We want the way we parse the date to match the way we ask for it.\n            // If we don't specify this, then the MID Server's JVM Locale, either explicitly specified by\n            // Java System Properties (user.country, user.language, user.variant) or implicitly specified by\n            // the host machine's settings will be used, potentially re-interpreting the format string\n            // incorrectly, as seen in PRB1265978.\n            var df = new SimpleDateFormat(\"EEE MMM d HH:mm z yyyy\", Locale.ROOT);\n            var d = df.parse(lines[1]);\n            nowDate = d.getTime();\n\n            uptime = nowDate - (uptime*1000); // in ms\n        }\n\t\t\n\t\t// round up to the next minute to increase the chance of cache hit\n\t\tvar roundToNearest = 60000;\n\t\tcurrent.start_date = Math.ceil(uptime/roundToNearest)*roundToNearest;\n    },\n  \n    getSecondsFromStr: function(str) {\n        var m = 0;\n\t\tvar secs = 0;\n\t\t\n        if ((m = str.match(/(\\d+) day/))) {\n            var days = m[1];\n            secs += days*86400;\n        } \n\t\t\n\t\tif ((m = str.match(/(\\d+) min/))) {\n            var mins = m[1];\n            secs += mins*60;\n        } \n\t\t\n\t\tif ((m = str.match(/(\\d+):(\\d+)/))) {\n            var hours = m[1];\n            var mins = m[2];\n            secs += 3600*hours;\n            secs += mins*60;\n        }\n\n        return secs;\n    },\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"4","sys_update_name":"discovery_probes_7bbde08c0a0a0b2500e88aeee4bd8ed5","ecc_queue_name":"uptime;env LC_ALL=C date '+%a %b %e %H:%M %Z %Y'","name":"UNIX - OS Uptime","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Explore Tags for the VMs discovered.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterVMTagsProbe.","host_classification":"false","sys_updated_on":"2019-03-06 17:11:04","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"7c070599674c330018da6c706785ef6b","sys_updated_by":"srikanth.nelapudi","sys_created_on":"2019-03-06 17:11:04","used_by_discovery":"true","sys_name":"VMWare - vCenter VM Tags","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"srikanth.nelapudi","ecc_queue_topic":"VMWareProbe","sys_mod_count":"0","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_7c070599674c330018da6c706785ef6b","ecc_queue_name":"VMWarevCenterVMTagsProbe","name":"VMWare - vCenter VM Tags","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather PostgreSQL configuration file contents","host_classification":"false","sys_updated_on":"2014-09-04 20:36:22","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"7df18800c33221002d031f051eba8f01","sys_updated_by":"chris.nguyen","sys_created_on":"2014-08-22 18:09:09","used_by_discovery":"true","sys_name":"PostgreSQL - Configuration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"chris.nguyen","ecc_queue_topic":"SSHCommand","sys_mod_count":"3","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\tprocess : function() {\n\t\tif (JSUtil.nil(output))\n\t\t\treturn;\n\t\t\n\t\tcurrent.postgres_conf = output;\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_7df18800c33221002d031f051eba8f01","ecc_queue_name":"cat ${pgsql_conf_file}","name":"PostgreSQL - Configuration","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Run a perlscript","host_classification":"false","sys_updated_on":"2011-10-03 21:22:39","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"10.10.10.5","sys_id":"7f7beaaf0a0a0a6f0041b2bb48873eb4","sys_updated_by":"steve.bandow","sys_created_on":"2007-02-01 22:45:31","used_by_discovery":"false","sys_name":"Example - Run Perl Script","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_7f7beaaf0a0a0a6f0041b2bb48873eb4","ecc_queue_name":"perl ${file:script.pl}","name":"Example - Run Perl Script","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve the Windows services","host_classification":"false","sys_updated_on":"2014-10-07 22:13:49","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"0","ecc_queue_source":"","sys_id":"828ebf830a0a0ba6003fc12640a94323","sys_updated_by":"josh.gerbasi","sys_created_on":"2009-04-07 21:49:34","used_by_discovery":"true","sys_name":"Windows - Services","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"12","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    process : function() {  \n\t\tvar dataArray = [];\n\t\tvar dataArrayList = g_array_util.ensureArray(output.Win32_Service);\n\n        for (var i = 0; i < dataArrayList.length; i++) {\n            var element = dataArrayList[i];\n            var dataArrayDef = {};\n\n            dataArrayDef.name             = element.Name;\n            dataArrayDef.display_name     = element.DisplayName;\n            dataArrayDef.path_name        = element.PathName;\n            dataArrayDef.service_state    = element.State;\n            dataArrayDef.start_mode       = element.StartMode;\n            dataArrayDef.service_type     = element.ServiceType;\n            dataArrayDef.process_id       = element.ProcessId;\n            dataArrayDef.can_be_paused    = element.AcceptPause;\n            dataArrayDef.can_be_stopped   = element.AcceptStop;\n            dataArrayDef.desktop_interact = element.DesktopInteract;\n            dataArrayDef.account          = element.StartName;\n\n            dataArray.push(dataArrayDef);\n        }\n\t\t\n\t\tif(dataArray.length > 0)\n\t\t\trelated_data.data_array = dataArray;\t\t\n\t},\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_wmi_828ebf830a0a0ba6003fc12640a94323","ecc_queue_name":"WMI: Services","name":"Windows - Services","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Determines DNS names for device","host_classification":"false","sys_updated_on":"2010-11-28 20:51:47","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"845331880a0a0bab008f5580d5b94a71","sys_updated_by":"jimmy.yuan","sys_created_on":"2010-06-29 15:28:51","used_by_discovery":"true","sys_name":"DNS","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"DNS","sys_mod_count":"3","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_845331880a0a0bab008f5580d5b94a71","ecc_queue_name":"${ip_addresses}","name":"DNS","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Identifies an SNMP device.","host_classification":"false","sys_updated_on":"2010-11-28 20:51:49","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"","ecc_queue_source":"","sys_id":"85fb14260ab3015300ccbcfd2ba828e7","sys_updated_by":"jimmy.yuan","sys_created_on":"2009-12-13 03:01:08","used_by_discovery":"true","sys_name":"SNMP - Identity Info","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"SNMP","sys_mod_count":"9","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_snmp_85fb14260ab3015300ccbcfd2ba828e7","ecc_queue_name":"SNMP - Identity Info","name":"SNMP - Identity Info","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information for identifying it in the CMDB, such as serial number and NICs.","host_classification":"false","sys_updated_on":"2012-11-07 07:05:18","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"","ecc_queue_source":"","sys_id":"861bec1a0ab301530025151b59a3c6b0","sys_updated_by":"aleck.lin","sys_created_on":"2009-12-13 03:37:20","used_by_discovery":"true","sys_name":"SNMP - Identity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"MultiProbe","sys_mod_count":"4","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_multi_861bec1a0ab301530025151b59a3c6b0","ecc_queue_name":"SNMP - Identity","name":"SNMP - Identity","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Tests the basic functionality of a MID server, returning some basic statistical information.","host_classification":"false","sys_updated_on":"2010-11-28 20:52:33","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"8e0018fb0ab301525da82c482bfc939d","sys_updated_by":"jimmy.yuan","sys_created_on":"2010-10-08 22:40:50","used_by_discovery":"false","sys_name":"Heartbeat","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"HeartbeatProbe","sys_mod_count":"4","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_8e0018fb0ab301525da82c482bfc939d","ecc_queue_name":"","name":"Heartbeat","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information for identifying it in the CMDB, such as serial number and NICs.","host_classification":"false","sys_updated_on":"2020-02-10 17:27:56","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"1","ecc_queue_source":"","sys_id":"8e2007e60a0a0b500044825832ac3d63","sys_updated_by":"christopher.thompson","sys_created_on":"2009-12-14 16:58:38","used_by_discovery":"true","sys_name":"Windows - Identity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"MultiProbe","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_multi_8e2007e60a0a0b500044825832ac3d63","ecc_queue_name":"Windows - Identity","name":"Windows - Identity","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Gather network information from Mac OS X machines.","host_classification":"false","sys_updated_on":"2012-11-04 14:50:46","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"8e2a13eb0a0a0bbe00b66c20e95a776d","sys_updated_by":"tom.dilatush","sys_created_on":"2008-11-12 00:46:41","used_by_discovery":"true","sys_name":"Mac OS X - Network","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"16","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_8e2a13eb0a0a0bbe00b66c20e95a776d","ecc_queue_name":"system_profiler SPNetworkDataType -xml;ifconfig | grep '\\Winet6\\W'","name":"Mac OS X - Network","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"true","description":"Gather MySQL Configuration information","host_classification":"false","sys_updated_on":"2014-09-09 20:57:49","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"8e812c67df1221001e02a3cf6bf26303","sys_updated_by":"swapnesh.patel","sys_created_on":"2014-08-08 20:54:50","used_by_discovery":"true","sys_name":"Windows - MySQL Configuration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"swapnesh.patel","ecc_queue_topic":"Powershell","sys_mod_count":"2","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_8e812c67df1221001e02a3cf6bf26303","ecc_queue_name":"Windows - MySQL Configuration","name":"Windows - MySQL Configuration","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information for identifying it in the CMDB, such as serial number and NICs.","host_classification":"false","sys_updated_on":"2020-02-10 17:07:22","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"7","ecc_queue_source":"","sys_id":"8e8d62060a0a0baa0a9b38b69341a321","sys_updated_by":"christopher.thompson","sys_created_on":"2009-12-14 18:57:28","used_by_discovery":"true","sys_name":"Linux - Identity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"MultiProbe","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_multi_8e8d62060a0a0baa0a9b38b69341a321","ecc_queue_name":"Linux - Identity","name":"Linux - Identity","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve running processes","host_classification":"false","sys_updated_on":"2024-10-17 21:19:25","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"2","ecc_queue_source":"","sys_id":"8ef5a7990a0a0ba5007a9d00e48e5e00","sys_updated_by":"now.discovery_infra","sys_created_on":"2008-11-12 04:29:25","used_by_discovery":"true","sys_name":"Windows - Active Processes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"71","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    procs: [],\n    proclist: [],\n    pidToProc: {},\n    pidToCreationDate: {},\n    ppidReplacement: {},\n    procsInCycle: {},\n\n    /**\n     * Runs the probe instance\n     */\n    process: function() {\n        this.proclist = g_array_util.ensureArray(output.Win32_Process);\n\n        for (var i = 0; i < this.proclist.length; i++) {\n            var wp = this.proclist[i];\n\n            var procDef = {};\n            procDef.pid = wp.ProcessId;\n            procDef.ppid = wp.ParentProcessId;\n            procDef.name = wp.Name;\n            procDef.parameters = JSUtil.notNil(wp.CommandLine) ? ('' + wp.CommandLine).trim() : '';\n            procDef.command = JSUtil.nil(wp.ExecutablePath) ? wp.Name : ('' + wp.ExecutablePath).trim();\n\n            if (wp.Name == \"System Idle Process\")\n                procDef.ppid = \"99999\" + wp.ParentProcessId;\n\n            this.procs.push(procDef);\n            this.pidToProc[procDef.pid] = procDef;\n            this.pidToCreationDate[procDef.pid] = '' + wp.CreationDate;\n        }\n\n        this.findCycles();\n        this.replacePPIDs();\n\n        try {\n            var rpf = this.getParameter(\"running_process_filter\");\n            if (rpf) {\n\t\t\t\t// There's both a Java and JavaScript implementation of process filtering. The Java\n\t\t\t\t// version is significantly faster so it's preferred and is what's used OOB.\n\t\t\t\t// The JavaScript version is shipped in case there's a bug in the Java version. If\n\t\t\t\t// there is a bug in the Java version then chances are good the JavaScript version\n\t\t\t\t// has the same bug, but the difference is that the JavaScript version can be fixed\n\t\t\t\t// and tested on a customer instance, providing immediate relief.\n\t\t\t\t// Switch to the JavaScript version by simply activating the MID script include\n\t\t\t\t// record named \"RunningProcessesFilter\".\n\t\t\t\t// IMPORTANT: Any fixes in this script need to be replicated in the Java code in\n\t\t\t\t// the RunningProcessFilterEvaluatorModule.\n\t\t\t\ttry {\n\t\t\t\t\tvar filtering = new RunningProcessesFilter();\n\t\t\t\t\tvar filterDefs = JSON.parse(rpf);\n\t\t\t\t\tthis.procs = filtering.filterResults(this.procs, filterDefs);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Doing this in the catch() makes it seem like this is fallback code when it's really\n\t\t\t\t\t// the preferred code path. Unfortunately we don't have a good way to know if someone\n\t\t\t\t\t// has activated the JavaScript (the real fallback) unless we try to use it.\n\t\t\t\t\tvar evaluator = Packages.com.snc.discovery.runningprocess.api.RunningProcessFilterEvaluatorJSProvider.get();\n\t\t\t\t\tthis.procs = JSON.parse(evaluator.filter(rpf, this.procs));\n\t\t\t\t}\n            }\n        } catch (e) {\n            if (typeof ms != 'undefined')\n                ms.log(\"Windows - Active Processes: Something went wrong while trying to filter processes. Error=\" + e);\n            else\n                // If we don't have access to ms, we are not on the MID\n                // Which means we are in classic mode:\n                DiscoveryLogger.warn(\"Unix - Active Processes: Process filtering skipped. Classic mode is not supported.\");\n        }\n        /*\n        \tCurrent is a global variable which is expected to hold a stringify JSON.\n        \tIt works for a subprobe while g_probe.setPostProcessOutput() did not work.\n        \tThe result of the probe would look like\n        \t<result>\n        \t\t<output>{\"current\": <current value> }\n        \t\t</output>\n        \t</result>\n        */\n        current = this.procs;\n    },\n\n    /*\n     * Detect the processes that have PPID that eventually point themselves in a cycle.\n     * According to MDSN (http://msdn.microsoft.com/en-us/library/aa394372(v=vs.85).aspx),\n     * MS OS would reuse a PID that was previously a process that's a parent of others.\n     * This results in an issue that we end up getting processes in a circle, but the reality is that\n     * there is actually a root. \n     */\n    findCycles: function() {\n        for (var i = 0; i < this.procs.length; i++) {\n            var proc = this.procs[i];\n            if (this.procsInCycle[proc.pid])\n                continue;\n\n            this.detectCycle(proc, []);\n        }\n    },\n\n    /*\n     * Once we know all the PPIDs that was re-used for a new process, we replace all the PPIDs\n     * that is still pointing to the old PID by prefixing them with \"99999\" in order to distinguish it from\n     * the new process. We do it here because it's possible that some other processes (not in the cycle) \n     * also has the old PPID. \n     */\n    replacePPIDs: function() {\n        for (var i = 0; i < this.procs.length; i++) {\n            var proc = this.procs[i];\n            if (this.ppidReplacement[proc.ppid])\n                proc.ppid = \"99999\" + proc.ppid;\n        }\n    },\n\n    detectCycle: function(proc, visited) {\n        var cycleStart = -1;\n        for (var i = 0; i < visited.length; i++) {\n            if (visited[i] == proc.pid) {\n                cycleStart = i;\n                break;\n            }\n        }\n\n        if (cycleStart > -1) { // We have a cycle.      \n            var smallestCD = this.pidToCreationDate[proc.pid];\n            var eldestPid = proc.pid;\n\n            for (var i = cycleStart; i < visited.length; i++) {\n                var pid = visited[i];\n                this.procsInCycle[pid] = true; // Remember the ones we've already found in a cycle              \n                var cd = this.pidToCreationDate[pid];\n                if (cd < smallestCD) {\n                    smallestCD = cd;\n                    eldestPid = pid;\n                }\n            }\n\n            // Mark the PPIDs that we need repalce\n            var a_proc = this.pidToProc[eldestPid];\n            this.ppidReplacement[a_proc.ppid] = true;\n            return;\n        }\n\n        var parent = this.pidToProc[proc.ppid];\n        if (parent) {\n            // If the parent is a process tht was previously detected to be in a cycle, \n            // we can be rest assured there's no way it's going to be in a cycle with current child process.\n            if (this.procsInCycle[proc.pid])\n                return;\n\n            visited.push(proc.pid);\n            this.detectCycle(parent, visited);\n        }\n    },\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_wmi_8ef5a7990a0a0ba5007a9d00e48e5e00","ecc_queue_name":"WMI: Active Processes","name":"Windows - Active Processes","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information for identifying it in the CMDB, such as serial number and NICs.","host_classification":"false","sys_updated_on":"2012-11-07 07:05:11","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"","ecc_queue_source":"","sys_id":"8f64dd100a0a0baa61fbb3161da04b5f","sys_updated_by":"aleck.lin","sys_created_on":"2009-12-14 22:52:49","used_by_discovery":"true","sys_name":"HP-UX - Identity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"MultiProbe","sys_mod_count":"6","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_multi_8f64dd100a0a0baa61fbb3161da04b5f","ecc_queue_name":"HP-UX - Identity","name":"HP-UX - Identity","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information for identifying it in the CMDB, such as serial number and NICs.","host_classification":"false","sys_updated_on":"2015-08-27 22:18:09","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"1","ecc_queue_source":"","sys_id":"8f6552de0a0a0baa162708e8abb3bcc0","sys_updated_by":"josh.gerbasi","sys_created_on":"2009-12-14 22:53:19","used_by_discovery":"true","sys_name":"AIX - Identity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"MultiProbe","sys_mod_count":"9","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_multi_8f6552de0a0a0baa162708e8abb3bcc0","ecc_queue_name":"AIX - Identity","name":"AIX - Identity","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information for identifying it in the CMDB, such as serial number and NICs.","host_classification":"false","sys_updated_on":"2019-04-12 21:10:46","type":"Java","sys_class_name":"discovery_probes_multi","minor_version":"4","ecc_queue_source":"","sys_id":"8f65e14e0a0a0baa2f810452d276ab62","sys_updated_by":"brandon.chiem","sys_created_on":"2009-12-14 22:53:56","used_by_discovery":"true","sys_name":"Solaris - Identity","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"MultiProbe","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_multi_8f65e14e0a0a0baa2f810452d276ab62","ecc_queue_name":"Solaris - Identity","name":"Solaris - Identity","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Uses SNMP to learn about UPS","host_classification":"false","sys_updated_on":"2012-11-12 00:22:07","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"","ecc_queue_source":"","sys_id":"8fa755870a0a0b0200a5dade609100a9","sys_updated_by":"aleck.lin","sys_created_on":"2008-11-03 19:31:50","used_by_discovery":"true","sys_name":"SNMP UPS","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SNMP","sys_mod_count":"34","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_snmp_8fa755870a0a0b0200a5dade609100a9","ecc_queue_name":"SNMP - UPS","name":"SNMP - UPS","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather disk information from Mac OS X machines.","host_classification":"false","sys_updated_on":"2016-08-16 21:45:36","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"9252356d0a0a0bbe00ffa15a47abbdea","sys_updated_by":"greg.grisco","sys_created_on":"2008-11-12 20:09:00","used_by_discovery":"true","sys_name":"Mac OS X - Disks","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"18","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_9252356d0a0a0bbe00ffa15a47abbdea","ecc_queue_name":"system_profiler SPSerialATADataType SPSASDataType SPFireWireDataType -xml","name":"Mac OS X - Disks","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Gather OS revision information from Mac OS X machines.","host_classification":"false","sys_updated_on":"2012-11-04 14:50:53","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"929f7bfc0a0a0bbe002db397baf0a8f0","sys_updated_by":"tom.dilatush","sys_created_on":"2008-11-12 21:33:24","used_by_discovery":"true","sys_name":"Mac OS X - OS Revision","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"19","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_929f7bfc0a0a0bbe002db397baf0a8f0","ecc_queue_name":"system_profiler SPSoftwareDataType -xml","name":"Mac OS X - OS Revision","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information to classify the type of SNMP device","host_classification":"true","sys_updated_on":"2019-04-15 09:58:34","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"0","ecc_queue_source":"","sys_id":"930a60500a0a0b61006f83edd300f689","sys_updated_by":"oron.subayi","sys_created_on":"2008-11-03 17:58:47","used_by_discovery":"true","sys_name":"SNMP - Classify","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SNMP","sys_mod_count":"38","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"5","sys_update_name":"discovery_probes_snmp_930a60500a0a0b61006f83edd300f689","ecc_queue_name":"SNMP - Classify","name":"SNMP - Classify","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve Mac OS X installed software","host_classification":"false","sys_updated_on":"2012-11-07 07:11:08","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"93754c1a0a0a0bbe008b08bd26115750","sys_updated_by":"aleck.lin","sys_created_on":"2008-11-13 01:30:33","used_by_discovery":"true","sys_name":"Mac OS X - Installed Software","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"6","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_93754c1a0a0a0bbe008b08bd26115750","ecc_queue_name":"system_profiler SPApplicationsDataType -xml","name":"Mac OS X - Installed Software","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Retrieve active connections infomation with powershell remoting","host_classification":"false","sys_updated_on":"2018-06-19 10:10:31","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"2","ecc_queue_source":"","sys_id":"94e843b49f321300ed6191aec32e705e","sys_updated_by":"yair.leibkowiz","sys_created_on":"2018-06-17 13:51:24","used_by_discovery":"true","sys_name":"Windows - Active Connections Session","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"yair.leibkowiz","ecc_queue_topic":"WMIRunner","sys_mod_count":"46","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n    \nrun : function() {   \t\n\t\t// Define global objects for use by subclass \n\t\tcurrent = {};\n\t\trelated_data = {};\n\n\t\t// If WMIRunner probe, convert the xml output to json before processing\n\t\tif (this.getParameter('topic') == 'WMIRunner') {\n\t\t\tvar xmlHelper = new XMLHelper();\n\t\t\tvar xmlResult = xmlHelper.toObject(output);\t\n\t\t\tif (!JSUtil.nil(xmlResult))\n\t\t\t\toutput = xmlResult;\n\t\t}\n\t\t\n\t\t// Class appropriate subclass postProcess\n    \tthis.process();\n        \n\t\tvar result = {};\n\t\t// If we have any logs, add it to the output\n\t\tif (this.logs.length > 0) {\n\t\t\tresult.logs = this.logs;\n\t\t}\n\t\t\n\t\t// If empty, do not set current\n\t\tif (!JSUtil.isEmpty(current))\n\t\t\tresult.current = current;\n\t\t\n\t\t// If empty, do not set related_data\n\t\tif (!JSUtil.isEmpty(related_data)) \n\t\t\tresult.related_data = related_data;\n\t\t\t\t\n    \t// Compare results with cache and send back json response\n    \tg_probe.setPostProcessOutput(result.current.processes);\n    },\t\n\t/**\n     * Runs the probe instance\n     */    \n    process : function() { \n\t\tvar os = g_array_util.ensureArray(output.Win32_OperatingSystem);\n        var Win32_os = os[0];\n\t\tvar Win32_osName = Win32_os.Name;\n\t\t\n\t\tvar host = this.getParameter('source');\n\t\tvar provider = new Packages.com.snc.sw.providers.wmi.WMIProviderImpl();\n\t\t\n\t\ttry {\n\t\t\tprovider.setHost(host);\n\t\t\tif (Win32_osName.indexOf('Windows 2000') != -1) {\n\t\t\t\tcurrent.processes = provider.executeCommand('netstat.exe -anp TCP');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcurrent.processes = provider.executeCommand('netstat.exe -anop TCP');\n\t\t\t}\n\t\t}\n\t\tfinally {\n\t\t\tprovider.closeSession();\n\t\t}\n\t}\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_wmi_94e843b49f321300ed6191aec32e705e","ecc_queue_name":"WMI: ActiveConnections","name":"Windows - Active Connections Session","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Probe to get information from vCenter about ESX hosts, resource pools, and virtual machines.  Implementation details for this probe are located in a MID server script include called VMWarevCenterProbe.","host_classification":"false","sys_updated_on":"2010-11-28 21:00:05","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"95e96f24c0a8019a15cccba63c35846a","sys_updated_by":"jimmy.yuan","sys_created_on":"2010-08-21 18:29:51","used_by_discovery":"true","sys_name":"VMWare - vCenter","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"jimmy.yuan","ecc_queue_topic":"VMWareProbe","sys_mod_count":"7","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_95e96f24c0a8019a15cccba63c35846a","ecc_queue_name":"VMWarevCenterProbe","name":"VMWare - vCenter","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve CPU/memory information from Mac OS X machines.","host_classification":"false","sys_updated_on":"2012-11-07 07:12:39","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"99e8bf8c0a0a0aa300da01b923b74bbb","sys_updated_by":"aleck.lin","sys_created_on":"2007-03-28 18:57:19","used_by_discovery":"true","sys_name":"Mac OS X - CPU / Memory","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"16","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_99e8bf8c0a0a0aa300da01b923b74bbb","ecc_queue_name":"system_profiler SPHardwareDataType SPMemoryDataType -xml","name":"Mac OS X - CPU / Memory","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve OS version","host_classification":"false","sys_updated_on":"2012-11-07 06:58:39","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"9f2b308d0a0a146700408d6e1cd354f7","sys_updated_by":"aleck.lin","sys_created_on":"2007-02-08 02:25:12","used_by_discovery":"true","sys_name":"AIX - OS Release","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"9","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_9f2b308d0a0a146700408d6e1cd354f7","ecc_queue_name":"oslevel","name":"AIX - OS Release","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve computer model","host_classification":"false","sys_updated_on":"2012-11-07 06:58:31","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"9f52e2e50a0a146700093a064d8365f8","sys_updated_by":"aleck.lin","sys_created_on":"2007-02-08 03:08:33","used_by_discovery":"true","sys_name":"AIX - Hardware Model","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_9f52e2e50a0a146700093a064d8365f8","ecc_queue_name":"lsattr -El sys0 -a modelname -F value","name":"AIX - Hardware Model","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Uses SNMP to learn about printers (or other devices that can also print).","host_classification":"false","sys_updated_on":"2012-11-12 00:21:39","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"","ecc_queue_source":"","sys_id":"9fae20c20ab3015500df8aef0b29c58c","sys_updated_by":"aleck.lin","sys_created_on":"2008-11-03 19:26:51","used_by_discovery":"true","sys_name":"SNMP - Printing","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SNMP","sys_mod_count":"31","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_snmp_9fae20c20ab3015500df8aef0b29c58c","ecc_queue_name":"SNMP - Printing","name":"SNMP - Printing","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Send a SOAP request","host_classification":"false","sys_updated_on":"2010-11-28 20:54:11","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"a152c4d40a0a0b5e009be973b683d69e","sys_updated_by":"jimmy.yuan","sys_created_on":"2008-03-12 04:49:58","used_by_discovery":"false","sys_name":"SOAPProbe","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SOAPProbe","sys_mod_count":"10","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_a152c4d40a0a0b5e009be973b683d69e","ecc_queue_name":"","name":"SOAPProbe","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Run a command that is expected to take a long time","host_classification":"false","sys_updated_on":"2012-03-16 16:41:45","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"a257c00e0a0a0b6600260fb83588ccad","sys_updated_by":"ben.yukich","sys_created_on":"2008-06-19 19:40:37","used_by_discovery":"false","sys_name":"Example Long Running Cmd","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommandLong","sys_mod_count":"13","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_a257c00e0a0a0b6600260fb83588ccad","ecc_queue_name":"cd /;du -sk *","name":"Example Long Running Cmd","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Determine network interfaces, IPs, and MACs","host_classification":"false","sys_updated_on":"2015-08-27 22:18:15","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"a2ae6646a9fe156100a4898898e81c16","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-02-08 18:47:22","used_by_discovery":"true","sys_name":"AIX - Network","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"16","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_a2ae6646a9fe156100a4898898e81c16","ecc_queue_name":"/etc/ifconfig -au; netstat -in","name":"AIX - Network","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Uses SNMP to learn about routers","host_classification":"false","sys_updated_on":"2012-11-12 00:21:48","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"","ecc_queue_source":"","sys_id":"a2bada940a0a0b6100d5e020a828fdeb","sys_updated_by":"aleck.lin","sys_created_on":"2008-11-03 19:29:53","used_by_discovery":"true","sys_name":"SNMP - Routing","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SNMP","sys_mod_count":"36","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_snmp_a2bada940a0a0b6100d5e020a828fdeb","ecc_queue_name":"SNMP - Routing","name":"SNMP - Routing","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Determine the OS processors","host_classification":"false","sys_updated_on":"2012-11-07 06:56:01","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"a7117dcca9fe156100afbcd624901028","sys_updated_by":"aleck.lin","sys_created_on":"2007-02-09 15:14:05","used_by_discovery":"true","sys_name":"AIX - CPU","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"9","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_a7117dcca9fe156100afbcd624901028","ecc_queue_name":"sh ${file:cpus.sh}","name":"AIX - CPU","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve active connections infomation","host_classification":"false","sys_updated_on":"2017-11-27 22:10:43","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"a87444cc0a0a0b6b0039d2d8d4f2b7c8","sys_updated_by":"benjamin.phan","sys_created_on":"2008-01-23 21:01:07","used_by_discovery":"true","sys_name":"Unix - Active Connections","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"24","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {    \n\t\t// parse the results from our lsof output, leaving the result in result.current.connections...\n\t\tvar lp = new LSOFParser();\n\t\tlp.parse(output);\n\t\trelated_data.connections = lp.tcp;\n\t\trelated_data.isValid = lp.isValid;\n\t\trelated_data.error_string = lp.errorString;\n    },\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_a87444cc0a0a0b6b0039d2d8d4f2b7c8","ecc_queue_name":"sudo lsof -iTCP -n -P -F pcnfT","name":"Unix - Active Connections","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"","host_classification":"false","sys_updated_on":"2016-12-16 23:11:25","type":"Java","sys_class_name":"automation_pipeline","minor_version":"0","ecc_queue_source":"","sys_id":"ab4536e43b3322002dc9239434efc4ca","sys_updated_by":"marjan","sys_created_on":"2016-12-16 22:16:21","used_by_discovery":"true","sys_name":"Subnet Probe","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"marjan.marzban","ecc_queue_topic":"CommandPipeline","sys_mod_count":"1","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"automation_pipeline_ab4536e43b3322002dc9239434efc4ca","ecc_queue_name":"Subnet Probe","name":"Subnet Probe","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Uses Simple Network Management Protocol to learn about Netware OS.","host_classification":"false","sys_updated_on":"2016-08-16 21:46:58","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"1","ecc_queue_source":"","sys_id":"ad30a7a80a0a0b3a0042e95fa89e2a4a","sys_updated_by":"greg.grisco","sys_created_on":"2008-11-18 01:22:06","used_by_discovery":"true","sys_name":"SNMP - Netware","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SNMP","sys_mod_count":"34","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_snmp_ad30a7a80a0a0b3a0042e95fa89e2a4a","ecc_queue_name":"SNMP - Netware","name":"SNMP - Netware","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Uses SNMP to learn about APC UPSs.","host_classification":"false","sys_updated_on":"2012-11-07 07:15:38","type":"Java","sys_class_name":"discovery_probes_snmp","minor_version":"","ecc_queue_source":"","sys_id":"b0355ee40ab3015600b2151338792f2e","sys_updated_by":"aleck.lin","sys_created_on":"2008-11-03 19:13:46","used_by_discovery":"true","sys_name":"SNMP APC UPS","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SNMP","sys_mod_count":"37","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_snmp_b0355ee40ab3015600b2151338792f2e","ecc_queue_name":"SNMP - APC UPS","name":"SNMP - APC UPS","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve hardware information, such as serial numbers","host_classification":"false","sys_updated_on":"2020-02-10 17:30:38","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"1","ecc_queue_source":"","sys_id":"b0fc08860a0a0baa005952556d837e18","sys_updated_by":"christopher.thompson","sys_created_on":"2008-11-18 19:03:44","used_by_discovery":"true","sys_name":"Windows - Hardware Information","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"19","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {  \n        var snm = new SerialNumberManager();\n        if (JSUtil.notNil(output.Win32_ComputerSystemProduct.IdentifyingNumber))\n            snm.add('system', output.Win32_ComputerSystemProduct.IdentifyingNumber);\n        if (JSUtil.notNil(output.Win32_ComputerSystemProduct.UUID))\n            snm.add('uuid', output.Win32_ComputerSystemProduct.UUID);\n        if (JSUtil.notNil(output.Win32_SystemEnclosure.SerialNumber))\n            snm.add('chassis', output.Win32_SystemEnclosure.SerialNumber);\n        if (JSUtil.notNil(output.Win32_BIOS.SerialNumber))\n            snm.add('bios', output.Win32_BIOS.SerialNumber);\n        if (JSUtil.notNil(output.Win32_BaseBoard.SerialNumber))\n            snm.add('baseboard', output.Win32_BaseBoard.SerialNumber);\n\n        related_data.srlArr = snm.getSerialsForCIData();\n        if (JSUtil.notNil(related_data.srlArr))\n\t\t\trelated_data.serial_array = snm.getSerialArray();\n        if (JSUtil.notNil(output.Win32_SystemEnclosure.ChassisTypes))\n            related_data.chassis_type = this.getChassisType(output.Win32_SystemEnclosure.ChassisTypes);\n    },\n\n    getChassisType: function(index) {\n        var types = [\"Other\", \"Unknown\", \"Desktop\", \"Low Profile Desktop\", \"Pizza Box\", \n                     \"Mini Tower\", \"Tower\", \"Portable\", \"Laptop\", \"Notebook\", \"Hand Held\", \n                     \"Docking Station\", \"All in One\", \"Sub Notebook\", \"Space-Saving\", \n                     \"Lunch Box\", \"Main System Chassis\", \"Expansion Chassis\", \"SubChassis\", \n                     \"Bus Expansion Chassis\", \"Peripheral Chassis\", \"Storage Chassis\", \n                     \"Rack Mount Chassis\", \"Sealed-Case PC\"];\n        return types[index - 1];\n    },\n    \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_wmi_b0fc08860a0a0baa005952556d837e18","ecc_queue_name":"WMI: Hardware Information","name":"Windows - Hardware Information","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information to classify the version of Windows","host_classification":"true","sys_updated_on":"2020-03-12 10:10:04","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"0","ecc_queue_source":"","sys_id":"b11360600a0a0ba500c41bcbae55c5c4","sys_updated_by":"benjamin.phan","sys_created_on":"2008-11-18 19:28:36","used_by_discovery":"true","sys_name":"Windows - Classify","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"15","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"5","sys_update_name":"discovery_probes_wmi_b11360600a0a0ba500c41bcbae55c5c4","ecc_queue_name":"WMI: Classify","name":"Windows - Classify","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve memory information","host_classification":"false","sys_updated_on":"2014-10-07 22:11:39","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"1","ecc_queue_source":"","sys_id":"b141fd470a0a0ba5001d3c32c7d834fb","sys_updated_by":"josh.gerbasi","sys_created_on":"2008-11-18 20:19:31","used_by_discovery":"true","sys_name":"Windows - CPU / Memory","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"20","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {  \n\t\tvar processors = g_array_util.ensureArray(output.Win32_Processor);\n        var Win32_Processor = processors[0];\n\n        if (JSUtil.notNil(Win32_Processor.Name))\n            current.cpu_name = Win32_Processor.Name;\n        if (JSUtil.notNil(Win32_Processor.MaxClockSpeed))\n            current.cpu_speed = Win32_Processor.MaxClockSpeed;\n\n        if (JSUtil.notNil(Win32_Processor.Manufacturer))\n\t\t    current.cpu_type = Win32_Processor.Manufacturer;\n        if (processors.length > 0)\n            current.cpu_count = processors.length;\n\t\t\n\t\tvar cpuCoreCount;\n\t\tvar logicalProcessors;\t\t\n\t\tcpuCoreCount = parseInt(Win32_Processor.NumberOfCores);\n\t\tlogicalProcessors = parseInt(Win32_Processor.NumberOfLogicalProcessors);\n\n        if (JSUtil.notNil(cpuCoreCount) && cpuCoreCount > 0) {\n            current.cpu_core_count = cpuCoreCount;\t\t\n            if (JSUtil.notNil(logicalProcessors) && logicalProcessors > 0)\n                current.cpu_core_thread = logicalProcessors/cpuCoreCount;\n        }\n\n        var mem_modules = g_array_util.ensureArray(output.Win32_PhysicalMemory);\n        var moduleArray = [];\n        var total_memory = 0;\n        for (var i = 0; i < mem_modules.length; i++) {\n            var Win32_PhysicalMemory = mem_modules[i];\n            var module = {};\n            \n            module.name             = Win32_PhysicalMemory.Tag;\n            module.bank_label       = Win32_PhysicalMemory.BankLabel;\n            module.capacity         = parseFloat(Win32_PhysicalMemory.Capacity) / 1048576;\n            module.data_width       = Win32_PhysicalMemory.DataWidth;\n            module.form_factor      = this.getMemoryFormFactor(Win32_PhysicalMemory.FormFactor);\n            module.device_locator   = Win32_PhysicalMemory.DeviceLocator;\n            module.manufacturer     = Win32_PhysicalMemory.Manufacturer;\n            module.part_number      = Win32_PhysicalMemory.PartNumber;\n            module.serial_number    = Win32_PhysicalMemory.SerialNumber;\n            module.speed            = Win32_PhysicalMemory.Speed;\n            module.module_status    = Win32_PhysicalMemory.Status;\n            module.total_width      = Win32_PhysicalMemory.TotalWidth;\n            module.type             = this.getMemoryType(Win32_PhysicalMemory.MemoryType);\n            module.type_detail      = this.getMemoryTypeDetail(Win32_PhysicalMemory.TypeDetail);\n            \n            total_memory += (parseFloat(Win32_PhysicalMemory.Capacity) / 1048576);\n            moduleArray.push(module);\n        }\n\n        related_data.module_array = moduleArray;\n        if (JSUtil.notNil(total_memory))\n             current.ram = total_memory;\n    },\n\n    getMemoryFormFactor: function(key) {\n        var ffArray = ['Unknown', 'Other', 'SIP', 'DIP',\n                       'ZIP', 'SOJ', 'Proprietary', 'SIMM',\n                       'DIMM', 'TSOP', 'PGA', 'RIMM',\n                       'SODIMM', 'SRIMM', 'SMD', 'SSMP',\n                       'QFP', 'TQFP', 'SOIC', 'LCC',\n                       'PLCC', 'BGA', 'FFBGA', 'LGA'];\n        return ffArray[key];\n    },\n    \n    getMemoryType: function(key) {\n        var mtArray = ['Unknown', 'Other', 'DRAM', 'Synchronous DRAM',\n                       'Cache DRAM', 'EDO', 'EDRAM', 'VRAM',\n                       'SRAM', 'RAM', 'ROM', 'Flash',\n                       'EEPROM', 'FEPROM', 'EPROM', 'CDRAM', \n                       '3DRAM', 'SDRAM', 'SGRAM', 'RDRAM',\n                       'DDR', 'DDR2', 'DDR3'];\n        return mtArray[key];\n    },\n    \n    getMemoryTypeDetail: function(key) {\n        var tdHash = {1:'Reserved', 2:'Other', 4:'Unknown', 8:'Fast-paged',\n                      16:'Static column', 32:'Pseudo-static', 64:'RAMBUS', 128:'Synchronous',\n                      256:'CMOS', 512:'EDO', 1024:'Window DRAM', 2048:'Cache DRAM',\n                      4096:'Nonvolatile'\n                     };\n        return tdHash[key];\n    },\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_wmi_b141fd470a0a0ba5001d3c32c7d834fb","ecc_queue_name":"WMI: CPU / Memory","name":"Windows - CPU / Memory","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve memory information","host_classification":"false","sys_updated_on":"2016-03-15 22:47:35","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"b577856b0a00002d005798ea7529a40b","sys_updated_by":"greg.grisco","sys_created_on":"2007-07-11 13:28:35","used_by_discovery":"true","sys_name":"AIX - Memory","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"6","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_b577856b0a00002d005798ea7529a40b","ecc_queue_name":"sh ${file:memory.sh}","name":"AIX - Memory","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"A probe for testing SSH using the Configuration Mutator.","host_classification":"false","sys_updated_on":"2012-10-20 19:07:39","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"b6cca0009711300010cb1bd74b29754b","sys_updated_by":"tom.dilatush","sys_created_on":"2012-10-20 19:07:39","used_by_discovery":"false","sys_name":"SSHTestCommand","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"SSHTestCommand","sys_mod_count":"0","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_b6cca0009711300010cb1bd74b29754b","ecc_queue_name":"uname -a","name":"SSHTestCommand","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Javascript probe","host_classification":"false","sys_updated_on":"2010-11-28 20:52:43","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"bc2279d50ad3370900933bcb76ad8f7a","sys_updated_by":"jimmy.yuan","sys_created_on":"2009-11-03 22:20:35","used_by_discovery":"false","sys_name":"JavascriptProbe","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.bow","ecc_queue_topic":"JavascriptProbe","sys_mod_count":"6","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_bc2279d50ad3370900933bcb76ad8f7a","ecc_queue_name":"","name":"JavascriptProbe","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve OS patch level","host_classification":"false","sys_updated_on":"2012-11-07 06:58:42","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"bd75ef7b0a00002d003ca1dfd66a0b1b","sys_updated_by":"aleck.lin","sys_created_on":"2007-07-13 02:43:49","used_by_discovery":"true","sys_name":"AIX - OS Revision","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"6","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_bd75ef7b0a00002d003ca1dfd66a0b1b","ecc_queue_name":"oslevel -r","name":"AIX - OS Revision","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve OS filesystem\r\n\r\nProbe parameter use_terminal (when true) is used to prevent lingering processes that result from bad network mounts.","host_classification":"false","sys_updated_on":"2014-10-07 22:08:13","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"bd7f3a7a0a00002d0051caaec62f1cc6","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-07-13 02:53:58","used_by_discovery":"true","sys_name":"UNIX - OS Filesystems","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"josh.gerbasi","ecc_queue_topic":"SSHCommand","sys_mod_count":"30","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n\n    process : function() {\n\t\tvar lines = output.split(/\\n/);\n\n\t\t// no results\n\t\tif (lines.length == 0)\n\t\t\treturn;\n\n\t\trelated_data.fileSystems = {};\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t    var line = lines[i].trim();\n            // handle the case where one of our data lines was split because the name was too long...\n            if (line.indexOf(' ') < 0) {\n                if ((i + 1 < lines.length) && (lines[i + 1].charAt(0) == ' ')) {\n                    i++;\n                    line = line + ' ' + lines[i].trim();\n                }\n            }\n\n\t\t    // neither local nor remote (cifs/nfs)\n            if (!line.startsWith('/dev/') && !line.startsWith('//') && line.indexOf(':') === -1)\n                continue;\n\n            var parts = line.split(/\\s+/);\n            related_data.fileSystems[parts[5]] = {};\n            related_data.fileSystems[parts[5]].name = parts[0];\n            related_data.fileSystems[parts[5]].capacity = Math.round(parseInt(parts[1]) / 1024);\n            related_data.fileSystems[parts[5]].available_space = Math.round(parseInt(parts[3]) / 1024);\n\t\t}\n\t},\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_bd7f3a7a0a00002d0051caaec62f1cc6","ecc_queue_name":"df -kP","name":"UNIX - OS Filesystems","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather Mongodb version information","host_classification":"false","sys_updated_on":"2020-03-17 17:39:41","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"bf9baaa1ef1221007f04b25495c0fb76","sys_updated_by":"benjamin.phan","sys_created_on":"2014-08-03 01:48:54","used_by_discovery":"true","sys_name":"Windows - MongoDB Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"jing.yang","ecc_queue_topic":"WindowsCommand","sys_mod_count":"18","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t/**\n     * Runs the probe instance\n     */\n\tprocess : function() {\n        var lines = output.split(\"\\n\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n            var line = lines[i];\n\n            if (line.indexOf(\"db version \") > -1) {\n\t\t\t\tvar matches = line.match(/db version v([\\d\\w.]+)/);\n\t\t\t\tif (matches)\n\t\t\t\t\tcurrent.version = matches[1];\n            } \n\t\t}\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});\t\n\t","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_bf9baaa1ef1221007f04b25495c0fb76","ecc_queue_name":"WindowsCommand: Get MongoDB Version","name":"Windows - MongoDB Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Determine the OS processors","host_classification":"false","sys_updated_on":"2016-06-27 18:22:01","type":"Java","sys_class_name":"discovery_probes","minor_version":"4","ecc_queue_source":"","sys_id":"c7623b68a9fe1561006b8a2ad5a90231","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-02-15 21:50:08","used_by_discovery":"true","sys_name":"Linux - CPU","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"16","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {\n\t\tvar lines = output.split(\"\\n\");\n\t\t\n\t\t// no results\n\t\tif (lines.length == 0)\n\t\t\treturn;\n\t\t\n\t\tvar processors = 0;\n        var physicalIds = {}; // Keep track of physical ids for an accurate count of CPUs\n        physicalIds.count = 0;\n        var coreIds = {}; // Keep track of core ids for an accurate count cores\n        coreIds.count = 0;\n\t\tvar cpu_cores = 0;\n\t\tvar physical_id_in_curr_block = '';\n\n        for (var i = 0; i < lines.length; i++) {\n            var line = lines[i];\n            if (line == '') \n                continue;\n\n            var parts = line.split(\":\");\n\t\t\t\n\t\t\tif (parts.length < 2)\n\t\t\t\tcontinue;\n\t\t\t\n            var name = parts[0].trim();\n            var value = parts[1].trim();\n\n\t\t\tif (name == \"processor\")\n\t\t\t\tprocessors++;\t\t\t\t\n            else if (name == \"cpu MHz\") {\n            \tvar cpu_speed = parseInt(value);\n                current.cpu_speed = (cpu_speed != Number.NaN ? cpu_speed : \"\");\n            } else if (name == \"physical id\") {\n\t\t\t\tphysical_id_in_curr_block = value;\n\t\t\t\tif (!physicalIds[value]) {\n               \t\tphysicalIds[value] = true;\n                \tphysicalIds.count++;\n                }\n            } else if (name == \"core id\" && !coreIds[physical_id_in_curr_block + '.' + value]) {\n                coreIds[physical_id_in_curr_block + '.' + value] = true;\n                coreIds.count++;\n            } else if (name == \"cpu cores\")\n\t\t\t\tcpu_cores = parseInt(value);\n            else if (name == \"model name\")\n\t\t\t\tcurrent.cpu_name = value;\n            else if (name == \"vendor_id\")\n                current.cpu_vendor = value;\n        }\n\n\t\t/**********************************************************\n\t\tHere are the assumptions how we're going to calculate CPU counts, core count and Hyperthreading...\n\t\t* Total number of \"processor\" is the multiplication of number of unique \"cpu cores\" and \n\t\t  of number of unique \"physic\" processors (based on physical_id)\n\t\t* Each \"physical id\" represents an actual CPU\n\t\t* Each \"physical id\" + \"core id\" combination is considered a unique cpu core\n\t\t* CPU core count is the number of cores per processor\n\t\t* If we get \"cpu cores\" then we use that instead as the number of cpu cores per processor\n\t\t* if total number of \"processors\" is twice the number of \"cpu cores\" times \"physical processors\", \n\t\t  then hyperthreading is enabled.\n\n\t\tOdd cases\n\t\t* If number of unique \"core id\" exceeds the number of \"cpu_core\", use the number of \"core id\" \n\t\t* divided by the number of processors to get core count per processor\n\t\t* For VMs, it doesn't have \"physical id\", \"core id\" or \"core count\". Its CPU count is based on number of processors\n\t\t*******************************************************/\n\t\t\n\t\tif (processors == 0) {\n\t\t\t// something's wrong here 'cause we didn't see a single procesor header! \n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// Calculate CPU count\n\t\tvar cpuCount = 1;\n\t\tif (physicalIds.count > 0) {\n\t\t\tcpuCount = physicalIds.count;\n\t\t\trelated_data.hasPhysicalId = true;\n\t\t} else\n\t\t\tcpuCount = processors;\n\t\t\n\t\tcurrent.cpu_count = cpuCount;\n\t\t\n\t\t// Calculate CPU core count\n\t\tvar cpuCoreCount = 1;\n\t\tif (coreIds.count > 0 || cpu_cores > 0) {\n\t\t\tif (cpu_cores > coreIds.count) \n\t\t\t\tcpuCoreCount = cpu_cores;\n\t\t\telse \n\t\t\t\tcpuCoreCount = coreIds.count / cpuCount;\t\t\t\n\t\t}\n\t\tcurrent.cpu_core_count = cpuCoreCount;\n\t\t\n\t\t// Determine hyperthreading. Theoretically, the number of processors should be exactly twice as many cpu * core/cpu.\n\t\t// But just in case there's some math error. We're manually setting this to 2 or 1\n\t\tif (processors > cpuCount * cpuCoreCount)\n\t\t\tcurrent.cpu_core_thread = 2;\n\t\telse\n\t\t\tcurrent.cpu_core_thread = 1;\n\t},\n   \n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_c7623b68a9fe1561006b8a2ad5a90231","ecc_queue_name":"cat /proc/cpuinfo","name":"Linux - CPU","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Runs a Windows Powershell script on the MID Server.  The Powershell script is provided as the value of a parameter with name ending in \".ps1\".  Two variables are available to the script:\r\n$computer - the computer pointed to as the \"source\" for this probe\r\n$cred - a Powershell credential using a user/password from the Credentials table that successfullly logs into $computer.","host_classification":"false","sys_updated_on":"2010-11-28 21:03:17","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"ca9edfec0a0a0baa011fe82922346887","sys_updated_by":"jimmy.yuan","sys_created_on":"2010-10-20 17:10:54","used_by_discovery":"false","sys_name":"Windows - Powershell","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"jimmy.yuan","ecc_queue_topic":"Powershell","sys_mod_count":"10","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_ca9edfec0a0a0baa011fe82922346887","ecc_queue_name":"Windows - Powershell","name":"Windows - Powershell","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve running processes","host_classification":"false","sys_updated_on":"2024-10-17 21:17:33","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"d1e11ba20a0a0b26008b521d6fed01fb","sys_updated_by":"now.discovery_infra","sys_created_on":"2009-07-31 17:35:06","used_by_discovery":"true","sys_name":"HP-UX - Active Processes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"19","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n    process: function() {\n        // parse the results from our ps output, leaving the result in sensor.running_processes...\n        var psop = new PsOutputParser();\n        var procs = psop.parse(output);\n        try {\n            var rpf = this.getParameter(\"running_process_filter\");\n            if (rpf) {\n\t\t\t\ttry {\n                    var filtering = new RunningProcessesFilter();\n                    var filterDefs = JSON.parse(rpf);\n                    procs = filtering.filterResults(procs, filterDefs);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tvar evaluator = Packages.com.snc.discovery.runningprocess.api.RunningProcessFilterEvaluatorJSProvider.get();\n\t\t\t\t\tprocs = JSON.parse(evaluator.filter(rpf, procs));\n\t\t\t\t}\n            }\n        } catch (e) {\n            if (typeof ms != 'undefined')\n                ms.log(\"HP-UX - Active Processes: Something went wrong while trying to filter processes. Error=\" + e);\n            else\n                // If we don't have access to ms, we are not on the MID\n                // Which means we are in classic mode:\n                DiscoveryLogger.warn(\"HP-UX - Active Processes: Process filtering skipped. Classic mode is not supported.\");\n        }\n\n        related_data.running_processes = procs;\n        related_data.error_msg = psop.error_msg;\n    },\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_d1e11ba20a0a0b26008b521d6fed01fb","ecc_queue_name":"ps -elx","name":"HP-UX - Active Processes","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Explore ESX host hardware: network adapters, disks, HBAs, FC ports, iSCSI and FC disks.\r\n\r\nThis probe's implementation is located in a MID server script include named VMWarevCenterESXHostsStorageProbe.\r\n","host_classification":"false","sys_updated_on":"2016-06-28 23:43:58","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"d272ab788f731200c2fe0b5437bdee89","sys_updated_by":"steve.francis","sys_created_on":"2016-06-02 00:00:46","used_by_discovery":"true","sys_name":"VMWare - vCenter ESX Hosts Storage","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"1","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_d272ab788f731200c2fe0b5437bdee89","ecc_queue_name":"VMWarevCenterESXHostsStorageProbe","name":"VMWare - vCenter ESX Hosts Storage","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather PostgreSQL version information","host_classification":"false","sys_updated_on":"2014-09-04 20:39:22","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"d4614800c33221002d031f051eba8f41","sys_updated_by":"amit.dhuleshia","sys_created_on":"2014-08-22 18:06:18","used_by_discovery":"true","sys_name":"PostgreSQL - Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"chris.nguyen","ecc_queue_topic":"SSHCommand","sys_mod_count":"1","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n\tprocess : function() {\n\t\tif (JSUtil.nil(output))\n\t\t\treturn;\n\t\t\n\t\tvar lines = output.split(\"\\n\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar line = lines[i];\n\t\t\t\n\t\t\t// expected: postgres (PostgreSQL) 8.4.20\n\t\t\tvar tokens = line.split(\" \");\n\t\t\t\n\t\t\tif (tokens && tokens.length == 3 && tokens[2])\n\t\t\t\tcurrent.version = tokens[2];\n\t\t}\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_d4614800c33221002d031f051eba8f41","ecc_queue_name":"${command} --version","name":"PostgreSQL - Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve information about the installed Microsoft SQL Server instances (2000, 2005, 2008, 2012) and associated databases.","host_classification":"false","sys_updated_on":"2017-02-16 10:41:11","type":"Java","sys_class_name":"discovery_probes","minor_version":"3","ecc_queue_source":"","sys_id":"de069b6d0a0a0b7800d600a7ff5a8724","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-10-26 20:35:39","used_by_discovery":"true","sys_name":"Windows - MSSQL","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"Powershell","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_de069b6d0a0a0b7800d600a7ff5a8724","ecc_queue_name":"Windows - MSSQL","name":"Windows - MSSQL","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve Windows installed software","host_classification":"false","sys_updated_on":"2020-03-16 18:28:52","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"0","ecc_queue_source":"","sys_id":"df4905820a0a0ba500b7ea51b460326c","sys_updated_by":"benjamin.phan","sys_created_on":"2008-10-15 01:18:29","used_by_discovery":"true","sys_name":"Windows - Installed Software","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"393","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n\t/**\n     * Runs the probe instance\n     */    \n\tprocess : function() {\n\t\trelated_data.packages = [];\n\t\t\n\t\tvar outputFormat = this.getParameter(\"output_format\");\n\t\tvar windowsSoftwareParser = (JSUtil.nil(outputFormat) || outputFormat != \"json\") ? new WindowsInstalledSoftwareLegacy() : new WindowsInstalledSoftware();\n\t\t\n\t\twindowsSoftwareParser.process(output, related_data);\n\t},\n\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"5","sys_update_name":"discovery_probes_wmi_df4905820a0a0ba500b7ea51b460326c","ecc_queue_name":"WMI: Installed Software","name":"Windows - Installed Software","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"A probe that is consists of command line execution of shell scripts after logging in via ssh","host_classification":"false","sys_updated_on":"2010-11-28 20:54:31","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"e07f03e8c0a800670196a29829b0e452","sys_updated_by":"jimmy.yuan","sys_created_on":"2007-01-02 01:49:17","used_by_discovery":"false","sys_name":"SSHCommand","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"14","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_e07f03e8c0a800670196a29829b0e452","ecc_queue_name":"","name":"SSHCommand","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Secure copy from one machine to another.  The copy is performed using the MID Server as a tunnel.","host_classification":"false","sys_updated_on":"2010-11-28 20:53:33","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"e07f4762c0a800670065db85f72bcaa7","sys_updated_by":"jimmy.yuan","sys_created_on":"2007-01-02 01:49:34","used_by_discovery":"false","sys_name":"SCPCommand","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SCPCommand","sys_mod_count":"11","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_e07f4762c0a800670065db85f72bcaa7","ecc_queue_name":"","name":"SCPCommand","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather log information from Mac OS X machines.","host_classification":"false","sys_updated_on":"2012-11-04 14:50:37","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"e0bc64980a0a0ba600450f07a092f525","sys_updated_by":"tom.dilatush","sys_created_on":"2009-01-16 18:38:09","used_by_discovery":"true","sys_name":"Mac OS X - Last User","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"21","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_e0bc64980a0a0ba600450f07a092f525","ecc_queue_name":"last | grep -m 1 console","name":"Mac OS X - Last User","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Resolves the DNS name of an IP address","host_classification":"false","sys_updated_on":"2012-11-07 06:57:51","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"e17dd23283001000dada83ec37d92982","sys_updated_by":"aleck.lin","sys_created_on":"2011-07-27 20:44:57","used_by_discovery":"true","sys_name":"DNS Name Resolver","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"tom.dilatush","ecc_queue_topic":"DNSNameResolver","sys_mod_count":"1","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_e17dd23283001000dada83ec37d92982","ecc_queue_name":"","name":"DNS Name Resolver","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Retrieve network printer information","host_classification":"false","sys_updated_on":"2012-11-07 07:24:13","type":"Java","sys_class_name":"discovery_probes_wmi","minor_version":"","ecc_queue_source":"","sys_id":"e2c966310a0a0ba50034ee1b8877a237","sys_updated_by":"aleck.lin","sys_created_on":"2008-10-11 01:53:50","used_by_discovery":"true","sys_name":"Windows - Printers","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"WMIRunner","sys_mod_count":"28","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_wmi_e2c966310a0a0ba50034ee1b8877a237","ecc_queue_name":"WMI: Printers","name":"Windows - Printers","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Determine Operating System","host_classification":"false","sys_updated_on":"2017-04-18 18:40:21","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"e5e075a2a9fe1561018f2a9636d5ec39","sys_updated_by":"steve.bandow","sys_created_on":"2007-02-21 19:56:37","used_by_discovery":"true","sys_name":"UNIX - OS","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"13","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_e5e075a2a9fe1561018f2a9636d5ec39","ecc_queue_name":"uname -a","name":"UNIX - OS","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Get network information","host_classification":"false","sys_updated_on":"2020-09-30 08:41:04","type":"Java","sys_class_name":"discovery_probes","minor_version":"7","ecc_queue_source":"","sys_id":"e643f2c2a9fe15610038fc84ebfc075a","sys_updated_by":"moiz.alibhayani","sys_created_on":"2007-02-21 21:45:17","used_by_discovery":"true","sys_name":"Linux - Network","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"67","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n    process: function() {\n        if (JSUtil.nil(output))\n            return;\n\n        var sliceIndex = output.indexOf('\\n');\n        if (sliceIndex === -1) {\n            g_probe.setError('Unexpected output: ' + output);\n            return;\n        }\n        var partsRegex;\n        var ipv4Regex;\n        var ipv6Regex;\n        var defaultGatewayRegex;\n        var getMacAddressFunction;\n        var isIprouteOutput;\n\t\t\n        if (output.startsWith('iproute output')) {\n            isIprouteOutput = true;\n            partsRegex = new RegExp(\"^\\\\d+:\\\\s+(\\\\S+)((?:.*\\\\n\\\\s+.*)+)\", \"gm\");\n            ipv4Regex = new RegExp(\"inet\\\\s+(\\\\S+)\\\\/(\\\\d+)\", \"ig\");\n            ipv6Regex = new RegExp(\"inet6\\\\s+(\\\\S+)\\\\/(\\\\d+)\", \"ig\");\n            defaultGatewayRegex = new RegExp(\"^default\\\\s+via\\\\s+(\\\\S+).*dev\\\\s+(\\\\S+)\", \"gm\");\n            getMacAddressFunction = this.getIprouteMacAddress;\n        } else if (output.startsWith('net-tools output')) {\n            isIprouteOutput = false;\n            partsRegex = new RegExp(\"^(\\\\S+)\\\\s+((.*\\\\n\\\\B){0,})\", \"gm\");\n            ipv4Regex = new RegExp(\"inet (?:addr:)?(\\\\S+).*?(?:(?:mask:)|(?:netmask ))(\\\\S+)\", \"ig\");\n            ipv6Regex = new RegExp(\"inet6 (?:addr: )?(\\\\S+)(?:\\\\/|(?:\\\\s+prefixlen ))(\\\\d*)\", \"ig\");\n            defaultGatewayRegex = new RegExp(\"^0.0.0.0\\\\s+(\\\\S+)\\\\s+(?:\\\\S+\\\\s+){5}(\\\\S+)$\", \"gm\");\n            getMacAddressFunction = this.getNetToolsMacAddress;\n        } else {\n            g_probe.setError('Both net-tools and iproute commands failed to get network information');\n            return;\n        }\n\n\t\t// separate out the actual output\n\t\toutput = output.substring(sliceIndex + 1);\n\n        var idutil = new IDSensorUtil();\n\t\tvar adapterInfo = output.substring(0, output.indexOf('SNC_ROUTING_TABLE_SNC'));\n\t\tvar replaceAdapterInfo = adapterInfo + 'SNC_ROUTING_TABLE_SNC';\n\t\toutput.replace(replaceAdapterInfo, '');\n        related_data.adapters = idutil.getAdapters(adapterInfo, null,\n            partsRegex,\n            ipv4Regex,\n            ipv6Regex,\n            getMacAddressFunction);\n\n        related_data.default_gateway = idutil.getAdapterGateways(output, related_data.adapters,\n            defaultGatewayRegex);\n\n        if (isIprouteOutput)\n            idutil.getAdapterRoutesIproute(output, related_data.adapters);\n        else\n            idutil.getAdapterRoutes(output, related_data.adapters);\n    },\n\n    getIprouteMacAddress: function(output, adapterName, ipAddress) {\n        var macRegex = new RegExp(\"^\\\\d+:\\\\s+\" + adapterName + \".*link\\\\/\\\\S+\\\\s(\\\\S+)\", \"mg\");\n        var macMatch = macRegex.exec(output);\n        if (macMatch !== null && macMatch[1])\n            return macMatch[1];\n        return \"\";\n    },\n\n    // Take the IP address even though we don't use it because other sensors do use it\n    // and this is to keep the signature in sync to be called from a common function\n    // in the script include DiscoveryIDSensor\n    getNetToolsMacAddress: function(output, adapterName, ipAddress) {\n        // Centos  10 and RHEL 10 use a very different output format from older versions:\n        // - interface name has ':' after it\n        // - 'ether ' precedes the MAC address (instead of 'HWaddr'), and it's not on the first line.\n        var macRegex = new RegExp(\"^\" + adapterName + \"(?::?[\\\\S\\\\s]*(?:ether|HWaddr)\\\\s+(\\\\S+))\", \"mg\");\n        var macMatch = macRegex.exec(output);\n\n        if (macMatch !== null && macMatch[1])\n            return macMatch[1];\n        return \"\";\n    }\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_e643f2c2a9fe15610038fc84ebfc075a","ecc_queue_name":"sh ${file:linux_network.sh}","name":"Linux - Network","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Determine hardware information","host_classification":"false","sys_updated_on":"2014-10-07 22:07:15","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"e71ace1ba9fe1561011c33bdea27a1bb","sys_updated_by":"josh.gerbasi","sys_created_on":"2007-02-22 01:39:58","used_by_discovery":"true","sys_name":"Solaris - Hardware Model","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"21","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t\n    /**\n     * Runs the probe instance\n     */\n\tprocess : function() {\n\t\tvar lines = output.split(/\\n/);\n\t\t\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar line = lines[i];\n\t\t\t\n\t\t\tif (line == '')\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tvar parts = line.split(\":\");\n\t\t\tvar name = parts[0].trim();\n\t\t\tvar value = parts[1].trim();\n\t\t\t\n\t\t\tif (JSUtil.notNil(name)){\n\t\t\t\tif (name == \"Model\")\n\t\t\t\t\tcurrent.model_number = value;\n\t\t\t\telse if (name == \"Description\") {\n\t\t\t\t\tvar extraLen = value.indexOf('(');\n\t\t\t\t\tif (extraLen > -1)\n\t\t\t\t\t\tvalue = value.substring(0, extraLen);\n\t\t\t\t\tcurrent.model_id = value.trim();\n\t\t\t\t} else if (name == \"System Configuration\") {\n\t\t\t\t\tvalparts = value.split(\"  \");\n\t\t\t\t\tmfr = valparts[0];\n\t\t\t\t\tcurrent.manufacturer = mfr;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_e71ace1ba9fe1561011c33bdea27a1bb","ecc_queue_name":"sh ${file:suntype.sh}","name":"Solaris - Hardware Model","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve (active) running processes","host_classification":"false","sys_updated_on":"2024-10-17 21:18:06","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"e71cd26fa9fe156100b4b355bf835b9c","sys_updated_by":"now.discovery_infra","sys_created_on":"2007-02-22 01:42:10","used_by_discovery":"true","sys_name":"Solaris - Active Processes","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"22","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */\n    process: function() {\n        // parse the results from our ps output, leaving the result in sensor.running_processes...\n        var psop = new PsOutputParser();\n        var procs = psop.parse(output);\n        try {\n            var rpf = this.getParameter(\"running_process_filter\");\n            if (rpf) {\n\t\t\t\ttry {\n    \t            var filtering = new RunningProcessesFilter();\n\t                var filterDefs = JSON.parse(rpf);\n        \t        procs = filtering.filterResults(procs, filterDefs);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tvar evaluator = Packages.com.snc.discovery.runningprocess.api.RunningProcessFilterEvaluatorJSProvider.get();\n\t\t\t\t\tprocs = JSON.parse(evaluator.filter(rpf, procs));\n\t\t\t\t}\n            }\n        } catch (e) {\n            if (typeof ms != 'undefined')\n                ms.log(\"Solaris - Active Processes: Something went wrong while trying to filter processes. Error=\" + e);\n            else\n                // If we don't have access to ms, we are not on the MID\n                // Which means we are in classic mode:\n                DiscoveryLogger.warn(\"Solaris - Active Processes: Process filtering skipped. Classic mode is not supported.\");\n        }\n\n        related_data.running_processes = procs;\n        related_data.error_msg = psop.error_msg;\n    },\n\n    type: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_e71cd26fa9fe156100b4b355bf835b9c","ecc_queue_name":"sh ${file:ps.sh} ${zone}","name":"Solaris - Active Processes","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Get network info","host_classification":"false","sys_updated_on":"2018-04-11 18:23:07","type":"Java","sys_class_name":"discovery_probes","minor_version":"4","ecc_queue_source":"","sys_id":"e71d42e6a9fe156101817ee126468a90","sys_updated_by":"christopher.thompson","sys_created_on":"2007-02-22 01:42:39","used_by_discovery":"true","sys_name":"Solaris - Network","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"19","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n    /**\n     * Runs the probe instance\n     */    \n    process : function() {   \n\t\t\n\t\tif (JSUtil.nil(output))\n\t\t\treturn;\n\t\t\n\t\tvar idutil = new IDSensorUtil();\n\t\t\n\t\trelated_data.adapters = idutil.getAdapters(output, \" zone \", \n            new RegExp(\"^(\\\\S+)\\\\s+((.*\\\\n\\\\t.*){0,})\", \"gm\"),\n            new RegExp(\"inet (\\\\S+)\\\\s+netmask (\\\\S+)\", \"g\"), \n            new RegExp(\"inet6 (\\\\S+)\\\\/(\\\\d+)\", \"ig\"), \n            this.getMacAddress);\n\n\t\t/* Example line:\n\t\t * default              192.168.2.1          UG        1      16935 pcn0\n\t\t *\n\t\t * Match group 1: 192.168.2.1\n\t\t * Match group 2: pcn0\n\t\t */\n\t\trelated_data.default_gateway = idutil.getAdapterGateways(output, related_data.adapters, new RegExp(\"^default\\\\s+(\\\\S+)\\\\s+(?:\\\\S+\\\\s+){3}(\\\\S+)\\\\s*$\", \"gm\"));\n\t},\n\t\n    getMacAddress : function(output, adapterName, ipAddress) {\n\t\t\n        var macRegex = new RegExp(\"^\" + adapterName + \".*? ether (\\\\S+)\", \"mg\");\n        var macMatch = macRegex.exec(output);\n        if (macMatch)\n            return macMatch[1];\n\n\t    macRegex = new RegExp(\"^\" + adapterName + \"\\\\s+\" + ipAddress + \"\\\\s+.*?(\\\\S+)$\", \"mg\");\n        macMatch = macRegex.exec(output);\n        if (macMatch)\n            return macMatch[1];\n\n        return \"\";\n    }\n\t\t\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_e71d42e6a9fe156101817ee126468a90","ecc_queue_name":"ifconfig -a; netstat -pnr -f inet","name":"Solaris - Network","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"true","description":"Gather MySQL version information","host_classification":"false","sys_updated_on":"2014-09-09 20:57:54","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"ea4afa31df5221001e02a3cf6bf263e2","sys_updated_by":"swapnesh.patel","sys_created_on":"2014-08-03 21:32:37","used_by_discovery":"true","sys_name":"Windows - MySQL Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"swapnesh.patel","ecc_queue_topic":"Powershell","sys_mod_count":"10","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\t/**\n \t* Runs the probe instance\n \t*/\n\tprocess : function() {\n\t\tif (JSUtil.notNil(output))\n\t\t\tcurrent.version = this.parseOutput(output);\n\t},\n\tparseOutput: function(output) {\n\t\tvar lines = output.split(\"\\n\");\n\t\tfor (var i = 0; i < lines.length; i++) {\n\t\t\tvar line = lines[i];\n\t\t\tvar indx = line.indexOf(\" Ver \");\n\t\t\tif ( indx > -1) {\n\t\t\t\tvar version = line.substring(indx + 5);\n\t\t\t\tversion = version.substring(0, version.indexOf(\" \"));\n\t\t\t\treturn version;\n\t\t\t}\n\t\t}\n\t},\n\ttype: \"ProbePostProcessor\"\n});","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_ea4afa31df5221001e02a3cf6bf263e2","ecc_queue_name":"Windows - MySQL Version","name":"Windows - MySQL Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"Determines what devices are active by doing a targeted port scanning ","host_classification":"false","sys_updated_on":"2020-04-09 08:36:43","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"eb95df760ab301550015543188996362","sys_updated_by":"benjamin.phan","sys_created_on":"2009-01-18 21:11:54","used_by_discovery":"true","sys_name":"Shazzam","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"Shazzam","sys_mod_count":"13","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"3","sys_update_name":"discovery_probes_eb95df760ab301550015543188996362","ecc_queue_name":"","name":"Shazzam","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Retrieve Apache configuration information","host_classification":"false","sys_updated_on":"2016-07-08 07:16:34","type":"Java","sys_class_name":"discovery_probes","minor_version":"2","ecc_queue_source":"","sys_id":"ef1c9c3d0a0a0b1000d1016807e46dae","sys_updated_by":"chris.nguyen","sys_created_on":"2007-12-18 21:15:37","used_by_discovery":"true","sys_name":"Apache - Get Configuration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"15","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"2","sys_update_name":"discovery_probes_ef1c9c3d0a0a0b1000d1016807e46dae","ecc_queue_name":"sh ${file:get-apcfg.sh} -${httpd_command} -${httpd_dir} -${httpd_cfg}","name":"Apache - Get Configuration","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Find a directory listing of Weblogic deployed web.xml","host_classification":"false","sys_updated_on":"2017-05-15 08:09:20","type":"Java","sys_class_name":"discovery_probes","minor_version":"3","ecc_queue_source":"","sys_id":"f3301ebfc3a12100d8d4bea192d3ae0a","sys_updated_by":"marjan.marzban","sys_created_on":"2014-07-03 16:49:36","used_by_discovery":"true","sys_name":"Linux - Weblogic - Find config.xml","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"josh.gerbasi","ecc_queue_topic":"SSHCommand","sys_mod_count":"64","sys_tags":"","post_processor_script":"new ProbePostProcessor({\n\n\t/**\n     * Runs the probe instance\n     */\n    process : function() {\n\t\trelated_data.apps = [];\n\t\trelated_data.servers = [];\n\n\t\tif (output == \"This is not an AdminServer\") {\n\t\t\trelated_data.info = \"This probe was triggered on a Managed Server and not an AdminServer so processing will be skipped.\";\n\t\t\treturn;\n\t\t}\n\n        // Parse config.xml for server info\n        var xmlDoc = XMLUtil.parse(output);\n\n\t\tif (!xmlDoc)\n\t\t\treturn;\n\n        var parent = xmlDoc.getDocumentElement();\n        var version = this.getTextFromChildNode(parent, \"domain-version\");\n        current.version = version;\n\t\tvar domain = this.getTextFromChildNode(parent, \"name\");\n        current.weblogic_domain = domain;\n\n        var servers = XMLUtil.selectNodes(parent, \"//server\");\n        // Create or Update weblogic server CIs\n        for (var i = 0; i < servers.length; i++) {\n\t\t\tvar serverNode = servers.item(i);\n\t\t\tvar name = this.getTextFromChildNode(serverNode, \"name\");\n\t\t\trelated_data.servers.push(name);\n\t\t}\n\n\t\tvar apps = XMLUtil.selectNodes(parent, \"//app-deployment\");\n        for (var i = 0; i < apps.length; i++) {\n\t\t\tvar appNode = apps.item(i);\n\t\t\tvar target = this.getTextFromChildNode(appNode, \"target\");\n\t\t\t// Case when same app is deployed to multiple servers\n\t\t\t// Commas are not valid server names so this should be safe\n\t\t\tvar targets = target.split(\",\");\n\t\t\tfor (var j = 0; j < targets.length; j++) {\n\t\t\t\tif (targets[j] != \"\") {\n\t\t\t\t\tvar app = {\n\t\t\t\t\t\t'name' : this.getTextFromChildNode(appNode, \"name\"),\n\t\t\t\t\t\t'path' : this.getTextFromChildNode(appNode, \"source-path\"),\n\t\t\t\t\t\t'target' : targets[j] + ''\n\t\t\t\t\t};\n\t\t\t\t\trelated_data.apps.push(app);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tgetTextFromChildNode: function(parent, target) {\n\t\tvar node = XMLUtil.getChildByTagName(parent, target);\n\t\treturn XMLUtil.getAllText(node);\n    },\n\n\ttype: \"ProbePostProcessor\"\n});\n","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_f3301ebfc3a12100d8d4bea192d3ae0a","ecc_queue_name":"sh ${file:findcat.sh} ${ppid} ${config}","name":"Linux - Weblogic - Find config.xml","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Determine Tomcat version","host_classification":"false","sys_updated_on":"2018-03-13 00:13:08","type":"Java","sys_class_name":"discovery_probes","minor_version":"1","ecc_queue_source":"","sys_id":"f39d6a930a0a0b780004c15893b3cfe4","sys_updated_by":"marjan.marzban","sys_created_on":"2007-10-31 01:12:00","used_by_discovery":"true","sys_name":"Tomcat - Get Version","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommand","sys_mod_count":"9","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_f39d6a930a0a0b780004c15893b3cfe4","ecc_queue_name":"sh ${file:findcat.sh} ${catalina_home}","name":"Tomcat - Get Version","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"true","description":"Gather HBase configuration information","host_classification":"false","sys_updated_on":"2014-07-28 22:09:47","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"f53594879f4221001e021a1cf67fcfa1","sys_updated_by":"admin","sys_created_on":"2014-07-25 20:27:39","used_by_discovery":"true","sys_name":"HBase - Configuration","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"SSHCommand","sys_mod_count":"2","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_f53594879f4221001e021a1cf67fcfa1","ecc_queue_name":"cat ${filename}","name":"HBase - Configuration","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"This probe's implementation is located in a MID server script include named VMWarevCenterClusterDRSProbe.","host_classification":"false","sys_updated_on":"2019-10-03 10:49:20","type":"Java","sys_class_name":"discovery_probes","minor_version":"0","ecc_queue_source":"","sys_id":"fa10cf6e5b33330012868473b881c7c1","sys_updated_by":"valarmathi.kannan","sys_created_on":"2019-09-13 09:07:35","used_by_discovery":"true","sys_name":"VMWare - vCenter Cluster DRS Probe","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"admin","ecc_queue_topic":"VMWareProbe","sys_mod_count":"2","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"1","sys_update_name":"discovery_probes_fa10cf6e5b33330012868473b881c7c1","ecc_queue_name":"VMWarevCenterClusterDRSProbe","name":"VMWare - vCenter Cluster DRS Probe","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"true","classic_mode":"false","cache_results":"false","description":"A probe that is consists of command line execution of shell scripts after logging in via ssh and takes a long time to run","host_classification":"false","sys_updated_on":"2010-11-28 20:54:31","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"fea359330a0a0b66003636a003d3647d","sys_updated_by":"jimmy.yuan","sys_created_on":"2008-07-07 17:48:15","used_by_discovery":"false","sys_name":"SSHCommandLong","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"glide.maint","ecc_queue_topic":"SSHCommandLong","sys_mod_count":"15","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_fea359330a0a0b66003636a003d3647d","ecc_queue_name":"","name":"SSHCommandLong","execute_script_remotely":"false","sys_policy":""},{"copy_script_to_target":"false","used_by_runbook":"false","classic_mode":"false","cache_results":"false","description":"Gather serial number information from Mac OS X machines.","host_classification":"false","sys_updated_on":"2012-11-04 14:51:36","type":"Java","sys_class_name":"discovery_probes","minor_version":"","ecc_queue_source":"","sys_id":"fed6fb7affb200006857361332f49d35","sys_updated_by":"tom.dilatush","sys_created_on":"2011-05-26 23:51:13","used_by_discovery":"true","sys_name":"Mac OS X - Serial Number","sys_scope":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_scope/global","value":"global"},"sys_created_by":"aleck.lin","ecc_queue_topic":"SSHCommand","sys_mod_count":"4","sys_tags":"","post_processor_script":"","script":"","sys_package":{"link":"https://dev315171.service-now.com/api/now/v1/table/sys_package/91d8237704f12210559073c06a02f73b","value":"91d8237704f12210559073c06a02f73b"},"major_version":"","sys_update_name":"discovery_probes_fed6fb7affb200006857361332f49d35","ecc_queue_name":"system_profiler SPHardwareDataType -xml","name":"Mac OS X - Serial Number","execute_script_remotely":"false","sys_policy":""}]}